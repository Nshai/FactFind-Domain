
<!-- FactFind API Design Specification -->
# FactFind System API Design Specification
## Comprehensive RESTful API for Wealth Management Platform

**Date:** 2026-02-19
**Status:** Design Specification
**API Version:** v2
**Base URL:** `https://api.factfind.com`
**Source:** Complete Domain Coverage (50+ entities, 2,000+ fields)

---

## Executive Summary

This document presents a comprehensive RESTful API design for the FactFind system, a wealth management platform built on Domain-Driven Design (DDD) principles. The API architecture follows industry best practices and provides complete coverage of all business capabilities required for modern financial advisory services.

### Overview

**Business Domain:** Wealth Management & Financial Advisory
**Total Entities:** 50+ entities across 8 bounded contexts
**Total Fields:** 1,786 business fields from Excel specification
**Regulatory Compliance:** FCA Handbook, MiFID II, IDD, Consumer Duty, GDPR, MLR 2017
**Industry Standards:** Aligned with Intelligent Office, Salesforce FSC, Xplan, MoneyHub

### API Scope

The FactFind API provides comprehensive digital capabilities for:

1. **Client Onboarding & KYC** - Client management, identity verification, regulatory compliance
2. **Circumstances Discovery** - Fact-finding, employment, income, expenditure tracking
3. **Arrangements Management** - Pensions, investments, protection, mortgages
4. **Goals & Objectives** - Financial goal setting and tracking
5. **Risk Profiling** - Attitude to risk assessment and capacity for loss
6. **Estate Planning** - Gifts, trusts, and inheritance tax planning
7. **Reference Data** - Centralized lookup data management

### Key Features

- **RESTful Architecture** - Resource-oriented design with proper HTTP semantics
- **Single Contract Principle** - One unified contract per entity for create, update, and response operations
- **Aggregate-Based** - APIs organized around DDD aggregates for transactional consistency
- **Event-Driven** - Domain events for loose coupling and integration
- **Industry-Standard** - FCA-compliant terminology and data structures
- **Production-Ready** - Complete request/response contracts with validation rules
- **HATEOAS Level 3** - Hypermedia controls for API discoverability
- **Multi-Tenancy** - Built-in tenant isolation for SaaS deployment

### Target Audience

- **API Consumers:** Frontend developers, mobile app developers, integration partners
- **Backend Developers:** Implementation teams building the API services
- **Product Owners:** Business stakeholders understanding API capabilities
- **Architects:** System designers reviewing architectural decisions
- **Compliance Teams:** Regulatory compliance verification


## Table of Contents

1. [API Design Principles](#1-api-design-principles)
   - [1.1 RESTful Architecture](#11-restful-architecture)
   - [1.2 Naming Conventions](#12-naming-conventions)
   - [1.3 HTTP Methods & Status Codes](#13-http-methods--status-codes)
   - [1.4 Error Response Format](#14-error-response-format-rfc-7807)
   - [1.5 API Architecture & Aggregate Root Pattern](#15-api-architecture--aggregate-root-pattern)
      - [1.5.1 Hierarchical Structure](#151-hierarchical-structure)
      - [1.5.2 FactFind as Aggregate Root](#152-factfind-as-aggregate-root)
      - [1.5.3 Context-Based Organization](#153-context-based-organization)
      - [1.5.4 Benefits of This Approach](#154-benefits-of-this-approach)
      - [1.5.5 Transactional Boundaries](#155-transactional-boundaries)
      - [1.5.6 Entity Lifecycle](#156-entity-lifecycle)
      - [1.5.7 Special Considerations](#157-special-considerations)
   - [1.6 Versioning Strategy](#16-versioning-strategy)
   - [1.7 Single Contract Principle](#17-single-contract-principle)
   - [1.8 Value and Reference Type Semantics](#18-value-and-reference-type-semantics)
      - [1.8.1 Value Types](#181-value-types)
      - [1.8.2 Reference Types](#182-reference-types)
      - [1.8.3 When to Use Value vs Reference Types](#183-when-to-use-value-vs-reference-types)
      - [1.8.4 Benefits of Value/Reference Semantics](#184-benefits-of-valuereference-semantics)
      - [1.8.5 Resource Expansion](#185-resource-expansion)
      - [1.8.6 Creating and Updating References](#186-creating-and-updating-references)
   - [1.9 Aggregate Root Pattern](#19-aggregate-root-pattern)
      - [1.9.1 What is an Aggregate Root?](#191-what-is-an-aggregate-root)
      - [1.9.2 Why FactFind is the Aggregate Root](#192-why-factfind-is-the-aggregate-root)
      - [1.9.3 What This Means for API Consumers](#193-what-this-means-for-api-consumers)
      - [1.9.4 Transactional Boundaries](#194-transactional-boundaries)
      - [1.9.5 Entity Lifecycle](#195-entity-lifecycle)
      - [1.9.6 Special Operations](#196-special-operations)
      - [1.9.7 Benefits of This Approach](#197-benefits-of-this-approach)
      - [1.9.8 Reference Data Exception](#198-reference-data-exception)
2. [Authentication & Authorization](#2-authentication--authorization)
   - [2.1 OAuth 2.0 with JWT](#21-oauth-20-with-jwt)
   - [2.2 Authorization Scopes](#22-authorization-scopes)
   - [2.3 Multi-Tenancy](#23-multi-tenancy)
   - [2.4 Sensitive Data Handling](#24-sensitive-data-handling)
   - [2.5 Audit Logging](#25-audit-logging)
3. [Common Patterns](#3-common-patterns)
   - [3.1 Pagination](#31-pagination)
   - [3.2 Filtering & Sorting](#32-filtering--sorting)
   - [3.3 Field Selection (Sparse Fieldsets)](#33-field-selection-sparse-fieldsets)
   - [3.4 Resource Expansion](#34-resource-expansion)
   - [3.5 Optimistic Concurrency Control](#35-optimistic-concurrency-control)
   - [3.6 Batch Operations](#36-batch-operations)
   - [3.7 HATEOAS (Hypermedia Controls)](#37-hateoas-hypermedia-controls)
   - [3.8 Data Types](#38-data-types)
4. [FactFind API (Root Aggregate)](#4-factfind-api-root-aggregate)
   - [4.1 Overview](#41-overview)
   - [4.2 Operations Summary](#42-operations-summary)
   - [4.3 Key Endpoints](#43-key-endpoints)
      - [4.3.1 Create Client](#431-create-client)
      - [4.3.2 Get Client](#432-get-client)
      - [4.3.3 List Clients](#433-list-clients)
      - [4.3.4 Add Address](#434-add-address)
      - [4.3.5 Update Vulnerability Assessment](#435-update-vulnerability-assessment)
   - [4.4 Current Position Summary API](#44-current-position-summary-api)
      - [4.4.1 Operations Summary](#441-operations-summary)
      - [4.4.2 Key Endpoints](#442-key-endpoints)
         - [4.4.2.1 Get Current Position Summary](#4421-get-current-position-summary)
5. [Client Management API](#5-client-management-api)
   - [5.1 Overview](#51-overview)
   - [5.2 Operations Summary](#52-operations-summary)
   - [5.3 Key Endpoints](#53-key-endpoints)
      - [5.3.1 Create FactFind](#531-create-factfind)
      - [5.3.2 Add Income](#532-add-income)
      - [5.3.3 Add Expenditure](#533-add-expenditure)
      - [5.3.4 Get FactFind Summary](#534-get-factfind-summary)
   - [5.4 Estate Planning](#54-estate-planning)
      - [5.4.1 Operations Summary](#541-operations-summary)
      - [5.4.2 Get Estate Planning Overview](#542-get-estate-planning-overview)
      - [5.4.3 Update Estate Planning Details](#543-update-estate-planning-details)
      - [5.4.4 Record Gift](#544-record-gift)
      - [5.4.5 List Gifts](#545-list-gifts)
      - [5.4.6 Create Gift Trust](#546-create-gift-trust)
   - [5.5 Dependants](#55-dependants)
      - [5.5.1 Operations Summary](#551-operations-summary)
      - [5.5.2 List Dependants](#552-list-dependants)
      - [5.5.3 Create Dependant](#553-create-dependant)
      - [5.5.4 Get Dependant Details](#554-get-dependant-details)
      - [5.5.5 Update Dependant](#555-update-dependant)
      - [5.5.6 Delete Dependant](#556-delete-dependant)
   - [5.6 Notes](#56-notes)
      - [5.6.1 Operations Summary](#561-operations-summary)
      - [5.6.2 List Notes](#562-list-notes)
      - [5.6.3 Create Note](#563-create-note)
      - [5.6.4 Update Note](#564-update-note)
      - [5.6.5 Delete Note](#565-delete-note)
   - [5.7 Custom Questions (Supplementary Questions)](#57-custom-questions-supplementary-questions)
      - [5.7.1 Operations Summary](#571-operations-summary)
      - [5.7.2 List Custom Questions](#572-list-custom-questions)
      - [5.7.3 Create Custom Question](#573-create-custom-question)
      - [5.7.4 Get Custom Question Details](#574-get-custom-question-details)
      - [5.7.5 Update Custom Question](#575-update-custom-question)
      - [5.7.6 Delete Custom Question](#576-delete-custom-question)
      - [5.7.7 Submit Question Answers](#577-submit-question-answers)
      - [5.7.8 Get Question Answers](#578-get-question-answers)
6. [Income & Expenditure API (Circumstances Context)](#6-income--expenditure-api-circumstances-context)
   - [6.1 Overview](#61-overview)
   - [6.2 Operations Summary](#62-operations-summary)
   - [6.3 Key Endpoints](#63-key-endpoints)
      - [6.3.1 List Income Sources](#631-list-income-sources)
      - [6.3.2 Create Income Source](#632-create-income-source)
      - [6.3.3 Create Income Change](#633-create-income-change)
      - [6.3.4 List Expenditure Items](#634-list-expenditure-items)
      - [6.3.5 Create Expenditure Item](#635-create-expenditure-item)
      - [6.3.6 Create Expenditure Change](#636-create-expenditure-change)
   - [6.4 Affordability](#64-affordability)
      - [6.4.1 Overview](#641-overview)
      - [6.4.2 Operations Summary](#642-operations-summary)
      - [6.4.3 Key Endpoints](#643-key-endpoints)
7. [Employment API (Circumstances Context)](#7-employment-api-circumstances-context)
   - [7.1 Overview](#71-overview)
   - [7.2 Operations Summary](#72-operations-summary)
   - [7.3 Key Endpoints](#73-key-endpoints)
      - [7.3.1 List Employment Records](#731-list-employment-records)
      - [7.3.2 Get Employment Details (Self-Employed Example)](#732-get-employment-details-self-employed-example)
      - [7.3.3 Get Employment Details (Employed Example)](#733-get-employment-details-employed-example)
      - [7.3.4 Create Employment Record (Self-Employed)](#734-create-employment-record-self-employed)
      - [7.3.5 Create Employment Record (Employed)](#735-create-employment-record-employed)
      - [7.3.6 Update Employment Record](#736-update-employment-record)
      - [7.3.7 Delete Employment Record](#737-delete-employment-record)
   - [7.4 Employment Status Types](#74-employment-status-types)
   - [7.5 Employment Business Type (Self-Employed)](#75-employment-business-type-self-employed)
   - [7.6 Field Definitions](#76-field-definitions)
   - [7.7 Validation Rules](#77-validation-rules)
   - [7.8 Business Rules](#78-business-rules)
   - [7.9 Use Cases](#79-use-cases)
8. [Credit History API](#8-credit-history-api)
   - [8.1 Overview](#81-overview)
   - [8.2 Operations Summary](#82-operations-summary)
   - [8.3 Key Endpoints](#83-key-endpoints)
      - [8.3.1 Get Credit History](#831-get-credit-history)
      - [8.3.2 Create Credit History Record](#832-create-credit-history-record)
      - [8.3.3 Update Credit History Record](#833-update-credit-history-record)
      - [8.3.4 Add Adverse Credit Event](#834-add-adverse-credit-event)
   - [8.4 Field Definitions](#84-field-definitions)
   - [8.5 Validation Rules](#85-validation-rules)
   - [8.6 Business Rules](#86-business-rules)
9. [Goals & Objectives API (Goals Context)](#9-goals--objectives-api-goals-context)
   - [9.1 Overview](#91-overview)
   - [9.2 Operations Summary](#92-operations-summary)
   - [9.3 Objective Types and Contracts](#93-objective-types-and-contracts)
      - [9.3.1 Investment Objectives](#931-investment-objectives)
      - [9.3.2 Pension Objectives](#932-pension-objectives)
      - [9.3.3 Protection Objectives](#933-protection-objectives)
      - [9.3.4 Mortgage Objectives](#934-mortgage-objectives)
      - [9.3.5 Budget Objectives](#935-budget-objectives)
      - [9.3.6 Estate Planning Objectives](#936-estate-planning-objectives)
   - [9.4 Needs Sub-Resources](#94-needs-sub-resources)
10. [Assets & Liabilities API](#10-assets--liabilities-api)
   - [10.1 Overview](#101-overview)
   - [10.2 Operations Summary](#102-operations-summary)
   - [10.3 Key Endpoints](#103-key-endpoints)
      - [10.3.1 List Assets](#1031-list-assets)
      - [10.3.2 Create Asset](#1032-create-asset)
      - [10.3.3 Get Property Details](#1033-get-property-details)
      - [10.3.4 List Liabilities](#1034-list-liabilities)
      - [10.3.5 Get Assets Summary](#1035-get-assets-summary)
      - [10.3.6 Calculate Net Worth](#1036-calculate-net-worth)
11. [Arrangements API (Type-Based Routing)](#11-arrangements-api-type-based-routing)
   - [11.1 Overview](#111-overview)
   - [11.2 Arrangement Types and Routing](#112-arrangement-types-and-routing)
   - [11.3 Investment Arrangements](#113-investment-arrangements)
      - [11.3.1 GIA (General Investment Account)](#1131-gia-general-investment-account)
      - [11.3.2 ISA (Individual Savings Account)](#1132-isa-individual-savings-account)
      - [11.3.3 Investment Bonds](#1133-investment-bonds)
      - [11.3.4 Investment Trusts](#1134-investment-trusts)
      - [11.3.5 Platform Accounts](#1135-platform-accounts)
      - [11.3.6 Offshore Bonds](#1136-offshore-bonds)
      - [11.3.7 Cash Accounts](#1137-cash-accounts)
   - [11.4 Pension Arrangements](#114-pension-arrangements)
      - [11.4.1 Personal Pension](#1141-personal-pension)
      - [11.4.2 State Pension](#1142-state-pension)
      - [11.4.3 Workplace Pension](#1143-workplace-pension)
      - [11.4.4 SIPP (Self-Invested Personal Pension)](#1144-sipp-self-invested-personal-pension)
      - [11.4.5 Final Salary (Defined Benefit)](#1145-final-salary-defined-benefit)
      - [11.4.6 Pension Drawdown](#1146-pension-drawdown)
      - [11.4.7 Annuity](#1147-annuity)
      - [11.4.8 Money Purchase](#1148-money-purchase)
   - [11.5 Mortgage Arrangements](#115-mortgage-arrangements)
   - [11.6 Protection Arrangements](#116-protection-arrangements)
      - [11.6.1 Personal Protection (Life, CI, IP)](#1161-personal-protection-life-ci-ip)
      - [11.6.2 General Insurance](#1162-general-insurance)
   - [11.7 Arrangement Sub-Resources](#117-arrangement-sub-resources)
      - [11.7.1 Contributions](#1171-contributions)
      - [11.7.2 Withdrawals](#1172-withdrawals)
      - [11.7.3 Beneficiaries](#1173-beneficiaries)
      - [11.7.4 Valuations](#1174-valuations)
12. [Risk Profile API](#12-risk-profile-api)
   - [12.1 Overview](#121-overview)
   - [12.2 Operations Summary](#122-operations-summary)
   - [12.3 Key Endpoints](#123-key-endpoints)
      - [12.3.1 Get Current ATR Assessment](#1231-get-current-atr-assessment)
      - [12.3.2 Submit/Update ATR Assessment](#1232-submitupdate-atr-assessment)
      - [12.3.3 Choose Risk Profile](#1233-choose-risk-profile)
      - [12.3.4 Get ATR Assessment History (Risk Replay)](#1234-get-atr-assessment-history-risk-replay)
   - [12.4 ATR Templates Reference Data](#124-atr-templates-reference-data)
      - [12.4.1 List Available ATR Templates](#1241-list-available-atr-templates)
      - [12.4.2 Get ATR Template Details](#1242-get-atr-template-details)
   - [12.5 Risk Assessment History API](#125-risk-assessment-history-api)
      - [12.5.1 Compare Two Assessments](#1251-compare-two-assessments)
   - [12.6 Integration with FactFind Workflow](#126-integration-with-factfind-workflow)
13. [Reference Data API](#13-reference-data-api)
   - [13.1 Performance Considerations](#131-performance-considerations)
   - [13.2 Caching Strategy](#132-caching-strategy)
   - [13.3 Rate Limiting](#133-rate-limiting)
   - [13.4 API Versioning](#134-api-versioning)
   - [13.5 Security Best Practices](#135-security-best-practices)
14. [Entity Contracts](#14-entity-contracts)
   - [14.1 Client Contract](#141-client-contract)
      - [14.1.1 Person Client Example](#1411-person-client-example)
      - [14.1.2 Corporate Client Example](#1412-corporate-client-example)
      - [14.1.3 Trust Client Example](#1413-trust-client-example)
      - [14.1.4 Field Behaviors (Composition Pattern)](#1414-field-behaviors-composition-pattern)
      - [14.1.5 PersonValue Type Definition](#1415-personvalue-type-definition)
      - [14.1.6 CorporateValue Type Definition](#1416-corporatevalue-type-definition)
      - [14.1.7 TrustValue Type Definition](#1417-trustvalue-type-definition)
      - [14.1.8 AddressValue Type](#1418-addressvalue-type)
      - [14.1.9 ContactValue Type](#1419-contactvalue-type)
      - [14.1.10 IdentityVerificationValue Type](#14110-identityverificationvalue-type)
      - [14.1.11 VulnerabilityValue Type](#14111-vulnerabilityvalue-type)
      - [14.1.12 DataProtectionValue Type](#14112-dataprotectionvalue-type)
      - [14.1.13 MarketingPreferencesValue Type](#14113-marketingpreferencesvalue-type)
      - [14.1.14 EstatePlanningValue Type](#14114-estateplanningvalue-type)
      - [14.1.15 FinancialProfileValue Type](#14115-financialprofilevalue-type)
      - [14.1.16 TerritorialProfileValue Type](#14116-territorialprofilevalue-type)
      - [14.1.17 Validation Rules by Client Type](#14117-validation-rules-by-client-type)
      - [14.1.18 Usage Examples](#14118-usage-examples)
   - [14.2 FactFind Contract](#142-factfind-contract)
      - [14.2.1 MeetingDetailsValue Type](#1421-meetingdetailsvalue-type)
      - [14.2.2 FinancialSummaryValue Type](#1422-financialsummaryvalue-type)
      - [14.2.3 AssetHoldingsValue Type](#1423-assetholdingsvalue-type)
      - [14.2.4 InvestmentCapacityValue Type](#1424-investmentcapacityvalue-type)
      - [14.2.5 CompletionStatusValue Type](#1425-completionstatusvalue-type)
   - [14.3 Address Contract](#143-address-contract)
   - [14.4 Income Contract](#144-income-contract)
   - [14.5 Arrangement Contract](#145-arrangement-contract)
   - [14.6 Goal Contract](#146-goal-contract)
   - [14.7 RiskProfile Contract](#147-riskprofile-contract)
   - [14.8 Investment Contract](#148-investment-contract)
   - [14.9 Property Contract](#149-property-contract)
   - [14.10 Equity Contract](#1410-equity-contract)
   - [14.11 IdentityVerification Contract](#1411-identityverification-contract)
   - [14.12 Consent Contract](#1412-consent-contract)
   - [14.13 Collection Response Wrapper](#1413-collection-response-wrapper)
   - [14.14 Contract Extension for Other Entities](#1414-contract-extension-for-other-entities)
   - [14.15 Standard Value Types](#1415-standard-value-types)
      - [14.15.1 MoneyValue](#14151-moneyvalue)
      - [14.15.2 AddressValue](#14152-addressvalue)
      - [14.15.3 DateRangeValue](#14153-daterangevalue)
      - [14.15.4 NameValue](#14154-namevalue)
      - [14.15.5 ContactValue](#14155-contactvalue)
      - [14.15.6 PercentageValue](#14156-percentagevalue)
      - [14.15.7 RateValue](#14157-ratevalue)
      - [14.15.8 TaxDetailsValue](#14158-taxdetailsvalue)
      - [14.15.9 AdverseCreditEvent](#14159-adversecreditevent)
      - [14.15.10 Enumeration Value Types](#141510-enumeration-value-types)
   - [14.16 Standard Reference Types](#1416-standard-reference-types)
      - [14.16.1 ClientRef](#14161-clientref)
      - [14.16.2 AdviserRef](#14162-adviserref)
      - [14.16.3 ProviderRef](#14163-providerref)
      - [14.16.4 ArrangementRef](#14164-arrangementref)
      - [14.16.5 EmploymentRef](#14165-employmentref)
      - [14.16.6 GoalRef](#14166-goalref)
      - [14.16.7 FactFindRef](#14167-factfindref)
   - [14.17 Asset Contract](#1417-asset-contract)
   - [14.18 Liability Contract](#1418-liability-contract)
   - [14.19 Employment Contract](#1419-employment-contract)
   - [14.20 Budget Contract](#1420-budget-contract)
   - [14.21 Expenditure Contract](#1421-expenditure-contract)
   - [14.22 Credit History Contract](#1422-credit-history-contract)
   - [14.23 Property Detail Contract](#1423-property-detail-contract)
   - [14.25 Notes Contract](#1425-notes-contract)
   - [14.26 Dependant Contract](#1426-dependant-contract)
   - [14.27 Income Changes Contract](#1427-income-changes-contract)
   - [14.28 Expenditure Changes Contract](#1428-expenditure-changes-contract)
   - [14.29 Affordability](#1429-affordability)
   - [14.30 Contact Contract](#1430-contact-contract)
   - [14.31 Attitude to Risk (ATR) Contract](#1431-attitude-to-risk-atr-contract)
   - [14.32 Professional Contact Contract](#1432-professional-contact-contract)
   - [14.33 Vulnerability Contract](#1433-vulnerability-contract)
   - [14.34 Marketing Preferences Contract](#1434-marketing-preferences-contract)
   - [14.35 Estate Planning - Will Contract](#1435-estate-planning---will-contract)
   - [14.36 Estate Planning - Lasting Power of Attorney (LPA) Contract](#1436-estate-planning---lasting-power-of-attorney-lpa-contract)
   - [14.38 Estate Planning - Gift Contract](#1438-estate-planning---gift-contract)
   - [14.39 Estate Planning - Trust Contract](#1439-estate-planning---trust-contract)
   - [14.40 Identity Verification & Data Protection Consent Contract](#1440-identity-verification--data-protection-consent-contract)
   - [14.41 Arrangement - Mortgage Contract](#1441-arrangement---mortgage-contract)
   - [14.42 Arrangement - Investment Contract (General Investment Account)](#1442-arrangement---investment-contract-general-investment-account)
   - [14.43 Arrangement - Protection Contract (Life Assurance)](#1443-arrangement---protection-contract-life-assurance)
   - [14.44 Arrangement - Pension Contract (Personal Pension)](#1444-arrangement---pension-contract-personal-pension)
   - [14.45 Arrangement - Pension Contract (SIPP)](#1445-arrangement---pension-contract-sipp)
   - [14.46 Arrangement - Pension Contract (Final Salary / Defined Benefit)](#1446-arrangement---pension-contract-final-salary--defined-benefit)
   - [14.47 Arrangement - Pension Contract (Money Purchase)](#1447-arrangement---pension-contract-money-purchase)
   - [14.48 Arrangement - Pension Contract (State Pension)](#1448-arrangement---pension-contract-state-pension)
   - [14.49 Arrangement - Pension Contract (Stakeholder Pension)](#1449-arrangement---pension-contract-stakeholder-pension)
   - [14.50 Arrangement - Pension Contract (Group Personal Pension)](#1450-arrangement---pension-contract-group-personal-pension)
   - [14.51 Arrangement - Pension Contract (Executive Pension Plan)](#1451-arrangement---pension-contract-executive-pension-plan)
   - [14.52 Arrangement - Investment Contract (Stocks & Shares ISA)](#1452-arrangement---investment-contract-stocks--shares-isa)
   - [14.53 Arrangement - Investment Contract (Cash ISA)](#1453-arrangement---investment-contract-cash-isa)
   - [14.54 Arrangement - Investment Contract (Lifetime ISA)](#1454-arrangement---investment-contract-lifetime-isa)
   - [14.55 Arrangement - Investment Contract (Investment Bond - Onshore)](#1455-arrangement---investment-contract-investment-bond---onshore)
   - [14.56 Arrangement - Investment Contract (Investment Bond - Offshore)](#1456-arrangement---investment-contract-investment-bond---offshore)
   - [14.57 Arrangement - Investment Contract (Savings Account / Cash Deposit)](#1457-arrangement---investment-contract-savings-account--cash-deposit)
   - [14.58 Arrangement - Protection Contract (Critical Illness Cover)](#1458-arrangement---protection-contract-critical-illness-cover)
   - [14.59 Arrangement - Protection Contract (Income Protection Insurance)](#1459-arrangement---protection-contract-income-protection-insurance)
   - [14.60 Arrangement - Protection Contract (Buildings Insurance)](#1460-arrangement---protection-contract-buildings-insurance)
   - [14.61 Arrangement - Protection Contract (Contents Insurance)](#1461-arrangement---protection-contract-contents-insurance)
   - [14.62 Arrangement - Protection Contract (Private Medical Insurance)](#1462-arrangement---protection-contract-private-medical-insurance)
   - [14.63 Arrangement - Mortgage Contract (Lifetime Mortgage - Equity Release)](#1463-arrangement---mortgage-contract-lifetime-mortgage---equity-release)
   - [14.64 Arrangement - Mortgage Contract (Buy-to-Let Mortgage)](#1464-arrangement---mortgage-contract-buy-to-let-mortgage)


**Appendices:**
- [Appendix A: Complete Entity-to-Endpoint Mapping](#appendix-a-complete-entity-to-endpoint-mapping)
- [Appendix B: HTTP Status Code Reference](#appendix-b-http-status-code-reference)
- [Appendix C: Data Type Formats](#appendix-c-data-type-formats)
- [Appendix D: Common Enumerations](#appendix-d-common-enumerations)
- [Appendix E: Security Considerations](#appendix-e-security-considerations)

---

## 1. API Design Principles

### 1.1 RESTful Architecture

The FactFind API strictly follows REST architectural principles:

**Resource-Oriented Design:**
- Resources are identified by URIs (e.g., `/api/v2/factfinds/{factfindId}/clients/123`)
- Resources are nouns, not verbs (clients, factfinds, arrangements)
- HTTP methods define operations (GET, POST, PUT, PATCH, DELETE)
- Proper HTTP status codes indicate outcomes

**Stateless Communication:**
- Each request contains all information needed to process it
- No server-side session state maintained
- Authentication via JWT tokens passed in Authorization header
- Enables horizontal scalability and load balancing

**Cacheable Responses:**
- ETags for optimistic concurrency control
- Cache-Control headers for performance optimization
- Conditional requests with If-Match/If-None-Match headers

**Layered System:**
- API Gateway for routing and security
- Service layer for business logic
- Data access layer for persistence
- Integration layer for external systems

### 1.2 Naming Conventions

**Resource URIs:**
```
/api/v2/factfinds/{factfindId}/clients                     (collection)
/api/v2/factfinds/{factfindId}/clients/{id}                (single resource)
/api/v2/factfinds/{factfindId}/clients/{id}/addresses      (sub-resource collection)
/api/v2/factfinds/{id}/income       (nested resource)
```

**Naming Rules:**
- Plural nouns for collections (`/clients`, `/factfinds`, `/arrangements`)
- Lowercase with hyphens for multi-word resources (`/contact-details`, `/risk-profiles`)
- Path parameters in camelCase (`{clientId}`, `{factfindId}`)
- Query parameters in camelCase (`sortBy`, `pageSize`, `includeArchived`)

**Property Naming (JSON):**
- camelCase for all properties (`firstName`, `dateOfBirth`, `grossAnnualIncome`)
- DateTime properties suffixed with `At` (`createdAt`, `updatedAt`)
- Date properties suffixed with `On` (`startedOn`, `completedOn`)
- Boolean properties prefixed with `is`, `has`, `can` (`isActive`, `hasWill`)

### 1.3 HTTP Methods & Status Codes

**Method Usage:**

| Method | Purpose | Success Response | Idempotent |
|--------|---------|------------------|------------|
| GET | Retrieve resource(s) | 200 OK | Yes |
| POST | Create new resource | 201 Created + Location header | No |
| PUT | Replace entire resource | 200 OK or 204 No Content | Yes |
| PATCH | Partial update | 200 OK or 204 No Content | Yes |
| DELETE | Remove resource | 204 No Content | Yes |

**Status Code Standards:**

**Success (2xx):**
- `200 OK` - Successful GET, PUT, PATCH with response body
- `201 Created` - Successful POST, Location header points to new resource
- `204 No Content` - Successful PUT, PATCH, DELETE with no response body

**Client Errors (4xx):**
- `400 Bad Request` - Invalid request syntax or validation failure
- `401 Unauthorized` - Authentication required or invalid
- `403 Forbidden` - Authenticated but lacks permission
- `404 Not Found` - Resource does not exist
- `409 Conflict` - Concurrent modification conflict (ETag mismatch)
- `412 Precondition Failed` - If-Match header missing or invalid
- `422 Unprocessable Entity` - Semantic validation error

**Server Errors (5xx):**
- `500 Internal Server Error` - Unexpected server error
- `503 Service Unavailable` - Service temporarily unavailable

### 1.4 Error Response Format (RFC 7807)

All error responses follow RFC 7807 Problem Details format:

```json
{
  "type": "https://api.factfind.com/problems/validation-error",
  "title": "Validation Failed",
  "status": 400,
  "detail": "One or more validation errors occurred",
  "instance": "/api/v2/factfinds/{factfindId}/clients/123/income",
  "traceId": "00-4bf92f3577b34da6a3ce929d0e0e4736-00",
  "errors": [
    {
      "field": "grossAmount.value",
      "code": "RANGE_ERROR",
      "message": "Gross amount must be greater than zero",
      "rejectedValue": -5000
    },
    {
      "field": "frequency",
      "code": "REQUIRED",
      "message": "Frequency is required",
      "rejectedValue": null
    }
  ]
}
```

**Error Type URIs:**
- `validation-error` - Request validation failures
- `authentication-error` - Authentication failures
- `authorization-error` - Permission denied
- `not-found-error` - Resource not found
- `conflict-error` - Business rule or concurrency violations
- `server-error` - Internal server errors


### 1.5 API Architecture & Aggregate Root Pattern

#### 1.5.1 Hierarchical Structure

The FactFind API follows a **hierarchical, context-based structure** where **FactFind is the aggregate root**. This means all business operations are scoped to a specific fact-find instance, and all API endpoints reflect this parent-child relationship in their URL structure.

**Design Principle:**
```
/api/v2/factfinds/{factfindId}/{context}/{resource}
```

**Examples:**
```
/api/v2/factfinds/12345/clients                                    # Client context
/api/v2/factfinds/12345/clients/67890/income                       # Circumstances context (per client)
/api/v2/factfinds/12345/arrangements/investments/isa               # Arrangements context (type-based)
/api/v2/factfinds/12345/arrangements/pensions/personal-pension     # Pension arrangements (type-based)
/api/v2/factfinds/12345/objectives/investment                      # Goals context (type-based)
/api/v2/factfinds/12345/attitude-to-risk                           # Risk profiling context
```

#### 1.5.2 FactFind as Aggregate Root

**What is an Aggregate Root?**

In Domain-Driven Design (DDD), an **aggregate** is a cluster of domain objects that can be treated as a single unit for data changes. The **aggregate root** is the entry point to the aggregate and the only entity that external objects should reference.

**Why FactFind is the Aggregate Root:**

1. **Transactional Boundary** - All client data, income, expenses, arrangements, and goals exist within the context of a single fact-find
2. **Consistency Guarantee** - Changes to related entities (client, income, arrangements) must be consistent within the fact-find
3. **Lifecycle Management** - Child entities (clients, arrangements, objectives) cannot exist without a parent fact-find
4. **Business Rule Enforcement** - Business rules (e.g., "total income must equal sum of all income sources") are enforced at the fact-find level
5. **Access Control** - Permissions are granted at the fact-find level and inherited by child entities

#### 1.5.3 Context-Based Organization

Resources are organized into **business contexts** that reflect the domain model:

| Context | Resources | Base Path |
|---------|-----------|-----------|
| **Client Onboarding & KYC** | Clients, Addresses, Contacts, Relationships, Dependants, Estate Planning, DPA Consent, Marketing Consent, Vulnerabilities, ID Verification, Professional Contacts | `/api/v2/factfinds/{id}/clients/{id}/*` |
| **Circumstances** | Employment, Income, Income Changes, Expenditure, Expenditure Changes | `/api/v2/factfinds/{id}/clients/{id}/*` |
| **Assets & Liabilities** | **Arrangements** | Investment Arrangements (GIA, ISA, Bonds), Pension Arrangements (personal-pension, state-pension), Mortgage Arrangements, Protection Arrangements (personal-protection, general-insurance), Contributions, Withdrawals, Beneficiaries, Client Pension Summary | `/api/v2/factfinds/{id}/arrangements/{type}` |
| **Goals & Objectives** | Objectives (investment, pension, protection, mortgages, budget, estate-planning), Needs | `/api/v2/factfinds/{id}/objectives/{type}` |
| **Risk Profiling** | ATR (client ATR), Supplementary Questions | `/api/v2/factfinds/{id}/attitude-to-risk` |
| **Estate Planning** | Gifts, Trusts (nested under clients) | `/api/v2/factfinds/{id}/clients/{id}/estate-planning` |

#### 1.5.4 Benefits of This Approach

**1. Clear Data Ownership**
- Every resource has a clear parent (ultimately, the fact-find)
- No ambiguity about which fact-find a client or arrangement belongs to
- Simplifies multi-tenancy and data isolation

**2. Transactional Consistency**
- All operations within a fact-find can be made atomic
- Business rules can be enforced at aggregate boundaries
- Easier to implement eventual consistency where needed

**3. Better API Discoverability**
- URL structure reflects domain model
- Parent-child relationships are explicit
- HATEOAS links are more meaningful

**4. Simplified Security**
- Access control at fact-find level applies to all child resources
- No need to check permissions on every nested resource
- Easier to implement row-level security

**5. Improved Multi-Tenancy**
- Clear tenant boundaries (each fact-find belongs to one tenant)
- Data isolation guaranteed by URL structure
- Prevents cross-fact-find data leakage

**6. Better Caching**
- Cache invalidation is simpler (invalidate by fact-find ID)
- More predictable cache keys
- Better cache hit rates

#### 1.5.5 Transactional Boundaries

**Aggregate Boundary = Transaction Boundary**

All changes within a fact-find aggregate should be:
- **Atomic** - Either all changes succeed or all fail
- **Consistent** - Business rules are enforced across all entities
- **Isolated** - Concurrent changes don't interfere
- **Durable** - Changes are persisted reliably

**Example - Adding Income to a Client:**

```http
POST /api/v2/factfinds/12345/clients/67890/income
```

This operation:
1. Creates the income record for the specific client
2. Updates the client's total income
3. Recalculates the client's disposable income
4. Updates the fact-find's last modified timestamp
5. Emits a domain event (`IncomeAdded`)

All these changes happen atomically within the fact-find aggregate boundary.

#### 1.5.6 Entity Lifecycle

**All entities within a fact-find follow a consistent lifecycle:**

1. **Creation** - Entities are created within a fact-find context
2. **Retrieval** - Entities are retrieved via their parent fact-find
3. **Update** - Entities are updated within their fact-find context
4. **Deletion** - Entities are deleted, but the fact-find remains
5. **Archival** - When a fact-find is archived, all child entities are archived

**Example Lifecycle:**

```http
# 1. Create a fact-find
POST /api/v2/factfinds
Response: 201 Created, Location: /api/v2/factfinds/12345

# 2. Add a client to the fact-find
POST /api/v2/factfinds/12345/clients
Response: 201 Created, Location: /api/v2/factfinds/12345/clients/67890

# 3. Add an address to the client
POST /api/v2/factfinds/12345/clients/67890/addresses
Response: 201 Created, Location: /api/v2/factfinds/12345/clients/67890/addresses/11111

# 4. Update the address
PATCH /api/v2/factfinds/12345/clients/67890/addresses/11111
Response: 200 OK

# 5. Delete the address
DELETE /api/v2/factfinds/12345/clients/67890/addresses/11111
Response: 204 No Content

# 6. Archive the fact-find (archives all children)
POST /api/v2/factfinds/12345/archive
Response: 200 OK
```

#### 1.5.7 Special Considerations

**Cross-Aggregate References**

Some entities may need to reference entities in other fact-finds (e.g., comparing historical risk profiles). These should be:
- **Read-only** - No modifications across aggregates
- **Eventually consistent** - Denormalized data may be slightly stale
- **Explicitly marked** - Use `factfind` to indicate cross-aggregate references

**Reference Data Exception**

Reference data (lookup tables, templates, provider data) is **not** scoped to a fact-find:
- `/api/v2/reference/income-types` - NOT `/api/v2/factfinds/{id}/reference/income-types`
- `/api/v2/reference/providers` - NOT `/api/v2/factfinds/{id}/reference/providers`

Reference data is **shared across all fact-finds** and managed separately.


### 1.6 Versioning Strategy

**URL-Based Versioning:**
```
https://api.factfind.com/api/v2/factfinds/{factfindId}/clients
https://api.factfind.com/api/v2/clients (future)
```

**Version Support Policy:**
- Current version (v2): Full support
- Previous version: Maintenance mode (12 months)
- Deprecated version: Security fixes only (6 months)
- Sunset: Returns 410 Gone

**Breaking vs Non-Breaking Changes:**

Non-Breaking (safe):
- Add new endpoints
- Add optional request fields
- Add response fields
- Add enum values (append only)
- Add optional query parameters

Breaking (requires version bump):
- Remove fields or endpoints
- Rename fields
- Change data types
- Change required/optional status
- Remove enum values
- Change validation rules (stricter)

### 1.7 Single Contract Principle

The FactFind API follows the **Single Contract Principle** for all entity representations. Instead of maintaining separate DTOs for create requests, update requests, and responses, each entity has **one unified contract** that flows through the entire request/response pipeline.

**Core Concept:**

A single entity contract (e.g., `Client`) is used for:
- POST requests (create operations)
- PUT requests (full updates)
- PATCH requests (partial updates)
- GET responses (retrieval)

**Traditional Approach (Not Used):**
```
CreateClientRequest { firstName, lastName, dateOfBirth }
UpdateClientRequest { firstName?, lastName?, email? }
ClientResponse { id, firstName, lastName, dateOfBirth, email, createdAt, updatedAt }
```

**Single Contract Approach (Used):**
```
Client {
  id: uuid (read-only)
  firstName: string (required-on-create, updatable)
  lastName: string (required-on-create, updatable)
  dateOfBirth: date (required-on-create, write-once)
  email: string (optional, updatable)
  createdAt: timestamp (read-only)
  updatedAt: timestamp (read-only)
}
```

**Field Annotations:**

Each field in the unified contract is annotated with behavioral characteristics:

| Annotation | Meaning | Create | Update | Response |
|------------|---------|--------|--------|----------|
| `required-on-create` | Must be provided when creating | Required | Optional/Ignored | Included |
| `optional` | Can be omitted in any operation | Optional | Optional | Included if set |
| `read-only` | System-generated, cannot be set | Ignored | Ignored | Included |
| `write-once` | Set on create, immutable thereafter | Allowed | Ignored | Included |
| `updatable` | Can be modified via PUT/PATCH | Allowed | Allowed | Included |

**HTTP Method Handling:**

**POST /api/v2/factfinds/{factfindId}/clients** (Create)
- Request: `Client` contract with required-on-create fields
- Server ignores: `id`, `createdAt`, `updatedAt`, and any read-only fields
- Response: Complete `Client` contract with all fields populated

**PUT /api/v2/factfinds/{factfindId}/clients/{clientId}** (Full Update)
- Request: `Client` contract with all updatable fields (full replacement)
- Server ignores: `id`, `createdAt`, `updatedAt`, `write-once` fields
- Response: Complete `Client` contract with updated values

**PATCH /api/v2/factfinds/{factfindId}/clients/{id}** (Partial Update)
- Request: `Client` contract with subset of updatable fields
- Server ignores: `id`, `createdAt`, `updatedAt`, `write-once` fields
- Response: Complete `Client` contract with updated values

**GET /api/v2/factfinds/{factfindId}/clients/{id}** (Retrieve)
- Response: Complete `Client` contract with all fields

**Benefits:**

1. **Single Source of Truth** - One contract definition per entity
2. **Reduced Duplication** - No need to maintain multiple DTOs
3. **Easier Maintenance** - Changes made in one place
4. **Clearer Contracts** - Field behaviors explicitly documented
5. **Better Versioning** - Contract evolution is simpler
6. **Type Safety** - Strongly typed across all operations
7. **API Simplicity** - Consumers learn one contract per entity

**Example: Client Contract**

```json
{
  "id": 123,                        // read-only
  "firstName": "John",              // required-on-create, updatable
  "lastName": "Smith",              // required-on-create, updatable
  "dateOfBirth": "1980-05-15",     // required-on-create, write-once
  "email": "john@example.com",     // optional, updatable
  "createdAt": "2020-01-15T10:30:00Z",  // read-only
  "updatedAt": "2026-02-16T14:30:00Z"   // read-only
}
```

When creating (POST): Client supplies `firstName`, `lastName`, `dateOfBirth`, and optionally `email`. Server generates `id`, `createdAt`, `updatedAt`.

When updating (PUT/PATCH): Client can modify `firstName`, `lastName`, `email`. Cannot change `dateOfBirth` (write-once) or `id`, `createdAt`, `updatedAt` (read-only).

When retrieving (GET): Server returns complete contract with all fields.

**Field Selection:**

For partial responses, use field selection query parameters rather than separate DTOs:

```http
GET /api/v2/factfinds/{factfindId}/clients/123?fields=id,firstName,lastName,email
```

Response returns the same `Client` contract with only requested fields populated.

**Collection Responses:**

Collection endpoints use a wrapper that contains an array of complete contracts:

```json
{
  "data": [
    { /* Complete Client contract */ },
    { /* Complete Client contract */ }
  ],
  "pagination": { /* Pagination metadata */ }
}
```

**Polymorphic Types:**

For entities with subtypes (e.g., Arrangement with Pension, Investment, Protection), use a discriminator field in the unified contract:

```json
{
  "id": 456,
  "arrangementCategory": "PENSION", // discriminator (read-only, required-on-create, write-once)
  "productName": "SIPP",            // common field
  "pensionType": "PERSONAL_PENSION",
  // ... other fields
}
```

### 1.8 Value and Reference Type Semantics

The FactFind API applies strict **VALUE TYPE** and **REFERENCE TYPE** semantics to all contracts to ensure consistency, clarity, and proper resource lifecycle management.

#### 1.8.1 Value Types

**Definition:**

Value types represent data that has **no independent identity** and are compared by their content rather than by an identifier. They are immutable concepts that are embedded directly within their parent entity.

**Characteristics:**

- **No Identity:** Value types do NOT have an `id` field
- **Embedded:** Always nested within a parent entity, never standalone resources
- **Immutable:** Represent immutable concepts (though the parent can replace them)
- **No Lifecycle:** Cannot be created, updated, or deleted independently
- **No Endpoints:** No dedicated API endpoints
- **Compared by Value:** Two value types are equal if their fields match
- **Naming Convention:** Suffixed with "Value" (e.g., `MoneyValue`, `AddressValue`)

**Common Value Types:**

Value types include three main categories:

1. **Composite Value Objects:** Complex data structures with multiple fields
   - `MoneyValue`, `AddressValue`, `NameValue`, `ContactValue`, `DateRangeValue`, `TaxDetailsValue`, `RateValue`, `PercentageValue`

2. **Simple Enumerations:** String codes for categorical data
   - `GenderValue`, `EmploymentStatusValue`, `ResidencyStatusValue`, `HealthStatusValue`, `SmokingStatusValue`

3. **Temporal Enumerations:** Code/display pairs with temporal tracking
   - `MaritalStatusValue` (has effectiveFrom field)

4. **Structured Enumerations:** Code/display pairs for reference data
   - `AddressTypeValue`, `ContactTypeValue`, `TitleValue`, `StatusValue`, `MeetingTypeValue`

5. **Lookup Values:** Reference data with rich metadata
   - `CountryValue`, `CountyValue`, `CurrencyValue`, `FrequencyValue`, `ProductTypeValue`

**All value types share these characteristics:**
- Are immutable
- Do NOT have identity (no `id` field)
- Named with "Value" suffix
- Embedded within parent entities
- Compared by value equality

| Value Type | Fields | Example |
|------------|--------|---------|
| `MoneyValue` | `amount: decimal`<br>`currency: CurrencyValue` | `{ "amount": 75000.00, "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" } }` |
| `AddressValue` | `line1-4, city, county, postcode`<br>`country: CountryValue`<br>`addressType: AddressTypeValue` | `{ "line1": "123 Main St", "city": "London", "postcode": "SW1A 1AA", "country": "GB" }` |
| `GenderValue` | `string` | `"M"` (simple string enum) |
| `MaritalStatusValue` | `code: string`<br>`display: string`<br>`effectiveFrom: date` | `{ "code": "MAR", "display": "Married", "effectiveFrom": "2015-06-20" }` |
| `CountryValue` | `code: string`<br>`display: string`<br>`alpha3: string` | `{ "code": "GB", "display": "United Kingdom", "alpha3": "GBR" }` |
| `DateRangeValue` | `startDate: date`<br>`endDate: date` | `{ "startDate": "2020-01-01", "endDate": "2025-12-31" }` |
| `NameValue` | `title: TitleValue`<br>`firstName, middleName`<br>`lastName, preferredName` | `{ "title": "MR", "firstName": "John", "lastName": "Smith" }` |
| `ContactValue` | `type: ContactTypeValue`<br>`value: string`<br>`isPrimary: boolean` | `{ "type": "EMAIL", "value": "john@example.com", "isPrimary": true }` |
| `PercentageValue` | `value: decimal` (0.00-1.00) | `{ "value": 0.25 }` |
| `RateValue` | `rate: decimal`<br>`type: enum` | `{ "rate": 3.5, "type": "Fixed" }` |
| `TaxDetailsValue` | `niNumber: string`<br>`taxReference: string` | `{ "niNumber": "AB123456C", "taxReference": "1234567890" }` |

**Value Type Usage Example:**

```json
{
  "id": 123,                     // Client entity has identity
  "name": {                               // NameValue - no id, embedded
    "title": "MR",
    "firstName": "John",
    "lastName": "Smith"
  },
  "dateOfBirth": "1980-01-15",            // Primitive value type
  "gender": "M",                          // GenderValue (simple string enum)
  "maritalStatus": {                      // MaritalStatusValue (temporal enumeration with effectiveFrom)
    "code": "MAR",
    "display": "Married",
    "effectiveFrom": "2015-06-20"
  },
  "financialProfile": {                   // FinancialProfileValue - no id, embedded
    "grossAnnualIncome": {                // MoneyValue - no id, embedded
      "amount": 75000.00,
      "currency": {                       // CurrencyValue (lookup)
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "primaryAddress": {                     // AddressValue - no id, embedded
    "line1": "123 Main Street",
    "city": "London",
    "postcode": "SW1A 1AA",
    "country": {                          // CountryValue (lookup)
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "addressType": "RES"
  },
  "contacts": [                           // Array of ContactValue
    {
      "type": "EMAIL",
      "value": "john@example.com",
      "isPrimary": true
    },
    {
      "type": "MOBILE",
      "value": "+44 7700 900123",
      "isPrimary": false
    }
  ]
}
```

**Key Points:**

- Value types are owned by their parent entity
- To change a value type, update the parent entity
- Value types cannot be referenced from multiple parents
- No hypermedia links (`href`) for value types

#### 1.8.2 Reference Types

**Definition:**

Reference types represent entities that have **independent identity** and can exist and be managed independently. They are first-class resources with their own lifecycle.

**Characteristics:**

- **Has Identity:** Reference types MUST have an `id` field (UUID or string)
- **Standalone Resources:** Can be created, read, updated, and deleted independently
- **Mutable:** Can be updated over time while maintaining identity
- **Own Endpoints:** Have dedicated API endpoints
- **Cross-References:** Can be referenced from multiple other entities
- **Naming Convention:**
  - Entity type: Singular noun (e.g., `Client`, `Adviser`, `Provider`)
  - Reference field: Entity name + "Ref" suffix (e.g., `client`, `adviser`)

**Reference Object Pattern:**

When one entity references another, use an expanded reference object containing:

```json
{
  "client": {
    "id": 123,                    // Required: Unique identifier (numeric)
    "href": "/api/v2/factfinds/{factfindId}/clients/123-123",  // Required: URL to resource
    "name": "John Smith",                // Required: Human-readable display name
    "clientNumber": "C00001234",         // Optional: Business identifier
    "type": "Person"                     // Optional: Discriminator for polymorphic types
  }
}
```

**Reference Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | uuid/string | Yes | Unique identifier for the referenced entity |
| `href` | string | Yes | Absolute or relative URL to the resource |
| Display field(s) | varies | Yes | Human-readable identifier (name, number, etc.) |
| `type` | enum | Optional | Discriminator for polymorphic references |

**Common Reference Types:**

| Reference Type | Display Fields | Example |
|----------------|----------------|---------|
| `ClientRef` | `name`<br>`clientNumber`<br>`type` | `{ "id": 953, "href": "/api/v2/factfinds/{factfindId}/clients/123", "name": "John Smith", "clientNumber": "C00001", "type": "Person" }` |
| `AdviserRef` | `name`<br>`code` | `{ "id": 953, "href": "/api/v2/advisers/789", "name": "Sarah Johnson", "code": "ADV001" }` |
| `ProviderRef` | `name`<br>`frnNumber` | `{ "id": 953, "href": "/api/v2/providers/555", "name": "Aviva", "frnNumber": "123456" }` |
| `ArrangementRef` | `policyNumber`<br>`productType`<br>`provider` | `{ "id": 953, "href": "/api/v2/factfinds/{factfindId}/arrangements/1001", "policyNumber": "POL12345", "productType": "Pension", "provider": "Aviva" }` |
| `EmploymentRef` | `employerName`<br>`status` | `{ "id": 953, "href": "/api/v2/employments/3001", "employerName": "Acme Corp", "status": "Current" }` |
| `GoalRef` | `goalName`<br>`priority` | `{ "id": 953, "href": "/api/v2/factfinds/{factfindId}/goals/7001", "goalName": "Retirement Planning", "priority": "High" }` |
| `FactFindRef` | `factFindNumber`<br>`status` | `{ "id": 953, "href": "/api/v2/factfinds/456", "factFindNumber": "FF001234", "status": "InProgress" }` |

**Reference Type Usage Example:**

```json
{
  "id": 456,                   // FactFind entity has identity
  "factFindNumber": "FF001234",
  "client": {                          // ClientRef - reference to Client entity
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "jointClientRef": {                     // Optional second client reference
    "id": 124,
    "href": "/api/v2/factfinds/{factfindId}/clients/124",
    "name": "Jane Smith",
    "clientNumber": "C00001235",
    "type": "Person"
  },
  "adviser": {                         // AdviserRef - reference to Adviser entity
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Sarah Johnson",
    "code": "ADV001"
  },
  "totalNetMonthlyIncome": {              // MoneyValue - embedded value type
    "amount": 4500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "sessionDate": "2026-02-15"             // Primitive value type
}
```

#### 1.8.3 When to Use Value vs Reference Types

**Use Value Types When:**

- ✅ The data has no independent identity
- ✅ The data is owned exclusively by one parent
- ✅ The data is conceptually immutable (replace, don't update)
- ✅ The data is compared by content, not identity
- ✅ Examples: Money amounts, addresses, date ranges, percentages

**Use Reference Types When:**

- ✅ The entity has independent identity and lifecycle
- ✅ The entity can be shared/referenced by multiple parents
- ✅ The entity can be updated independently
- ✅ The entity needs its own API endpoints
- ✅ Examples: Clients, advisers, providers, arrangements

#### 1.8.4 Benefits of Value/Reference Semantics

**Clarity:**
- Clear distinction between entities and value objects
- Obvious which types have lifecycle management
- Explicit ownership relationships

**Consistency:**
- Uniform naming conventions across all contracts
- Predictable structure for references
- Standard patterns for expansion and linking

**API Design:**
- Value types: No endpoints needed
- Reference types: Full CRUD endpoints
- Reduced API surface area

**Performance:**
- Value types embedded: Fewer HTTP requests
- Reference types expandable: Client controls data fetching
- Selective expansion via query parameters

**Maintainability:**
- Clear contract boundaries
- Easier to reason about relationships
- Simplified testing and mocking

#### 1.8.5 Resource Expansion

Reference types support expansion to include the full referenced entity inline:

**Default Response (Minimal):**
```http
GET /api/v2/factfinds/456
```

```json
{
  "id": 456,
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234"
  }
}
```

**Expanded Response:**
```http
GET /api/v2/factfinds/456?expand=client,adviser
```

```json
{
  "id": 456,
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person",
    // Full Client entity embedded when expanded
    "dateOfBirth": "1980-01-15",
    "financialProfile": {
      "grossAnnualIncome": {
        "amount": 75000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "primaryAddress": {
      "line1": "123 Main St",
      "city": "London",
      "postcode": "SW1A 1AA",
      "country": "GB"
    }
  }
}
```

**Expansion Rules:**
- Use `?expand=fieldName` query parameter
- Multiple fields: `?expand=client,adviser,provider`
- Nested expansion: `?expand=client.employment`
- Only reference types can be expanded
- Value types are always fully embedded

#### 1.8.6 Creating and Updating References

**Creating with References (POST):**

When creating an entity that references others, provide only the reference `id`:

```json
POST /api/v2/factfinds

{
  "client": {
    "id": 123              // Only id required on create
  },
  "adviser": {
    "id": 789
  },
  "sessionDate": "2026-02-15",
  "totalNetMonthlyIncome": {        // Value type fully embedded
    "amount": 4500.00,
    "currency": {
    "code": "GBP",
    "display": "British Pound",
    "symbol": "£"
  }
  }
}

Response:
{
  "id": 456,
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",           // Server populates display fields
    "clientNumber": "C00001234"
  },
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Sarah Johnson",
    "code": "ADV001"
  },
  "sessionDate": "2026-02-15",
  "totalNetMonthlyIncome": {
    "amount": 4500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "createdAt": "2026-02-16T10:30:00Z",
  "updatedAt": "2026-02-16T10:30:00Z"
}
```

**Updating References (PUT/PATCH):**

To change a reference, provide the new reference `id`:

```json
PATCH /api/v2/factfinds/456

{
  "adviser": {
    "id": 999             // Change to different adviser
  }
}

Response:
{
  "id": 456,
  "adviser": {
    "id": 999,
    "href": "/api/v2/advisers/999",
    "name": "Michael Brown",        // Server updates display fields
    "code": "ADV002"
  },
  // ... other fields unchanged
}
```

**Validation:**

- Server validates that referenced `id` exists
- Returns `422 Unprocessable Entity` if reference is invalid
- Returns updated display fields in response

### 1.9 Aggregate Root Pattern

The FactFind API implements a strict **single aggregate root pattern** where FactFind is the ONLY aggregate root for all business data. This architectural decision enforces Domain-Driven Design principles and provides strong transactional guarantees.

#### 1.9.1 What is an Aggregate Root?

In Domain-Driven Design (DDD), an **aggregate** is a cluster of domain objects that can be treated as a single unit for data changes. The **aggregate root** is the only member of the aggregate that outside objects are allowed to hold references to.

**Key Characteristics:**
- **Single Entry Point:** All access to aggregate members must go through the root
- **Transactional Boundary:** Changes within an aggregate are atomic
- **Consistency Boundary:** Business invariants are maintained within the aggregate
- **Identity:** Only the aggregate root has global identity; members have local identity

#### 1.9.2 Why FactFind is the Aggregate Root

**FactFind represents a complete fact-finding session** for one or more clients. It is the natural aggregate root because:

1. **Contextual Ownership:** All data collected during fact-finding (clients, income, expenditure, arrangements, goals) belongs to that specific fact-finding session

2. **Temporal Consistency:** The fact find represents a point-in-time snapshot of a client's financial situation. All data must be consistent with that point in time.

3. **Business Process Boundary:** Fact-finding is a complete business process. Creating a fact find initiates the process; completing it marks the end.

4. **Transactional Integrity:** Changes to any part of the fact find (adding income, recording arrangements, setting goals) should be transactionally consistent with the fact find state.

5. **Access Control:** Authorization is naturally scoped to the fact find level. Users have permissions to view/edit specific fact finds, which includes all nested data.

#### 1.9.3 What This Means for API Consumers

**Top-Level Resource:**

FactFind is the ONLY top-level business resource:
```
POST /api/v2/factfinds          (Create a new fact find - the only top-level POST)
GET /api/v2/factfinds          (List fact finds)
GET /api/v2/factfinds/{id}     (Get a fact find)
PUT /api/v2/factfinds/{id}     (Update fact find metadata)
DELETE /api/v2/factfinds/{id}   (Delete entire fact find and all data)
```

**All Other Entities are Nested:**

Clients, arrangements, goals, etc. are accessed through the fact find:
```
POST /api/v2/factfinds/{factfindId}/clients
GET /api/v2/factfinds/{factfindId}/clients/{clientId}
POST /api/v2/factfinds/{factfindId}/arrangements
GET /api/v2/factfinds/{factfindId}/arrangements/{arrangementId}
POST /api/v2/factfinds/{factfindId}/goals
GET /api/v2/factfinds/{factfindId}/goals/{goalId}
```

**No Independent Entity Access:**

You CANNOT create or access these entities without a fact find context:
```
❌ POST /api/v2/factfinds/{factfindId}/clients               (Not supported)
❌ GET /api/v2/factfinds/{factfindId}/clients/{id}          (Not supported)
❌ POST /api/v2/factfinds/{factfindId}/arrangements          (Not supported)
❌ GET /api/v2/factfinds/{factfindId}/arrangements/{id}     (Not supported)
❌ POST /api/v2/factfinds/{factfindId}/goals                 (Not supported)
```

#### 1.9.4 Transactional Boundaries

**Within Aggregate (Atomic):**
```http
# These operations are transactionally consistent
POST /api/v2/factfinds/{id}/income
POST /api/v2/factfinds/{id}/expenditure
PUT /api/v2/factfinds/{id}
```

All operations on the same fact find aggregate are guaranteed to be consistent. For example:
- Adding income automatically updates the fact find's total income calculation
- Deleting a fact find deletes all nested entities atomically
- Completing a fact find validates all required data is present

**Cross-Aggregate (Eventual Consistency):**

Reference data and lookups are separate aggregates:
```http
GET /api/v2/reference/countries     (Separate aggregate)
GET /api/v2/reference/providers     (Separate aggregate)
```

Changes to reference data do not affect existing fact finds immediately; they use eventual consistency patterns.

#### 1.9.5 Entity Lifecycle

**FactFind Lifecycle:**
```
1. Create fact find         POST /api/v2/factfinds
2. Add client data         POST /api/v2/factfinds/{id}/clients
3. Record income           POST /api/v2/factfinds/{id}/income
4. Record expenditure      POST /api/v2/factfinds/{id}/expenditure
5. Identify arrangements   POST /api/v2/factfinds/{id}/arrangements
6. Set goals               POST /api/v2/factfinds/{id}/goals
7. Complete fact find      POST /api/v2/factfinds/{id}/complete
```

**Cascading Deletes:**

Deleting a fact find cascades to ALL nested entities:
```http
DELETE /api/v2/factfinds/456   # Deletes:
                                # - All clients in this fact find
                                # - All income records
                                # - All expenditure records
                                # - All arrangements
                                # - All goals
                                # - All assets and liabilities
                                # - Risk profile
                                # - Estate planning data
```

#### 1.9.6 Special Operations

**Get Complete Aggregate:**

A special endpoint retrieves the entire aggregate in a single request:

```http
GET /api/v2/factfinds/{id}/complete
```

**Response:**
```json
{
  "id": 456,
  "sessionDate": "2026-02-16",
  "status": "COMP",
  "clients": [
    { /* Complete client data */ }
  ],
  "income": [
    { /* All income records */ }
  ],
  "expenditure": [
    { /* All expenditure records */ }
  ],
  "arrangements": [
    { /* All arrangements with contributions, valuations */ }
  ],
  "goals": [
    { /* All goals */ }
  ],
  "assets": [
    { /* All assets */ }
  ],
  "liabilities": [
    { /* All liabilities */ }
  ],
  "riskProfile": {
    /* Risk assessment data */
  },
  "estatePlanning": {
    /* Estate planning data */
  }
}
```

**Use Cases:**
- Displaying complete fact find summary
- Generating fact find reports
- Exporting fact find data
- Comparing fact finds
- Audit trail review

#### 1.9.7 Benefits of This Approach

**1. Transactional Consistency**
- All changes within a fact find are atomic
- No partial updates or inconsistent states
- Database transactions align with business transactions

**2. Business Rule Enforcement**
- Fact find status controls what operations are allowed
- Cannot add data to a completed fact find without reopening it
- Required sections can be enforced before completion

**3. Clear Ownership and Context**
- Every entity belongs to exactly one fact find
- No ambiguity about which fact find data belongs to
- Easy to understand data lineage

**4. Simplified Authorization**
- Permissions are scoped at the fact find level
- Grant access to a fact find = access to all nested data
- Easier to implement row-level security

**5. Better API Ergonomics**
- Clear, predictable URL structure
- Obvious relationship between entities
- HATEOAS links are more meaningful

**6. Data Integrity**
- Cascading deletes prevent orphaned data
- Cannot create entities without proper context
- Referential integrity is enforced

**7. Performance Optimization**
- Can cache entire aggregate
- Bulk operations are natural
- Denormalization strategies are clearer

**8. Audit and Compliance**
- Complete fact find history is preserved
- Changes are scoped to specific fact finds
- Easier to generate audit reports

#### 1.9.8 Reference Data Exception

**System-Wide Reference Data** remains independent and is NOT part of the FactFind aggregate:

```
/api/v2/reference/genders           (System-wide enum)
/api/v2/reference/countries         (System-wide lookup)
/api/v2/reference/providers         (System-wide directory)
/api/v2/reference/product-types     (System-wide catalog)
```

**Rationale:**
- Reference data is shared across all fact finds
- Changes to reference data should not affect existing fact finds
- Reference data has its own lifecycle and versioning
- Reference data is read-mostly and heavily cached

---

## 2. Authentication & Authorization

### 2.1 OAuth 2.0 with JWT

**Authentication Flow:**

1. Client obtains access token from authorization server
2. Client includes token in Authorization header: `Bearer {token}`
3. API validates token signature and expiration
4. API extracts claims (userId, tenantId, scopes)
5. API enforces authorization based on scopes

**Token Structure (JWT):**
```json
{
  "sub": "user-123",
  "tenant_id": "tenant-456",
  "scope": "factfind:read factfind:write client:read",
  "iat": 1708084800,
  "exp": 1708088400,
  "aud": "https://api.factfind.com"
}
```

### 2.2 Authorization Scopes

**Scope Hierarchy:**

| Scope | Access Level | Description |
|-------|--------------|-------------|
| `client:read` | Read | View client profiles and demographics |
| `client:write` | Write | Create/update client information |
| `client:pii:read` | Sensitive Read | View PII (NI number, passport) |
| `factfind:read` | Read | View fact find data |
| `factfind:write` | Write | Create/update fact finds |
| `arrangements:read` | Read | View arrangements (plans, policies) |
| `arrangements:write` | Write | Create/update arrangements |
| `goals:read` | Read | View goals and objectives |
| `goals:write` | Write | Create/update goals |
| `risk:read` | Read | View risk profiles |
| `risk:write` | Write | Create/update risk assessments |
| `admin:*` | Admin | Full administrative access |

**Scope Naming Convention:**
```
{domain}:{permission}:{sensitivity}
```

Examples:
- `client:read` - Read client data
- `client:pii:read` - Read sensitive PII
- `factfind:write` - Write fact find data
- `admin:users:write` - Admin user management

### 2.3 Multi-Tenancy

**Tenant Isolation:**

- Tenant ID extracted from JWT claims (`tenant_id`)
- All queries filtered by tenant ID automatically
- Cross-tenant access strictly prohibited
- Tenant data physically or logically separated

**Tenant Context:**
```http
GET /api/v2/factfinds/{factfindId}/clients HTTP/1.1
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
X-Tenant-ID: tenant-456

Response includes only clients for tenant-456
```

**Tenant-Level Configuration:**
- Reference data customization per tenant
- Feature flags per tenant
- Rate limits per tenant
- Branding and white-labeling

### 2.4 Sensitive Data Handling

**PII Fields (Personally Identifiable Information):**

Requires special scope: `client:pii:read`

- National Insurance Number
- Passport Number
- Driving License Number
- Date of Birth
- Full Address
- Bank Account Details

**Obfuscation Strategy:**

Default response (without `client:pii:read` scope):
```json
{
  "nationalInsuranceNumber": "AB****56C",
  "passportNumber": "5******21",
  "dateOfBirth": "****-**-15"
}
```

Full response (with `client:pii:read` scope):
```json
{
  "nationalInsuranceNumber": "AB123456C",
  "passportNumber": "502135321",
  "dateOfBirth": "1980-05-15"
}
```

### 2.5 Audit Logging

**Audit Requirements:**

All write operations (POST, PUT, PATCH, DELETE) are logged:

- User ID (from JWT)
- Tenant ID
- Timestamp
- Operation type (CREATE, UPDATE, DELETE)
- Resource type and ID
- Changed fields (before/after values)
- IP address
- Request ID (correlation)

**Audit Log Entry:**
```json
{
  "auditId": "audit-789",
  "timestamp": "2026-02-16T14:30:00Z",
  "tenantId": "tenant-456",
  "userId": "user-123",
  "operation": "UPDATE",
  "resourceType": "Client",
  "resourceId": "999",
  "changes": [
    {
      "field": "lastName",
      "oldValue": "Smith",
      "newValue": "Johnson"
    }
  ],
  "ipAddress": "203.0.113.42",
  "requestId": "req-abc-123"
}
```

---

## 3. Common Patterns

### 3.1 Pagination

**Cursor-Based Pagination (Preferred):**

Request:
```http
GET /api/v2/factfinds/{factfindId}/clients?limit=20&cursor=eyJpZCI6MTAwfQ==
```

Response:
```json
{
  "data": [
    { "id": 101, "firstName": "John", "lastName": "Smith" },
    { "id": 102, "firstName": "Jane", "lastName": "Doe" }
  ],
  "pagination": {
    "limit": 20,
    "hasMore": true,
    "nextCursor": "eyJpZCI6MTIwfQ==",
    "prevCursor": null
  }/clients?limit=20&cursor=eyJpZCI6MTAwfQ=="
    },
    "next": {
      "href": "/api/v2/factfinds/{factfindId}/clients?limit=20&cursor=eyJpZCI6MTIwfQ=="
    }
  }
}
```

**Offset-Based Pagination (Alternative):**

Request:
```http
GET /api/v2/factfinds/{factfindId}/clients?page=2&pageSize=20
```

Response:
```json
{
  "data": [...],
  "pagination": {
    "page": 2,
    "pageSize": 20,
    "totalPages": 10,
    "totalCount": 195
  }/clients?page=1&pageSize=20" },
    "prev": { "href": "/api/v2/factfinds/{factfindId}/clients?page=1&pageSize=20" },
    "self": { "href": "/api/v2/factfinds/{factfindId}/clients?page=2&pageSize=20" },
    "next": { "href": "/api/v2/factfinds/{factfindId}/clients?page=3&pageSize=20" },
    "last": { "href": "/api/v2/factfinds/{factfindId}/clients?page=10&pageSize=20" }
  }
}
```

### 3.2 Filtering & Sorting

**Query Parameters:**

```http
GET /api/v2/factfinds/{factfindId}/clients?status=Active&clientType=Person&sortBy=lastName&sortOrder=asc
```

**Supported Filters:**
- Equality: `?status=Active`
- Multiple values: `?status=Active,Prospect`
- Date ranges: `?createdAfter=2026-01-01&createdBefore=2026-12-31`
- Boolean flags: `?isActive=true&hasWill=false`
- Text search: `?search=smith` (searches across multiple fields)

**Sorting:**
- Single field: `?sortBy=lastName&sortOrder=asc`
- Multiple fields: `?sortBy=lastName,firstName&sortOrder=asc,asc`
- Shorthand: `?sort=lastName,-createdAt` (minus = desc)

### 3.3 Field Selection (Sparse Fieldsets)

Following the Single Contract Principle (see Section 1.7), the API uses field selection for partial responses rather than creating separate "summary" or "list" DTOs. The same entity contract is returned with only the requested fields populated.

**Select Specific Fields:**
```http
GET /api/v2/factfinds/{factfindId}/clients/123?fields=id,firstName,lastName,dateOfBirth
```

Response returns the `Client` contract with only requested fields populated:
```json
{
  "id": 123,
  "firstName": "John",
  "lastName": "Smith",
  "dateOfBirth": "1980-05-15"
}
```

**Exclude Fields:**
```http
GET /api/v2/factfinds/{factfindId}/clients/123?exclude=notes,medicalConditions
```

### 3.4 Resource Expansion

**Embed Related Resources:**

Reference types (entities with identity) can be expanded to include their full entity data inline. This applies to fields ending with "Ref" (e.g., `client`, `adviser`). Value types are always fully embedded by default.

**Default response (minimal references):**
```http
GET /api/v2/factfinds/123
```
```json
{
  "id": 123,
  "factFindNumber": "FF001234",
  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/{factfindId}/clients/456",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Jane Doe",
    "code": "ADV001"
  },
  "totalNetMonthlyIncome": {
    "amount": 7500.00,
    "currency": {
    "code": "GBP",
    "display": "British Pound",
    "symbol": "£"
  }
  }
}
```

**Expanded response (full referenced entities):**
```http
GET /api/v2/factfinds/123?expand=client,adviser
```
```json
{
  "id": 123,
  "factFindNumber": "FF001234",
  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/{factfindId}/clients/456",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person",
    // Full Client entity expanded
    "dateOfBirth": "1980-05-15",
    "age": 45,
    "financialProfile": {
      "grossAnnualIncome": {
        "amount": 75000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "primaryAddress": {
      "line1": "123 Main Street",
      "city": "London",
      "postcode": "SW1A 1AA",
      "country": "GB"
    }
  },
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Jane Doe",
    "code": "ADV001",
    // Full Adviser entity expanded
    "email": "jane.doe@example.com",
    "phone": "+44 20 1234 5678"
  },
  "totalNetMonthlyIncome": {
    "amount": 7500.00,
    "currency": {
    "code": "GBP",
    "display": "British Pound",
    "symbol": "£"
  }
  }
}
```

**Expansion Rules:**
- Use `?expand=fieldName` query parameter
- Multiple fields: `?expand=client,adviser,provider`
- Nested expansion: `?expand=client.employment` (expand client, then employment within client)
- Only reference types can be expanded
- Value types (MoneyValue, AddressValue, etc.) are always fully embedded
- Maximum expansion depth: 2 levels to prevent excessive response sizes

### 3.5 Optimistic Concurrency Control

**ETag-Based Locking:**

1. Client retrieves resource:
```http
GET /api/v2/factfinds/{factfindId}/clients/123

Response:
ETag: "33a64df551425fcc55e4d42a148795d9f25f89d4"
```

2. Client updates resource with If-Match:
```http
PUT /api/v2/factfinds/{factfindId}/clients/123
If-Match: "33a64df551425fcc55e4d42a148795d9f25f89d4"

{
  "firstName": "John",
  "lastName": "Johnson"
}
```

3. Success or conflict:
```http
Success (200 OK):
ETag: "9b8769a4f1dce434b9b9c5c82b68b61c0e7f9a5d"

Conflict (409 Conflict):
{
  "type": "https://api.factfind.com/problems/conflict-error",
  "title": "Concurrent Modification",
  "status": 409,
  "detail": "Resource has been modified by another user"
}
```

### 3.6 Batch Operations

**Bulk Create:**
```http
POST /api/v2/factfinds/{factfindId}/clients/bulk
Content-Type: application/json

{
  "clients": [
    {
      "firstName": "John",
      "lastName": "Smith",
      "clientType": "Person"
    },
    {
      "firstName": "Jane",
      "lastName": "Doe",
      "clientType": "Person"
    }
  ]
}

Response (207 Multi-Status):
{
  "results": [
    {
      "status": 201,
      "id": 101,
      "href": "/api/v2/factfinds/{factfindId}/clients/101"
    },
    {
      "status": 400,
      "error": {
        "type": "validation-error",
        "message": "Invalid client type"
      }
    }
  ]
}
```

### 3.7 HATEOAS (Hypermedia Controls)

**Resource Links:**

```json
{
  "id": 123,
  "firstName": "John",
  "lastName": "Smith"/clients/123"
    },
    "update": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123",
      "method": "PUT"
    },
    "delete": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123",
      "method": "DELETE"
    },
    "addresses": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123/addresses"
    },
    "factfinds": {
      "href": "/api/v2/factfinds?clientId=123"
    }
  }
}
```

**Conditional Links (State-Based):**

```json
{
  "id": 123,
  "status": "DRAFT",
    "complete": {
      "href": "/api/v2/factfinds/123/complete",
      "method": "POST",
      "enabled": true
    },
    "archive": {
      "href": "/api/v2/factfinds/123/archive",
      "method": "POST",
      "enabled": false,
      "reason": "Cannot archive draft fact find"
    }
  }
}
```

### 3.8 Data Types

**Money (Currency):**
Uses `MoneyValue` with nested `CurrencyValue`:
```json
{
  "financialProfile": {
    "grossAnnualIncome": {
      "amount": 75000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  }
}
```

**Date and DateTime (ISO 8601):**
```json
{
  "dateOfBirth": "1980-05-15",
  "createdAt": "2026-02-16T14:30:00Z",
  "updatedAt": "2026-02-16T15:45:00Z"
}
```

**Percentage:**
```json
{
  "interestRate": 4.75,
  "ownershipPercentage": 50.0
}
```

**Address:**
Uses `AddressValue` with nested `CountryValue` and `CountyValue`:
```json
{
  "address": {
    "line1": "123 High Street",
    "line2": "Apartment 4B",
    "city": "London",
    "postcode": "SW1A 1AA",
    "county": "GLA",
    "country": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "addressType": "RES"
  }
}
```

**Enumeration Value Types:**
All enumerations use structured Value Types with code/display pattern:
```json
{
  "gender": "M",
  "maritalStatus": {
    "code": "MAR",
    "display": "Married",
    "effectiveFrom": "2015-06-20"
  },
  "employmentStatus": "Employed"
}
```

**Key Benefits:**
- **Self-Documenting**: No need to look up code meanings
- **Internationalization**: Display text can be localized
- **Rich Metadata**: Additional context fields (dates, categories, etc.)
- **Forward-Compatible**: New fields can be added without breaking changes
- **Type-Safe**: Strongly typed in contract definitions

See Section 12.10.9 for complete enumeration value type definitions.

---

## 4. FactFind API (Root Aggregate)


**ARCHITECTURAL NOTE:**

FactFind is the **aggregate root** for all business operations. All other resources (clients, income, arrangements, etc.) are accessed through the FactFind context:

- `/api/v2/factfinds` - Root collection
- `/api/v2/factfinds/{factfindId}` - Specific fact-find
- `/api/v2/factfinds/{factfindId}/clients` - Clients within a fact-find
- `/api/v2/factfinds/{factfindId}/arrangements` - Arrangements within a fact-find
- `/api/v2/factfinds/{factfindId}/objectives` - Objectives within a fact-find

All subsequent API sections (5-11) document resources that are **nested under** the FactFind aggregate root.

---
### 4.1 Overview

**Purpose:** Manage client identities, relationships, and regulatory onboarding requirements.

**Scope:**
- Client registration (Person, Corporate, Trust)
- Contact details management
- Address management
- Identity verification (KYC/AML)
- Data protection consent (GDPR)
- Marketing preferences
- Vulnerability assessments
- Professional contacts (solicitors, accountants)
- Family relationships and dependants

**Aggregate Root:** FactFind (clients are nested within)

**Regulatory Compliance:**
- FCA COBS (Client Classification)
- Money Laundering Regulations 2017 (AML/CTF)
- GDPR (Data Protection)
- Consumer Duty (Vulnerable Customers)

### 4.2 Operations Summary

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients` | List clients with filtering | `client:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients` | Create new client | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}` | Get client details | `client:read` |
| PUT | `/api/v2/factfinds/{factfindId}/clients/{clientId}` | Update client | `client:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}` | Delete client (soft delete) | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/addresses` | List client addresses | `client:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/addresses` | Add address | `client:write` |
| PUT | `/api/v2/factfinds/{factfindId}/clients/{clientId}/addresses/{id}` | Update address | `client:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/addresses/{id}` | Remove address | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/contacts` | List contact details | `client:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/contacts` | Add contact detail | `client:write` |
| PUT | `/api/v2/factfinds/{factfindId}/clients/{clientId}/contacts/{id}` | Update contact | `client:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/contacts/{id}` | Remove contact | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/relationships` | List relationships | `client:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/relationships` | Create relationship | `client:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/relationships/{id}` | Remove relationship | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dependants` | List dependants | `client:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dependants` | Add dependant | `client:write` |
| PUT | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dependants/{id}` | Update dependant | `client:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dependants/{id}` | Remove dependant | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/id-verification` | Get ID verification docs | `client:pii:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/id-verification` | Upload ID document | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dpa-consent` | Get data protection consent | `client:read` |
| PUT | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dpa-consent` | Update DPA consent | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/marketing-consent` | Get marketing preferences | `client:read` |
| PUT | `/api/v2/factfinds/{factfindId}/clients/{clientId}/marketing-consent` | Update marketing consent | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/vulnerability` | Get vulnerability assessment | `client:read` |
| PUT | `/api/v2/factfinds/{factfindId}/clients/{clientId}/vulnerability` | Update vulnerability | `client:write` |

### 4.3 Key Endpoints

#### 4.3.1 Create Client

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients`

**Description:** Create a new client record (Person, Corporate, or Trust).

**Contract:** Uses the unified `Client` contract (see Section 12.1). The same contract structure is used for request and response. Read-only fields (`id`, `createdAt`, `updatedAt`, computed fields) are ignored in the request and populated by the server in the response.

**Request Headers:**
```http
Content-Type: application/json
Authorization: Bearer {token}
```

**Request Body (Person):**
Client contract with required-on-create fields. Read-only and computed fields are ignored.
```json
{
  "clientType": "Person",
  "name": {
    "title": "MR",
    "firstName": "John",
    "middleName": "Michael",
    "lastName": "Smith",
    "preferredName": "John"
  },
  "salutation": "Mr Smith",
  "dateOfBirth": "1980-05-15",
  "gender": "M",
  "maritalStatus": "MAR",
  "taxDetails": {
    "niNumber": "AB123456C"
  },
  "nationalityCountry": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "countryOfBirth": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "countryOfResidence": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "isUkResident": true,
  "isExpatriate": false,
  "isDeceased": false,
  "hasEverSmoked": false,
  "inGoodHealth": true,
  "hasWill": true,
  "isWillUpToDate": true,
  "isPowerOfAttorneyGranted": false,
  "adviser": {
    "id": 789
  }
}
```

**Response:**
Complete `Client` contract with all fields populated, including server-generated fields.

```http
HTTP/1.1 201 Created
Location: /api/v2/factfinds/{factfindId}/clients/123
ETag: "33a64df551425fcc55e4d42a148795d9f25f89d4"
Content-Type: application/json

{
  "id": 123,
  "clientNumber": "C00001234",
  "clientType": "Person",
  "name": {
    "title": "MR",
    "firstName": "John",
    "middleName": "Michael",
    "lastName": "Smith",
    "preferredName": "John"
  },
  "fullName": "Mr John Michael Smith",
  "salutation": "Mr Smith",
  "dateOfBirth": "1980-05-15",
  "age": 45,
  "gender": "M",
  "maritalStatus": "MAR",
  "taxDetails": {
    "niNumber": "AB123456C"
  },
  "nationalityCountry": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "countryOfBirth": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "countryOfResidence": {
    "code": "GB",
    "name": "United Kingdom"
  },
  "isUkResident": true,
  "isExpatriate": false,
  "isDeceased": false,
  "hasEverSmoked": false,
  "isSmoker": "Never",
  "inGoodHealth": true,
  "hasWill": true,
  "isWillUpToDate": true,
  "isPowerOfAttorneyGranted": false,
  "primaryAdviser": {
    "id": 789,
    "firstName": "Jane",
    "lastName": "Doe",
    "href": "/api/v2/advisers/789"
  },
  "serviceStatus": "Active",
  "clientSegment": "A",
  "createdAt": "2026-02-16T14:30:00Z",
  "updatedAt": "2026-02-16T14:30:00Z",
  "createdBy": {
    "id": 999,
    "name": "System Admin"
  },
  "updatedBy": {
    "id": 999,
    "name": "System Admin"
  }/clients/123"
    },
    "update": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123",
      "method": "PUT"
    },
    "addresses": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123/addresses"
    },
    "contacts": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123/contacts"
    },
    "factfinds": {
      "href": "/api/v2/factfinds?clientId=123"
    },
    "arrangements": {
      "href": "/api/v2/factfinds/{factfindId}/arrangements?clientId=123"
    }
  }
}
```

**Status Codes:**
- `201 Created` - Client created successfully
- `400 Bad Request` - Validation errors
- `401 Unauthorized` - Invalid or missing authentication token
- `403 Forbidden` - Insufficient permissions
- `409 Conflict` - Client with same NI number already exists

**Validation Rules:**
- `firstName` - Required, max 100 characters
- `lastName` - Required, max 100 characters
- `dateOfBirth` - Required, must be in past, minimum age 18
- `nationalInsuranceNumber` - Optional, UK NI format validation
- `clientType` - Required, one of: Person, Corporate, Trust
- `gender` - Required for Person, one of: Male, Female, Other, PreferNotToSay
- `maritalStatus` - Optional, one of: Single, Married, Divorced, Widowed, CivilPartnership, Separated

**Business Rules:**
- National Insurance Number must be unique across all clients
- Date of Birth must represent age 18 or older for full client
- UK resident requires UK address
- Primary adviser must be an active adviser in the system

#### 4.3.2 Get Client

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}`

**Description:** Retrieve complete client details including demographic information.

**Contract:** Returns the complete unified `Client` contract (see Section 12.1) with all fields populated.

**Request Headers:**
```http
Authorization: Bearer {token}
```

**Query Parameters:**
- `expand` (optional) - Comma-separated list: `addresses,contacts,dependants,relationships`
- `fields` (optional) - Comma-separated field list for sparse fieldsets (returns `Client` contract with only requested fields)

**Response:**
Complete `Client` contract.
```json
{
  "id": 123,
  "clientType": "Person",
  "name": {
    "title": "MR",
    "firstName": "John",
    "middleName": "Michael",
    "lastName": "Smith"
  },
  "fullName": "Mr John Michael Smith",
  "dateOfBirth": "1980-05-15",
  "age": 45,
  "gender": "M",
  "maritalStatus": {
    "code": "MAR",
    "display": "Married",
    "effectiveFrom": "2005-06-20"
  },
  "nationalInsuranceNumber": "AB123456C",
  "nationalityCountry": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "countryOfBirth": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "countryOfResidence": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "isUkResident": true,
  "isExpatriate": false,
  "hasWill": true,
  "isWillUpToDate": true,
  "willDetails": "Will created in 2020, held by Smith & Co Solicitors",
  "isPowerOfAttorneyGranted": false,
  "hasEverSmoked": false,
  "isSmoker": "Never",
  "inGoodHealth": true,
  "serviceStatus": "Active",
  "serviceStatusDate": "2020-01-15",
  "clientSegment": "A",
  "clientSegmentDate": "2020-01-15",
  "financialProfile": {
    "grossAnnualIncome": {
      "amount": 75000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "householdIncome": {
      "amount": 120000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netWorth": {
      "amount": 450000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalAssets": {
      "amount": 500000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "calculatedAt": "2026-02-18T10:30:00Z",
    "lastReviewDate": "2026-02-18"
  },
  "primaryAdviser": {
    "id": 789,
    "firstName": "Jane",
    "lastName": "Doe",
    "email": "jane.doe@example.com",
    "href": "/api/v2/advisers/789"
  },
  "createdAt": "2020-01-15T10:30:00Z",
  "updatedAt": "2026-02-16T14:30:00Z"/clients/123" },
    "update": { "href": "/api/v2/factfinds/{factfindId}/clients/123", "method": "PUT" },
    "addresses": { "href": "/api/v2/factfinds/{factfindId}/clients/123/addresses" },
    "contacts": { "href": "/api/v2/factfinds/{factfindId}/clients/123/contacts" },
    "relationships": { "href": "/api/v2/factfinds/{factfindId}/clients/123/relationships" },
    "dependants": { "href": "/api/v2/factfinds/{factfindId}/clients/123/dependants" },
    "factfinds": { "href": "/api/v2/factfinds?clientId=123" },
    "arrangements": { "href": "/api/v2/factfinds/{factfindId}/arrangements?clientId=123" },
    "goals": { "href": "/api/v2/factfinds/{factfindId}/objectives?clientId=123" }
  }
}
```

**Status Codes:**
- `200 OK` - Client retrieved successfully
- `401 Unauthorized` - Invalid authentication
- `403 Forbidden` - Insufficient permissions
- `404 Not Found` - Client does not exist

#### 4.3.3 List Clients

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients`

**Description:** List clients with filtering, sorting, and pagination.

**Contract:** Returns collection wrapper (see Section 12.8) containing an array of `Client` contracts. Use `fields` query parameter for sparse fieldsets.

**Query Parameters:**
- `search` (optional) - Full-text search across name fields
- `clientType` (optional) - Filter by type: Person, Corporate, Trust
- `serviceStatus` (optional) - Filter by status: Active, Inactive, Prospect
- `adviserId` (optional) - Filter by primary adviser
- `hasWill` (optional) - Filter by will status: true, false
- `maritalStatus` (optional) - Filter by marital status
- `sortBy` (optional) - Sort field: lastName, firstName, createdAt (default: lastName)
- `sortOrder` (optional) - Sort direction: asc, desc (default: asc)
- `limit` (optional) - Page size (default: 20, max: 100)
- `cursor` (optional) - Pagination cursor
- `expand` (optional) - Include related resources: addresses, contacts
- `fields` (optional) - Comma-separated field list for sparse fieldsets (e.g., `id,fullName,serviceStatus`)

**Response:**
Collection wrapper with array of `Client` contracts (partial fields shown for brevity).

```json
{
  "data": [
    {
      "id": 123,
      "clientType": "Person",
      "fullName": "Mr John Smith",
      "firstName": "John",
      "lastName": "Smith",
      "dateOfBirth": "1980-05-15",
      "age": 45,
      "maritalStatus": "Married",
      "serviceStatus": "Active",
      "primaryAdviser": {
        "id": 789,
        "name": "Jane Doe",
        "href": "/api/v2/advisers/789"
      }/clients/123" }
      }
    },
    {
      "id": 124,
      "clientType": "Person",
      "fullName": "Mrs Sarah Smith",
      "firstName": "Sarah",
      "lastName": "Smith",
      "dateOfBirth": "1982-08-22",
      "age": 43,
      "maritalStatus": "Married",
      "serviceStatus": "Active",
      "primaryAdviser": {
        "id": 789,
        "name": "Jane Doe",
        "href": "/api/v2/advisers/789"
      }/clients/124" }
      }
    }
  ],
  "pagination": {
    "limit": 20,
    "hasMore": true,
    "nextCursor": "eyJpZCI6MTI0fQ==",
    "totalCount": 156
  }/clients?limit=20"
    },
    "next": {
      "href": "/api/v2/factfinds/{factfindId}/clients?limit=20&cursor=eyJpZCI6MTI0fQ=="
    }
  }
}
```

#### 4.3.4 Add Address

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{id}/addresses`

**Description:** Add a new address for a client (residential, correspondence, etc.).

**Request Body:**
```json
{
  "addressType": "Residential",
  "addressLine1": "123 High Street",
  "addressLine2": "Apartment 4B",
  "city": "London",
  "postcode": "SW1A 1AA",
  "county": {
    "code": "GB-LND",
    "name": "London"
  },
  "country": {
    "code": "GB",
    "name": "United Kingdom"
  },
  "correspondenceAddress": true,
  "residentFromDate": "2020-01-15",
  "residencyStatus": "Owner",
  "isOnElectoralRoll": true
}
```

**Response:**
```http
HTTP/1.1 201 Created
Location: /api/v2/factfinds/{factfindId}/clients/123/addresses/456

{
  "id": 456,
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "addressType": "Residential",
  "address": {
    "line1": "123 High Street",
    "line2": "Apartment 4B",
    "city": "London",
    "county": "Greater London",
    "postcode": "SW1A 1AA",
    "country": "GB"
  },
  "isCorrespondenceAddress": true,
  "residencyPeriod": {
    "startDate": "2020-01-15",
    "endDate": null
  },
  "residencyStatus": "Owner",
  "isOnElectoralRoll": true,
  "durationAtAddressYears": 6,
  "durationAtAddressMonths": 1,
  "createdAt": "2026-02-16T14:30:00Z"/clients/123/addresses/address-456" },
    "client": { "href": "/api/v2/factfinds/{factfindId}/clients/123" }
  }
}
```

**Validation Rules:**
- `addressLine1` - Required, max 100 characters
- `city` - Required, max 50 characters
- `postcode` - Required for UK addresses, format validation
- `country` - Required
- `addressType` - Required, one of: Residential, Correspondence, Previous, Business
- `residencyStatus` - Optional, one of: Owner, Tenant, LivingWithFamily, Other

#### 4.3.5 Update Vulnerability Assessment

**Endpoint:** `PUT /api/v2/factfinds/{factfindId}/clients/{clientId}/vulnerability`

**Description:** Update client vulnerability assessment for Consumer Duty compliance.

**Request Body:**
```json
{
  "hasVulnerability": "Yes",
  "vulnerabilityType": "Physical",
  "vulnerabilityCategory": "HealthCondition",
  "vulnerabilityActionTakenDetails": "Large print documents provided, additional time given during meetings, family member invited to participate",
  "isClientPortalSuitable": "WithSupport",
  "clientPortalSuitabilityDetails": "Can use portal with assistance from family member",
  "dateAssessed": "2026-02-16",
  "reviewDate": "2026-08-16"
}
```

**Response:**
```json
{
  "id": 789,
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "hasVulnerability": "Yes",
  "vulnerabilityType": "Physical",
  "vulnerabilityCategory": "HealthCondition",
  "vulnerabilityActionTakenDetails": "Large print documents provided, additional time given during meetings, family member invited to participate",
  "isClientPortalSuitable": "WithSupport",
  "clientPortalSuitabilityDetails": "Can use portal with assistance from family member",
  "dateAssessed": "2026-02-16",
  "reviewDate": "2026-08-16",
  "updatedAt": "2026-02-16T14:30:00Z",
  "updatedBy": {
    "id": 999,
    "name": "Jane Doe"
  }/clients/123/vulnerability" },
    "client": { "href": "/api/v2/factfinds/{factfindId}/clients/123" },
    "history": { "href": "/api/v2/factfinds/{factfindId}/clients/123/vulnerability/history" }
  }
}
```

**Validation Rules:**
- `hasVulnerability` - Required, one of: Yes, No, Unknown
- `vulnerabilityType` - Required if hasVulnerability=Yes, one of: Physical, Mental, Financial, LifeEvent
- `dateAssessed` - Required, must not be in future
- `reviewDate` - Optional, must be after dateAssessed

**Business Rules:**
- Review date should typically be 6-12 months after assessment
- Action taken details required if vulnerability identified
- Assessment triggers notification to primary adviser

---


### 4.4 Current Position Summary API

**Purpose:** Provide aggregated financial position snapshot including net worth, asset allocation, income vs. expenditure comparison, and financial health scoring.

**Scope:**
- Net worth calculation (assets minus liabilities)
- Asset allocation summary across all holdings
- Income vs. expenditure comparison
- Cash flow analysis
- Financial health score (0-100) with component breakdown
- Portfolio diversification metrics
- Debt-to-income ratios
- Emergency fund adequacy
- Savings rate analysis

**Aggregate Root:** FactFind

**Regulatory Compliance:**
- FCA Consumer Duty (Financial Resilience Assessment)
- Vulnerability Framework (Financial Health Indicators)
- Treating Customers Fairly (TCF) Outcome 1

### 4.4.1 Operations Summary

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/current-position` | Get comprehensive financial position summary | `factfind:read` |
| GET | `/api/v2/factfinds/{factfindId}/current-position/net-worth` | Get detailed net worth breakdown | `factfind:read` |
| GET | `/api/v2/factfinds/{factfindId}/current-position/financial-health` | Get financial health score and analysis | `factfind:read` |
| GET | `/api/v2/factfinds/{factfindId}/current-position/cash-flow` | Get cash flow analysis | `factfind:read` |
| GET | `/api/v2/factfinds/{factfindId}/current-position/asset-allocation` | Get detailed asset allocation | `factfind:read` |

### 4.4.2 Key Endpoints

#### 4.4.2.1 Get Current Position Summary

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/current-position`

**Description:** Get comprehensive financial position summary for a fact find including net worth, asset allocation, cash flow, and financial health score.

**Query Parameters:**
- `asOfDate` - Calculate position as of specific date (ISO 8601 format, default: today)
- `includeProjections` - Include future projections (default: false)

**Response:**

```json
{
  "factfindId": 456,
  "asOfDate": "2026-02-17",
  "clients": [
    {
      "id": 123,
      "name": "John Smith",
      "age": 45,
      "retirementAge": 67
    },
    {
      "id": 124,
      "name": "Jane Smith",
      "age": 43,
      "retirementAge": 67
    }
  ],
  "netWorth": {
    "totalAssets": {
      "amount": 850000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalLiabilities": {
      "amount": 250000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netWorth": {
      "amount": 600000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "assetBreakdown": {
    "property": {
      "amount": 450000.00,
      "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"},
      "percentage": 52.9,
      "count": 2
    },
    "pensions": {
      "amount": 250000.00,
      "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"},
      "percentage": 29.4,
      "count": 3
    },
    "investments": {
      "amount": 100000.00,
      "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"},
      "percentage": 11.8,
      "count": 5
    },
    "cash": {
      "amount": 30000.00,
      "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"},
      "percentage": 3.5,
      "count": 3
    }
  },
  "liabilityBreakdown": {
    "mortgages": {
      "amount": 200000.00,
      "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"},
      "percentage": 80.0,
      "count": 1
    },
    "loans": {
      "amount": 30000.00,
      "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"},
      "percentage": 12.0,
      "count": 2
    },
    "creditCards": {
      "amount": 15000.00,
      "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"},
      "percentage": 6.0,
      "count": 3
    }
  },
  "assetAllocation": {
    "equities": {
      "percentage": 45.0,
      "amount": {"amount": 382500.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}}
    },
    "bonds": {
      "percentage": 25.0,
      "amount": {"amount": 212500.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}}
    },
    "property": {
      "percentage": 20.0,
      "amount": {"amount": 170000.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}}
    },
    "cash": {
      "percentage": 7.0,
      "amount": {"amount": 59500.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}}
    },
    "alternatives": {
      "percentage": 3.0,
      "amount": {"amount": 25500.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}}
    }
  },
  "incomeVsExpenditure": {
    "totalGrossAnnualIncome": {"amount": 120000.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}},
    "totalNetMonthlyIncome": {"amount": 7500.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}},
    "totalNetAnnualIncome": {"amount": 90000.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}},
    "totalMonthlyExpenditure": {"amount": 4500.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}},
    "totalAnnualExpenditure": {"amount": 54000.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}},
    "monthlyDisposableIncome": {"amount": 3000.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}},
    "annualDisposableIncome": {"amount": 36000.00, "currency": {"code": "GBP", "display": "British Pound", "symbol": "£"}},
    "savingsRate": 40.0
  },
  "financialHealthScore": {
    "overallScore": 75,
    "scoreDate": "2026-02-17",
    "rating": "Good",
    "components": {
      "emergencyFund": {
        "score": 18,
        "maxScore": 20,
        "percentage": 90.0,
        "status": "Excellent",
        "monthsCovered": 6.7,
        "targetMonths": 6.0,
        "details": "Emergency fund covers 6.7 months of expenditure (target: 6 months)"
      },
      "debtToIncome": {
        "score": 20,
        "maxScore": 25,
        "percentage": 80.0,
        "status": "Good",
        "ratio": 31.2,
        "targetRatio": 36.0,
        "details": "Debt-to-income ratio of 31.2% is below the 36% threshold"
      },
      "savingsRate": {
        "score": 16,
        "maxScore": 20,
        "percentage": 80.0,
        "status": "Good",
        "rate": 40.0,
        "targetRate": 20.0,
        "details": "Saving 40.0% of net income (target: 20%)"
      },
      "diversification": {
        "score": 14,
        "maxScore": 20,
        "percentage": 70.0,
        "status": "Fair",
        "assetClassCount": 5,
        "concentrationRisk": "Medium",
        "details": "Portfolio spread across 5 asset classes with medium concentration"
      },
      "netWorthGrowth": {
        "score": 7,
        "maxScore": 15,
        "percentage": 46.7,
        "status": "Fair",
        "oneYearGrowth": 4.5,
        "threeYearGrowth": 12.8,
        "details": "Net worth growth of 4.5% over past year"
      }
    },
    "recommendations": [
      "Consider increasing property diversification to reduce concentration risk",
      "Net worth growth is below inflation - review investment strategy",
      "Strong emergency fund position - consider redirecting excess to investments"
    ]
  },
    "factfind": {"href": "/api/v2/factfinds/456"},
    "net-worth": {"href": "/api/v2/factfinds/456/current-position/net-worth"},
    "financial-health": {"href": "/api/v2/factfinds/456/current-position/financial-health"},
    "cash-flow": {"href": "/api/v2/factfinds/456/current-position/cash-flow"},
    "asset-allocation": {"href": "/api/v2/factfinds/456/current-position/asset-allocation"}
  }
}
```

**Financial Health Score Calculation:**

The financial health score is calculated on a 0-100 scale with five components:

1. **Emergency Fund (20 points max)**
   - 20 points: 6+ months of expenditure
   - 15 points: 4-6 months
   - 10 points: 2-4 months
   - 5 points: 1-2 months
   - 0 points: < 1 month

2. **Debt-to-Income Ratio (25 points max)**
   - 25 points: < 20%
   - 20 points: 20-30%
   - 15 points: 30-36%
   - 10 points: 36-43%
   - 5 points: 43-50%
   - 0 points: > 50%

3. **Savings Rate (20 points max)**
   - 20 points: > 30% of net income
   - 15 points: 20-30%
   - 10 points: 10-20%
   - 5 points: 5-10%
   - 0 points: < 5%

4. **Diversification (20 points max)**
   - 20 points: Well diversified across 5+ asset classes, no concentration > 40%
   - 15 points: Diversified across 4-5 asset classes, concentration < 50%
   - 10 points: Moderate diversification, concentration < 60%
   - 5 points: Limited diversification, concentration < 75%
   - 0 points: Poor diversification, high concentration > 75%

5. **Net Worth Growth (15 points max)**
   - 15 points: > 10% annual growth
   - 12 points: 7-10% annual growth
   - 9 points: 5-7% annual growth
   - 6 points: 3-5% annual growth
   - 3 points: 0-3% annual growth
   - 0 points: Negative growth

**Rating Bands:**
- 90-100: Excellent
- 75-89: Good
- 60-74: Fair
- 40-59: Needs Improvement
- 0-39: Poor

**Validation Rules:**
- `factfindId` must be a valid fact find identifier
- `asOfDate` must be valid ISO 8601 date format
- Response includes only data available as of the specified date
- All monetary values must be positive
- Percentages must sum to 100 where applicable

**HTTP Status Codes:**
- `200 OK` - Summary retrieved successfully
- `404 Not Found` - Fact find not found
- `403 Forbidden` - Insufficient permissions

---


## 5. Client Management API

### 5.1 Overview


**Base Path:** `/api/v2/factfinds/{factfindId}/clients`

**Purpose:** Capture comprehensive client circumstances and current financial position for financial planning.

**Scope:**
- Fact find session management (ADVICE_CASE aggregate root)
- Employment history and current employment
- Income from all sources (employed, self-employed, investment, rental, etc.)
- Expenditure tracking (essential vs discretionary)
- Expenditure and income changes (future projections)
- Budget analysis and affordability calculations
- Emergency fund assessment

**Aggregate Root:** ADVICE_CASE (FactFind)

**Regulatory Compliance:**
- FCA COBS 9.2 (Assessing Suitability)
- MCOB (Mortgage affordability)
- Consumer Duty (Understanding customer needs)

### 5.2 Operations Summary

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds` | List fact finds | `factfind:read` |
| POST | `/api/v2/factfinds` | Create new fact find | `factfind:write` |
| GET | `/api/v2/factfinds/{id}` | Get fact find summary | `factfind:read` |
| PUT | `/api/v2/factfinds/{id}` | Update fact find | `factfind:write` |
| DELETE | `/api/v2/factfinds/{id}` | Delete fact find | `factfind:write` |
| POST | `/api/v2/factfinds/{id}/complete` | Mark fact find as complete | `factfind:write` |
| GET | `/api/v2/factfinds/{id}/summary` | Get financial summary | `factfind:read` |
| GET | `/api/v2/factfinds/{id}/employment` | List employment records | `factfind:read` |
| POST | `/api/v2/factfinds/{id}/employment` | Add employment | `factfind:write` |
| PUT | `/api/v2/factfinds/{id}/employment/{empId}` | Update employment | `factfind:write` |
| DELETE | `/api/v2/factfinds/{id}/employment/{empId}` | Remove employment | `factfind:write` |
| GET | `/api/v2/factfinds/{id}/income` | List income sources | `factfind:read` |
| POST | `/api/v2/factfinds/{id}/income` | Add income | `factfind:write` |
| PUT | `/api/v2/factfinds/{id}/income/{incomeId}` | Update income | `factfind:write` |
| DELETE | `/api/v2/factfinds/{id}/income/{incomeId}` | Remove income | `factfind:write` |
| GET | `/api/v2/factfinds/{id}/expenditure` | List expenditure | `factfind:read` |
| POST | `/api/v2/factfinds/{id}/expenditure` | Add expenditure | `factfind:write` |
| PUT | `/api/v2/factfinds/{id}/expenditure/{expId}` | Update expenditure | `factfind:write` |
| DELETE | `/api/v2/factfinds/{id}/expenditure/{expId}` | Remove expenditure | `factfind:write` |
| GET | `/api/v2/factfinds/{id}/income-changes` | List expected income changes | `factfind:read` |
| POST | `/api/v2/factfinds/{id}/income-changes` | Add income change | `factfind:write` |
| GET | `/api/v2/factfinds/{id}/expenditure-changes` | List expected expenditure changes | `factfind:read` |
| POST | `/api/v2/factfinds/{id}/expenditure-changes` | Add expenditure change | `factfind:write` |
| GET | `/api/v2/factfinds/{id}/affordability` | Calculate affordability | `factfind:read` |
| GET | `/api/v2/factfinds/{id}/complete` | Get complete aggregate | `factfind:read` |--------|----------|-------------|---------------|
| **Estate Planning Overview** | | | |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning` | Get estate planning overview | `estate:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning` | Update estate planning details | `estate:write` |
| **Gifts Management** | | | |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/gifts` | Record a new gift | `estate:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/gifts` | List all gifts by client | `estate:read` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/gifts/{giftId}` | Get gift details | `estate:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/gifts/{giftId}` | Update gift record | `estate:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/gifts/{giftId}` | Delete gift record | `estate:write` |
| **Trusts Management** | | | |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/trusts` | Create gift trust | `estate:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/trusts` | List client's trusts | `estate:read` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/trusts/{trustId}` | Get trust details | `estate:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/trusts/{trustId}` | Update trust | `estate:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/estate-planning/trusts/{trustId}` | Delete trust | `estate:write` |--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dependants` | List all client's dependants | `clients:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dependants` | Add new dependant | `clients:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dependants/{dependantId}` | Get dependant details | `clients:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dependants/{dependantId}` | Update dependant | `clients:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/dependants/{dependantId}` | Delete dependant | `clients:write` |

**Total Endpoints:** 5

#### 5.5.2 List Dependants

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/dependants`

**Description:** Retrieve all dependants associated with a client.

**Query Parameters:**
- `isFinanciallyDependant` - Filter by financial dependency status (true/false)
- `isLivingWith` - Filter by living arrangement (true/false)
- `relationshipType` - Filter by relationship (Son, Daughter, Elderly Parent, etc.)
- `maxAge` - Filter dependants under specified age
- `includeInactive` - Include dependants past financial dependency end date (default: false)

**Response:**

```json
{
  "client": {
    "id": 123,
    "fullName": "John Smith",
    "href": "/api/v2/factfinds/ff-456/clients/123"
  },
  "dependants": [
    {
      "id": 1,
      "name": "James Smith",
      "dateOfBirth": "2015-06-20",
      "calculatedAge": 10,
      "relationshipType": "SON",
      "isLivingWith": true,
      "isFinanciallyDependant": true,
      "ageCustomUntil": 21,
      "financialDependencyEndsOn": "2036-06-20",
      "financialDependencyPeriod": "Until Age 21",
      "yearsOfDependencyRemaining": 11,
      "clients": [
        {
          "id": 123,
          "fullName": "John Smith",
          "href": "/api/v2/factfinds/ff-456/clients/123"
        },
        {
          "id": 124,
          "fullName": "Sarah Smith",
          "href": "/api/v2/factfinds/ff-456/clients/124"
        }
      ]
      }
    },
    {
      "id": 2,
      "name": "Emma Smith",
      "dateOfBirth": "2018-03-15",
      "calculatedAge": 7,
      "relationshipType": "DAUGHTER",
      "isLivingWith": true,
      "isFinanciallyDependant": true,
      "ageCustomUntil": 18,
      "financialDependencyEndsOn": "2036-03-15",
      "financialDependencyPeriod": "Until Age 18",
      "yearsOfDependencyRemaining": 10,
      "clients": [
        {
          "id": 123,
          "fullName": "John Smith",
          "href": "/api/v2/factfinds/ff-456/clients/123"
        },
        {
          "id": 124,
          "fullName": "Sarah Smith",
          "href": "/api/v2/factfinds/ff-456/clients/124"
        }
      ]
      }
    }
  ],
  "totalCount": 2,
  "financiallyDependantCount": 2,
    "client": { "href": "/api/v2/factfinds/ff-456/clients/123" }
  }
}
```

#### 5.5.3 Create Dependant

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/dependants`

**Description:** Add a new dependant to a client's record.

**Request Body:**

```json
{
  "name": "James Smith",
  "dateOfBirth": "2015-06-20",
  "relationshipType": "SON",
  "isLivingWith": true,
  "isFinanciallyDependant": true,
  "ageCustom": null,
  "ageCustomUntil": 21,
  "notes": "Attending secondary school. Plans to attend university.",
  "clients": [
    {
      "id": 123
    },
    {
      "id": 124
    }
  ]
}
```

**Response:**

```json
{
  "id": 1,
  "name": "James Smith",
  "dateOfBirth": "2015-06-20",
  "calculatedAge": 10,
  "relationshipType": "SON",
  "isLivingWith": true,
  "isFinanciallyDependant": true,
  "ageCustom": null,
  "ageCustomUntil": 21,
  "financialDependencyEndsOn": "2036-06-20",
  "financialDependencyPeriod": "Until Age 21",
  "yearsOfDependencyRemaining": 11,
  "notes": "Attending secondary school. Plans to attend university.",
  "clients": [
    {
      "id": 123,
      "fullName": "John Smith",
      "href": "/api/v2/factfinds/ff-456/clients/123"
    },
    {
      "id": 124,
      "fullName": "Sarah Smith",
      "href": "/api/v2/factfinds/ff-456/clients/124"
    }
  ],
  "createdAt": "2026-02-18T12:00:00Z",
  "updatedAt": "2026-02-18T12:00:00Z",
    "client": { "href": "/api/v2/factfinds/ff-456/clients/123" }
  }
}
```

**Validation Rules:**
- `name` - Required, max 200 characters
- `dateOfBirth` - Required, cannot be in future, must result in age < 100
- `relationshipType` - Required, must be valid code
- `ageCustomUntil` - Optional, must be >= current age and <= 30
- `clients` - At least one client required, all clients must exist and belong to same factfind

**Business Rules:**
- If `ageCustomUntil` not provided, defaults to 18
- If `ageCustom` provided, overrides calculated age (for adoption scenarios)
- `financialDependencyEndsOn` automatically calculated as dateOfBirth + ageCustomUntil years
- `calculatedAge` updated daily based on current date and dateOfBirth
- `yearsOfDependencyRemaining` = financialDependencyEndsOn - current date (in years)
- `financialDependencyPeriod` formatted as human-readable string

#### 5.5.4 Get Dependant Details

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/dependants/{dependantId}`

**Description:** Retrieve detailed information about a specific dependant.

**Response:**

```json
{
  "id": 1,
  "name": "James Smith",
  "dateOfBirth": "2015-06-20",
  "calculatedAge": 10,
  "ageCustom": null,
  "ageCustomUntil": 21,
  "relationshipType": "SON",
  "isLivingWith": true,
  "isFinanciallyDependant": true,
  "financialDependencyEndsOn": "2036-06-20",
  "financialDependencyPeriod": "Until Age 21",
  "yearsOfDependencyRemaining": 11,
  "monthsOfDependencyRemaining": 131,
  "notes": "Attending secondary school. Plans to attend university.",
  "clients": [
    {
      "id": 123,
      "fullName": "John Smith",
      "relationshipToClient": "Father",
      "href": "/api/v2/factfinds/ff-456/clients/123"
    },
    {
      "id": 124,
      "fullName": "Sarah Smith",
      "relationshipToClient": "Mother",
      "href": "/api/v2/factfinds/ff-456/clients/124"
    }
  ],
  "protectionNeeds": {
    "estimatedAnnualCost": {
      "amount": 12000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalCapitalRequired": {
      "amount": 132000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
      "calculation": "11 years × £12,000"
    }
  },
  "createdAt": "2026-02-18T12:00:00Z",
  "updatedAt": "2026-02-18T12:00:00Z",
    "client": { "href": "/api/v2/factfinds/ff-456/clients/123" },
    "update": { "href": "/api/v2/factfinds/ff-456/clients/123/dependants/1", "method": "PATCH" },
    "delete": { "href": "/api/v2/factfinds/ff-456/clients/123/dependants/1", "method": "DELETE" }
  }
}
```

**Additional Calculated Fields:**
- `monthsOfDependencyRemaining` - Months until dependency ends
- `protectionNeeds.estimatedAnnualCost` - Estimated yearly cost for dependant
- `protectionNeeds.totalCapitalRequired` - Total capital needed until independence

#### 5.5.5 Update Dependant

**Endpoint:** `PATCH /api/v2/factfinds/{factfindId}/clients/{clientId}/dependants/{dependantId}`

**Description:** Update dependant information. Commonly used to update living arrangements, financial dependency status, or custom age threshold.

**Request Body:**

```json
{
  "isLivingWith": false,
  "ageCustomUntil": 25,
  "notes": "Now attending university. Living in student accommodation. Extended dependency to age 25 to cover university and initial career years."
}
```

**Response:** 200 OK with updated dependant entity including recalculated fields:
- `financialDependencyEndsOn` recalculated to "2040-06-20" (age 25)
- `financialDependencyPeriod` updated to "Until Age 25"
- `yearsOfDependencyRemaining` recalculated to 15 years
- `protectionNeeds.totalCapitalRequired` recalculated based on new duration

**Partial Update Support:**
- Only provided fields are updated
- Calculated fields automatically updated when dependencies change
- Timestamps updated on any change

#### 5.5.6 Delete Dependant

**Endpoint:** `DELETE /api/v2/factfinds/{factfindId}/clients/{clientId}/dependants/{dependantId}`

**Description:** Remove a dependant record from the client.

**Response:** 204 No Content

**Business Rules:**
- Soft delete - record marked as deleted but retained for audit
- Cannot be restored via API (contact support for restoration)
- Removes dependant from protection needs calculations
- Does not affect historical protection recommendations

---

**Relationship Types:**

| Code | Display | Description |
|------|---------|-------------|
| CHILD | Child | Child of client (gender neutral) |
| SON | Son | Male child of client |
| DAUGHTER | Daughter | Female child of client |
| STEP_CHILD | StepChild | Stepchild of client |
| GRANDCHILD | Grandchild | Child of client's child |
| PARENT | Parent | Parent of client requiring support |
| GRANDPARENT | Grandparent | Grandparent of client requiring support |
| STEP_PARENT | StepParent | Stepparent of client requiring support |
| SPOUSE | Spouse | Married partner of client |
| CIVIL_PARTNER | CivilPartner | Civil partnership partner of client |
| PARTNER | Partner | Unmarried partner of client |
| OTHER | Other | Other dependent relationship |

---

**Age Calculation Rules:**

1. **Standard Calculation:**
   - `calculatedAge = floor((current date - dateOfBirth) / 365.25)`
   - Updated daily at midnight UTC

2. **Custom Age Override:**
   - `ageCustom` field allows manual age entry (for adoption scenarios)
   - If `ageCustom` is set, it overrides `calculatedAge`
   - Use case: Child adopted at age 5, birth date unknown

3. **Financial Dependency End Date:**
   - `financialDependencyEndsOn = dateOfBirth + ageCustomUntil years`
   - Default `ageCustomUntil = 18`
   - Common overrides: 21 (higher education), 25 (university + career start)

4. **Years Remaining:**
   - `yearsOfDependencyRemaining = floor((financialDependencyEndsOn - current date) / 365.25)`
   - Can be negative if dependency end date has passed
   - Used for protection needs calculations

---

**Protection Needs Calculation:**

Used to calculate life insurance and income protection requirements.

**Formula:**
```
Total Capital Required = Years of Dependency Remaining × Estimated Annual Cost

Where:
- Years of Dependency Remaining = financialDependencyEndsOn - current date
- Estimated Annual Cost = configurable per dependant (default £12,000 per child)
```

**Example:**
- Dependant: James Smith, age 10
- Dependency until: Age 21
- Years remaining: 11 years
- Estimated annual cost: £12,000
- **Total capital required: £132,000**

**Multiple Dependants:**
- Sum total capital required across all dependants
- Add 10-20% buffer for inflation and unexpected costs
- Consider education costs separately (university fees, living expenses)

---

**Use Cases:**

### Use Case 1: Add Child Dependant for Joint Clients

**Scenario:** Joint clients have a 10-year-old son attending secondary school

**API Flow:**
```
1. POST /clients/123/dependants
   Request: {
     name: "James Smith",
     dateOfBirth: "2015-06-20",
     relationshipType: "SON",
     isLivingWith: true,
     isFinanciallyDependant: true,
     ageCustomUntil: 21,
     clients: [123, 124]  // Both parents
   }

2. Response includes:
   - calculatedAge: 10
   - financialDependencyEndsOn: "2036-06-20"
   - yearsOfDependencyRemaining: 11
   - protectionNeeds.totalCapitalRequired: £132,000

3. Use for protection planning:
   - Calculate life insurance requirement
   - Calculate income protection requirement
   - Factor into retirement planning (freed-up cash flow at age 21)
```

### Use Case 2: Update Dependency Age for University

**Scenario:** Child going to university, extend dependency from 18 to 25

**API Flow:**
```
1. PATCH /clients/123/dependants/1
   Request: {
     ageCustomUntil: 25,
     notes: "Attending university. Extended to age 25 for university and career start."
   }

2. Automatic recalculation:
   - financialDependencyEndsOn: "2040-06-20" (was "2033-06-20")
   - yearsOfDependencyRemaining: 15 (was 8)
   - protectionNeeds.totalCapitalRequired: £180,000 (was £96,000)

3. Update protection recommendations:
   - Increase life insurance coverage by £84,000
   - Update income protection calculations
```

### Use Case 3: Calculate Total Protection Needs

**Scenario:** Calculate total life insurance required for all dependants

**API Flow:**
```
1. GET /clients/123/dependants

2. Response includes 3 dependants:
   - James (age 10, until 21): £132,000
   - Emma (age 7, until 18): £132,000
   - Oliver (age 4, until 18): £168,000

3. Calculate total:
   - Sum: £432,000
   - Add 15% buffer: £496,800
   - Add mortgage: £250,000
   - Add funeral costs: £10,000
   - **Total life insurance required: £756,800**
```

---

### 5.6 Notes

**Base Path:** `/api/v2/factfinds/{factfindId}/clients/{clientId}/notes`

**Purpose:** Capture and manage advisor notes across different areas of the fact find, providing context, observations, and important information related to specific aspects of the client's financial planning.

**Scope:**
- Profile notes (personal circumstances, life events)
- Employment notes (job security, career plans)
- Asset & Liabilities notes (property, investments, debts)
- Budget notes (spending patterns, financial discipline)
- Mortgage notes (housing plans, affordability concerns)
- Protection notes (health issues, cover requirements)
- Retirement notes (retirement plans, pension expectations)
- Investment notes (risk tolerance, investment experience)
- Estate Planning notes (inheritance wishes, family dynamics)
- Summary notes (overall observations, recommendations)

**Key Features:**
- **Categorized Notes** - Notes organized by discriminator for easy filtering
- **Character Limit** - 500 characters per note for concise documentation
- **Multiple Notes** - Multiple notes per category for comprehensive tracking
- **Timestamped** - Track when notes were created and updated
- **Audit Trail** - Complete history of all notes for compliance

**Aggregate Root:** Client (notes nested under client)

**Regulatory Compliance:**
- FCA Handbook - Documenting client interactions and observations
- COBS 9.2 - Recording basis for suitability assessment
- Consumer Duty - Understanding customer circumstances
- Data Protection Act 2018 - Secure storage of client notes
- TCF (Treating Customers Fairly) - Documenting fair treatment

#### 5.6.1 Operations Summary

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/notes` | List all notes for client | `notes:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/notes` | Create new note | `notes:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/notes/{noteId}` | Get specific note | `notes:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/notes/{noteId}` | Update note | `notes:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/notes/{noteId}` | Delete note | `notes:write` |

**Total Endpoints:** 5

#### 5.6.2 List Notes

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/notes`

**Description:** Retrieve all notes for a client with optional filtering by discriminator.

**Query Parameters:**
- `discriminator` - Filter by note category (Profile, Employment, AssetLiabilities, etc.)
- `sort` - Sort by createdAt or updatedAt (default: createdAt desc)
- `limit` - Maximum results (default: 50, max: 200)
- `offset` - Pagination offset

**Response:**

```json
{
  "client": {
    "id": 456,
    "fullName": "John Smith",
    "href": "/api/v2/factfinds/ff-423/clients/456"
  },
  "notes": [
    {
      "id": 789,
      "href": "/api/v2/factfinds/ff-423/clients/456/notes/note-789",
      "discriminator": "Profile",
      "notes": "Client recently married, spouse is self-employed. Planning to start a family within 2 years. Important for protection planning.",
      "createdAt": "2026-02-18T10:30:00Z",
      "updatedAt": "2026-02-18T10:30:00Z"
    },
    {
      "id": 790,
      "href": "/api/v2/factfinds/ff-423/clients/456/notes/note-790",
      "discriminator": "Mortgage",
      "notes": "Client's fixed rate ends in 6 months. Should review remortgage options. Considering moving to larger property in next 2-3 years.",
      "createdAt": "2026-02-18T11:00:00Z",
      "updatedAt": "2026-02-18T11:00:00Z"
    },
    {
      "id": 791,
      "href": "/api/v2/factfinds/ff-423/clients/456/notes/note-791",
      "discriminator": "Protection",
      "notes": "Client has no life insurance. High priority due to mortgage and planned family. Spouse has chronic condition - may affect premiums.",
      "createdAt": "2026-02-18T11:15:00Z",
      "updatedAt": "2026-02-18T11:15:00Z"
    }
  ],
  "totalCount": 3,
    "client": {
      "href": "/api/v2/factfinds/ff-423/clients/456"
    }
  }
}
```

#### 5.6.3 Create Note

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/notes`

**Description:** Create a new note for the client in a specific category.

**Request Body:**

```json
{
  "discriminator": "Investment",
  "notes": "Client has limited investment experience. Previously held only cash ISAs. Risk profile indicates balanced approach. Recommend gradual introduction to equity funds with clear education on volatility."
}
```

**Response:**

```json
{
  "id": 792,
  "href": "/api/v2/factfinds/ff-423/clients/456/notes/note-792",
  "client": {
    "id": 456,
    "fullName": "John Smith",
    "href": "/api/v2/factfinds/ff-423/clients/456"
  },
  "discriminator": "Investment",
  "notes": "Client has limited investment experience. Previously held only cash ISAs. Risk profile indicates balanced approach. Recommend gradual introduction to equity funds with clear education on volatility.",
  "createdAt": "2026-02-18T14:20:00Z",
  "updatedAt": "2026-02-18T14:20:00Z",
    "client": {
      "href": "/api/v2/factfinds/ff-423/clients/456"
    }
  }
}
```

**Validation Rules:**
- `discriminator` - Required, must be valid enum value
- `notes` - Required, max 500 characters
- Client must exist and belong to factfind

**Business Rules:**
- Notes are immutable after creation (updates create new version)
- Deleted notes soft-deleted (retained for audit)
- Notes included in fact find completion checklist
- Notes exported with fact find reports

#### 5.6.4 Update Note

**Endpoint:** `PATCH /api/v2/factfinds/{factfindId}/clients/{clientId}/notes/{noteId}`

**Description:** Update the text content of an existing note.

**Request Body:**

```json
{
  "notes": "Client has limited investment experience. Previously held only cash ISAs. Risk profile indicates balanced approach. Recommend gradual introduction to equity funds with clear education on volatility. UPDATE: Client comfortable with proposal after discussion."
}
```

**Response:** 200 OK with updated note entity.

**Note:** Some implementations may choose to make notes append-only for compliance, in which case PATCH would create a new version rather than overwrite.

#### 5.6.5 Delete Note

**Endpoint:** `DELETE /api/v2/factfinds/{factfindId}/clients/{clientId}/notes/{noteId}`

**Description:** Delete a note (soft delete for audit trail).

**Response:** 204 No Content

---

**Note Discriminators (Enum):**

| Code | Display | Use Case |
|------|---------|----------|
| PROFILE | Profile | Personal circumstances, life events, family status |
| EMPLOYMENT | Employment | Job security, career plans, income stability |
| ASSET_LIABILITIES | AssetLiabilities | Property notes, investment holdings, debt concerns |
| BUDGET | Budget | Spending patterns, financial discipline, affordability |
| MORTGAGE | Mortgage | Housing plans, remortgage, property moves |
| PROTECTION | Protection | Health issues, cover requirements, existing policies |
| RETIREMENT | Retirement | Retirement plans, pension expectations, lifestyle goals |
| INVESTMENT | Investment | Risk tolerance, investment experience, objectives |
| ESTATE_PLANNING | EstatePlanning | Inheritance wishes, family dynamics, trusts |
| SUMMARY | Summary | Overall observations, key recommendations, next steps |

---

**Use Cases:**

### Use Case 1: Record Protection Planning Notes

**Scenario:** During fact find, discover client health issues affecting protection

**API Flow:**
```
POST /clients/456/notes
{
  "discriminator": "Protection",
  "notes": "Client disclosed pre-existing condition (Type 2 diabetes, controlled). May affect life insurance premiums. Consider specialist broker for underwriting."
}

Response: Note created successfully

Use: Reference during protection planning
```

### Use Case 2: Track Mortgage Timeline

**Scenario:** Client fixed rate ending, need to track timeline

**API Flow:**
```
POST /clients/456/notes
{
  "discriminator": "Mortgage",
  "notes": "Fixed rate ends Aug 2026. Current rate 2.5%, reverting to 6.5% SVR. Must review options by June 2026. Client considering moving to 4-bed in next 2 years."
}

Response: Note created

Use: Set reminders, include in regular review
```

### Use Case 3: Document Investment Risk Discussion

**Scenario:** Record client's risk tolerance discussion

**API Flow:**
```
POST /clients/456/notes
{
  "discriminator": "Investment",
  "notes": "ATR questionnaire: Balanced risk. Client comfortable with 5-10% volatility. Lost money in 2008 crash, learned to hold long-term. Prefers diversified funds over individual stocks."
}

Response: Note created

Use: Demonstrate suitability in file review
```

---

### 5.7 Custom Questions (Supplementary Questions)

**Base Path:** `/api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions`

**Purpose:** Capture additional client information through configurable custom questions beyond standard fact-find fields. Supports dynamic questionnaires with conditional logic, validation rules, and flexible answer types.

**Key Features:**
- **10 Question Types** - Text, Textarea, NumberWhole, NumberDecimal, Date, YesNo, DropDownList, Select, Checkbox, Monetary
- **Conditional Logic** - Questions can be required, enabled, or visible based on answers to other questions
- **Flexible Options** - Multi-select support for dropdown, select, and checkbox questions
- **Pattern Validation** - Regex patterns for text input validation
- **Custom Attributes** - Extensible dictionary for additional metadata
- **Tagging System** - Organize questions by tags and subcategories
- **Separate Answer Storage** - Questions and answers stored separately for versioning
- **Archival Support** - Questions can be archived without losing historical data

**Use Cases:**
- ESG preferences and ethical investing criteria
- Additional due diligence questions for high-net-worth clients
- Product-specific suitability questions
- Regional compliance requirements
- Firm-specific data capture requirements
- Client preference tracking (communication, meeting preferences, etc.)

**Aggregate Root:** Client (within FactFind context)

**Regulatory Compliance:**
- FCA COBS 9.2 (Assessing Suitability - Additional Information Gathering)
- MiFID II Article 25 (Assessment of Suitability)
- FCA Consumer Duty (Understanding Customer Needs)
- GDPR Article 6 (Lawful Basis for Processing)
- Data Protection Act 2018 (Special Category Data)

---

#### 5.7.1 Operations Summary

**Question Management Endpoints:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions` | List all custom questions | `client:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions` | Create custom question | `client:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/{questionId}` | Get question details | `client:read` |
| PUT | `/api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/{questionId}` | Update custom question | `client:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/{questionId}` | Delete custom question | `client:write` |

**Answer Management Endpoints:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/answers` | Get all question answers | `client:read` |
| PUT | `/api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/answers` | Submit/update question answers | `client:write` |

---

#### 5.7.2 List Custom Questions

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions`

**Description:** Retrieves all custom questions configured for a client, including archived questions. Use query parameters to filter by tags, subcategory, or archived status.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier
- `clientId` (required) - The client identifier

**Query Parameters:**
- `tags` (optional) - Filter by tags (comma-separated)
- `subcategoryId` (optional) - Filter by subcategory ID
- `includeArchived` (optional) - Include archived questions (default: false)
- `page` (optional) - Page number (default: 1)
- `pageSize` (optional) - Items per page (default: 50, max: 200)

**Response:** `200 OK`

```json
{
  "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions",
  "first_href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions?page=1",
  "last_href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions?page=1",
  "next_href": null,
  "prev_href": null,
  "items": [
    {
      "id": 1234,
      "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1234",
      "questionType": "YesNo",
      "subcategory": {
        "id": 10,
        "order": 1
      },
      "isRequired": true,
      "isMultiple": false,
      "text": "Are you interested in ethical or ESG investing?",
      "options": null,
      "order": 1,
      "tags": ["ESG", "Investment"],
      "isArchived": false,
      "includeNotes": true,
      "placeHolderText": null,
      "helpText": "ESG stands for Environmental, Social, and Governance investing",
      "pattern": null,
      "errorText": null,
      "attributes": {
        "displayGroup": "Investment Preferences",
        "adviserOnly": "false"
      },
      "logic": []
    },
    {
      "id": 1235,
      "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1235",
      "questionType": "Checkbox",
      "subcategory": {
        "id": 10,
        "order": 2
      },
      "isRequired": false,
      "isMultiple": true,
      "text": "Which ESG factors are most important to you?",
      "options": [
        {
          "order": 1,
          "isArchived": false,
          "value": 1,
          "text": "Environmental sustainability"
        },
        {
          "order": 2,
          "isArchived": false,
          "value": 2,
          "text": "Social responsibility"
        },
        {
          "order": 3,
          "isArchived": false,
          "value": 3,
          "text": "Corporate governance"
        },
        {
          "order": 4,
          "isArchived": false,
          "value": 4,
          "text": "Climate change mitigation"
        }
      ],
      "order": 2,
      "tags": ["ESG", "Investment"],
      "isArchived": false,
      "includeNotes": false,
      "placeHolderText": null,
      "helpText": "Select all that apply",
      "pattern": null,
      "errorText": null,
      "attributes": {
        "displayGroup": "Investment Preferences"
      },
      "logic": [
        {
          "type": "VisibleIf",
          "parentQuestion": {
            "id": 1234,
            "answer": "Yes"
          }
        }
      ]
    },
    {
      "id": 1236,
      "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1236",
      "questionType": "Monetary",
      "subcategory": {
        "id": 11,
        "order": 1
      },
      "isRequired": true,
      "isMultiple": false,
      "text": "What is your target retirement income per year?",
      "options": null,
      "order": 3,
      "tags": ["Retirement", "Goals"],
      "isArchived": false,
      "includeNotes": true,
      "placeHolderText": "GBP 50000",
      "helpText": "Enter amount in format: CURRENCY AMOUNT (e.g., GBP 50000)",
      "pattern": "^[A-Z]{3}\\s\\d+(\\.\\d{2})?$",
      "errorText": "Please enter amount in format: GBP 50000",
      "attributes": {
        "displayGroup": "Retirement Planning"
      },
      "logic": []
    }
  ],
  "count": 3,
    "client": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456" },
    "answers": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/answers" }
  }
}
```

**Business Rules:**
- Questions are returned in `order` sequence
- Archived questions excluded by default unless `includeArchived=true`
- Questions with conditional logic include parent question reference
- Maximum 200 custom questions per client

**Validation Rules:**
- `factfindId` must exist
- `clientId` must exist and belong to the factfind
- User must have `client:read` permission

---

#### 5.7.3 Create Custom Question

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions`

**Description:** Creates a new custom question for a client. The question can include validation rules, conditional logic, and custom attributes.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier
- `clientId` (required) - The client identifier

**Request Body:**

```json
{
  "questionType": "DropDownList",
  "subcategory": {
    "id": 12,
    "order": 1
  },
  "isRequired": true,
  "isMultiple": false,
  "text": "How frequently would you like portfolio reviews?",
  "options": [
    {
      "order": 1,
      "isArchived": false,
      "value": 1,
      "text": "Quarterly"
    },
    {
      "order": 2,
      "isArchived": false,
      "value": 2,
      "text": "Semi-annually"
    },
    {
      "order": 3,
      "isArchived": false,
      "value": 3,
      "text": "Annually"
    }
  ],
  "order": 5,
  "tags": ["Service", "Preferences"],
  "isArchived": false,
  "includeNotes": true,
  "placeHolderText": "Select review frequency",
  "helpText": "We'll schedule regular reviews based on your preference",
  "pattern": null,
  "errorText": null,
  "attributes": {
    "displayGroup": "Service Preferences",
    "affectsServiceLevel": "true"
  },
  "logic": []
}
```

**Response:** `201 Created`

```json
{
  "id": 1240,
  "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1240",
  "questionType": "DropDownList",
  "subcategory": {
    "id": 12,
    "order": 1
  },
  "isRequired": true,
  "isMultiple": false,
  "text": "How frequently would you like portfolio reviews?",
  "options": [
    {
      "order": 1,
      "isArchived": false,
      "value": 1,
      "text": "Quarterly"
    },
    {
      "order": 2,
      "isArchived": false,
      "value": 2,
      "text": "Semi-annually"
    },
    {
      "order": 3,
      "isArchived": false,
      "value": 3,
      "text": "Annually"
    }
  ],
  "order": 5,
  "tags": ["Service", "Preferences"],
  "isArchived": false,
  "includeNotes": true,
  "placeHolderText": "Select review frequency",
  "helpText": "We'll schedule regular reviews based on your preference",
  "pattern": null,
  "errorText": null,
  "attributes": {
    "displayGroup": "Service Preferences",
    "affectsServiceLevel": "true"
  },
  "logic": [],
    "client": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456" },
    "questions": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions" },
    "answers": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/answers" }
  }
}
```

**Validation Rules:**
- `questionType` must be one of: Text, Textarea, NumberWhole, NumberDecimal, Date, YesNo, DropDownList, Select, Checkbox, Monetary
- `text` is required (max 500 characters)
- `options` required for DropDownList, Select, Checkbox types
- `options` must have at least 2 options
- Each option must have unique `value`
- `pattern` must be valid regex if provided
- `logic.parentQuestion.id` must reference existing question
- Maximum 200 custom questions per client

**Error Responses:**
- `400 Bad Request` - Invalid question type or validation failure
- `404 Not Found` - Client or factfind not found
- `409 Conflict` - Order conflict with existing question
- `422 Unprocessable Entity` - Parent question reference invalid

---

#### 5.7.4 Get Custom Question Details

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/{questionId}`

**Description:** Retrieves full details of a specific custom question including all logic rules and options.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier
- `clientId` (required) - The client identifier
- `questionId` (required) - The custom question identifier

**Response:** `200 OK`

```json
{
  "id": 1237,
  "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1237",
  "questionType": "NumberDecimal",
  "subcategory": {
    "id": 13,
    "order": 1
  },
  "isRequired": true,
  "isMultiple": false,
  "text": "What percentage of your portfolio would you allocate to alternative investments?",
  "options": null,
  "order": 10,
  "tags": ["Investment", "RiskProfile"],
  "isArchived": false,
  "includeNotes": true,
  "placeHolderText": "0.00",
  "helpText": "Alternative investments include private equity, hedge funds, commodities, real estate",
  "pattern": "^\\d{1,2}(\\.\\d{1,2})?$",
  "errorText": "Please enter a percentage between 0 and 100",
  "attributes": {
    "displayGroup": "Asset Allocation",
    "min": "0",
    "max": "100",
    "step": "0.01"
  },
  "logic": [
    {
      "type": "EnabledIf",
      "parentQuestion": {
        "id": 1234,
        "answer": "Yes"
      }
    }
  ],
    "client": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456" },
    "questions": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions" },
    "parentQuestion": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1234" }
  }
}
```

**Error Responses:**
- `404 Not Found` - Question, client, or factfind not found

---

#### 5.7.5 Update Custom Question

**Endpoint:** `PUT /api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/{questionId}`

**Description:** Updates an existing custom question. Cannot change question type. All fields are replaced (not merged).

**Path Parameters:**
- `factfindId` (required) - The fact find identifier
- `clientId` (required) - The client identifier
- `questionId` (required) - The custom question identifier

**Request Body:**

```json
{
  "questionType": "Text",
  "subcategory": {
    "id": 14,
    "order": 1
  },
  "isRequired": false,
  "isMultiple": false,
  "text": "Do you have any specific investment exclusions? (Updated wording)",
  "options": null,
  "order": 7,
  "tags": ["Investment", "ESG", "Preferences"],
  "isArchived": false,
  "includeNotes": true,
  "placeHolderText": "e.g., tobacco, weapons, fossil fuels",
  "helpText": "List any sectors or companies you wish to exclude from your portfolio",
  "pattern": null,
  "errorText": null,
  "attributes": {
    "displayGroup": "Investment Preferences",
    "maxLength": "1000"
  },
  "logic": []
}
```

**Response:** `200 OK`

```json
{
  "id": 1238,
  "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1238",
  "questionType": "Text",
  "subcategory": {
    "id": 14,
    "order": 1
  },
  "isRequired": false,
  "isMultiple": false,
  "text": "Do you have any specific investment exclusions? (Updated wording)",
  "options": null,
  "order": 7,
  "tags": ["Investment", "ESG", "Preferences"],
  "isArchived": false,
  "includeNotes": true,
  "placeHolderText": "e.g., tobacco, weapons, fossil fuels",
  "helpText": "List any sectors or companies you wish to exclude from your portfolio",
  "pattern": null,
  "errorText": null,
  "attributes": {
    "displayGroup": "Investment Preferences",
    "maxLength": "1000"
  },
  "logic": [],
    "client": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456" },
    "questions": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions" }
  }
}
```

**Business Rules:**
- Cannot change `questionType` after creation
- Updating question text does not affect existing answers
- Order changes may require reordering other questions

**Validation Rules:**
- Same validation rules as Create operation
- `id` in URL must match existing question
- Cannot change `questionType`

**Error Responses:**
- `400 Bad Request` - Attempt to change question type
- `404 Not Found` - Question not found
- `409 Conflict` - Order conflict

---

#### 5.7.6 Delete Custom Question

**Endpoint:** `DELETE /api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/{questionId}`

**Description:** Soft deletes a custom question by marking it as archived. Historical answers are retained for audit purposes.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier
- `clientId` (required) - The client identifier
- `questionId` (required) - The custom question identifier

**Response:** `204 No Content`

**Business Rules:**
- Question is marked as `isArchived: true` (soft delete)
- Historical answers are retained
- Archived questions excluded from default listings
- Can be retrieved with `includeArchived=true` query parameter

**Error Responses:**
- `404 Not Found` - Question not found
- `409 Conflict` - Question has dependent child questions with logic

---

#### 5.7.7 Submit Question Answers

**Endpoint:** `PUT /api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/answers`

**Description:** Submits or updates answers to custom questions. Replaces all answers (upsert operation). Missing questions in request remain unchanged.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier
- `clientId` (required) - The client identifier

**Request Body:**

```json
[
  {
    "question": {
      "id": 1234
    },
    "answerText": "Yes",
    "selectedOptions": null,
    "notes": "Client very interested in sustainable investing options"
  },
  {
    "question": {
      "id": 1235
    },
    "answerText": null,
    "selectedOptions": [
      {
        "value": 1,
        "text": "Environmental sustainability"
      },
      {
        "value": 4,
        "text": "Climate change mitigation"
      }
    ],
    "notes": null
  },
  {
    "question": {
      "id": 1236
    },
    "answerText": "GBP 60000",
    "selectedOptions": null,
    "notes": "Includes state pension estimate of £11,500/year"
  }
]
```

**Response:** `200 OK`

```json
{
  "message": "Answers saved successfully",
  "answeredCount": 3,
  "totalQuestions": 5,
  "completionPercentage": 60.0,
    "questions": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions" },
    "client": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456" }
  }
}
```

**Business Rules:**
- Upsert operation - creates new answers or updates existing
- Missing questions in request are not modified
- Empty `answerText` and `selectedOptions` clears the answer
- For monetary questions, format is "CURRENCY AMOUNT" (e.g., "GBP 50000")
- For select/dropdown/checkbox, use `selectedOptions` array
- For all other types, use `answerText`

**Validation Rules:**
- `question.id` must reference existing custom question
- `answerText` OR `selectedOptions` required (not both)
- For DropDownList/Select/Checkbox: `selectedOptions` required
- For other types: `answerText` required
- `selectedOptions` values must match question's option values
- `isMultiple=false`: maximum 1 option in `selectedOptions`
- `isMultiple=true`: multiple options allowed in `selectedOptions`
- Monetary format must match pattern: `^[A-Z]{3}\s\d+(\.\d{2})?$`
- Number answers must match question's `pattern` if specified
- Required questions must have answer if visible/enabled

**Error Responses:**
- `400 Bad Request` - Invalid answer format or validation failure
- `404 Not Found` - Question reference not found
- `422 Unprocessable Entity` - Answer doesn't match question type or options

---

#### 5.7.8 Get Question Answers

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/custom-questions/answers`

**Description:** Retrieves all answers to custom questions for a client, including the question details for context.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier
- `clientId` (required) - The client identifier

**Query Parameters:**
- `tags` (optional) - Filter by question tags (comma-separated)
- `subcategoryId` (optional) - Filter by subcategory
- `includeUnanswered` (optional) - Include questions without answers (default: false)

**Response:** `200 OK`

```json
{
  "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/answers",
  "first_href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/answers?page=1",
  "last_href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/answers?page=1",
  "next_href": null,
  "prev_href": null,
  "items": [
    {
      "question": {
        "id": 1234,
        "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1234",
        "questionType": "YesNo",
        "subcategory": {
          "id": 10,
          "order": 1
        },
        "isRequired": true,
        "isMultiple": false,
        "text": "Are you interested in ethical or ESG investing?",
        "options": null,
        "order": 1,
        "tags": ["ESG", "Investment"],
        "isArchived": false,
        "includeNotes": true,
        "placeHolderText": null,
        "helpText": "ESG stands for Environmental, Social, and Governance investing",
        "pattern": null,
        "errorText": null,
        "attributes": {
          "displayGroup": "Investment Preferences"
        },
        "logic": []
      },
      "answer": {
        "answerText": "Yes",
        "selectedOptions": null,
        "notes": "Client very interested in sustainable investing options"
      }
    },
    {
      "question": {
        "id": 1235,
        "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1235",
        "questionType": "Checkbox",
        "subcategory": {
          "id": 10,
          "order": 2
        },
        "isRequired": false,
        "isMultiple": true,
        "text": "Which ESG factors are most important to you?",
        "options": [
          {
            "order": 1,
            "isArchived": false,
            "value": 1,
            "text": "Environmental sustainability"
          },
          {
            "order": 2,
            "isArchived": false,
            "value": 2,
            "text": "Social responsibility"
          },
          {
            "order": 3,
            "isArchived": false,
            "value": 3,
            "text": "Corporate governance"
          },
          {
            "order": 4,
            "isArchived": false,
            "value": 4,
            "text": "Climate change mitigation"
          }
        ],
        "order": 2,
        "tags": ["ESG", "Investment"],
        "isArchived": false,
        "includeNotes": false,
        "placeHolderText": null,
        "helpText": "Select all that apply",
        "pattern": null,
        "errorText": null,
        "attributes": {
          "displayGroup": "Investment Preferences"
        },
        "logic": [
          {
            "type": "VisibleIf",
            "parentQuestion": {
              "id": 1234,
              "answer": "Yes"
            }
          }
        ]
      },
      "answer": {
        "answerText": null,
        "selectedOptions": [
          {
            "value": 1,
            "text": "Environmental sustainability"
          },
          {
            "value": 4,
            "text": "Climate change mitigation"
          }
        ],
        "notes": null
      }
    },
    {
      "question": {
        "id": 1236,
        "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions/1236",
        "questionType": "Monetary",
        "subcategory": {
          "id": 11,
          "order": 1
        },
        "isRequired": true,
        "isMultiple": false,
        "text": "What is your target retirement income per year?",
        "options": null,
        "order": 3,
        "tags": ["Retirement", "Goals"],
        "isArchived": false,
        "includeNotes": true,
        "placeHolderText": "GBP 50000",
        "helpText": "Enter amount in format: CURRENCY AMOUNT (e.g., GBP 50000)",
        "pattern": "^[A-Z]{3}\\s\\d+(\\.\\d{2})?$",
        "errorText": "Please enter amount in format: GBP 50000",
        "attributes": {
          "displayGroup": "Retirement Planning"
        },
        "logic": []
      },
      "answer": {
        "answerText": "GBP 60000",
        "selectedOptions": null,
        "notes": "Includes state pension estimate of £11,500/year"
      }
    }
  ],
  "count": 3,
    "client": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456" },
    "questions": { "href": "https://api.factfind.com/api/v2/factfinds/ff-123/clients/456/custom-questions" }
  }
}
```

**Business Rules:**
- Returns only answered questions by default
- Use `includeUnanswered=true` to see all questions with empty answers
- Answers are returned in question order
- Includes full question details for context

---

### Question Types Reference

| Question Type | Answer Format | Example | Notes |
|--------------|---------------|---------|-------|
| **Text** | Short text string | `"John Smith"` | Single-line text, max 255 chars |
| **Textarea** | Long text string | `"Multi-line\ntext content"` | Multi-line text, max 5000 chars |
| **NumberWhole** | Integer string | `"42"` | Whole numbers only |
| **NumberDecimal** | Decimal string | `"42.50"` | Decimal numbers |
| **Date** | ISO 8601 date | `"2026-02-18"` | Format: YYYY-MM-DD |
| **YesNo** | "Yes" or "No" | `"Yes"` | Boolean question |
| **DropDownList** | selectedOptions array | `[{"value": 1, "text": "Option 1"}]` | Single selection |
| **Select** | selectedOptions array | `[{"value": 2, "text": "Option 2"}]` | Single or multiple selection |
| **Checkbox** | selectedOptions array | `[{"value": 1}, {"value": 3}]` | Multiple selection |
| **Monetary** | Currency + amount | `"GBP 50000.00"` | Format: CURRENCY AMOUNT |

### Logic Types Reference

| Logic Type | Description | Example Use Case |
|-----------|-------------|------------------|
| **RequiredIf** | Question becomes required if parent answer matches | "Pension transfer details required if 'Have existing pension' = Yes" |
| **EnabledIf** | Question becomes enabled (editable) if parent answer matches | "Investment amount enabled if 'Investing?' = Yes" |
| **VisibleIf** | Question becomes visible if parent answer matches | "ESG preferences visible if 'Interest in ESG' = Yes" |

---

### Use Cases

#### Use Case 1: ESG Investment Preferences

**Scenario:** Capture client's environmental, social, and governance investment preferences

**API Flow:**
```
1. Create YesNo question: "Interested in ESG investing?"
   POST /custom-questions

2. Create Checkbox question with VisibleIf logic: "Which ESG factors?"
   POST /custom-questions
   (Visible only if Q1 = "Yes")

3. Client completes questionnaire:
   PUT /custom-questions/answers
   [
     {"question": {"id": 1}, "answerText": "Yes"},
     {"question": {"id": 2}, "selectedOptions": [{"value": 1}, {"value": 4}]}
   ]

4. Retrieve answers for suitability report:
   GET /custom-questions/answers
```

**Benefit:** Dynamic questionnaire adapts based on client responses, reducing clutter

---

#### Use Case 2: High-Net-Worth Due Diligence

**Scenario:** Additional KYC questions for HNW clients (>£1M investable assets)

**API Flow:**
```
1. Create custom questions for source of wealth:
   POST /custom-questions
   {
     "text": "Please describe the source of your wealth",
     "questionType": "Textarea",
     "isRequired": true,
     "tags": ["KYC", "HNW"]
   }

2. Create question for politically exposed person status:
   POST /custom-questions
   {
     "text": "Are you or any family member a Politically Exposed Person?",
     "questionType": "YesNo",
     "isRequired": true,
     "tags": ["KYC", "HNW", "PEP"]
   }

3. Submit answers during onboarding:
   PUT /custom-questions/answers
```

**Benefit:** Firm-specific compliance requirements captured alongside standard fact-find

---

#### Use Case 3: Pension Transfer Suitability

**Scenario:** Additional questions required for DB pension transfer advice

**API Flow:**
```
1. Create question: "Do you have guaranteed benefits?"
   POST /custom-questions

2. Create conditional question: "What is your guaranteed annual income?"
   POST /custom-questions
   {
     "logic": [{
       "type": "RequiredIf",
       "parentQuestion": {"id": 100, "answer": "Yes"}
     }]
   }

3. Create monetary question: "Current transfer value?"
   POST /custom-questions
   {"questionType": "Monetary"}

4. Adviser submits pension analysis:
   PUT /custom-questions/answers
```

**Benefit:** Complex conditional logic ensures regulatory compliance for specialist advice

---

### Regulatory Compliance

**FCA COBS 9.2 - Assessing Suitability:**
- Custom questions allow firms to gather additional information beyond standard fact-find
- Supports "know your customer" obligation
- Documents client circumstances affecting suitability

**MiFID II Article 25:**
- Additional questions support enhanced suitability assessment
- ESG preferences align with sustainability preferences requirements
- Documented questionnaire responses provide audit trail

**FCA Consumer Duty:**
- Custom questions help firms understand individual client needs
- Flexible questionnaire adapts to client circumstances
- Notes field allows advisers to document client discussions

**Data Protection Act 2018:**
- Custom questions may capture special category data (health, politics)
- Firms must ensure lawful basis for processing
- Attributes field can flag data requiring additional protection
- Soft delete preserves data for regulatory retention periods

**FCA Handbook PS21/5 (Pension Transfer Advice):**
- Additional due diligence questions for DB pension transfers
- Conditional logic ensures required fields completed
- Monetary question types capture transfer values and guaranteed benefits

---

### Technical Notes

**Question Versioning:**
- Questions are immutable once answers exist
- Updates create new version internally
- Historical answers reference original question version

**Performance Optimization:**
- Questions cached per client (invalidate on update)
- Answers stored separately for efficient retrieval
- Pagination recommended for clients with >50 questions

**Conditional Logic Execution:**
- Logic evaluated client-side for UX responsiveness
- Server validates all logic rules on answer submission
- Circular dependencies detected and rejected

**Security Considerations:**
- Custom attributes allow PII flagging
- Questions marked as "adviserOnly" hidden from client portal
- Audit log tracks all question and answer modifications
- GDPR right-to-erasure: soft delete retains regulatory minimum

---



## 6. Income & Expenditure API (Circumstances Context)

### 6.1 Overview

**Base Paths:**
- Income: `/api/v2/factfinds/{factfindId}/clients/{clientId}/income`
- Income Changes: `/api/v2/factfinds/{factfindId}/clients/{clientId}/income-changes`
- Expenditure: `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditures`
- Expenditure Changes: `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditure-changes`

**Purpose:** Track client's actual income sources, expenditure, and expected changes to their financial circumstances.

**Scope:**
- Income sources (salaries, rental income, dividends, pensions in payment, benefits)
- Expected income changes (promotions, bonuses, retirement, benefit changes)
- Living expenses (mortgage/rent, utilities, food, transport, insurance)
- Debt payments (loans, credit cards)
- Expected expenditure changes (mortgage payoff, retirement lifestyle changes)

**Note:** Employment history and details are managed separately in Section 7 (Employment API).

**Aggregate Root:** Client (each client has their own circumstances, nested under FactFind)

**Key Characteristics:**
- **Nested under clients** - Each client in a fact-find has their own income and expenditure
- **Actual cash flow** - Records real money coming in and going out
- **Time-based** - Tracks start dates, end dates, and future changes
- **Frequency-aware** - Handles weekly, monthly, quarterly, annual amounts
- **Affordability calculations** - Supports budget and affordability assessments

**Regulatory Compliance:**
- FCA COBS (Suitability and Affordability)
- Consumer Duty (Understanding Customer Needs)
- Mortgage Credit Directive (Affordability Assessment)

### 6.2 Operations Summary

**Income Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income` | List income sources | `circumstances:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income` | Create income source | `circumstances:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income/{id}` | Get income details | `circumstances:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income/{id}` | Update income source | `circumstances:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income/{id}` | Delete income source | `circumstances:write` |

**Income Changes Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income-changes` | List expected income changes | `circumstances:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income-changes` | Create income change | `circumstances:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income-changes/{id}` | Get income change details | `circumstances:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income-changes/{id}` | Update income change | `circumstances:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/income-changes/{id}` | Delete income change | `circumstances:write` |

**Expenditure Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditures` | List expenditure items | `circumstances:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditures` | Create expenditure item | `circumstances:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditures/{id}` | Get expenditure details | `circumstances:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditures/{id}` | Update expenditure item | `circumstances:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditures/{id}` | Delete expenditure item | `circumstances:write` |

**Expenditure Changes Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditure-changes` | List expected expenditure changes | `circumstances:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditure-changes` | Create expenditure change | `circumstances:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditure-changes/{id}` | Get expenditure change details | `circumstances:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditure-changes/{id}` | Update expenditure change | `circumstances:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/expenditure-changes/{id}` | Delete expenditure change | `circumstances:write` |

### 6.3 Key Endpoints

**Note:** Employment operations have been moved to Section 7 (Employment API). See Section 7.3 for employment endpoint documentation.

#### 6.3.1 List Income Sources

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/income`

**Description:** Retrieve all income sources for a client.

**Query Parameters:**
- `incomeCategory` - Filter by income category (Employment, Rental, Investment, Pension, Benefits, Other)
- `isTaxable` - Filter by taxable status (true/false)
- `includeEnded` - Include income with end dates (default: true)

**Response:**
```json
{
  "clientId": 123,
  "clientName": "John Smith",
  "totalIncome": {
    "amount": 72000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "income": [
    {
      "id": 111,
      "incomeCategory": "Employment",
      "description": "Salary from ABC Technology",
      "amount": {
        "amount": 65000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "Annual",
      "startDate": "2020-03-01",
      "endDate": null,
      "isTaxable": true,
      "asset": null/clients/123/income/inc-111"
        }
      }
    },
    {
      "id": 222,
      "incomeCategory": "Rental",
      "description": "Rental income - Buy-to-Let property",
      "amount": {
        "amount": 7000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "Annual",
      "startDate": "2019-01-01",
      "endDate": null,
      "isTaxable": true,
      "asset": {
        "id": 5001,
        "href": "/api/v2/factfinds/{factfindId}/assets/5001",
        "assetType": "Property",
        "description": "Buy-to-Let Property - 42 Elm Street"
      }/clients/123/income/inc-222"
        }
      }
    }
  ]/clients/123/income"
    },
    "create": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123/income",
      "method": "POST"
    }
  }
}
```

#### 6.3.2 Create Income Source

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/income`

**Description:** Create a new income source for a client.

**Request Body:**
```json
{
  "incomeCategory": "Pension",
  "description": "State Pension",
  "amount": {
    "amount": 10600.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": "Annual",
  "startDate": "2027-01-01",
  "endDate": null,
  "isTaxable": true,
  "asset": null
}
```

**Response:**
```http
HTTP/1.1 201 Created
Location: /api/v2/factfinds/{factfindId}/clients/123/income/inc-333

{
  "id": 333,
  "incomeCategory": "Pension",
  "description": "State Pension",
  "amount": {
    "amount": 10600.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": "Annual",
  "startDate": "2027-01-01",
  "endDate": null,
  "isTaxable": true,
  "asset": null,
  "createdAt": "2026-02-18T10:15:00Z",
  "updatedAt": "2026-02-18T10:15:00Z"/clients/123/income/inc-333"
    },
    "update": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123/income/inc-333",
      "method": "PATCH"
    },
    "client": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123"
    }
  }
}
```

**Income Categories:**
- `Employment` - Salary, wages, bonuses
- `Rental` - Rental income from properties
- `Investment` - Dividends, interest
- `Pension` - Pension income (state, private)
- `Benefits` - State benefits, welfare
- `Other` - Other income sources

**Frequency Values:**
- `Weekly`, `Fortnightly`, `Monthly`, `Quarterly`, `Annual`

#### 6.3.3 Create Income Change

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/income-changes`

**Description:** Record an expected change to income (e.g., retirement, promotion, bonus ending).

**Request Body:**
```json
{
  "income": {
    "id": 111,
    "description": "Salary from ABC Technology"
  },
  "changeType": "Stop",
  "effectiveDate": "2027-03-01",
  "newAmount": null,
  "reason": "Retirement"
}
```

**Response:**
```http
HTTP/1.1 201 Created
Location: /api/v2/factfinds/{factfindId}/clients/123/income-changes/inc-change-444

{
  "id": 444,
  "income": {
    "id": 111,
    "description": "Salary from ABC Technology",
    "href": "/api/v2/factfinds/{factfindId}/clients/123/income/inc-111"
  },
  "changeType": "Stop",
  "effectiveDate": "2027-03-01",
  "newAmount": null,
  "reason": "Retirement",
  "createdAt": "2026-02-18T10:30:00Z",
  "updatedAt": "2026-02-18T10:30:00Z"/clients/123/income-changes/inc-change-444"
    },
    "income": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123/income/inc-111"
    },
    "client": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123"
    }
  }
}
```

**Change Types:**
- `Increase` - Income will increase
- `Decrease` - Income will decrease
- `Stop` - Income will cease
- `Start` - New income will commence

#### 6.3.4 List Expenditure Items

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/expenditures`

**Description:** Retrieve all expenditure items for a client.

**Query Parameters:**
- `expenditureType` - Filter by type (see Expenditure Types in Section 14.21)
- `isConsolidated` - Filter by consolidation status (true/false)
- `isLiabilityToBeRepaid` - Filter expenditures linked to liabilities (true/false)

**Response:**
```json
{
  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/234/clients/456",
    "fullName": "John Smith"
  },
  "totalMonthlyExpenditure": {
    "amount": 3855.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "expenditures": [
    {
      "id": 1001,
      "href": "/api/v2/factfinds/234/clients/456/expenditures/1001",
      "factfind": {
        "id": 234,
        "href": "/api/v2/factfinds/234"
      },
      "description": "Monthly mortgage payment - main residence",
      "expenditureType": "Mortgage",
      "netAmount": {
        "amount": 1500.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "Monthly",
      "startsOn": "2020-06-01",
      "endsOn": null,
      "isConsolidated": false,
      "isLiabilityToBeRepaid": true,
      "liability": {
        "id": 5001,
        "href": "/api/v2/factfinds/234/liabilities/5001",
        "description": "Residential Mortgage - Main Home"
      },
      "notes": "Fixed rate until 2027"
    },
    {
      "id": 1002,
      "href": "/api/v2/factfinds/234/clients/456/expenditures/1002",
      "factfind": {
        "id": 234,
        "href": "/api/v2/factfinds/234"
      },
      "description": "Council tax - Band D property",
      "expenditureType": "Council Tax",
      "netAmount": {
        "amount": 185.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "Monthly",
      "startsOn": "2025-04-01",
      "endsOn": null,
      "isConsolidated": false,
      "isLiabilityToBeRepaid": false,
      "liability": null,
      "notes": "10 monthly payments (April-January)"
    },
    {
      "id": 1004,
      "href": "/api/v2/factfinds/234/clients/456/expenditures/1004",
      "factfind": {
        "id": 234,
        "href": "/api/v2/factfinds/234"
      },
      "description": "Weekly food shopping and personal care items",
      "expenditureType": "Food & Personal Care",
      "netAmount": {
        "amount": 520.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "Monthly",
      "startsOn": "2025-01-01",
      "endsOn": null,
      "isConsolidated": false,
      "isLiabilityToBeRepaid": false,
      "liability": null,
      "notes": "Family of 4 - approximately £120/week"
    }
  ]
    "create": {
      "href": "/api/v2/factfinds/234/clients/456/expenditures",
      "method": "POST"
    }
  }
}
```

#### 6.3.5 Create Expenditure Item

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/expenditures`

**Description:** Create a new expenditure item for a client.

**Request Body:**
```json
{
  "description": "Car lease payment",
  "expenditureType": "Car/Travelling Expenses",
  "netAmount": {
    "amount": 300.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": "Monthly",
  "startsOn": "2024-01-01",
  "endsOn": "2027-12-31",
  "isConsolidated": false,
  "isLiabilityToBeRepaid": false,
  "notes": "3-year lease agreement"
}
```

**Response:**
```http
HTTP/1.1 201 Created
Location: /api/v2/factfinds/234/clients/456/expenditures/1005

{
  "id": 1005,
  "href": "/api/v2/factfinds/234/clients/456/expenditures/1005",

  "factfind": {
    "id": 234,
    "href": "/api/v2/factfinds/234"
  },

  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/234/clients/456"
  },

  "description": "Car lease payment",
  "expenditureType": "Car/Travelling Expenses",
  "netAmount": {
    "amount": 300.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": "Monthly",
  "startsOn": "2024-01-01",
  "endsOn": "2027-12-31",
  "isConsolidated": false,
  "isLiabilityToBeRepaid": false,
  "liability": null,
  "notes": "3-year lease agreement",
  "createdAt": "2026-02-18T11:00:00Z",
  "updatedAt": "2026-02-18T11:00:00Z"
    "update": {
      "href": "/api/v2/factfinds/234/clients/456/expenditures/1005",
      "method": "PATCH"
    },
    "client": {
      "href": "/api/v2/factfinds/234/clients/456"
    }
  }
}
```

**Expenditure Types:**

See Section 14.21 for the complete list of expenditure types organized by category:

**Basic Essential Expenditure:**
- Rent, Mortgage, Council Tax
- Gas, Electricity, Water, Telephone/Mobile
- Food & Personal Care, Car/Travelling Expenses
- Housekeeping, Ground Rent/Service charge

**Basic Quality of Living:**
- Clothing, Furniture/Appliances/Repairs
- TV/Satellite/Internet/Basic Recreation
- Pension, School Fee/Childcare

**Non-Essential Outgoings:**
- Sports and Recreation, Holidays, Entertainment
- Life/General Assurance Premium, Investments, Credit Card

#### 6.3.6 Create Expenditure Change

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/expenditure-changes`

**Description:** Record an expected change to expenditure (e.g., mortgage payoff, lifestyle changes).

**Request Body:**
```json
{
  "expenditure": {
    "id": 555,
    "description": "Mortgage payment - main residence"
  },
  "changeType": "Stop",
  "effectiveDate": "2040-05-31",
  "newAmount": null,
  "reason": "Mortgage term end"
}
```

**Response:**
```http
HTTP/1.1 201 Created
Location: /api/v2/factfinds/{factfindId}/clients/123/expenditure-changes/exp-change-888

{
  "id": 888,
  "expenditure": {
    "id": 555,
    "description": "Mortgage payment - main residence",
    "href": "/api/v2/factfinds/{factfindId}/clients/123/expenditure/exp-555"
  },
  "changeType": "Stop",
  "effectiveDate": "2040-05-31",
  "newAmount": null,
  "reason": "Mortgage term end",
  "createdAt": "2026-02-18T11:15:00Z",
  "updatedAt": "2026-02-18T11:15:00Z"/clients/123/expenditure-changes/exp-change-888"
    },
    "expenditure": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123/expenditure/exp-555"
    },
    "client": {
      "href": "/api/v2/factfinds/{factfindId}/clients/123"
    }
  }
}
```

**Change Types:**
- `Increase` - Expenditure will increase
- `Decrease` - Expenditure will decrease
- `Stop` - Expenditure will cease
- `Start` - New expenditure will commence

### 6.4 Affordability
**Base Path:** `/api/v2/factfinds/{factfindId}/affordability`

**Purpose:** Provides comprehensive affordability assessments for both monthly cashflow analysis and lumpsum investment planning. Supports mortgage applications, protection planning, investment advice, debt consolidation scenarios, and retirement planning through sophisticated scenario modelling and calculation capabilities.

#### 6.4.1 Overview

Affordability Assessment is a critical component of the fact-find process that evaluates a client's financial capacity to take on new commitments or make investment decisions. This API enables advisers to:

**Key Features:**
- **Monthly Cashflow Analysis** - Calculate disposable income based on current income and expenditure
- **Scenario Modelling** - Test multiple "what-if" scenarios with configurable options:
  * Incorporate planned income/expenditure changes
  * Model forgoing non-essential expenditure
  * Exclude consolidated debts
  * Exclude debts being repaid
  * Include new protection premium costs
- **Lumpsum Investment Assessment** - Evaluate available capital for investment or debt reduction
- **Emergency Fund Planning** - Calculate required emergency reserves and track shortfalls
- **Multi-Client Support** - Assess affordability for individual clients or joint scenarios
- **Dynamic Recalculation** - All calculated fields update automatically when inputs change
- **Regulatory Compliance** - Built-in validation for FCA affordability requirements

**Use Cases:**
1. **Mortgage Applications** - Demonstrate affordability for mortgage lending criteria
2. **Investment Advice** - Determine sustainable monthly investment capacity
3. **Retirement Planning** - Assess sustainability of retirement income vs expenditure
4. **Debt Consolidation** - Model impact of consolidating multiple debts
5. **Protection Planning** - Calculate impact of new protection premiums on cashflow
6. **Emergency Fund Planning** - Establish appropriate emergency reserves

**Regulatory Compliance:**
- MCOB (Mortgage Conduct of Business) - Mortgage affordability assessments
- FCA Handbook COBS 9.2 - Suitability for investments and protection
- Consumer Duty - Understanding customer financial position and vulnerability
- FCA Responsible Lending - Creditworthiness assessments
- CCA (Consumer Credit Act) - Pre-contractual credit assessments

#### 6.4.2 Operations Summary

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/affordability` | Get the affordability assessment | Yes |
| PUT | `/api/v2/factfinds/{factfindId}/affordability` | Update affordability assessment | Yes |

**Total Endpoints:** 2

**Key Design Decisions:**
- Affordability is a singleton resource per factfind (one assessment per factfind)
- No id field required as it's uniquely identified by factfind
- Support for multiple clients within the assessment (joint scenarios)
- Automatic calculation on update
- Cannot be deleted independently (deleted when factfind is deleted)

#### 6.4.3 Key Endpoints

##### 6.4.3.1 Get Affordability
**Endpoint:** `GET /api/v2/factfinds/{factfindId}/affordability`

**Description:** Retrieve the affordability assessment for this factfind with all calculated values.

**Path Parameters:**
- `factfindId` (string, required) - The fact-find identifier

**Response:** `200 OK`

**Response Body:**

```json
{
  "href": "/api/v2/factfinds/456/affordability",

  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456"
  },

  "clients": [
    {
      "id": 456,
      "href": "/api/v2/factfinds/456/clients/456"
    }
  ],

  "incomes": [
    {
      "id": 2001,
      "href": "/api/v2/factfinds/456/clients/456/incomes/2001"
    }
  ],

  "expenditures": [
    {
      "id": 1001,
      "href": "/api/v2/factfinds/456/clients/456/expenditures/1001"
    }
  ],

  "monthlyCashFlow": {
    "totalNetIncome": {
      "amount": 4500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalExpenditure": {
      "amount": 2800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "disposableIncome": {
      "amount": 1700.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "monthlyModelling": {
    "options": {
      "incorporateIncomeChanges": "Yes",
      "incorporateExpenditureChanges": "Yes",
      "forgoNonEssentialExpenditure": "No",
      "excludeConsolidatedExpenditure": "Yes",
      "excludeRepaidExpenditure": "Yes",
      "hasRebrokerProtection": "No"
    },
    "agreedMonthlyBudget": {
      "amount": 1500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "notes": "Client has variable income from bonus"
  },

  "monthlyAffordability": {
    "revisedIncome": {
      "amount": 4700.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "revisedExpenditure": {
      "amount": 2900.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "consolidatedExpenditurePayments": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "expenditurePaymentsTobeRepaid": {
      "amount": 300.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "protectionPremiums": {
      "amount": 150.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "finalDisposableIncome": {
      "amount": 1250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "lumpsumAffordability": {
    "totalLumpSumAvailable": {
      "amount": 50000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "agreedInvestmentAmount": {
      "amount": 30000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "sourceOfInvestment": "PropertySale",
    "isInvestmentAvailableWithoutPenalty": "Yes",
    "notes": "From property sale completion expected March 2026",
    "totalFundsAvailable": {
      "amount": 55000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "emergencyFund": {
    "committedAmount": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "requiredAmount": {
      "amount": 8000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "shortfall": {
      "amount": 3000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "createdAt": "2026-01-15T10:30:00Z",
  "lastUpdatedAt": "2026-01-29T14:45:00Z"
}
```

**Status Codes:**
- `200 OK` - Assessment retrieved successfully
- `404 Not Found` - Assessment or fact-find not found
- `401 Unauthorized` - Missing or invalid authentication
- `403 Forbidden` - Insufficient permissions

**Business Logic:**
- All calculated fields are read-only and computed server-side
- MonthlyC ashFlow calculations aggregate data from referenced incomes and expenditures
- MonthlyAffordability applies scenario options to produce adjusted figures
- LumpsumAffordability evaluates available capital for investment

---

##### 6.4.3.2 Create Affordability
**Endpoint:** `POST /api/v2/factfinds/{factfindId}/affordability`

**Description:** Create a new affordability assessment with initial parameters. All calculated fields are automatically computed.

**Path Parameters:**
- `factfindId` (string, required) - The fact-find identifier

**Request Body:**

```json
{
  "clients": [
    {
      "id": 456
    }
  ],

  "incomes": [
    {
      "id": 2001
    },
    {
      "id": 2002
    }
  ],

  "expenditures": [
    {
      "id": 1001
    },
    {
      "id": 1002
    },
    {
      "id": 1003
    }
  ],

  "monthlyModelling": {
    "options": {
      "incorporateIncomeChanges": "Yes",
      "incorporateExpenditureChanges": "Yes",
      "forgoNonEssentialExpenditure": "No",
      "excludeConsolidatedExpenditure": "Yes",
      "excludeRepaidExpenditure": "Yes",
      "hasRebrokerProtection": "No"
    },
    "agreedMonthlyBudget": {
      "amount": 1500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "notes": "Client has variable income from bonus"
  },

  "lumpsumAffordability": {
    "totalLumpSumAvailable": {
      "amount": 50000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "agreedInvestmentAmount": {
      "amount": 30000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "sourceOfInvestment": "PropertySale",
    "isInvestmentAvailableWithoutPenalty": "Yes",
    "notes": "From property sale completion expected March 2026"
  },

  "emergencyFund": {
    "committedAmount": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "requiredAmount": {
      "amount": 8000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  }
}
```

**Response:** `201 Created`

**Response Body:** Full affordability assessment entity (same structure as GET response)

**Status Codes:**
- `200 OK` - Assessment updated successfully
- `400 Bad Request` - Invalid request data or validation failure
- `404 Not Found` - Referenced clients, incomes, or expenditures not found
- `401 Unauthorized` - Missing or invalid authentication
- `403 Forbidden` - Insufficient permissions

**Validation Rules:**
- At least 1 client required
- At least 1 income required
- Expenditures can be empty array (clients with no recorded expenditure)
- All referenced IDs must exist and belong to the fact-find
- All MoneyValue amounts must be non-negative
- `agreedMonthlyBudget` cannot exceed calculated `finalDisposableIncome`
- `agreedInvestmentAmount` cannot exceed `totalLumpSumAvailable`
- Yes/No fields must be exactly "Yes" or "No" (case-sensitive)

**Business Logic:**
- Server automatically calculates all fields in monthlyCashFlow
- Server applies monthlyModelling options to calculate monthlyAffordability
- Server calculates emergencyFund.shortfall
- Server calculates lumpsumAffordability.totalFundsAvailable
- Currency codes must be consistent across all money values in the assessment

---

##### 6.4.3.2 Update Affordability
**Endpoint:** `PUT /api/v2/factfinds/{factfindId}/affordability`

**Description:** Update scenario options, budget amounts, or change which incomes/expenditures are included. All calculated fields automatically recalculate.

**Path Parameters:**
- `factfindId` (string, required) - The fact-find identifier

**Request Body:**

```json
{
  "monthlyModelling": {
    "options": {
      "forgoNonEssentialExpenditure": "Yes",
      "excludeConsolidatedExpenditure": "Yes"
    },
    "agreedMonthlyBudget": {
      "amount": 1800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "notes": "Updated scenario: client willing to reduce non-essentials"
  },

  "lumpsumAffordability": {
    "agreedInvestmentAmount": {
      "amount": 35000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  }
}
```

**Response:** `200 OK`

**Response Body:** Full affordability assessment entity with recalculated values

**Status Codes:**
- `200 OK` - Assessment updated successfully
- `400 Bad Request` - Invalid request data or validation failure
- `404 Not Found` - Assessment or fact-find not found
- `401 Unauthorized` - Missing or invalid authentication
- `403 Forbidden` - Insufficient permissions

**Automatic Recalculations:**
- All monthlyCashFlow values recalculated if incomes/expenditures changed
- All monthlyAffordability values recalculated based on new options
- emergencyFund.shortfall recalculated if amounts changed
- lastUpdatedAt timestamp updated

**Partial Update Support:**
- Only provided fields are updated
- Nested objects are merged (not replaced entirely)
- To unset optional fields, explicitly set to null

---

##### 6.4.3.4 Recalculate Affordability

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/affordability/{affordabilityId}/recalculate`

**Description:** Manually trigger recalculation of all derived fields. Useful when underlying income or expenditure records have been updated outside of this assessment.

**Path Parameters:**
- `factfindId` (string, required) - The fact-find identifier
- `affordabilityId` (integer, required) - The affordability assessment identifier

**Request Body:** Empty (or optional notes)

```json
{
  "notes": "Recalculated after updating client employment income"
}
```

**Response:** `200 OK`

**Response Body:** Full affordability assessment entity with recalculated values

**Status Codes:**
- `200 OK` - Recalculation completed successfully
- `404 Not Found` - Assessment or fact-find not found
- `422 Unprocessable Entity` - Referenced incomes/expenditures no longer exist
- `401 Unauthorized` - Missing or invalid authentication
- `403 Forbidden` - Insufficient permissions

**Use Cases:**
- Client income records have been updated
- Expenditure records have been modified
- Referenced records have been deleted (will return 422)
- Periodic refresh to ensure data consistency

---

#### 6.4.4 Field Definitions

##### Identification Fields

| Field | Type | Required | Read-Only | Description |
|-------|------|----------|-----------|-------------|
| `href` | string | - | Yes | Canonical URI for this affordability assessment |
| `factfind.id` | integer | On create | Yes | Reference to parent fact-find |
| `factfind.href` | string | - | Yes | URI to parent fact-find |
| `clients` | array | On create | No | Array of client references included in this assessment (minimum 1) |
| `clients[].id` | integer | Yes | No | Client identifier |
| `clients[].href` | string | - | Yes | URI to client resource |
| `incomes` | array | On create | No | Array of income references to include (minimum 1) |
| `incomes[].id` | integer | Yes | No | Income identifier |
| `incomes[].href` | string | - | Yes | URI to income resource |
| `expenditures` | array | On create | No | Array of expenditure references to include (can be empty) |
| `expenditures[].id` | integer | Yes | No | Expenditure identifier |
| `expenditures[].href` | string | - | Yes | URI to expenditure resource |

##### Monthly Cash Flow (Read-Only Calculated)

All fields in this section are calculated server-side based on the referenced incomes and expenditures.

| Field | Type | Required | Read-Only | Description |
|-------|------|----------|-----------|-------------|
| `monthlyCashFlow.totalNetIncome` | MoneyValue | - | Yes | Sum of all net annual income from incomes array ÷ 12 |
| `monthlyCashFlow.totalExpenditure` | MoneyValue | - | Yes | Sum of all expenditures converted to monthly equivalent |
| `monthlyCashFlow.disposableIncome` | MoneyValue | - | Yes | totalNetIncome - totalExpenditure |

**Calculation Logic:**
```
totalNetIncome = Σ(incomes[].netAnnualAmount) / 12
totalExpenditure = Σ(expenditures[].monthlyEquivalent)
disposableIncome = totalNetIncome - totalExpenditure
```

##### Monthly Modelling Options

Controls which scenario adjustments are applied to calculate revised affordability.

| Field | Type | Required | Read-Only | Description | Values |
|-------|------|----------|-----------|-------------|--------|
| `monthlyModelling.options.incorporateIncomeChanges` | string | No | No | Include expected future income changes | "Yes" or "No" |
| `monthlyModelling.options.incorporateExpenditureChanges` | string | No | No | Include expected future expenditure changes | "Yes" or "No" |
| `monthlyModelling.options.forgoNonEssentialExpenditure` | string | No | No | Exclude all non-essential expenditure | "Yes" or "No" |
| `monthlyModelling.options.excludeConsolidatedExpenditure` | string | No | No | Exclude expenditures marked for consolidation | "Yes" or "No" |
| `monthlyModelling.options.excludeRepaidExpenditure` | string | No | No | Exclude expenditures marked to be repaid | "Yes" or "No" |
| `monthlyModelling.options.hasRebrokerProtection` | string | No | No | Include cost of new/rebrokered protection | "Yes" or "No" |
| `monthlyModelling.agreedMonthlyBudget` | MoneyValue | No | No | Monthly amount client commits to for new commitment |  |
| `monthlyModelling.notes` | string | No | No | Free-text notes about modelling assumptions | Max 1000 chars |

**Default Values (if not provided):**
- All options default to "No"
- agreedMonthlyBudget defaults to null
- notes defaults to empty string

##### Monthly Affordability (Read-Only Calculated)

All fields in this section are calculated by applying monthlyModelling options to the base cashflow.

| Field | Type | Required | Read-Only | Description |
|-------|------|----------|-----------|-------------|
| `monthlyAffordability.revisedIncome` | MoneyValue | - | Yes | Income adjusted for expected changes (if incorporateIncomeChanges = "Yes") |
| `monthlyAffordability.revisedExpenditure` | MoneyValue | - | Yes | Expenditure adjusted for expected changes (if incorporateExpenditureChanges = "Yes") |
| `monthlyAffordability.consolidatedExpenditurePayments` | MoneyValue | - | Yes | Sum of expenditure payments flagged as consolidated |
| `monthlyAffordability.expenditurePaymentsTobeRepaid` | MoneyValue | - | Yes | Sum of expenditure payments flagged to be repaid |
| `monthlyAffordability.protectionPremiums` | MoneyValue | - | Yes | Sum of protection arrangement premiums (if hasRebrokerProtection = "Yes") |
| `monthlyAffordability.finalDisposableIncome` | MoneyValue | - | Yes | Final monthly surplus after all adjustments |

**Calculation Logic (detailed in section 6.4.5)**

##### Lumpsum Affordability

Assesses available capital for investment, purchase, or debt reduction.

| Field | Type | Required | Read-Only | Description |
|-------|------|----------|-----------|-------------|
| `lumpsumAffordability.totalLumpSumAvailable` | MoneyValue | No | No | Total cash available for investment/commitment |
| `lumpsumAffordability.agreedInvestmentAmount` | MoneyValue | No | No | Amount client agrees to invest/commit |
| `lumpsumAffordability.sourceOfInvestment` | string | No | No | Where the funds come from (free text or enum) |
| `lumpsumAffordability.isInvestmentAvailableWithoutPenalty` | string | No | No | Can funds be accessed without penalties? | "Yes" or "No" |
| `lumpsumAffordability.notes` | string | No | No | Additional context about lumpsum availability | Max 1000 chars |
| `lumpsumAffordability.totalFundsAvailable` | MoneyValue | - | Yes | Total funds available (calculated, may include other sources) |

**Validation:**
- agreedInvestmentAmount cannot exceed totalLumpSumAvailable
- sourceOfInvestment typically one of: PropertySale, Inheritance, Bonus, InvestmentMaturity, Savings, Gift, PensionLumpSum, Redundancy, Other

##### Emergency Fund

Tracks emergency fund adequacy and shortfall.

| Field | Type | Required | Read-Only | Description |
|-------|------|----------|-----------|-------------|
| `emergencyFund.committedAmount` | MoneyValue | No | No | Amount client has set aside for emergencies |
| `emergencyFund.requiredAmount` | MoneyValue | No | No | Recommended emergency fund (typically 3-6 months essential expenditure) |
| `emergencyFund.shortfall` | MoneyValue | - | Yes | Gap to close (requiredAmount - committedAmount, minimum 0) |

**Calculation Logic:**
```
shortfall = MAX(0, requiredAmount - committedAmount)
```

**Business Rule:**
- requiredAmount typically = essentialMonthlyExpenditure × months (3-6)

##### Audit Trail

| Field | Type | Required | Read-Only | Description |
|-------|------|----------|-----------|-------------|
| `createdAt` | timestamp | - | Yes | When assessment was created (ISO 8601 format) |
| `lastUpdatedAt` | timestamp | - | Yes | When assessment was last modified (ISO 8601 format) |

---

#### 6.4.5 Calculation Rules

This section documents the precise formulas used to calculate derived fields.

##### Monthly Cash Flow Calculations

**1. Total Net Income (Monthly)**
```
totalNetIncome = Σ(incomes[i].netAnnualAmount) / 12

Where:
  - netAnnualAmount is the after-tax annual income for each income source
  - Result is normalized to monthly frequency
```

**2. Total Expenditure (Monthly)**
```
totalExpenditure = Σ(expenditures[i].monthlyEquivalent)

Where:
  - monthlyEquivalent converts all expenditures to monthly frequency
  - Annual expenditure ÷ 12
  - Quarterly expenditure ÷ 3
  - Weekly expenditure × 52 ÷ 12
```

**3. Disposable Income**
```
disposableIncome = totalNetIncome - totalExpenditure
```

##### Monthly Affordability Calculations

**4. Revised Income**
```
IF incorporateIncomeChanges = "Yes":
  revisedIncome = totalNetIncome + Σ(expectedIncomeIncreases) - Σ(expectedIncomeDecreases)
ELSE:
  revisedIncome = totalNetIncome

Where:
  - expectedIncomeIncreases/Decreases come from income records with futureChange flags
  - All normalized to monthly frequency
```

**5. Revised Expenditure (Base)**
```
IF incorporateExpenditureChanges = "Yes":
  revisedExpenditure = totalExpenditure + Σ(expectedExpenditureIncreases) - Σ(expectedExpenditureDecreases)
ELSE:
  revisedExpenditure = totalExpenditure
```

**6. Apply Forgo Non-Essentials Option**
```
IF forgoNonEssentialExpenditure = "Yes":
  revisedExpenditure = Σ(expenditures WHERE isEssential = true)

This overrides step 5 - only essential expenditures are counted
```

**7. Consolidated Expenditure Adjustment**
```
consolidatedExpenditurePayments = Σ(expenditures WHERE isConsolidated = true)

IF excludeConsolidatedExpenditure = "Yes":
  revisedExpenditure = revisedExpenditure - consolidatedExpenditurePayments
```

**8. Repaid Expenditure Adjustment**
```
expenditurePaymentsTobeRepaid = Σ(expenditures WHERE isLiabilityToBeRepaid = true)

IF excludeRepaidExpenditure = "Yes":
  revisedExpenditure = revisedExpenditure - expenditurePaymentsTobeRepaid
```

**9. Protection Premium Adjustment**
```
IF hasRebrokerProtection = "Yes":
  protectionPremiums = Σ(newProtectionArrangements.monthlyPremium)
  revisedExpenditure = revisedExpenditure + protectionPremiums
ELSE:
  protectionPremiums = 0
```

**10. Final Disposable Income**
```
finalDisposableIncome = revisedIncome - revisedExpenditure
```

##### Lumpsum Affordability Calculations

**11. Total Funds Available**
```
totalFundsAvailable = totalLumpSumAvailable + Σ(additionalAvailableFunds)

Where:
  - additionalAvailableFunds might include accessible savings, maturing investments, etc.
  - For basic scenarios: totalFundsAvailable = totalLumpSumAvailable
```

##### Emergency Fund Calculations

**12. Shortfall**
```
shortfall = MAX(0, requiredAmount - committedAmount)

If committedAmount >= requiredAmount, shortfall = 0
```

**Recommended Required Amount:**
```
requiredAmount = essentialMonthlyExpenditure × months

Where months typically:
  - Conservative approach: 6 months
  - Moderate approach: 4 months
  - Minimum recommendation: 3 months
```

---

#### 6.4.6 Validation Rules

**Required Fields (on create):**
- `factfind` reference is required
- `clients` array must contain at least 1 client
- `incomes` array must contain at least 1 income
- `expenditures` array can be empty (representing client with no recorded expenditure)

**Reference Validation:**
- All client IDs must exist in the fact-find
- All income IDs must exist and belong to one of the specified clients
- All expenditure IDs must exist and belong to one of the specified clients
- Cross-fact-find references are not permitted

**Money Value Validation:**
- All MoneyValue amounts must be >= 0 (non-negative)
- All MoneyValue currency codes must be valid ISO 4217 codes
- All money values within a single assessment should use consistent currency
- Mixing currencies within one assessment is not recommended (may cause calculation errors)

**Option Field Validation:**
- All Yes/No fields must be exactly "Yes" or "No" (case-sensitive)
- Invalid values like "yes", "YES", "true", "1" will be rejected

**Budget Validation:**
- `agreedMonthlyBudget` cannot exceed `finalDisposableIncome`
- `agreedInvestmentAmount` cannot exceed `totalLumpSumAvailable`
- Both can be equal to their respective maximums

**Emergency Fund Validation:**
- `committedAmount` must be >= 0
- `requiredAmount` must be >= 0
- `committedAmount` can exceed `requiredAmount` (shortfall will be 0)

**Text Field Length Limits:**
- `monthlyModelling.notes`: 1000 characters
- `lumpsumAffordability.notes`: 1000 characters
- `lumpsumAffordability.sourceOfInvestment`: 100 characters

---

#### 6.4.7 Business Rules

**Emergency Fund Guidelines:**
- Standard recommendation: 3-6 months of essential expenditure
- Essential expenditure = Σ(expenditures WHERE isEssential = true)
- Higher-risk situations (self-employed, single income): 6 months
- Lower-risk situations (dual income, stable employment): 3-4 months
- Emergency fund should be held in accessible, low-risk accounts

**Mortgage Affordability Standards:**
- Lenders typically stress-test at higher interest rates (+2-3% above current rate)
- Affordable mortgage payment typically <= 40-45% of gross income
- finalDisposableIncome should comfortably cover proposed mortgage payment
- Conservative approach: mortgage payment <= 35% of net income
- Must account for future life changes (children, retirement, etc.)

**Investment Capacity Assessment:**
- Never invest emergency fund reserves
- Regular contributions should not compromise essential expenditure
- Lumpsum investments should maintain adequate liquidity buffer
- Consider penalty-free access requirements (especially for shorter time horizons)

**Debt Consolidation Scenarios:**
- Model excludes consolidated debt payments to show improved cashflow
- Consolidation only beneficial if lower total interest cost
- Must ensure client can afford consolidated payment sustainably
- Warning: extending term may increase total interest paid despite lower monthly payment

**Protection Planning:**
- New protection premiums should be affordable from sustainable income
- Rebrokering may increase/decrease premiums
- hasRebrokerProtection option models the cost impact
- Protection premiums should not exceed 5-10% of net income typically

**Non-Essential Expenditure:**
- forgoNonEssentialExpenditure models worst-case scenario
- Used for conservative mortgage affordability assessments
- Helps identify sustainable cutbacks if income reduced
- Not a long-term recommendation (quality of life considerations)

**Currency Consistency:**
- All money values should use the same currency within one assessment
- Mixed currencies require manual conversion before assessment
- Exchange rates should be documented if conversions performed

**Regulatory Compliance:**
- FCA MCOB rules require comprehensive affordability assessment for mortgages
- Must consider foreseeable future changes (retirement, children, etc.)
- Consumer Duty requires understanding of customer vulnerability
- Documentation should support suitability of recommendations

---

#### 6.4.8 Comprehensive Examples

##### Example 1: Mortgage Application Scenario

**Context:**
- Joint clients applying for £350,000 mortgage
- Combined income: £75,000/year (£6,250/month after tax)
- Existing mortgage: £1,200/month (will be replaced)
- Want to consolidate two credit card debts: £300/month total
- Proposed new mortgage payment: £1,850/month

**POST /api/v2/factfinds/456/affordability**

```json
{
  "clients": [
    { "id": 101 },
    { "id": 102 }
  ],

  "incomes": [
    { "id": 501 },
    { "id": 502 }
  ],

  "expenditures": [
    { "id": 801 },
    { "id": 802 },
    { "id": 803 },
    { "id": 804 },
    { "id": 805 }
  ],

  "monthlyModelling": {
    "options": {
      "incorporateIncomeChanges": "No",
      "incorporateExpenditureChanges": "Yes",
      "forgoNonEssentialExpenditure": "No",
      "excludeConsolidatedExpenditure": "Yes",
      "excludeRepaidExpenditure": "Yes",
      "hasRebrokerProtection": "No"
    },
    "agreedMonthlyBudget": {
      "amount": 1850.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "notes": "Conservative assessment - not including expected bonus income. Excluding current mortgage (will be repaid) and credit cards (will be consolidated)."
  },

  "emergencyFund": {
    "committedAmount": {
      "amount": 10000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "requiredAmount": {
      "amount": 12000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  }
}
```

**Response: 201 Created**

```json
{
  "href": "/api/v2/factfinds/456/affordability",

  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456"
  },

  "clients": [
    { "id": 101, "href": "/api/v2/factfinds/456/clients/101" },
    { "id": 102, "href": "/api/v2/factfinds/456/clients/102" }
  ],

  "incomes": [
    { "id": 501, "href": "/api/v2/factfinds/456/clients/101/incomes/501" },
    { "id": 502, "href": "/api/v2/factfinds/456/clients/102/incomes/502" }
  ],

  "expenditures": [
    { "id": 801, "href": "/api/v2/factfinds/456/clients/101/expenditures/801" },
    { "id": 802, "href": "/api/v2/factfinds/456/clients/101/expenditures/802" },
    { "id": 803, "href": "/api/v2/factfinds/456/clients/101/expenditures/803" },
    { "id": 804, "href": "/api/v2/factfinds/456/clients/102/expenditures/804" },
    { "id": 805, "href": "/api/v2/factfinds/456/clients/102/expenditures/805" }
  ],

  "monthlyCashFlow": {
    "totalNetIncome": {
      "amount": 6250.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "totalExpenditure": {
      "amount": 4350.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "disposableIncome": {
      "amount": 1900.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "monthlyModelling": {
    "options": {
      "incorporateIncomeChanges": "No",
      "incorporateExpenditureChanges": "Yes",
      "forgoNonEssentialExpenditure": "No",
      "excludeConsolidatedExpenditure": "Yes",
      "excludeRepaidExpenditure": "Yes",
      "hasRebrokerProtection": "No"
    },
    "agreedMonthlyBudget": {
      "amount": 1850.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "notes": "Conservative assessment - not including expected bonus income. Excluding current mortgage (will be repaid) and credit cards (will be consolidated)."
  },

  "monthlyAffordability": {
    "revisedIncome": {
      "amount": 6250.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "revisedExpenditure": {
      "amount": 2850.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "consolidatedExpenditurePayments": {
      "amount": 300.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "expenditurePaymentsTobeRepaid": {
      "amount": 1200.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "protectionPremiums": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "finalDisposableIncome": {
      "amount": 3400.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "lumpsumAffordability": null,

  "emergencyFund": {
    "committedAmount": {
      "amount": 10000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "requiredAmount": {
      "amount": 12000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "shortfall": {
      "amount": 2000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "createdAt": "2026-02-20T10:30:00Z",
  "lastUpdatedAt": "2026-02-20T10:30:00Z"
}
```

**Interpretation:**
- **Before remortgage:** Disposable income = £1,900/month
- **After remortgage:** Final disposable income = £3,400/month
- **Impact:** Remortgage increases disposable income by £1,500/month
- **Proposed payment:** £1,850/month fits comfortably within £3,400 available
- **Affordability verdict:** AFFORDABLE ✓
- **Recommendation:** Proceed with application, build emergency fund from improved cashflow

---

##### Example 2: Investment Advice Scenario

**Context:**
- Single client, age 45
- Just sold buy-to-let property: £80,000 proceeds
- Wants to invest for retirement (20 years)
- Regular income sustainable for monthly contributions
- Already has adequate emergency fund

**POST /api/v2/factfinds/789/affordability**

```json
{
  "clients": [
    { "id": 201 }
  ],

  "incomes": [
    { "id": 601 }
  ],

  "expenditures": [
    { "id": 901 },
    { "id": 902 },
    { "id": 903 }
  ],

  "monthlyModelling": {
    "options": {
      "incorporateIncomeChanges": "No",
      "incorporateExpenditureChanges": "No",
      "forgoNonEssentialExpenditure": "No",
      "excludeConsolidatedExpenditure": "No",
      "excludeRepaidExpenditure": "No",
      "hasRebrokerProtection": "No"
    },
    "agreedMonthlyBudget": {
      "amount": 800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "notes": "Client wants to invest £800/month regularly for retirement"
  },

  "lumpsumAffordability": {
    "totalLumpSumAvailable": {
      "amount": 80000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "agreedInvestmentAmount": {
      "amount": 70000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "sourceOfInvestment": "PropertySale",
    "isInvestmentAvailableWithoutPenalty": "Yes",
    "notes": "BTL property sale completed January 2026. Retaining £10,000 for potential home improvements."
  },

  "emergencyFund": {
    "committedAmount": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "requiredAmount": {
      "amount": 12000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  }
}
```

**Response: 201 Created**

```json
{
  "href": "/api/v2/factfinds/789/affordability",

  "factfind": {
    "id": 789,
    "href": "/api/v2/factfinds/789"
  },

  "clients": [
    { "id": 201, "href": "/api/v2/factfinds/789/clients/201" }
  ],

  "incomes": [
    { "id": 601, "href": "/api/v2/factfinds/789/clients/201/incomes/601" }
  ],

  "expenditures": [
    { "id": 901, "href": "/api/v2/factfinds/789/clients/201/expenditures/901" },
    { "id": 902, "href": "/api/v2/factfinds/789/clients/201/expenditures/902" },
    { "id": 903, "href": "/api/v2/factfinds/789/clients/201/expenditures/903" }
  ],

  "monthlyCashFlow": {
    "totalNetIncome": {
      "amount": 3800.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "totalExpenditure": {
      "amount": 2600.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "disposableIncome": {
      "amount": 1200.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "monthlyModelling": {
    "options": {
      "incorporateIncomeChanges": "No",
      "incorporateExpenditureChanges": "No",
      "forgoNonEssentialExpenditure": "No",
      "excludeConsolidatedExpenditure": "No",
      "excludeRepaidExpenditure": "No",
      "hasRebrokerProtection": "No"
    },
    "agreedMonthlyBudget": {
      "amount": 800.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "notes": "Client wants to invest £800/month regularly for retirement"
  },

  "monthlyAffordability": {
    "revisedIncome": {
      "amount": 3800.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "revisedExpenditure": {
      "amount": 2600.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "consolidatedExpenditurePayments": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "expenditurePaymentsTobeRepaid": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "protectionPremiums": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "finalDisposableIncome": {
      "amount": 1200.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "lumpsumAffordability": {
    "totalLumpSumAvailable": {
      "amount": 80000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "agreedInvestmentAmount": {
      "amount": 70000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "sourceOfInvestment": "PropertySale",
    "isInvestmentAvailableWithoutPenalty": "Yes",
    "notes": "BTL property sale completed January 2026. Retaining £10,000 for potential home improvements.",
    "totalFundsAvailable": {
      "amount": 80000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "emergencyFund": {
    "committedAmount": {
      "amount": 15000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "requiredAmount": {
      "amount": 12000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "shortfall": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "createdAt": "2026-02-20T11:15:00Z",
  "lastUpdatedAt": "2026-02-20T11:15:00Z"
}
```

**Interpretation:**
- **Monthly capacity:** £1,200 disposable income available
- **Proposed monthly investment:** £800 (67% of disposable income)
- **Buffer remaining:** £400/month for unexpected costs
- **Lumpsum capacity:** £70,000 from property sale (retaining £10,000)
- **Emergency fund:** Fully funded (no shortfall) ✓
- **Affordability verdict:** AFFORDABLE ✓
- **Recommendation:**
  * Lumpsum investment: £70,000 into diversified pension/ISA
  * Regular contribution: £800/month
  * Review after 12 months (lifestyle may improve without rental property costs)

---

##### Example 3: Retirement Planning Scenario

**Context:**
- Retired couple (ages 68 and 66)
- Fixed pension income
- Mortgage paid off
- Want to assess sustainability of current expenditure
- Considering one-off luxury cruise: £12,000

**POST /api/v2/factfinds/555/affordability**

```json
{
  "clients": [
    { "id": 301 },
    { "id": 302 }
  ],

  "incomes": [
    { "id": 701 },
    { "id": 702 },
    { "id": 703 }
  ],

  "expenditures": [
    { "id": 1001 },
    { "id": 1002 },
    { "id": 1003 },
    { "id": 1004 }
  ],

  "monthlyModelling": {
    "options": {
      "incorporateIncomeChanges": "Yes",
      "incorporateExpenditureChanges": "Yes",
      "forgoNonEssentialExpenditure": "No",
      "excludeConsolidatedExpenditure": "No",
      "excludeRepaidExpenditure": "No",
      "hasRebrokerProtection": "No"
    },
    "agreedMonthlyBudget": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "notes": "Retirement sustainability check. State pension increases incorporated."
  },

  "lumpsumAffordability": {
    "totalLumpSumAvailable": {
      "amount": 45000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "agreedInvestmentAmount": {
      "amount": 12000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "sourceOfInvestment": "Savings",
    "isInvestmentAvailableWithoutPenalty": "Yes",
    "notes": "Accessible savings for planned cruise in 2026. Want to ensure affordability without compromising financial security."
  },

  "emergencyFund": {
    "committedAmount": {
      "amount": 20000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "requiredAmount": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  }
}
```

**Response: 201 Created**

```json
{
  "href": "/api/v2/factfinds/555/affordability",

  "factfind": {
    "id": 555,
    "href": "/api/v2/factfinds/555"
  },

  "clients": [
    { "id": 301, "href": "/api/v2/factfinds/555/clients/301" },
    { "id": 302, "href": "/api/v2/factfinds/555/clients/302" }
  ],

  "incomes": [
    { "id": 701, "href": "/api/v2/factfinds/555/clients/301/incomes/701" },
    { "id": 702, "href": "/api/v2/factfinds/555/clients/301/incomes/702" },
    { "id": 703, "href": "/api/v2/factfinds/555/clients/302/incomes/703" }
  ],

  "expenditures": [
    { "id": 1001, "href": "/api/v2/factfinds/555/clients/301/expenditures/1001" },
    { "id": 1002, "href": "/api/v2/factfinds/555/clients/301/expenditures/1002" },
    { "id": 1003, "href": "/api/v2/factfinds/555/clients/302/expenditures/1003" },
    { "id": 1004, "href": "/api/v2/factfinds/555/clients/302/expenditures/1004" }
  ],

  "monthlyCashFlow": {
    "totalNetIncome": {
      "amount": 3200.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "totalExpenditure": {
      "amount": 2400.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "disposableIncome": {
      "amount": 800.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "monthlyModelling": {
    "options": {
      "incorporateIncomeChanges": "Yes",
      "incorporateExpenditureChanges": "Yes",
      "forgoNonEssentialExpenditure": "No",
      "excludeConsolidatedExpenditure": "No",
      "excludeRepaidExpenditure": "No",
      "hasRebrokerProtection": "No"
    },
    "agreedMonthlyBudget": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "notes": "Retirement sustainability check. State pension increases incorporated."
  },

  "monthlyAffordability": {
    "revisedIncome": {
      "amount": 3350.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "revisedExpenditure": {
      "amount": 2500.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "consolidatedExpenditurePayments": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "expenditurePaymentsTobeRepaid": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "protectionPremiums": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "finalDisposableIncome": {
      "amount": 850.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "lumpsumAffordability": {
    "totalLumpSumAvailable": {
      "amount": 45000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "agreedInvestmentAmount": {
      "amount": 12000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "sourceOfInvestment": "Savings",
    "isInvestmentAvailableWithoutPenalty": "Yes",
    "notes": "Accessible savings for planned cruise in 2026. Want to ensure affordability without compromising financial security.",
    "totalFundsAvailable": {
      "amount": 45000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "emergencyFund": {
    "committedAmount": {
      "amount": 20000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "requiredAmount": {
      "amount": 15000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "shortfall": {
      "amount": 0.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    }
  },

  "createdAt": "2026-02-20T14:20:00Z",
  "lastUpdatedAt": "2026-02-20T14:20:00Z"
}
```

**Interpretation:**
- **Current position:** £800/month surplus (sustainable) ✓
- **Future position:** £850/month surplus (with state pension increases) ✓
- **Cruise affordability:** £12,000 from £45,000 savings (27%)
- **Remaining savings after cruise:** £33,000 (well above £20,000 emergency fund)
- **Emergency fund:** Fully funded with £5,000 buffer ✓
- **Affordability verdict:** CRUISE IS AFFORDABLE ✓
- **Recommendation:**
  * Retirement income sustainable with comfortable margin
  * Cruise affordable without compromising financial security
  * Maintain £20,000 emergency fund
  * Annual surplus of ~£10,000 available for discretionary spending
  * Consider inflation impact on fixed incomes - review annually

---

## 7. Employment API (Circumstances Context)

### 7.1 Overview

**Base Path:** `/api/v2/factfinds/{factfindId}/clients/{clientId}/employments`

**Purpose:** Track comprehensive employment history, employment status, self-employed income, and employment-related information for affordability assessments and mortgage applications.

**Scope:**
- Current and historical employment records
- Employment status tracking (employed, self-employed, director, retired, etc.)
- Self-employed income with 3 years of accounts
- Employer details and business information
- Probation period tracking
- Industry and occupation classification
- Intended retirement age
- Tax rate capture for affordability
- Continuous employment duration
- Connection to income sources

**Aggregate Root:** Client (employment is nested under each client)

**Key Characteristics:**
- **Comprehensive employment tracking** - Full employment history with start/end dates
- **Self-employed income support** - Track 3 years of accounts for mortgage applications
- **Business type classification** - Sole trader, limited company, partnership, LLP
- **Affordability integration** - Employment data feeds into affordability calculations
- **Income linking** - HATEOAS links to related income records
- **Mortgage application ready** - Captures all data needed for UK mortgage lending

**Regulatory Compliance:**
- FCA COBS (Know Your Customer - Employment Status)
- Mortgage Credit Directive (Employment verification for affordability)
- MCOB (Mortgage Conduct of Business) - Income verification requirements
- Consumer Duty (Understanding client circumstances)
- FCA Handbook - Responsible lending employment checks

### 7.2 Operations Summary

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/employments` | List employment history | `employment:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/employments` | Create employment record | `employment:write` |
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/employments/{employmentId}` | Get employment details | `employment:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/employments/{employmentId}` | Update employment | `employment:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/employments/{employmentId}` | Delete employment | `employment:write` |

**Total Endpoints:** 5

### 7.3 Key Endpoints

#### 7.3.1 List Employment Records

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/employments`

**Description:** Retrieve all employment records for a client, including current and historical employment with self-employed income details.

**Query Parameters:**
- `employmentStatus` - Filter by status (Employed, SelfEmployed, CompanyDirector, Retired, etc.)
- `isCurrentEmployment` - Filter by current employment (true/false)
- `includeEnded` - Include employment with end dates (default: true)

**Response:**
```json
{
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/679/clients/456",
    "name": "John Smith"
  },
  "employments": [
    {
      "id": 12345,
      "href": "/api/v2/factfinds/679/clients/456/employments/12345",
      "employmentStatus": "SelfEmployed",
      "employmentBusinessType": "PrivateLimitedCompany",
      "occupation": "Software Consultant / Company Director",
      "employer": "Smith Tech Solutions Ltd",
      "startsOn": "2018-04-01",
      "endsOn": null,
      "isCurrentEmployment": true,
      "continuousEmploymentMonths": 70,
      "intendedRetirementAge": 65,
      "industryType": "Information Technology"
    },
    {
      "id": 12344,
      "href": "/api/v2/factfinds/679/clients/456/employments/12344",
      "employmentStatus": "Employed",
      "employmentBusinessType": null,
      "occupation": "Senior Developer",
      "employer": "Previous Tech Corp",
      "startsOn": "2015-01-15",
      "endsOn": "2018-03-31",
      "isCurrentEmployment": false,
      "continuousEmploymentMonths": 38,
      "intendedRetirementAge": null,
      "industryType": "Information Technology"
    }
  ],
  "totalCount": 2,
    "create": {
      "href": "/api/v2/factfinds/679/clients/456/employments",
      "method": "POST"
    }
  }
}
```

#### 7.3.2 Get Employment Details (Self-Employed Example)

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/employments/{employmentId}`

**Description:** Get detailed employment information including self-employed income with 3 years of accounts.

**Response:**
```json
{
  "id": 12345,
  "href": "/api/v2/factfinds/679/clients/456/employments/12345",

  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/679/clients/456"
  },

  "employmentStatus": "SelfEmployed",
  "employmentBusinessType": "PrivateLimitedCompany",
  "employmentStatusDescription": "Managing Director of software consultancy company",
  "occupation": "Software Consultant / Company Director",
  "employer": "Smith Tech Solutions Ltd",
  "intendedRetirementAge": 65,
  "startsOn": "2018-04-01",
  "endsOn": null,
  "inProbation": false,
  "probationPeriodInMonths": null,
  "industryType": "Information Technology",
  "continuousEmploymentMonths": 70,
  "isCurrentEmployment": true,
  "highestTaxRate": "40",

  "address": {
    "line1": "Tech Hub Building",
    "line2": "45 Innovation Drive",
    "line3": null,
    "line4": null,
    "locality": "London",
    "postalCode": "EC2A 4BX",
    "county": {
      "code": "GB-LND",
      "name": "Greater London"
    },
    "country": {
      "isoCode": "GB",
      "name": "United Kingdom"
    }
  },

  "selfEmployedIncome": {
    "mostRecentAnnualAccounts": {
      "grossProfit": {
        "amount": 180000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netProfit": {
        "amount": 150000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "shareOfCompanyProfit": {
        "amount": 180000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "grossDividend": {
        "amount": 60000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netDividend": {
        "amount": 54000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "grossSalary": {
        "amount": 25000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netSalary": {
        "amount": 20000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "yearEnd": "2024-03-31",
      "includeInAffordability": true
    },
    "yearTwoAnnualAccounts": {
      "grossProfit": {
        "amount": 165000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netProfit": {
        "amount": 135000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "shareOfCompanyProfit": {
        "amount": 165000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "grossDividend": {
        "amount": 55000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netDividend": {
        "amount": 49500.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "grossSalary": {
        "amount": 24000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netSalary": {
        "amount": 19200.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "yearEnd": "2023-03-31",
      "includeInAffordability": false
    },
    "yearThreeAnnualAccounts": {
      "grossProfit": {
        "amount": 150000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netProfit": {
        "amount": 120000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "shareOfCompanyProfit": {
        "amount": 150000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "grossDividend": {
        "amount": 50000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netDividend": {
        "amount": 45000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "grossSalary": {
        "amount": 22000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netSalary": {
        "amount": 17600.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "yearEnd": "2022-03-31",
      "includeInAffordability": false
    },
    "recentGrossPreTaxProfit": {
      "amount": 180000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "incomesHref": "/api/v2/factfinds/679/clients/456/incomes?filter=employment.id eq 12345",

  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

#### 7.3.3 Get Employment Details (Employed Example)

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/employments/{employmentId}`

**Description:** Get employment details for standard employed status (no self-employed income).

**Response:**
```json
{
  "id": 12346,
  "href": "/api/v2/factfinds/679/clients/457/employments/12346",

  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 457,
    "href": "/api/v2/factfinds/679/clients/457"
  },

  "employmentStatus": "Employed",
  "employmentBusinessType": null,
  "employmentStatusDescription": "Full-time permanent employee",
  "occupation": "Senior Software Engineer",
  "employer": "Acme Corporation Ltd",
  "intendedRetirementAge": 67,
  "startsOn": "2015-03-01",
  "endsOn": null,
  "inProbation": false,
  "probationPeriodInMonths": null,
  "industryType": "Information Technology",
  "continuousEmploymentMonths": 132,
  "isCurrentEmployment": true,
  "highestTaxRate": "40",

  "address": {
    "line1": "Tech Park Building 5",
    "line2": "Silicon Way",
    "line3": null,
    "line4": null,
    "locality": "London",
    "postalCode": "EC1A 1BB",
    "county": {
      "code": "GB-LND",
      "name": "Greater London"
    },
    "country": {
      "isoCode": "GB",
      "name": "United Kingdom"
    }
  },

  "selfEmployedIncome": null,

  "incomesHref": "/api/v2/factfinds/679/clients/457/incomes?filter=employment.id eq 12346",

  "createdAt": "2026-01-10T09:00:00Z",
  "updatedAt": "2026-02-10T11:15:00Z"
}
```

#### 7.3.4 Create Employment Record (Self-Employed)

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/employments`

**Description:** Create a new self-employed employment record with 3 years of accounts.

**Request Body:**
```json
{
  "employmentStatus": "SelfEmployed",
  "employmentBusinessType": "PrivateLimitedCompany",
  "employmentStatusDescription": "Managing Director of software consultancy company",
  "occupation": "Software Consultant / Company Director",
  "employer": "Smith Tech Solutions Ltd",
  "intendedRetirementAge": 65,
  "startsOn": "2018-04-01",
  "endsOn": null,
  "industryType": "Information Technology",
  "highestTaxRate": "40",
  "address": {
    "line1": "Tech Hub Building",
    "line2": "45 Innovation Drive",
    "locality": "London",
    "postalCode": "EC2A 4BX",
    "country": {
      "isoCode": "GB"
    }
  },
  "selfEmployedIncome": {
    "mostRecentAnnualAccounts": {
      "grossProfit": { "amount": 180000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "netProfit": { "amount": 150000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "shareOfCompanyProfit": { "amount": 180000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "grossDividend": { "amount": 60000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "netDividend": { "amount": 54000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "grossSalary": { "amount": 25000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "netSalary": { "amount": 20000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "yearEnd": "2024-03-31",
      "includeInAffordability": true
    },
    "yearTwoAnnualAccounts": {
      "grossProfit": { "amount": 165000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "netProfit": { "amount": 135000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "yearEnd": "2023-03-31",
      "includeInAffordability": false
    }
  }
}
```

**Response:** 201 Created with complete employment entity (see 7.3.2 for response structure)

#### 7.3.5 Create Employment Record (Employed)

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/employments`

**Description:** Create a standard employed employment record.

**Request Body:**
```json
{
  "employmentStatus": "Employed",
  "employmentStatusDescription": "Full-time permanent employee",
  "occupation": "Senior Software Engineer",
  "employer": "Acme Corporation Ltd",
  "intendedRetirementAge": 67,
  "startsOn": "2015-03-01",
  "inProbation": false,
  "industryType": "Information Technology",
  "highestTaxRate": "40",
  "address": {
    "line1": "Tech Park Building 5",
    "line2": "Silicon Way",
    "locality": "London",
    "postalCode": "EC1A 1BB",
    "country": {
      "isoCode": "GB"
    }
  }
}
```

**Response:** 201 Created with complete employment entity

#### 7.3.6 Update Employment Record

**Endpoint:** `PATCH /api/v2/factfinds/{factfindId}/clients/{clientId}/employments/{employmentId}`

**Description:** Update employment details, add new year's accounts for self-employed, or mark employment as ended.

**Request Body (End Employment):**
```json
{
  "endsOn": "2026-06-30"
}
```

**Request Body (Add New Year's Accounts):**
```json
{
  "selfEmployedIncome": {
    "mostRecentAnnualAccounts": {
      "grossProfit": { "amount": 195000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "netProfit": { "amount": 165000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "yearEnd": "2025-03-31",
      "includeInAffordability": true
    },
    "yearTwoAnnualAccounts": {
      "grossProfit": { "amount": 180000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "netProfit": { "amount": 150000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "yearEnd": "2024-03-31",
      "includeInAffordability": false
    },
    "yearThreeAnnualAccounts": {
      "grossProfit": { "amount": 165000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "netProfit": { "amount": 135000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "yearEnd": "2023-03-31",
      "includeInAffordability": false
    }
  }
}
```

**Response:** 200 OK with updated employment entity

#### 7.3.7 Delete Employment Record

**Endpoint:** `DELETE /api/v2/factfinds/{factfindId}/clients/{clientId}/employments/{employmentId}`

**Description:** Delete an employment record (soft delete for audit trail).

**Response:** 204 No Content

**Business Rules:**
- Soft delete (retained for compliance)
- Cannot delete if referenced in active income records
- Cannot delete if used in affordability calculations
- Deletion logged for audit trail

---

### 7.4 Employment Status Types

**Complete Enum List:**

| Code | Display | Description | Common Use Cases |
|------|---------|-------------|-----------------|
| `Employed` | Employed | Standard PAYE employment | Full-time and part-time employees |
| `SelfEmployed` | Self-Employed | Self-employed/sole trader | Freelancers, contractors, sole traders |
| `CompanyDirector` | Company Director | Director of limited company | Business owners, company directors |
| `Retired` | Retired | Retired from employment | Pensioners, early retirees |
| `Unemployed` | Unemployed | Currently unemployed | Job seekers, between employment |
| `Houseperson` | Houseperson | Home maker | Stay-at-home parents, carers |
| `Student` | Student | Full-time student | University students, apprentices |
| `MaternityLeave` | Maternity Leave | On maternity/paternity leave | Temporary leave from employment |
| `LongTermIllness` | Long Term Illness | Unable to work due to illness | Long-term sick leave |
| `ContractWorker` | Contract Worker | Fixed-term contract | Agency workers, fixed-term contracts |
| `CarerOfaChildUnder16` | Carer of Child Under 16 | Full-time carer | Child carer |
| `CarerOfaPersonOver16` | Carer of Person Over 16 | Full-time carer | Adult carer |
| `Other` | Other | Other employment status | Non-standard situations |
| `Unknown` | Unknown | Status not yet determined | Initial fact-find state |

### 7.5 Employment Business Type (Self-Employed)

**Enum Values (only applicable when employmentStatus = "SelfEmployed"):**

| Code | Display | Description | Tax Structure |
|------|---------|-------------|---------------|
| `SoleTrader` | Sole Trader | Individual trading under own name or trading name | Self-assessment, personal tax |
| `PrivateLimitedCompany` | Private Limited Company | Limited company (Ltd) with shareholders | Corporation tax, dividends, salary |
| `Partnership` | Partnership | Business partnership (not LLP) | Self-assessment, shared profits |
| `LimitedLiabilityPartnership` | Limited Liability Partnership | LLP structure | Self-assessment, LLP tax rules |

**Notes:**
- employmentBusinessType is NULL for all non-self-employed statuses
- Required when employmentStatus = "SelfEmployed"
- Determines income assessment method for mortgage applications
- Affects affordability calculations and evidence requirements

### 7.6 Field Definitions

**Identification Fields:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned employment identifier |
| `href` | string | read-only | Canonical URI for this employment record |
| `factfind.id` | integer | read-only | Reference to parent fact find |
| `factfind.href` | string | read-only | URI to parent fact find |
| `client.id` | integer | read-only | Reference to client |
| `client.href` | string | read-only | URI to client |

**Employment Details:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `employmentStatus` | enum | required-on-create | Employment status (see Section 7.4) |
| `employmentBusinessType` | enum | conditional | Business type for self-employed (see Section 7.5), null for employed |
| `employmentStatusDescription` | string | optional | Additional status details (max 1000 chars) |
| `occupation` | string | optional | Job title or occupation (max 512 chars) |
| `employer` | string | optional | Employer or business name (max 512 chars) |
| `industryType` | string | optional | Industry or sector (max 100 chars) |
| `highestTaxRate` | string | optional | Highest marginal tax rate (e.g., "20", "40", "45") |

**Employment Period:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `startsOn` | date | required-on-create | Employment start date (YYYY-MM-DD) |
| `endsOn` | date | optional | Employment end date (YYYY-MM-DD), null if current |
| `isCurrentEmployment` | boolean | read-only | Computed: true if endsOn is null |
| `continuousEmploymentMonths` | integer | read-only | Calculated months from startsOn to endsOn or today |
| `inProbation` | boolean | optional | Currently in probation period |
| `probationPeriodInMonths` | integer | optional | Length of probation period (1-99 months) |
| `intendedRetirementAge` | integer | optional | Planned retirement age (0-99 years) |

**Employment Location:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `address.line1` | string | optional | Address line 1 (max 100 chars) |
| `address.line2` | string | optional | Address line 2 (max 100 chars) |
| `address.line3` | string | optional | Address line 3 (max 100 chars) |
| `address.line4` | string | optional | Address line 4 (max 100 chars) |
| `address.locality` | string | optional | City/town (max 100 chars) |
| `address.postalCode` | string | optional | Postal/ZIP code (max 20 chars) |
| `address.county.code` | string | optional | County code (ISO-3166-2, max 6 chars) |
| `address.county.name` | string | read-only | County name (derived from code) |
| `address.country.isoCode` | string | required | Country ISO code (ISO-3166-1 alpha-2) |
| `address.country.name` | string | read-only | Country name (derived from ISO code) |

**Self-Employed Income (3 Years of Accounts):**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `selfEmployedIncome` | object | conditional | Self-employed accounts (null if not self-employed) |
| `selfEmployedIncome.mostRecentAnnualAccounts` | object | required-if-se | Most recent year accounts |
| `selfEmployedIncome.yearTwoAnnualAccounts` | object | optional | Previous year accounts |
| `selfEmployedIncome.yearThreeAnnualAccounts` | object | optional | Third year accounts |
| `selfEmployedIncome.recentGrossPreTaxProfit` | MoneyValue | read-only | Most recent gross profit (computed) |

**Annual Accounts Fields (for each year):**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `grossProfit` | MoneyValue | optional | Gross profit for the year |
| `netProfit` | MoneyValue | optional | Net profit after expenses |
| `shareOfCompanyProfit` | MoneyValue | optional | Individual's share of company profit |
| `grossDividend` | MoneyValue | optional | Gross dividend received |
| `netDividend` | MoneyValue | optional | Net dividend after tax |
| `grossSalary` | MoneyValue | optional | Gross salary/director's salary |
| `netSalary` | MoneyValue | optional | Net salary after tax and NI |
| `yearEnd` | date | required | Year end date (YYYY-MM-DD) |
| `includeInAffordability` | boolean | required | Include this year in affordability calculations |

**Related Resources:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `incomesHref` | string | read-only | HATEOAS link to related income records filtered by this employment |

**Audit Trail:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

### 7.7 Validation Rules

**Required Fields:**
- `employmentStatus` - Must be one of the valid enum values
- `startsOn` - Must be a valid date, cannot be in future
- `address.country.isoCode` - Must be valid ISO 3166-1 alpha-2 code

**Conditional Requirements:**
- If `employmentStatus` = "SelfEmployed":
  - `employmentBusinessType` is required
  - `selfEmployedIncome` must be provided
  - `selfEmployedIncome.mostRecentAnnualAccounts` must be complete
- If `inProbation` = true:
  - `probationPeriodInMonths` should be provided

**Date Validations:**
- `endsOn` must be after `startsOn` if provided
- `yearEnd` dates must be in chronological order (most recent first)
- All dates cannot be in the future

**Self-Employed Income Validations:**
- Must have at least `mostRecentAnnualAccounts`
- `yearEnd` must be in the past
- At least one financial field must be populated per year
- `includeInAffordability` = true only for most recent year (typically)

**Business Logic:**
- `continuousEmploymentMonths` automatically calculated from dates
- `isCurrentEmployment` automatically computed (endsOn == null)
- `recentGrossPreTaxProfit` derived from mostRecentAnnualAccounts.grossProfit

### 7.8 Business Rules

**Self-Employed Income Assessment:**

**Mortgage Lenders Typically:**
- Require 2-3 years of accounts for self-employed applicants
- Use average of 2 years net profit for affordability
- May stress-test using lower of 2 years
- Some lenders accept 1 year for established businesses (3+ years trading)
- Directors of limited companies: salary + dividends + retained profits

**Income Averaging Formula:**
```
Average Annual Income = (Year 1 Net Profit + Year 2 Net Profit) / 2

For Limited Companies:
Total Income = Net Salary + Net Dividends + Share of Retained Profits
```

**Accountant Certification Requirements:**
- Certified accounts required for self-employed mortgage applications
- SA302 forms (HMRC Self-Assessment) required as evidence
- Tax year overview from HMRC
- Some lenders accept management accounts for most recent year

**Probation Period Impact on Lending:**
- Most lenders require probation period to be completed
- Some specialist lenders accept "out of probation" letters
- Contract of employment must be permanent
- Probation period typically 3-6 months

**Continuous Employment Calculations:**
- Calculated from `startsOn` to `endsOn` or current date
- Used for mortgage affordability (longer employment = lower risk)
- Gaps in employment may require explanation
- Typical mortgage requirement: 12+ months continuous employment

**Retirement Age Considerations:**
- Most lenders require mortgage term to end before retirement age
- State pension age is currently 66-67 in UK
- Private pension access from age 55 (increasing to 57 in 2028)
- Intended retirement age affects maximum mortgage term

**Tax Rate Capture:**
- Used for net income calculations in affordability
- UK tax rates: 20% (basic), 40% (higher), 45% (additional)
- Scottish tax rates differ slightly
- Affects net disposable income calculations

**Industry Type:**
- Some industries considered higher risk by lenders
- Construction, hospitality may require larger deposits
- Professional occupations (IT, finance) typically preferred
- Used for insurance underwriting and occupation classification

### 7.9 Use Cases

**Use Case 1: Self-Employed Mortgage Application**

**Scenario:** Self-employed client applying for £300,000 mortgage, need to provide 2 years accounts.

**API Flow:**
```
1. Create self-employed employment record:
   POST /api/v2/factfinds/679/clients/456/employments
   {
     "employmentStatus": "SelfEmployed",
     "employmentBusinessType": "PrivateLimitedCompany",
     "employer": "Smith Tech Solutions Ltd",
     "startsOn": "2018-04-01",
     "selfEmployedIncome": {
       "mostRecentAnnualAccounts": {
         "netProfit": { "amount": 150000.00 },
         "yearEnd": "2024-03-31"
       },
       "yearTwoAnnualAccounts": {
         "netProfit": { "amount": 135000.00 },
         "yearEnd": "2023-03-31"
       }
     }
   }

2. Lender calculates affordability:
   Average Net Profit = (£150,000 + £135,000) / 2 = £142,500
   Max Mortgage = £142,500 × 4.5 = £641,250

3. Decision: £300,000 mortgage comfortably affordable
```

**Use Case 2: Standard Employed Worker**

**Scenario:** PAYE employee with stable 10-year employment history.

**API Flow:**
```
1. Create employment record:
   POST /api/v2/factfinds/679/clients/457/employments
   {
     "employmentStatus": "Employed",
     "employer": "Acme Corporation Ltd",
     "occupation": "Senior Software Engineer",
     "startsOn": "2015-03-01",
     "continuousEmploymentMonths": 132
   }

2. Link to income record:
   POST /api/v2/factfinds/679/clients/457/incomes
   {
     "description": "Salary from Acme Corporation",
     "amount": { "amount": 65000.00 },
     "employment": { "id": 12346 }
   }

3. Affordability calculation uses stable employment (10+ years) as positive factor
```

**Use Case 3: Update Employment - New Year's Accounts**

**Scenario:** Add new year's accounts to existing self-employed record.

**API Flow:**
```
1. Fetch current employment:
   GET /api/v2/factfinds/679/clients/456/employments/12345
   Current: 2 years of accounts (2024, 2023)

2. Update with new year's accounts:
   PATCH /api/v2/factfinds/679/clients/456/employments/12345
   {
     "selfEmployedIncome": {
       "mostRecentAnnualAccounts": {
         "grossProfit": { "amount": 195000.00 },
         "netProfit": { "amount": 165000.00 },
         "yearEnd": "2025-03-31",
         "includeInAffordability": true
       },
       "yearTwoAnnualAccounts": {
         "grossProfit": { "amount": 180000.00 },
         "netProfit": { "amount": 150000.00 },
         "yearEnd": "2024-03-31",
         "includeInAffordability": false
       },
       "yearThreeAnnualAccounts": {
         "grossProfit": { "amount": 165000.00 },
         "netProfit": { "amount": 135000.00 },
         "yearEnd": "2023-03-31",
         "includeInAffordability": false
       }
     }
   }

3. New average for mortgage: (£165,000 + £150,000) / 2 = £157,500
4. Improved affordability due to income growth trend
```

**Use Case 4: Employment in Probation Period**

**Scenario:** Client just started new job, still in probation.

**API Flow:**
```
1. Create employment with probation flag:
   POST /api/v2/factfinds/679/clients/458/employments
   {
     "employmentStatus": "Employed",
     "employer": "New Employer Ltd",
     "startsOn": "2026-01-15",
     "inProbation": true,
     "probationPeriodInMonths": 6
   }

2. Mortgage application impact:
   - Most lenders will decline until probation completed
   - Expected completion: July 2026
   - Recommend waiting until probation cleared
   - Some specialist lenders may consider with premium rates

3. Follow-up after probation:
   PATCH /api/v2/factfinds/679/clients/458/employments/12347
   {
     "inProbation": false
   }
```

---

## 8. Credit History API

### 8.1 Overview

**Base Path:** `/api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history`

**Purpose:** Track and manage comprehensive client credit history including adverse credit events, missed payments, defaults, CCJs, IVAs, bankruptcies, and repossessions to support mortgage applications, creditworthiness assessments, and financial planning.

**Scope:**
- Comprehensive credit history tracking per client
- Summary dashboard with aggregate statistics
- Adverse credit event recording (CCJ, Default, IVA, Bankruptcy, Arrears, Repossession)
- Payment history tracking (missed payments over 12 months and 6 years)
- Outstanding debt aggregation
- Credit event timeline management
- Liability linking for debt tracking
- Mortgage lending impact assessment

**Key Features:**
- **Aggregate Summary** - Calculated summary of all adverse events and outstanding debts
- **Event-Based Tracking** - Individual adverse credit events with full lifecycle
- **Timeline Management** - Track registration, satisfaction, discharge, and repossession dates
- **Amount Tracking** - Monitor original and outstanding debt amounts
- **Payment Analysis** - Track missed and consecutive missed payments
- **Arrears Management** - Monitor payment arrears and clearance status
- **Liability Integration** - Link credit events to specific liability records
- **Mortgage Suitability** - Assess impact on mortgage lending eligibility

**Aggregate Root:** Client (credit history nested under client within factfind context)

**Regulatory Compliance:**
- MCOB (Mortgage Conduct of Business) - Credit history disclosure for mortgage applications
- FCA Handbook - Understanding client creditworthiness
- Consumer Credit Act - Credit history accuracy requirements
- Data Protection Act 2018 - Sensitive credit data handling
- GDPR - Right to rectification of credit data
- Consumer Duty - Fair treatment in lending decisions

### 8.2 Operations Summary

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history` | Get credit history with summary | `credit:read` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history` | Create or update credit history record | `credit:write` |
| PATCH | `/api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history/{creditHistoryId}` | Update credit history | `credit:write` |
| POST | `/api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history/{creditHistoryId}/adverse-events` | Add adverse credit event | `credit:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history/{creditHistoryId}` | Delete credit history (soft delete) | `credit:write` |

**Total Endpoints:** 5

**Business Operations:**
- Record clean credit history for mortgage application
- Add adverse credit event (CCJ, Default, IVA, etc.)
- Update event when debt satisfied or discharged
- Track payment history for affordability assessment
- Link credit events to specific liabilities
- Calculate total outstanding debt
- Generate mortgage suitability assessment

### 8.3 Key Endpoints

#### 10.3.1 Get Credit History

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history`

**Description:** Retrieve the credit history record for a client, including aggregated summary and all adverse credit events.

**Query Parameters:**
- `expand` - Expand related resources (liability)

**Response:**

```json
{
  "id": 334,
  "href": "/api/v2/factfinds/679/clients/346/credit-history/334",

  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },

  "client": {
    "id": 346,
    "href": "/api/v2/factfinds/679/clients/346",
    "fullName": "John Smith"
  },

  "summary": {
    "totalRecords": 1,
    "hasAdverseCredit": true,
    "hasCCJ": false,
    "hasBeenRefusedCredit": false,
    "ivaHistory": false,
    "hasDefault": true,
    "hasBankruptcyHistory": false,
    "hasArrears": false,

    "totalDebtOutstanding": {
      "amount": 3500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },

    "missedPayments": {
      "last12Months": 0,
      "last6Years": 2
    }
  },

  "adverseCreditEvents": [{
    "type": "Default",
    "registeredOn": "2020-06-15T00:00:00Z",
    "satisfiedOrClearedOn": null,
    "reposessedOn": null,
    "dischargedOn": null,
    "amountRegistered": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "amountOutstanding": {
      "amount": 3500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "isDebtOutstanding": true,
    "numberOfPaymentsMissed": 2,
    "consecutivePaymentsMissed": 2,
    "numberOfPaymentsInArrears": 1,
    "isArrearsClearedUponCompletion": false,
    "yearsMaintained": 0,
    "lender": "High Street Bank",
    "liability": {
      "id": 1001,
      "href": "/api/v2/factfinds/679/liabilities/1001",
      "description": "Credit Card Debt"
    },
    "concurrencyId": 1,
    "createdAt": "2026-01-15T10:30:00Z",
    "lastUpdatedAt": "2026-01-15T10:30:00Z"
  }],

  "notes": "Client has one outstanding default from 2020. Currently making regular payments to clear the debt.",

  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-01-15T10:00:00Z",
    "client": {
      "href": "/api/v2/factfinds/679/clients/346"
    },
    "factfind": {
      "href": "/api/v2/factfinds/679"
    }
  }
}
```

**Status Codes:**
- `200 OK` - Credit history retrieved successfully
- `404 Not Found` - Client or factfind not found
- `401 Unauthorized` - Missing or invalid authentication
- `403 Forbidden` - Insufficient permissions

#### 10.3.2 Create Credit History Record

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history`

**Description:** Create a new credit history record for a client. This is typically done once per client and then updated as needed.

**Request Body:**

```json
{
  "summary": {
    "hasAdverseCredit": true,
    "hasCCJ": false,
    "hasBeenRefusedCredit": false,
    "ivaHistory": false,
    "hasDefault": true,
    "hasBankruptcyHistory": false,
    "hasArrears": false
  },

  "adverseCreditEvents": [{
    "type": "Default",
    "registeredOn": "2020-06-15T00:00:00Z",
    "amountRegistered": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "amountOutstanding": {
      "amount": 3500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "isDebtOutstanding": true,
    "numberOfPaymentsMissed": 2,
    "consecutivePaymentsMissed": 2,
    "numberOfPaymentsInArrears": 1,
    "isArrearsClearedUponCompletion": false,
    "lender": "High Street Bank",
    "liability": {
      "id": 1001
    }
  }],

  "notes": "Client has one outstanding default from 2020. Currently making regular payments to clear the debt."
}
```

**Response:**

```json
{
  "id": 334,
  "href": "/api/v2/factfinds/679/clients/346/credit-history/334",

  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },

  "client": {
    "id": 346,
    "href": "/api/v2/factfinds/679/clients/346",
    "fullName": "John Smith"
  },

  "summary": {
    "totalRecords": 1,
    "hasAdverseCredit": true,
    "hasCCJ": false,
    "hasBeenRefusedCredit": false,
    "ivaHistory": false,
    "hasDefault": true,
    "hasBankruptcyHistory": false,
    "hasArrears": false,

    "totalDebtOutstanding": {
      "amount": 3500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },

    "missedPayments": {
      "last12Months": 0,
      "last6Years": 2
    }
  },

  "adverseCreditEvents": [{
    "type": "Default",
    "registeredOn": "2020-06-15T00:00:00Z",
    "satisfiedOrClearedOn": null,
    "reposessedOn": null,
    "dischargedOn": null,
    "amountRegistered": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "amountOutstanding": {
      "amount": 3500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "isDebtOutstanding": true,
    "numberOfPaymentsMissed": 2,
    "consecutivePaymentsMissed": 2,
    "numberOfPaymentsInArrears": 1,
    "isArrearsClearedUponCompletion": false,
    "yearsMaintained": 0,
    "lender": "High Street Bank",
    "liability": {
      "id": 1001,
      "href": "/api/v2/factfinds/679/liabilities/1001",
      "description": "Credit Card Debt"
    },
    "concurrencyId": 1,
    "createdAt": "2026-01-15T10:30:00Z",
    "lastUpdatedAt": "2026-01-15T10:30:00Z"
  }],

  "notes": "Client has one outstanding default from 2020. Currently making regular payments to clear the debt.",

  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-01-15T10:00:00Z",
    "client": {
      "href": "/api/v2/factfinds/679/clients/346"
    },
    "factfind": {
      "href": "/api/v2/factfinds/679"
    },
    "add-event": {
      "href": "/api/v2/factfinds/679/clients/346/credit-history/334/adverse-events",
      "method": "POST"
    }
  }
}
```

**Status Codes:**
- `201 Created` - Credit history record created successfully
- `400 Bad Request` - Invalid request body or validation failure
- `404 Not Found` - Client or factfind not found
- `409 Conflict` - Credit history record already exists for this client
- `401 Unauthorized` - Missing or invalid authentication
- `403 Forbidden` - Insufficient permissions

#### 10.3.3 Update Credit History Record

**Endpoint:** `PATCH /api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history/{creditHistoryId}`

**Description:** Update an existing credit history record. Typically used to mark adverse events as satisfied, update outstanding amounts, or add notes.

**Request Body:**

```json
{
  "adverseCreditEvents": [{
    "type": "Default",
    "registeredOn": "2020-06-15T00:00:00Z",
    "satisfiedOrClearedOn": "2026-02-01T00:00:00Z",
    "amountRegistered": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "amountOutstanding": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "isDebtOutstanding": false,
    "numberOfPaymentsMissed": 2,
    "consecutivePaymentsMissed": 2,
    "numberOfPaymentsInArrears": 0,
    "isArrearsClearedUponCompletion": true,
    "lender": "High Street Bank",
    "liability": {
      "id": 1001
    }
  }],

  "notes": "Default satisfied in full on 2026-02-01. Client now has clean credit history.",

  "concurrencyId": 12
}
```

**Response:** 200 OK with updated credit history entity (same structure as GET response).

**Common Update Scenarios:**
- Mark default or CCJ as satisfied
- Update outstanding debt amount as client makes payments
- Clear arrears status
- Complete and discharge IVA
- Discharge bankruptcy
- Add notes about credit improvement

**Status Codes:**
- `200 OK` - Credit history updated successfully
- `400 Bad Request` - Invalid request body or validation failure
- `404 Not Found` - Credit history, client, or factfind not found
- `409 Conflict` - Concurrency conflict (stale concurrencyId)
- `401 Unauthorized` - Missing or invalid authentication
- `403 Forbidden` - Insufficient permissions

#### 10.3.4 Add Adverse Credit Event

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/clients/{clientId}/credit-history/{creditHistoryId}/adverse-events`

**Description:** Add a new adverse credit event to an existing credit history record. This is a convenience endpoint for appending events without replacing the entire array.

**Request Body:**

```json
{
  "type": "CCJ",
  "registeredOn": "2023-11-15T00:00:00Z",
  "amountRegistered": {
    "amount": 2500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "amountOutstanding": {
    "amount": 2500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "isDebtOutstanding": true,
  "lender": "Council Tax Authority"
}
```

**Response:** 201 Created with the updated credit history entity including the new event.

**Status Codes:**
- `201 Created` - Adverse event added successfully
- `400 Bad Request` - Invalid event data
- `404 Not Found` - Credit history record not found
- `401 Unauthorized` - Missing or invalid authentication
- `403 Forbidden` - Insufficient permissions

### 8.4 Field Definitions

**Identification Fields**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned credit history record identifier |
| `href` | string | read-only | Canonical URI for this credit history record |
| `factfind` | FactfindRef | read-only | Reference to parent factfind |
| `client` | ClientRef | read-only | Reference to the client this credit history belongs to |

**Summary Object (Aggregate Fields)**

The summary object provides a calculated overview of the client's entire credit history:

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `summary` | object | read-only | Calculated summary of credit history status |
| `summary.totalRecords` | integer | read-only | Count of adverse credit events in the array |
| `summary.hasAdverseCredit` | boolean | read-only | True if adverseCreditEvents array is not empty |
| `summary.hasCCJ` | boolean | required | Has County Court Judgment(s) registered |
| `summary.hasBeenRefusedCredit` | boolean | required | Has been refused credit in the past |
| `summary.ivaHistory` | boolean | required | Has Individual Voluntary Arrangement (IVA) history |
| `summary.hasDefault` | boolean | required | Has default(s) registered on credit file |
| `summary.hasBankruptcyHistory` | boolean | required | Has bankruptcy history on record |
| `summary.hasArrears` | boolean | required | Currently has or had payment arrears |
| `summary.totalDebtOutstanding` | MoneyValue | read-only | Sum of all amountOutstanding where isDebtOutstanding = true |
| `summary.missedPayments` | object | read-only | Summary of missed payment history |
| `summary.missedPayments.last12Months` | integer | read-only | Count of missed payments in last 12 months (aggregated from events) |
| `summary.missedPayments.last6Years` | integer | read-only | Count of missed payments in last 6 years (aggregated from events) |

**Adverse Credit Events Array**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `adverseCreditEvents[]` | AdverseCreditEvent[] | optional | Array of adverse credit events (see AdverseCreditEvent value type) |

**AdverseCreditEvent Value Type Fields:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `type` | enum | required | Type of adverse event: "CCJ", "Default", "IVA", "Bankruptcy", "Arrears", "Repossession" |
| `registeredOn` | datetime | required | Date event was registered with Credit Reference Agencies (ISO 8601) |
| `satisfiedOrClearedOn` | datetime | optional | Date the debt was satisfied or cleared (ISO 8601) |
| `reposessedOn` | datetime | optional | Date of property repossession if applicable (ISO 8601) |
| `dischargedOn` | datetime | optional | Date bankruptcy or IVA was discharged (ISO 8601) |
| `amountRegistered` | MoneyValue | required | Original amount registered when event occurred |
| `amountOutstanding` | MoneyValue | required | Current outstanding amount (can be 0 if satisfied) |
| `isDebtOutstanding` | boolean | required | Whether debt is still outstanding (true) or fully paid (false) |
| `numberOfPaymentsMissed` | integer | optional | Total number of payments missed for this event |
| `consecutivePaymentsMissed` | integer | optional | Number of consecutive payments missed (maximum consecutive period) |
| `numberOfPaymentsInArrears` | integer | optional | Number of payments currently in arrears |
| `isArrearsClearedUponCompletion` | boolean | optional | Whether arrears were cleared when arrangement completed |
| `yearsMaintained` | integer | optional | Number of years successfully maintained after event (for IVA/payment plans) |
| `lender` | string | optional | Name of lender or creditor involved in the adverse event (max 200 chars) |
| `liability` | LiabilityRef | optional | Reference to related liability record if applicable |
| `concurrencyId` | integer | read-only | Concurrency control identifier for optimistic locking |
| `createdAt` | datetime | read-only | ISO 8601 timestamp when event record was created |
| `lastUpdatedAt` | datetime | read-only | ISO 8601 timestamp when event record was last updated |

**Additional Information**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `notes` | string | optional | Free-text notes about credit history, mitigating circumstances, or additional context (max 2000 chars) |

**Audit Trail**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `createdAt` | datetime | read-only | ISO 8601 timestamp when credit history record was created |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp when credit history record was last updated |

### 8.5 Validation Rules

**Summary Validation:**
- `summary.totalRecords` must equal the count of items in `adverseCreditEvents` array
- `summary.hasAdverseCredit` must be true if `adverseCreditEvents` is not empty
- `summary.totalDebtOutstanding` must equal the sum of all `adverseCreditEvents[].amountOutstanding` where `isDebtOutstanding` = true
- Summary boolean flags must align with events in array:
  - If `summary.hasCCJ` = true, there must be at least one event with `type` = "CCJ"
  - If `summary.hasDefault` = true, there must be at least one event with `type` = "Default"
  - If `summary.ivaHistory` = true, there must be at least one event with `type` = "IVA"
  - If `summary.hasBankruptcyHistory` = true, there must be at least one event with `type` = "Bankruptcy"
  - If `summary.hasArrears` = true, there must be at least one event with `type` = "Arrears"

**Adverse Credit Event Validations:**
- `type` is required when event is present
- `registeredOn` is required and cannot be in the future
- If `satisfiedOrClearedOn` is provided, it must be after `registeredOn`
- If `dischargedOn` is provided, it must be after `registeredOn`
- If `reposessedOn` is provided, it must be after `registeredOn`
- `amountOutstanding` cannot exceed `amountRegistered`
- If `isDebtOutstanding` = false, `amountOutstanding.amount` should be 0
- `numberOfPaymentsMissed` must be >= 0
- `consecutivePaymentsMissed` must be <= `numberOfPaymentsMissed`
- `numberOfPaymentsInArrears` must be >= 0
- `yearsMaintained` must be >= 0 and <= 10
- `lender` max length 200 characters
- All dates must be valid ISO 8601 format (YYYY-MM-DDTHH:mm:ssZ)
- Currency codes must be valid ISO 4217 codes

**Date Validations:**
- All event dates must not be in the future
- Timeline must be logical: registeredOn < satisfiedOrClearedOn < dischargedOn
- For repossession events, reposessedOn must be between registeredOn and dischargedOn

### 8.6 Business Rules

**Credit Event Types and Impact:**

1. **CCJ (County Court Judgment)**
   - Court order requiring debt repayment
   - Stays on credit file for 6 years from judgment date
   - Can be marked as "satisfied" when paid
   - CCJs over £500 within 3 years typically exclude standard mortgages
   - Significant impact on credit score and lending terms

2. **Default**
   - Creditor has written off debt (typically 3-6 months of missed payments)
   - Stays on credit file for 6 years from default date
   - Even if paid, remains on file for full 6 years
   - Impact reduces over time
   - Multiple defaults severely impact lending options

3. **IVA (Individual Voluntary Arrangement)**
   - Formal agreement to pay reduced debt over time
   - Typically 5-6 year payment plan
   - Stays on credit file for 6 years from approval date
   - Can apply for mortgages after 3 years with good payment record
   - Must disclose to lenders
   - `yearsMaintained` tracks compliance with IVA terms

4. **Bankruptcy**
   - Legal process to write off unaffordable debts
   - Typically discharged after 12 months
   - Stays on credit file for 6 years from bankruptcy date
   - Severely restricts access to credit during bankruptcy
   - Can obtain credit after discharge, but with higher rates
   - May prevent certain professional roles

5. **Arrears**
   - Currently behind on payment schedule
   - Track with `numberOfPaymentsInArrears`
   - Active arrears seriously impact mortgage applications
   - `isArrearsClearedUponCompletion` indicates if cleared with final payment

6. **Repossession**
   - Property has been repossessed by lender
   - Very serious adverse event
   - Stays on file for 6 years
   - Makes obtaining new mortgage extremely difficult
   - May require specialist lender

**Summary Calculation Rules:**
- `totalRecords` = count of all items in `adverseCreditEvents` array
- `hasAdverseCredit` = true if array length > 0, otherwise false
- `totalDebtOutstanding` = sum of all `adverseCreditEvents[].amountOutstanding.amount` where `isDebtOutstanding` = true
- `missedPayments.last12Months` = sum of all `numberOfPaymentsMissed` where event was within last 12 months
- `missedPayments.last6Years` = sum of all `numberOfPaymentsMissed` where event was within last 6 years
- Boolean flags (`hasCCJ`, `hasDefault`, etc.) are set based on presence of corresponding event types in array

**Mortgage Lending Impact:**

Standard UK mortgage lending typically requires:
- No missed payments in last 6 months
- No CCJs in last 3 years, or if older and satisfied, may be acceptable
- No defaults in last 3 years, or if older and satisfied with good explanation
- No active IVA (must be completed and discharged)
- No bankruptcy in last 6 years
- No repossession history in last 6 years
- Clean payment record on existing credit commitments

Specialist lenders may accept:
- Recent defaults if satisfied and with larger deposit (25-40%)
- Discharged bankruptcy after 3+ years
- Completed IVA after 3+ years
- Historical CCJs if satisfied
- But typically with higher interest rates (2-5% premium)

**Affordability Assessment Integration:**
- Total outstanding debt feeds into debt-to-income calculations
- Missed payments in last 12 months are red flags for lenders
- Active IVA means no new borrowing until completion
- Credit history directly affects maximum loan-to-value (LTV) ratios
- Adverse events within 3 years typically reduce borrowing capacity by 20-30%

**Compliance Requirements:**
- Credit history must be disclosed honestly for mortgage applications (Consumer Duty)
- Inaccurate credit history can be challenged under GDPR right to rectification
- Lenders must assess creditworthiness under MCOB rules
- Advisers must consider credit history when recommending products
- Soft delete policy for credit history records (retain for 7 years for audit)

**Business Process Notes:**
- Credit history should be reviewed annually and updated as events are satisfied
- Link adverse events to liability records for complete financial picture
- Use notes field to record mitigating circumstances or explanation
- For joint clients, credit events may appear on both client records
- Credit score can be tracked separately via external Credit Reference Agency integration

---

**Adverse Credit Event Type Enum:**

| Code | Display | Description | Duration on File | Typical Mortgage Impact |
|------|---------|-------------|-----------------|------------------------|
| CCJ | County Court Judgment | Court judgment for unpaid debt | 6 years from judgment | Significant - may require specialist lender |
| Default | Default | Payment default registered by creditor | 6 years from default date | Moderate to significant depending on age and amount |
| IVA | Individual Voluntary Arrangement | Formal debt repayment arrangement | 6 years from approval | Severe during arrangement, moderate after 3+ years |
| Bankruptcy | Bankruptcy | Declared bankrupt | 6 years from bankruptcy date | Very severe - specialist lenders only |
| Arrears | Payment Arrears | Currently in arrears on payments | Ongoing until cleared | Severe if active, moderate if historical |
| Repossession | Repossession | Property repossessed by lender | 6 years from repossession | Very severe - extremely difficult to obtain mortgage |

---

**Use Cases:**

**Use Case 1: Clean Credit History - Standard Mortgage Application**

**Scenario:** Client has no adverse credit, applying for standard residential mortgage.

**API Flow:**
```
POST /api/v2/factfinds/679/clients/346/credit-history
{
  "summary": {
    "hasAdverseCredit": false,
    "hasCCJ": false,
    "hasBeenRefusedCredit": false,
    "ivaHistory": false,
    "hasDefault": false,
    "hasBankruptcyHistory": false,
    "hasArrears": false
  },
  "adverseCreditEvents": [],
  "notes": "Excellent credit history. Eligible for best mortgage rates."
}

Response: Credit history created with clean record
Summary shows: totalDebtOutstanding = £0, missedPayments = 0

Mortgage impact:
- Eligible for standard mortgage products
- Can access best interest rates
- Maximum LTV available (up to 95% with 5% deposit)
- No credit-related restrictions
```

**Use Case 2: Satisfied Default - Explaining to Lender**

**Scenario:** Client had credit card default 4 years ago, now satisfied. Needs documentation for mortgage broker.

**API Flow:**
```
POST /api/v2/factfinds/679/clients/346/credit-history
{
  "summary": {
    "hasAdverseCredit": true,
    "hasDefault": true,
    "hasCCJ": false,
    "ivaHistory": false,
    "hasBankruptcyHistory": false
  },
  "adverseCreditEvents": [{
    "type": "Default",
    "registeredOn": "2020-06-15T00:00:00Z",
    "satisfiedOrClearedOn": "2023-12-20T00:00:00Z",
    "amountRegistered": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "amountOutstanding": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "isDebtOutstanding": false,
    "numberOfPaymentsMissed": 2,
    "lender": "High Street Bank"
  }],
  "notes": "Default occurred due to temporary unemployment. Client secured new job and satisfied debt in full 3 years later. No other adverse credit."
}

Response: Credit history created
Summary shows: totalDebtOutstanding = £0, totalRecords = 1

Mortgage impact:
- Default over 3 years old and satisfied: Acceptable to most lenders
- May need to provide letter of explanation
- Might require 10-15% deposit (instead of 5%)
- Interest rates may be 0.5-1% higher than best rates
- Mainstream lenders will consider with good income
```

**Use Case 3: Active IVA - Cannot Obtain Mortgage**

**Scenario:** Client in active IVA, wants to know when they can apply for mortgage.

**API Flow:**
```
POST /api/v2/factfinds/679/clients/346/credit-history
{
  "summary": {
    "hasAdverseCredit": true,
    "ivaHistory": true,
    "hasCCJ": false,
    "hasDefault": false
  },
  "adverseCreditEvents": [{
    "type": "IVA",
    "registeredOn": "2022-03-01T00:00:00Z",
    "amountRegistered": {
      "amount": 45000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "amountOutstanding": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "isDebtOutstanding": true,
    "yearsMaintained": 2,
    "lender": "Various Creditors"
  }],
  "notes": "IVA started March 2022, typically 5-6 year term. Client maintaining regular payments. Expected completion 2027-2028."
}

Response: Credit history created
Summary shows: totalDebtOutstanding = £15,000, ivaHistory = true

Mortgage impact:
- Cannot obtain mortgage during active IVA
- Must complete IVA and have it discharged
- After discharge, wait 3 years for mainstream lenders
- Specialist lenders may consider after 1 year of completion
- Will need larger deposit (25-40%) and face higher rates
- Advise client to focus on completing IVA first
```

**Use Case 4: Multiple Adverse Events - Specialist Lending**

**Scenario:** Client with CCJ and default, both satisfied, applying through specialist broker.

**API Flow:**
```
POST /api/v2/factfinds/679/clients/346/credit-history
{
  "summary": {
    "hasAdverseCredit": true,
    "hasCCJ": true,
    "hasDefault": true,
    "ivaHistory": false,
    "hasBankruptcyHistory": false
  },
  "adverseCreditEvents": [
    {
      "type": "CCJ",
      "registeredOn": "2021-08-10T00:00:00Z",
      "satisfiedOrClearedOn": "2022-12-15T00:00:00Z",
      "amountRegistered": {
        "amount": 2500.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "amountOutstanding": {
        "amount": 0.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "isDebtOutstanding": false,
      "lender": "Council Tax Authority"
    },
    {
      "type": "Default",
      "registeredOn": "2020-06-15T00:00:00Z",
      "satisfiedOrClearedOn": "2023-12-20T00:00:00Z",
      "amountRegistered": {
        "amount": 5000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "amountOutstanding": {
        "amount": 0.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "isDebtOutstanding": false,
      "numberOfPaymentsMissed": 3,
      "lender": "Credit Card Provider"
    }
  ],
  "notes": "Both adverse events satisfied in full. Client has stable employment and clean record since 2023."
}

Response: Credit history created
Summary shows: totalDebtOutstanding = £0, totalRecords = 2

Mortgage impact:
- Multiple adverse events = specialist lender required
- Both satisfied = positive factor
- CCJ over 3 years old = less impact
- Default over 3 years old = acceptable
- Will need 20-25% deposit minimum
- Interest rates 2-3% higher than standard rates
- Recommend specialist mortgage broker
- Can improve situation by building 12 months clean credit
```

**Use Case 5: Updating Event When Debt Satisfied**

**Scenario:** Client makes final payment to clear outstanding default during factfind process.

**API Flow:**
```
Step 1: Get current credit history
GET /api/v2/factfinds/679/clients/346/credit-history/334

Response shows:
- Default with amountOutstanding = £3,500
- isDebtOutstanding = true
- satisfiedOrClearedOn = null

Step 2: Client pays off debt, update the event
PATCH /api/v2/factfinds/679/clients/346/credit-history/334
{
  "adverseCreditEvents": [{
    "type": "Default",
    "registeredOn": "2020-06-15T00:00:00Z",
    "satisfiedOrClearedOn": "2026-02-18T00:00:00Z",
    "amountRegistered": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "amountOutstanding": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "isDebtOutstanding": false,
    "numberOfPaymentsMissed": 2,
    "consecutivePaymentsMissed": 2,
    "numberOfPaymentsInArrears": 0,
    "isArrearsClearedUponCompletion": true,
    "lender": "High Street Bank",
    "liability": { "id": 1001 }
  }],
  "notes": "Default satisfied in full on 2026-02-18. Demonstrates commitment to clearing debts.",
  "concurrencyId": 12
}

Response: Updated credit history
Summary recalculated: totalDebtOutstanding = £0

Mortgage impact:
- Recently satisfied = better than outstanding
- Shows commitment to debt management
- May improve mortgage terms
- Recommend waiting 3-6 months for credit file to update
- Can now approach more mainstream lenders
```

---

## 9. Goals & Objectives API (Goals Context)

### 9.1 Overview

**Base Path:** `/api/v2/factfinds/{factfindId}/objectives`

**Purpose:** Capture and track client financial goals and objectives across different life areas using type-based routing.

**Scope:**
- Type-based objectives (investment, pension, protection, mortgage, budget, estate-planning)
- Short, medium, and long-term goal definition
- Protection goals (life cover, income protection, critical illness)
- Retirement planning goals (retirement age, desired income)
- Investment goals (lump sum targets, regular savings)
- Mortgage goals (house purchase, remortgage)
- Budget goals (spending limits, debt reduction)
- Estate planning goals (inheritance, trusts, gifting)
- Goal prioritization and tracking
- Needs sub-resources for detailed requirements capture

**Aggregate Root:** FactFind (objectives are nested within)

**Key Characteristics:**
- **Type discrimination via URL path** - Different objective types have type-specific fields
- **Six objective types** - investment, pension, protection, mortgage, budget, estate-planning
- **Type-specific contracts** - Each objective type has its own schema
- **Needs sub-resources** - Capture detailed needs under each objective

**Regulatory Compliance:**
- FCA COBS (Understanding client objectives)
- Consumer Duty (Delivering good outcomes)
- PROD (Target Market assessment)

### 9.2 Operations Summary

**Objective Type Operations (6 types × 4 operations + 1 list + 1 delete = 26 endpoints):**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/objectives` | List all objectives (all types) | `objectives:read` |
| POST | `/api/v2/factfinds/{factfindId}/objectives/investment` | Create Investment Objective | `objectives:write` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/investment` | List Investment Objectives | `objectives:read` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/investment/{objectiveId}` | Get Investment Objective | `objectives:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/objectives/investment/{objectiveId}` | Update Investment Objective | `objectives:write` |
| POST | `/api/v2/factfinds/{factfindId}/objectives/pension` | Create Pension Objective | `objectives:write` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/pension` | List Pension Objectives | `objectives:read` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/pension/{objectiveId}` | Get Pension Objective | `objectives:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/objectives/pension/{objectiveId}` | Update Pension Objective | `objectives:write` |
| POST | `/api/v2/factfinds/{factfindId}/objectives/protection` | Create Protection Objective | `objectives:write` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/protection` | List Protection Objectives | `objectives:read` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/protection/{objectiveId}` | Get Protection Objective | `objectives:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/objectives/protection/{objectiveId}` | Update Protection Objective | `objectives:write` |
| POST | `/api/v2/factfinds/{factfindId}/objectives/mortgage` | Create Mortgage Objective | `objectives:write` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/mortgage` | List Mortgage Objectives | `objectives:read` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/mortgage/{objectiveId}` | Get Mortgage Objective | `objectives:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/objectives/mortgage/{objectiveId}` | Update Mortgage Objective | `objectives:write` |
| POST | `/api/v2/factfinds/{factfindId}/objectives/budget` | Create Budget Objective | `objectives:write` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/budget` | List Budget Objectives | `objectives:read` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/budget/{objectiveId}` | Get Budget Objective | `objectives:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/objectives/budget/{objectiveId}` | Update Budget Objective | `objectives:write` |
| POST | `/api/v2/factfinds/{factfindId}/objectives/estate-planning` | Create Estate Planning Objective | `objectives:write` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/estate-planning` | List Estate Planning Objectives | `objectives:read` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/estate-planning/{objectiveId}` | Get Estate Planning Objective | `objectives:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/objectives/estate-planning/{objectiveId}` | Update Estate Planning Objective | `objectives:write` |
| **DELETE** | **`/api/v2/factfinds/{factfindId}/objectives/{objectiveId}`** | **Delete any objective (all types)** | `objectives:write` |

**Note:** DELETE operation does not require type in the path. The objective ID is sufficient to identify and delete the objective regardless of its type. The type is determined from the existing objective record.

**Needs Sub-Resources (5 operations):**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/objectives/{objectiveId}/needs` | List needs | `objectives:read` |
| POST | `/api/v2/factfinds/{factfindId}/objectives/{objectiveId}/needs` | Add need | `objectives:write` |
| GET | `/api/v2/factfinds/{factfindId}/objectives/{objectiveId}/needs/{needId}` | Get need details | `objectives:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/objectives/{objectiveId}/needs/{needId}` | Update need | `objectives:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/objectives/{objectiveId}/needs/{needId}` | Delete need | `objectives:write` |--------|----------|-------------|---------------|
| **Assets** | | | |
| GET | `/api/v2/factfinds/{id}/clients/{clientId}/assets` | List all assets | `assets:read` |
| POST | `/api/v2/factfinds/{id}/clients/{clientId}/assets` | Add asset | `assets:write` |
| GET | `/api/v2/factfinds/{id}/clients/{clientId}/assets/{assetId}` | Get asset details | `assets:read` |
| PUT | `/api/v2/factfinds/{id}/clients/{clientId}/assets/{assetId}` | Update asset | `assets:write` |
| DELETE | `/api/v2/factfinds/{id}/clients/{clientId}/assets/{assetId}` | Delete asset | `assets:write` |
| **Liabilities** | | | |
| GET | `/api/v2/factfinds/{id}/liabilities` | List all liabilities | `liabilities:read` |
| POST | `/api/v2/factfinds/{id}/liabilities` | Add liability | `liabilities:write` |
| GET | `/api/v2/factfinds/{id}/liabilities/{liabilityId}` | Get liability details | `liabilities:read` |
| PATCH | `/api/v2/factfinds/{id}/liabilities/{liabilityId}` | Update liability | `liabilities:write` |
| DELETE | `/api/v2/factfinds/{id}/liabilities/{liabilityId}` | Delete liability | `liabilities:write` |
| **Property Details** | | | |
| GET | `/api/v2/factfinds/{id}/property-details/{propertyId}` | Get property detail | `assets:read` |
| PUT | `/api/v2/factfinds/{id}/property-details/{propertyId}` | Update property detail | `assets:write` |
| GET | `/api/v2/factfinds/{id}/property-details/{propertyId}/valuations` | Get valuation history | `assets:read` |
| POST | `/api/v2/factfinds/{id}/property-details/{propertyId}/valuations` | Add property valuation | `assets:write` |
| GET | `/api/v2/factfinds/{id}/property-details/{propertyId}/capital-gains` | Calculate CGT | `assets:read` |
| **Aggregated Views** | | | |
| GET | `/api/v2/factfinds/{id}/clients/{clientId}/assets/summary` | Get client assets summary | `assets:read` |
| GET | `/api/v2/factfinds/{id}/liabilities/summary` | Get liabilities summary | `liabilities:read` |
| GET | `/api/v2/factfinds/{id}/clients/{clientId}/net-worth` | Calculate client net worth | `assets:read` |

**Total Endpoints:** 22

**Note:** Rental yield values (`rentalYieldGross` and `rentalYieldNet`) are calculated and stored as part of the property details contract. No separate calculation endpoint is provided - rental yield is automatically recalculated when rental income or property value changes.

### 10.3 Key Endpoints

#### 10.3.1 List Assets

**Endpoint:** `GET /api/v2/factfinds/{id}/clients/{clientId}/assets`

**Description:** Retrieve all assets associated with a client in a factfind. Assets can be owned solely or jointly.

**Query Parameters:**
- `assetType` - Filter by asset type codes (PROPERTY, CASH, INVESTMENTS, OWN_BUSINESS, etc.)
- `ownershipType` - Filter by ownership type (SOLE_CLIENT1, SOLE_CLIENT2, JOINT)
- `hasIncome` - Filter assets with linked income (true/false)
- `hasDividends` - Filter assets with dividend income (true/false)

**Response:**

```json
{
  "assets": [
    {
      "id": 1234,
      "href": "/api/v2/factfinds/679/clients/346/assets/1234",
      "factfind": { "id": 679, "href": "/api/v2/factfinds/679" },
      "assetType": "PROPERTY",
      "description": "Primary Residence - 123 Main Street",
      "ownership": {
        "ownershipType": "JOINT",
        "owners": [
          {
            "client": { "id": 123, "href": "/api/v2/factfinds/679/clients/123" },
            "ownershipShare": 50.0
          },
          {
            "client": { "id": 124, "href": "/api/v2/factfinds/679/clients/124" },
            "ownershipShare": 50.0
          }
        ]
      },
      "currentValue": {
        "amount": 450000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "valuedOn": "2026-01-15",
      "valuationBasis": "Comparable Sales",
      "originalValue": {
        "amount": 450000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "purchasedOn": "2024-05-10",
      "rentalExpenses": { "amount": 1200.00, "currency": "GBP" },
      "isVisibleToClient": true,
      "isBusinessAssetDisposalRelief": false,
      "isFreeFromInheritanceTax": false,
      "rnrbEligibility": "Not Eligible",
      "isBusinessReliefQualifying": false,
      "isHolding": false,
      "property": { "id": 1234, "href": "/api/v2/factfinds/679/property-details/1234" },
      "arrangement": { "id": 1234, "href": "/api/v2/factfinds/679/clients/4436/arrangements/1234" },
      "income": { "id": 1234, "href": "/api/v2/factfinds/679/clients/4436/income/1234" },
      "notes": "Rental property - managed by external agent",
      "createdAt": "2026-02-01T10:00:00Z",
      "updatedAt": "2026-02-15T14:30:00Z"
    },
    {
      "id": 1235,
      "href": "/api/v2/factfinds/679/clients/346/assets/1235",
      "factfind": { "id": 679, "href": "/api/v2/factfinds/679" },
      "assetType": "OWN_BUSINESS",
      "description": "Smith & Co Limited - Software Consulting",
      "ownership": {
        "ownershipType": "SOLE_CLIENT1",
        "owners": [
          {
            "client": { "id": 123, "href": "/api/v2/factfinds/679/clients/123" },
            "ownershipShare": 100.0
          }
        ]
      },
      "dividends": {
        "owners": [
          {
            "client": { "id": 123, "href": "/api/v2/factfinds/679/clients/123" },
            "dividend": { "amount": 5000.00, "currency": "GBP" },
            "withdrawalType": "Regular",
            "frequency": "Monthly"
          }
        ]
      },
      "currentValue": {
        "amount": 250000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "valuedOn": "2026-01-15",
      "valuationBasis": "Net Asset Value",
      "originalValue": {
        "amount": 100000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "purchasedOn": "2018-03-20",
      "isVisibleToClient": true,
      "isBusinessAssetDisposalRelief": true,
      "isFreeFromInheritanceTax": false,
      "isBusinessReliefQualifying": true,
      "isHolding": false,
      "notes": "Limited company - 100% shareholding",
      "createdAt": "2026-01-10T09:30:00Z",
      "updatedAt": "2026-02-01T11:00:00Z"
    }
  ],
  "totalCount": 2,
  "totalValue": {
    "amount": 700000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  }
}
```

#### 10.3.2 Create Asset

**Endpoint:** `POST /api/v2/factfinds/{id}/clients/{clientId}/assets`

**Description:** Add a new asset to the client's portfolio.

**Request Body:**

```json
{
  "assetType": "PROPERTY",
  "description": "Buy-to-Let Property - 45 Oak Avenue",
  "ownership": {
    "ownershipType": "SOLE_CLIENT1",
    "owners": [
      {
        "client": { "id": 123 },
        "ownershipShare": 100.0
      }
    ]
  },
  "currentValue": {
    "amount": 275000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuedOn": "2026-02-01",
  "valuationBasis": "Market Valuation",
  "originalValue": {
    "amount": 220000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "purchasedOn": "2020-03-15",
  "rentalExpenses": { "amount": 800.00, "currency": "GBP" },
  "isVisibleToClient": true,
  "isBusinessAssetDisposalRelief": false,
  "isFreeFromInheritanceTax": false,
  "rnrbEligibility": "Eligible",
  "isBusinessReliefQualifying": false,
  "isHolding": false,
  "property": { "id": 5001 },
  "income": { "id": 3456 },
  "notes": "Rental property generating monthly income"
}
```

**Response:** 201 Created with complete asset entity including server-generated fields (`id`, `href`, `factfind`, `createdAt`, `updatedAt`).

**Example Response:**

```json
{
  "id": 1236,
  "href": "/api/v2/factfinds/679/clients/346/assets/1236",
  "factfind": { "id": 679, "href": "/api/v2/factfinds/679" },
  "assetType": "PROPERTY",
  "description": "Buy-to-Let Property - 45 Oak Avenue",
  "ownership": {
    "ownershipType": "SOLE_CLIENT1",
    "owners": [
      {
        "client": { "id": 123, "href": "/api/v2/factfinds/679/clients/123" },
        "ownershipShare": 100.0
      }
    ]
  },
  "currentValue": {
    "amount": 275000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuedOn": "2026-02-01",
  "valuationBasis": "Market Valuation",
  "originalValue": {
    "amount": 220000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "purchasedOn": "2020-03-15",
  "rentalExpenses": { "amount": 800.00, "currency": "GBP" },
  "isVisibleToClient": true,
  "isBusinessAssetDisposalRelief": false,
  "isFreeFromInheritanceTax": false,
  "rnrbEligibility": "Eligible",
  "isBusinessReliefQualifying": false,
  "isHolding": false,
  "property": { "id": 5001, "href": "/api/v2/factfinds/679/property-details/5001" },
  "income": { "id": 3456, "href": "/api/v2/factfinds/679/clients/346/income/3456" },
  "notes": "Rental property generating monthly income",
  "createdAt": "2026-02-19T10:15:00Z",
  "updatedAt": "2026-02-19T10:15:00Z"
}
```

#### 10.3.3 Get Property Details

**Endpoint:** `GET /api/v2/factfinds/{id}/property-details/{propertyId}`

**Description:** Get detailed property information including construction details, tenure, and physical characteristics.

**Response:**

```json
{
  "id": 1234,
  "href": "/api/v2/factfinds/679/property-details/1234",
  "propertyType": "DETACHED",
  "tenureType": "Freehold",
  "leaseholdEndsOn": null,
  "propertyStatus": "RESIDENTIAL",
  "constructionType": "BRICK_AND_TILE",
  "constructionNotes": "Traditional brick construction with tile roof",
  "roofConstructionType": "PITCHED_CLAY_TILES",
  "numberOfBedrooms": 3,
  "yearBuilt": 1995,
  "isNewBuild": false,
  "isNHBCCertificateCovered": false,
  "isOtherCertificateCovered": false,
  "otherCertificateNotes": null,
  "builderName": null,
  "isExLocalAuthority": false,
  "numberOfOutbuildings": 1,
  "address": {
    "line1": "123 Main Street",
    "line2": "Apartment 4B",
    "line3": null,
    "line4": null,
    "locality": "London",
    "postalCode": "SW1A 1AA",
    "county": {
      "code": "GB-LND",
      "name": "London"
    },
    "country": {
      "isoCode": "GB",
      "name": "United Kingdom"
    }
  },
  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-10T14:20:00Z",
    "factfind": { "href": "/api/v2/factfinds/679" }
  }
}
```

#### 10.3.4 List Liabilities

**Endpoint:** `GET /api/v2/factfinds/{id}/liabilities`

**Description:** Retrieve all liabilities associated with a factfind.

**Query Parameters:**
- `liabilityType` - Filter by type (mortgage, loan, credit_card, other)
- `clientId` - Filter by responsible client

**Response:**

```json
{
  "liabilities": [
    {
      "id": 789,
      "factfind": { "id": 456 },
      "liabilityType": "MORTGAGE",
      "lender": "First National Bank",
      "accountNumber": "****1234",
      "outstandingBalance": {
        "amount": 180000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "monthlyPayment": {
        "amount": 1200.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "interestRate": 3.5,
      "remainingTerm": {
        "years": 20,
        "months": 6
      },
      "linkedAsset": {
        "asset": { "id": 123, "href": "/api/v2/factfinds/ff-456/assets/123" },
        "description": "Primary Residence"
      },
      "responsibleClients": [
        {
          "client": { "id": 123 },
          "responsibilityShare": 50.0
        },
        {
          "client": { "id": 124 },
          "responsibilityShare": 50.0
        }
      ],
        "linked-asset": { "href": "/api/v2/factfinds/ff-456/assets/123" }
      }
    }
  ],
  "totalCount": 1,
  "totalOutstanding": {
    "amount": 180000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  }
}
```

#### 10.3.5 Get Assets Summary

**Endpoint:** `GET /api/v2/factfinds/{id}/clients/{clientId}/assets/summary`

**Description:** Get aggregated summary of all assets for a client by type.

**Response:**

```json
{
  "factfind": { "id": 679 },
  "totalAssets": {
    "amount": 700000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "assetsByType": [
    {
      "assetType": "PROPERTY",
      "count": 1,
      "totalValue": {
        "amount": 450000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 64.29
    },
    {
      "assetType": "OWN_BUSINESS",
      "count": 1,
      "totalValue": {
        "amount": 250000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 35.71
    }
  ],
  "assetsByClient": [
    {
      "client": { "id": 123, "name": "John Smith" },
      "totalValue": {
        "amount": 500000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 68.97
    },
    {
      "client": { "id": 124, "name": "Jane Smith" },
      "totalValue": {
        "amount": 225000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 31.03
    }
  ],
  "calculatedAt": "2026-02-18T10:30:00Z"
}
```

#### 10.3.6 Calculate Net Worth

**Endpoint:** `GET /api/v2/factfinds/{id}/clients/{clientId}/net-worth`

**Description:** Calculate net worth (total assets minus total liabilities) for a specific client.

**Response:**

```json
{
  "factfind": { "id": 679 },
  "client": { "id": 123, "href": "/api/v2/factfinds/679/clients/123" },
  "totalAssets": {
    "amount": 700000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "totalLiabilities": {
    "amount": 180000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "netWorth": {
    "amount": 520000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "assetBreakdown": [
    {
      "assetType": "PROPERTY",
      "value": { "amount": 450000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } }
    },
    {
      "assetType": "OWN_BUSINESS",
      "value": { "amount": 250000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } }
    }
  ],
  "calculatedAt": "2026-02-18T10:30:00Z"
}
```


#### 10.3.7 List Net Worth Calculations

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/networth`

**Description:** List all net worth calculations for a factfind, showing historical snapshots of client wealth over time.

**Query Parameters:**

| Parameter | Type | Description |
|-----------|------|-------------|
| clientId | integer | Filter by specific client |
| fromDate | date | Filter calculations from this date |
| toDate | date | Filter calculations to this date |
| page | integer | Page number (default: 1) |
| pageSize | integer | Results per page (default: 20, max: 100) |

**Response:**

```json
{
  "items": [
    {
      "id": 9001,
      "href": "/api/v2/factfinds/456/networth/9001",
      "factfind": {
        "id": 456,
        "href": "/api/v2/factfinds/456"
      },
      "clients": [
        {
          "id": 456,
          "href": "/api/v2/factfinds/456/clients/456"
        }
      ],
      "netWorth": {
        "amount": 761500.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "calculatedOn": "2026-02-18T14:30:00Z",
      "notes": "Net worth calculation as of property revaluation"
    },
    {
      "id": 9000,
      "href": "/api/v2/factfinds/456/networth/9000",
      "factfind": {
        "id": 456,
        "href": "/api/v2/factfinds/456"
      },
      "clients": [
        {
          "id": 456,
          "href": "/api/v2/factfinds/456/clients/456"
        }
      ],
      "netWorth": {
        "amount": 745000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "calculatedOn": "2026-01-15T10:00:00Z",
      "notes": "Initial net worth assessment"
    }
  ],
  "pagination": {
    "page": 1,
    "pageSize": 20,
    "totalItems": 2,
    "totalPages": 1
  }
}
```

#### 10.3.8 Create Net Worth Calculation

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/networth`

**Description:** Create a new net worth calculation snapshot for tracking client wealth over time.

**Request Body:**

```json
{
  "clients": [
    {
      "id": 456,
      "href": "/api/v2/factfinds/456/clients/456"
    }
  ],
  "calculatedOn": "2026-02-18T14:30:00Z",
  "assets": {
    "property": {
      "amount": 450000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "pensions": {
      "amount": 325000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "investments": {
      "amount": 185000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "cash": {
      "amount": 45000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "other": {
      "amount": 25000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "liabilities": {
    "mortgages": {
      "amount": 240000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "loans": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "creditCards": {
      "amount": 8500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "other": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "notes": "Net worth calculation as of property revaluation"
}
```

**Response:** `201 Created`

Returns the complete Net Worth object with system-calculated fields (see Section 14.31 for full contract).

**Validation:**

- All clients must exist and belong to the specified factfind
- calculatedOn cannot be in the future
- All currency codes must be consistent
- System automatically calculates totalAssets, totalLiabilities, and netWorth
- All amounts must be non-negative except netWorth which can be negative

#### 10.3.9 Get Net Worth Calculation

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/networth/{networthId}`

**Description:** Retrieve a specific net worth calculation by ID.

**Response:**

```json
{
  "id": 9001,
  "href": "/api/v2/factfinds/456/networth/9001",
  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456"
  },
  "clients": [
    {
      "id": 456,
      "href": "/api/v2/factfinds/456/clients/456"
    }
  ],
  "calculatedOn": "2026-02-18T14:30:00Z",
  "assets": {
    "property": {
      "amount": 450000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "pensions": {
      "amount": 325000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "investments": {
      "amount": 185000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "cash": {
      "amount": 45000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "other": {
      "amount": 25000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalAssets": {
      "amount": 1030000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "liabilities": {
    "mortgages": {
      "amount": 240000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "loans": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "creditCards": {
      "amount": 8500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "other": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalLiabilities": {
      "amount": 268500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "netWorth": {
    "amount": 761500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "notes": "Net worth calculation as of property revaluation",
  "createdAt": "2026-02-18T14:30:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

See Section 14.31 for complete field definitions.

#### 10.3.10 Update Net Worth Calculation

**Endpoint:** `PATCH /api/v2/factfinds/{factfindId}/networth/{networthId}`

**Description:** Update an existing net worth calculation. Typically used to correct data or add notes.

**Request Body:**

Partial Net Worth object with fields to update:

```json
{
  "notes": "Updated: Net worth calculation as of property revaluation and mortgage refinance",
  "assets": {
    "property": {
      "amount": 460000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  }
}
```

**Response:** `200 OK`

Returns the updated complete Net Worth object with recalculated totals.

**Note:** Updating any asset or liability amounts will trigger automatic recalculation of totalAssets, totalLiabilities, and netWorth.

#### 10.3.11 Delete Net Worth Calculation

**Endpoint:** `DELETE /api/v2/factfinds/{factfindId}/networth/{networthId}`

**Description:** Delete a net worth calculation. Used to remove incorrect or duplicate calculations.

**Response:** `204 No Content`

**Note:** This operation is permanent and cannot be undone. Consider whether the calculation should be archived rather than deleted.



---
## 11. Arrangements API (Type-Based Routing)

### 11.1 Overview

**Purpose:** Manage all financial arrangements held by clients including investments, pensions, mortgages, and protection policies with type-specific endpoints and operations.

**Base Path:** `/api/v2/factfinds/{factfindId}/arrangements`

**Key Features:**

The Arrangements API provides comprehensive management of client financial products through a hierarchical, type-based routing structure:

1. **Type-Based Routing** - Separate endpoints for each arrangement category (investments, pensions, mortgages, protection)
2. **Sub-Type Specialization** - Further refined endpoints for specific product types (GIA, ISA, SIPP, etc.)
3. **Unified Data Model** - Common base fields with type-specific extensions
4. **Provider Integration** - Track provider details, policy numbers, and account references
5. **Valuation History** - Complete audit trail of arrangement values over time
6. **Ownership Tracking** - Multi-client ownership with percentage allocations
7. **Sub-Resource Management** - Contributions, withdrawals, beneficiaries, and valuations

**Aggregate Root:** FactFind (arrangements are part of the fact-find lifecycle)

**Arrangement Categories:**
- **Investment Arrangements:** GIA, ISA, Investment Bonds, Investment Trusts, Platform Accounts, Offshore Bonds, Cash Accounts
- **Pension Arrangements:** Personal Pension, State Pension, Workplace Pension, SIPP, Final Salary, Money Purchase, Drawdown, Annuity
- **Mortgage Arrangements:** Residential, Buy-to-Let, Second Charge
- **Protection Arrangements:** Personal Protection (Life, Critical Illness, Income Protection), General Insurance

**Regulatory Compliance:**
- FCA COBS 9.2 (Suitability Assessment)
- FCA COBS 13 (Periodic Reporting)
- MiFID II Article 25 (Suitability and Appropriateness)
- Pension Schemes Act 2015 (Pension Freedoms)
- Financial Services and Markets Act 2000 (Regulated Activities)
- Consumer Duty (Product Governance and Fair Value)
- IDD (Insurance Distribution Directive)
- GDPR (Data Protection for Financial Records)

### 11.2 Arrangement Types and Routing

**Hierarchical URL Structure:**

```
/api/v2/factfinds/{factfindId}/arrangements
├── /investments
│   ├── /GIA
│   ├── /ISA
│   ├── /Bonds
│   ├── /Investment-Trust
│   ├── /Platform-Account
│   └── /Offshore-Bond
├── /pensions
│   ├── /personal-pension
│   ├── /state-pension
│   ├── /workplace-pension
│   ├── /SIPP
│   ├── /final-salary
│   ├── /drawdown
│   └── /annuity
├── /mortgages
└── /protections
    ├── /personal-protection
    └── /general-insurance
```

**Common Operations (All Types):**

| Method | Endpoint Pattern | Description |
|--------|-----------------|-------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/{category}/{type}` | Create new arrangement |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{category}/{type}` | List arrangements by type |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{category}/{type}/{arrangementId}` | Get specific arrangement |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/{category}/{type}/{arrangementId}` | Update arrangement |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/{category}/{type}/{arrangementId}` | Delete arrangement (soft) |

**Common Fields (All Arrangements):**

```json
{
  "id": "string",
  "href": "string",
  "arrangementCategory": "string (enum)",
  "provider": {
    "name": "string",
    "reference": "string",
    "contactDetails": {}
  },
  "policyNumber": "string",
  "accountNumber": "string",
  "startDate": "date",
  "maturityDate": "date",
  "currentValue": "Money",
  "valuationDate": "date",
  "owners": [
    {
      "client": "Reference",
      "ownershipPercentage": "number"
    }
  ],
  "status": "string (enum)",
  "concurrencyId": "string",
  "createdAt": "datetime",
  "updatedAt": "datetime"
}
```

### 11.3 Investment Arrangements

**Base Path:** `/api/v2/factfinds/{factfindId}/arrangements/investments`

**Purpose:** Manage investment products including tax-wrappers (ISA, GIA), bonds, trusts, and platform-based investments.

**Common Investment Fields:**

```json
{
  "investmentType": "string (enum)",
  "platformName": "string",
  "investmentObjective": "string (enum)",
  "assetAllocation": {
    "cash": "number",
    "equities": "number",
    "bonds": "number",
    "property": "number",
    "alternatives": "number"
  },
  "performanceMetrics": {
    "annualReturn": "number",
    "totalReturn": "number",
    "benchmark": "string",
    "benchmarkReturn": "number"
  },
  "charges": {
    "amc": "number",
    "platformFee": "number",
    "adviserFee": "number",
    "totalCharges": "number"
  },
  "holdings": [
    {
      "fundName": "string",
      "isin": "string",
      "units": "number",
      "value": "Money",
      "percentage": "number"
    }
  ]
}
```

#### 13.3.1 GIA (General Investment Account)

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/investments/GIA` | Create GIA | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/GIA` | List GIAs | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/GIA/{arrangementId}` | Get GIA details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/investments/GIA/{arrangementId}` | Update GIA | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/investments/GIA/{arrangementId}` | Delete GIA | `arrangements:write` |

**Create GIA Request:**

```json
{
  "arrangementType": "GIA",
  "provider": {
    "name": "Vanguard UK",
    "reference": "VANG-UK-001",
    "contactDetails": {
      "phone": "0800 587 0460",
      "email": "clientservices@vanguard.co.uk",
      "website": "https://www.vanguard.co.uk"
    }
  },
  "accountNumber": "GB12345678",
  "startDate": "2020-03-15",
  "currentValue": {
    "amount": 45000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "owners": [
    {
      "client": { "id": 123 },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "investmentObjective": "GROWTH",
  "assetAllocation": {
    "cash": 5.0,
    "equities": 70.0,
    "bonds": 20.0,
    "property": 5.0,
    "alternatives": 0.0
  },
  "charges": {
    "amc": 0.15,
    "platformFee": 0.25,
    "adviserFee": 0.50,
    "totalCharges": 0.90
  },
  "taxPosition": {
    "capitalGainsUsed": {
      "amount": 3000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "dividendTaxPaid": {
      "amount": 450.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxYear": "2025/26"
  },
  "regularContribution": {
    "amount": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2020-04-01",
    "endDate": null
  }
}
```

**Response (201 Created):**

```json
{
  "id": 1,
  "href": "/api/v2/factfinds/ff-456/arrangements/investments/GIA/arr-gia-001",
  "arrangementType": "GIA",
  "arrangementCategory": "INVESTMENT",
  "provider": {
    "name": "Vanguard UK",
    "reference": "VANG-UK-001",
    "contactDetails": {
      "phone": "0800 587 0460",
      "email": "clientservices@vanguard.co.uk",
      "website": "https://www.vanguard.co.uk"
    }
  },
  "accountNumber": "GB12345678",
  "startDate": "2020-03-15",
  "currentValue": {
    "amount": 45000.00,
    "currency": { "code": "GBP", "symbol": "£", "display": "British Pound" }
  },
  "valuationDate": "2026-02-18",
  "owners": [
    {
      "client": {
        "id": 123,
        "fullName": "John Smith",
        "href": "/api/v2/factfinds/ff-456/clients/123"
      },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "investmentObjective": "GROWTH",
  "assetAllocation": {
    "cash": 5.0,
    "equities": 70.0,
    "bonds": 20.0,
    "property": 5.0,
    "alternatives": 0.0
  },
  "performanceMetrics": {
    "annualReturn": 7.2,
    "totalReturn": 28.5,
    "benchmark": "FTSE All Share",
    "benchmarkReturn": 6.8
  },
  "charges": {
    "amc": 0.15,
    "platformFee": 0.25,
    "adviserFee": 0.50,
    "totalCharges": 0.90
  },
  "taxPosition": {
    "capitalGainsUsed": {
      "amount": 3000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "dividendTaxPaid": {
      "amount": 450.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxYear": "2025/26"
  },
  "regularContribution": {
    "amount": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2020-04-01",
    "endDate": null
  },
  "concurrencyId": "e7b3c1a0-2f45-4e8b-9d3c-1a2b3c4d5e6f",
  "createdAt": "2026-02-18T10:30:00Z",
  "updatedAt": "2026-02-18T10:30:00Z",
    "factfind": { "href": "/api/v2/factfinds/ff-456" },
    "owner": { "href": "/api/v2/factfinds/ff-456/clients/123" },
    "contributions": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-gia-001/contributions" },
    "withdrawals": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-gia-001/withdrawals" },
    "valuations": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-gia-001/valuations" }
  }
}
```

**Validation Rules:**
- `arrangementType.code` - Required, must be "GIA"
- `provider.name` - Required
- `accountNumber` - Required, unique per provider
- `startDate` - Required, cannot be in future
- `currentValue` - Required, must be positive
- `valuationDate` - Required, cannot be more than 12 months old
- `owners` - Required, at least one owner, percentages must sum to 100
- `assetAllocation` - If provided, percentages must sum to 100

**Business Rules:**
- Capital gains tracking against annual allowance (£3,000 for 2025/26)
- Dividend tax calculation based on dividend allowance
- Regular contribution tracking for cash flow planning
- Performance comparison against benchmark indices

#### 13.3.2 ISA (Individual Savings Account)

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/investments/ISA` | Create ISA | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/ISA` | List ISAs | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/ISA/{arrangementId}` | Get ISA details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/investments/ISA/{arrangementId}` | Update ISA | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/investments/ISA/{arrangementId}` | Delete ISA | `arrangements:write` |

**Create ISA Request:**

```json
{
  "arrangementType": "ISA",
  "isaType": "STOCKS_SHARES",
  "provider": {
    "name": "Hargreaves Lansdown",
    "reference": "HL-UK-001",
    "contactDetails": {
      "phone": "0117 900 9000",
      "email": "helpdesk@hl.co.uk",
      "website": "https://www.hl.co.uk"
    }
  },
  "accountNumber": "HL-ISA-987654",
  "startDate": "2018-04-06",
  "currentValue": {
    "amount": 75000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "owners": [
    {
      "client": { "id": 123 },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "investmentObjective": "BALANCED",
  "assetAllocation": {
    "cash": 10.0,
    "equities": 60.0,
    "bonds": 25.0,
    "property": 5.0,
    "alternatives": 0.0
  },
  "charges": {
    "amc": 0.18,
    "platformFee": 0.45,
    "adviserFee": 0.00,
    "totalCharges": 0.63
  },
  "isaAllowance": {
    "taxYear": "2025/26",
    "annualAllowance": {
      "amount": 20000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "usedThisYear": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "remainingAllowance": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "previousYearTransfers": [
    {
      "fromProvider": "AJ Bell",
      "transferDate": "2023-09-15",
      "transferValue": {
        "amount": 45000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    }
  ],
  "regularContribution": {
    "amount": {
      "amount": 1250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2025-04-06",
    "endDate": null
  }
}
```

**Response (201 Created):**

```json
{
  "id": 2,
  "href": "/api/v2/factfinds/ff-456/arrangements/investments/ISA/arr-isa-002",
  "arrangementType": "ISA",
  "arrangementCategory": "INVESTMENT",
  "isaType": "STOCKS_SHARES",
  "provider": {
    "name": "Hargreaves Lansdown",
    "reference": "HL-UK-001",
    "contactDetails": {
      "phone": "0117 900 9000",
      "email": "helpdesk@hl.co.uk",
      "website": "https://www.hl.co.uk"
    }
  },
  "accountNumber": "HL-ISA-987654",
  "startDate": "2018-04-06",
  "currentValue": {
    "amount": 75000.00,
    "currency": { "code": "GBP", "symbol": "£", "display": "British Pound" }
  },
  "valuationDate": "2026-02-18",
  "owners": [
    {
      "client": {
        "id": 123,
        "fullName": "John Smith",
        "href": "/api/v2/factfinds/ff-456/clients/123"
      },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "investmentObjective": "BALANCED",
  "assetAllocation": {
    "cash": 10.0,
    "equities": 60.0,
    "bonds": 25.0,
    "property": 5.0,
    "alternatives": 0.0
  },
  "performanceMetrics": {
    "annualReturn": 6.8,
    "totalReturn": 45.3,
    "benchmark": "FTSE 100",
    "benchmarkReturn": 6.2
  },
  "charges": {
    "amc": 0.18,
    "platformFee": 0.45,
    "adviserFee": 0.00,
    "totalCharges": 0.63
  },
  "isaAllowance": {
    "taxYear": "2025/26",
    "annualAllowance": {
      "amount": 20000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "usedThisYear": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "remainingAllowance": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "projectedYearEnd": {
      "amount": 20000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "previousYearTransfers": [
    {
      "fromProvider": "AJ Bell",
      "transferDate": "2023-09-15",
      "transferValue": {
        "amount": 45000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    }
  ],
  "regularContribution": {
    "amount": {
      "amount": 1250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2025-04-06",
    "endDate": null
  },
  "taxBenefits": {
    "taxSavedPerYear": {
      "amount": 1200.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "lifetimeTaxSaved": {
      "amount": 9600.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "concurrencyId": "f8c4d2b1-3g56-5f9c-0e4d-2b3c4d5e6f7g",
  "createdAt": "2026-02-18T10:35:00Z",
  "updatedAt": "2026-02-18T10:35:00Z",
    "factfind": { "href": "/api/v2/factfinds/ff-456" },
    "owner": { "href": "/api/v2/factfinds/ff-456/clients/123" },
    "contributions": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-isa-002/contributions" },
    "withdrawals": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-isa-002/withdrawals" },
    "valuations": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-isa-002/valuations" }
  }
}
```

**Validation Rules:**
- `arrangementType.code` - Required, must be "ISA"
- `isaType` - Required, one of: STOCKS_SHARES, CASH, LIFETIME, INNOVATIVE_FINANCE
- `provider.name` - Required
- `accountNumber` - Required
- `startDate` - Required, must be on or after April 6 (ISA year start)
- `currentValue` - Required, must be positive
- `isaAllowance.usedThisYear` - Cannot exceed annual allowance
- `owners` - Required, must be single owner (ISAs cannot be joint)

**Business Rules:**
- Annual ISA allowance tracking (£20,000 for 2025/26)
- Only one ISA of each type per tax year
- Automatic calculation of remaining allowance
- Tax benefits calculation based on income tax band
- Lifetime ISA bonus tracking (25% government bonus up to £1,000/year)
- Transfer tracking maintains tax-free status

#### 13.3.3 Investment Bonds

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/investments/Bonds` | Create Investment Bond | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Bonds` | List Investment Bonds | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Bonds/{arrangementId}` | Get Bond details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/investments/Bonds/{arrangementId}` | Update Bond | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/investments/Bonds/{arrangementId}` | Delete Bond | `arrangements:write` |

**Bond-Specific Fields:**

```json
{
  "bondType": "ONSHORE",
  "segments": 101,
  "segmentsRemaining": 95,
  "topSlicing": {
    "years": 8,
    "annualGain": {
      "amount": 1875.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "surrenderValue": {
    "amount": 85000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "initialInvestment": {
    "amount": 75000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "cumulativeWithdrawals": {
    "amount": 4500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "annualWithdrawalAllowance": {
    "amount": 3750.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "unused5PercentAllowance": {
    "amount": 18750.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  }
}
```

**Validation Rules:**
- `bondType` - Required, one of: ONSHORE, OFFSHORE
- `segments` - Required for UK bonds, must be positive integer
- `initialInvestment` - Required
- 5% withdrawal allowance tracking
- Top-slicing relief calculations

#### 13.3.4 Investment Trusts

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/investments/Investment-Trust` | Create Investment Trust | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Investment-Trust` | List Investment Trusts | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Investment-Trust/{arrangementId}` | Get Trust details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/investments/Investment-Trust/{arrangementId}` | Update Trust | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/investments/Investment-Trust/{arrangementId}` | Delete Trust | `arrangements:write` |

**Trust-Specific Fields:**

```json
{
  "trustName": "Scottish Mortgage Investment Trust",
  "ticker": "SMT.L",
  "isin": "GB0009349011",
  "shares": 5000,
  "averagePurchasePrice": {
    "amount": 8.50,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "currentSharePrice": {
    "amount": 9.25,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "premiumDiscount": -2.3,
  "yieldPercent": 0.8,
  "dividendPaymentSchedule": "Quarterly"
}
```

#### 13.3.5 Platform Accounts

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/investments/Platform-Account` | Create Platform Account | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Platform-Account` | List Platform Accounts | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Platform-Account/{arrangementId}` | Get Account details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/investments/Platform-Account/{arrangementId}` | Update Account | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/investments/Platform-Account/{arrangementId}` | Delete Account | `arrangements:write` |

**Platform-Specific Fields:**

```json
{
  "platformName": "Interactive Investor",
  "platformType": "DISCRETIONARY",
  "modelPortfolio": "Aggressive Growth Portfolio",
  "rebalancingFrequency": "QUARTERLY",
  "lastRebalance": "2026-01-15"
}
```

#### 13.3.6 Offshore Bonds

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/investments/Offshore-Bond` | Create Offshore Bond | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Offshore-Bond` | List Offshore Bonds | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Offshore-Bond/{arrangementId}` | Get Offshore Bond details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/investments/Offshore-Bond/{arrangementId}` | Update Offshore Bond | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/investments/Offshore-Bond/{arrangementId}` | Delete Offshore Bond | `arrangements:write` |

**Offshore Bond-Specific Fields:**

```json
{
  "bondJurisdiction": "IOM",
  "segments": 0,
  "foreignTaxCredit": {
    "amount": 0.00,
    "currency": {
        "code": "EUR",
        "display": "Euro",
        "symbol": "€"
      }
  },
  "currencyHedging": true,
  "reportableForUKTax": true,
  "topSlicingAvailable": true
}
```

#### 13.3.7 Cash Accounts

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/investments/Cash` | Create Cash Account | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Cash` | List Cash Accounts | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/investments/Cash/{arrangementId}` | Get Cash Account details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/investments/Cash/{arrangementId}` | Update Cash Account | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/investments/Cash/{arrangementId}` | Delete Cash Account | `arrangements:write` |

**Create Cash Account Request:**

```json
{
  "arrangementType": "Cash",
  "arrangementCategory": "INVESTMENT",
  "provider": {
    "name": "HSBC UK",
    "reference": "HSBC-UK-001",
    "contactDetails": {
      "phone": "0800 678 3456",
      "email": "customer.service@hsbc.co.uk",
      "website": "https://www.hsbc.co.uk"
    }
  },
  "accountType": "SavingsAccount",
  "accountNumber": "12345678",
  "sortCode": "40-47-84",
  "productName": "Advance Savings Account",
  "policyNumber": "POL-CASH-001",
  "purpose": "EmergencyFund",
  "owners": [
    {
      "client": { "id": 123 },
      "ownershipPercentage": 100.0
    }
  ],
  "sellingAdviser": {
    "id": 456,
    "name": "Jane Adviser",
    "firmName": "ABC Financial Services"
  },
  "agencyStatus": "NotUnderAgency",
  "agencyStatusDate": "2023-01-15",
  "currentBalance": {
    "amount": 15000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "interestRate": 4.50,
  "interestRateType": "Variable",
  "startDate": "2023-01-15",
  "endDate": null,
  "maturityDate": null,
  "lastUpdatedDate": "2026-02-18",
  "valuationDate": "2026-02-18",
  "taxWrapper": "Taxable",
  "status": "ACTIVE",
  "features": {
    "hasInstantAccess": true,
    "hasNoticeRequired": false,
    "noticePeriodDays": 0,
    "hasWithdrawalLimit": false,
    "monthlyWithdrawalLimit": null,
    "isFixedTerm": false,
    "termMonths": null
  },
  "interestPayment": {
    "frequency": "Monthly",
    "method": "PaidToAccount",
    "lastPaymentDate": "2026-02-01",
    "nextPaymentDate": "2026-03-01"
  }
}
```

**Response (201 Created):**

```json
{
  "id": 1,
  "href": "/api/v2/factfinds/ff-456/arrangements/investments/Cash/arr-cash-001",
  "arrangementType": "Cash",
  "arrangementCategory": "INVESTMENT",
  "provider": {
    "name": "HSBC UK",
    "reference": "HSBC-UK-001",
    "contactDetails": {
      "phone": "0800 678 3456",
      "email": "customer.service@hsbc.co.uk",
      "website": "https://www.hsbc.co.uk"
    }
  },
  "accountType": "SavingsAccount",
  "accountNumber": "12345678",
  "sortCode": "40-47-84",
  "productName": "Advance Savings Account",
  "policyNumber": "POL-CASH-001",
  "purpose": "EmergencyFund",
  "owners": [
    {
      "client": {
        "id": 123,
        "fullName": "John Smith",
        "href": "/api/v2/factfinds/ff-456/clients/123"
      },
      "ownershipPercentage": 100.0
    }
  ],
  "sellingAdviser": {
    "id": 456,
    "name": "Jane Adviser",
    "firmName": "ABC Financial Services",
    "href": "/api/v2/advisers/456"
  },
  "agencyStatus": "NotUnderAgency",
  "agencyStatusDate": "2023-01-15",
  "currentBalance": {
    "amount": 15000.00,
    "currency": { "code": "GBP", "symbol": "£", "display": "British Pound" }
  },
  "interestRate": 4.50,
  "interestRateType": "Variable",
  "startDate": "2023-01-15",
  "endDate": null,
  "maturityDate": null,
  "lastUpdatedDate": "2026-02-18",
  "valuationDate": "2026-02-18",
  "taxWrapper": "Taxable",
  "status": "ACTIVE",
  "features": {
    "hasInstantAccess": true,
    "hasNoticeRequired": false,
    "noticePeriodDays": 0,
    "hasWithdrawalLimit": false,
    "monthlyWithdrawalLimit": null,
    "isFixedTerm": false,
    "termMonths": null
  },
  "interestPayment": {
    "frequency": "Monthly",
    "method": "PaidToAccount",
    "lastPaymentDate": "2026-02-01",
    "nextPaymentDate": "2026-03-01"
  },
  "createdAt": "2023-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

**Cash Account-Specific Fields:**

```json
{
  "accountType": "SavingsAccount",
  "sortCode": "40-47-84",
  "interestRate": 4.50,
  "interestRateType": "Variable",
  "taxWrapper": "Taxable",
  "features": {
    "hasInstantAccess": true,
    "hasNoticeRequired": false,
    "noticePeriodDays": 0,
    "hasWithdrawalLimit": false,
    "monthlyWithdrawalLimit": null,
    "isFixedTerm": false,
    "termMonths": null
  },
  "interestPayment": {
    "frequency": "Monthly",
    "method": "PaidToAccount",
    "lastPaymentDate": "2026-02-01",
    "nextPaymentDate": "2026-03-01"
  }
}
```

**Account Type Codes:**

| Code | Display Name |
|------|-------------|
| `CashAccount` | Cash Account |
| `CashDeposit` | Cash Deposit |
| `CurrentAccount` | Current Account |
| `SavingsAccount` | Savings Account |

**Purpose Codes:**

| Code | Display Name |
|------|-------------|
| `EmergencyFund` | Emergency Fund |
| `Savings` | General Savings |
| `SpecificGoal` | Specific Goal |
| `IncomeReserve` | Income Reserve |
| `BusinessReserve` | Business Reserve |

**Agency Status Codes:**

| Code | Display Name |
|------|-------------|
| `NotUnderAgency` | Not Under Agency |
| `UnderAgencyInformationOnly` | Under Agency - Information Only |
| `UnderAgencyServicingAgent` | Under Agency - Servicing Agent |

**Interest Rate Type Codes:**

| Code | Display Name |
|------|-------------|
| `Fixed` | Fixed Rate |
| `Variable` | Variable Rate |
| `TrackerRate` | Tracker Rate |
| `TieredRate` | Tiered Rate |

**Interest Payment Frequency Codes:**

| Code | Display Name |
|------|-------------|
| `Monthly` | Monthly |
| `Quarterly` | Quarterly |
| `Annually` | Annually |
| `OnMaturity` | On Maturity |

**Interest Payment Method Codes:**

| Code | Display Name |
|------|-------------|
| `PaidToAccount` | Paid to Account |
| `Reinvested` | Reinvested |
| `PaidToExternalAccount` | Paid to External Account |

---

### 11.4 Pension Arrangements

**Base Path:** `/api/v2/factfinds/{factfindId}/arrangements/pensions`

**Purpose:** Manage all pension arrangements including workplace, personal, SIPPs, money purchase, defined benefit schemes, drawdown, and annuities.

**Common Pension Fields:**

```json
{
  "pensionType": "string (enum)",
  "employerContribution": "Money",
  "employeeContribution": "Money",
  "taxRelief": {
    "method": "string (enum)",
    "amount": "Money"
  },
  "crystallisedAmount": "Money",
  "uncrystallisedAmount": "Money",
  "protectedRights": "Money",
  "pensionCommencement": "date",
  "normalRetirementAge": "number",
  "projectedFund": {
    "atAge55": "Money",
    "atAge60": "Money",
    "atAge65": "Money",
    "atSPA": "Money"
  },
  "annualAllowance": {
    "standardAllowance": "Money",
    "usedThisYear": "Money",
    "carryForward": [
      {
        "taxYear": "string",
        "available": "Money"
      }
    ]
  },
  "lifetimeAllowance": {
    "standard": "Money",
    "used": "Money",
    "remaining": "Money",
    "hasProtection": "boolean",
    "protectionType": "string (enum)"
  }
}
```

#### 13.4.1 Personal Pension

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/pensions/personal-pension` | Create Personal Pension | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/personal-pension` | List Personal Pensions | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/personal-pension/{arrangementId}` | Get Personal Pension | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/pensions/personal-pension/{arrangementId}` | Update Personal Pension | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/pensions/personal-pension/{arrangementId}` | Delete Personal Pension | `arrangements:write` |

**Create Personal Pension Request:**

```json
{
  "arrangementType": "PERSONAL_PENSION",
  "provider": {
    "name": "Standard Life",
    "reference": "SL-UK-001",
    "contactDetails": {
      "phone": "0800 333 353",
      "email": "customer.services@standardlife.com"
    }
  },
  "policyNumber": "PP-12345678",
  "startDate": "2015-06-01",
  "currentValue": {
    "amount": 125000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "owners": [
    {
      "client": { "id": 123 },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "uncrystallisedAmount": {
    "amount": 125000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "crystallisedAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "regularContribution": {
    "grossAmount": {
      "amount": 625.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netAmount": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxRelief": {
      "amount": 125.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY"
  },
  "employeeContribution": {
    "amount": 500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "normalRetirementAge": 67,
  "selectedRetirementAge": 60,
  "projectedFund": {
    "atAge55": {
      "amount": 142000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "atAge60": {
      "amount": 175000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "atAge65": {
      "amount": 215000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "atAge67": {
      "amount": 235000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "investmentStrategy": {
    "riskProfile": "MODERATE",
    "lifestyling": true,
    "lifestylingStartAge": 55
  }
}
```

**Response (201 Created):**

```json
{
  "id": 3,
  "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003",
  "arrangementType": "PERSONAL_PENSION",
  "arrangementCategory": "PENSION",
  "provider": {
    "name": "Standard Life",
    "reference": "SL-UK-001",
    "contactDetails": {
      "phone": "0800 333 353",
      "email": "customer.services@standardlife.com"
    }
  },
  "policyNumber": "PP-12345678",
  "startDate": "2015-06-01",
  "currentValue": {
    "amount": 125000.00,
    "currency": { "code": "GBP", "symbol": "£", "display": "British Pound" }
  },
  "valuationDate": "2026-02-18",
  "owners": [
    {
      "client": {
        "id": 123,
        "fullName": "John Smith",
        "href": "/api/v2/factfinds/ff-456/clients/123"
      },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "uncrystallisedAmount": {
    "amount": 125000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "crystallisedAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxFreeCashAvailable": {
    "amount": 31250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "regularContribution": {
    "grossAmount": {
      "amount": 625.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netAmount": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxRelief": {
      "amount": 125.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY"
  },
  "employeeContribution": {
    "amount": 500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "annualContribution": {
    "amount": 7500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "normalRetirementAge": 67,
  "selectedRetirementAge": 60,
  "yearsToRetirement": 15,
  "projectedFund": {
    "atAge55": {
      "amount": 142000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "atAge60": {
      "amount": 175000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "atAge65": {
      "amount": 215000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "atAge67": {
      "amount": 235000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "investmentStrategy": {
    "riskProfile": "MODERATE",
    "lifestyling": true,
    "lifestylingStartAge": 55
  },
  "annualAllowance": {
    "taxYear": "2025/26",
    "standardAllowance": {
      "amount": 60000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "usedThisYear": {
      "amount": 7500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "remaining": {
      "amount": 52500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "concurrencyId": "g9d5e3c2-4h67-6g0d-1f5e-3c4d5e6f7g8h",
  "createdAt": "2026-02-18T10:40:00Z",
  "updatedAt": "2026-02-18T10:40:00Z",
    "factfind": { "href": "/api/v2/factfinds/ff-456" },
    "owner": { "href": "/api/v2/factfinds/ff-456/clients/123" },
    "contributions": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-pp-003/contributions" },
    "beneficiaries": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-pp-003/beneficiaries" },
    "valuations": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-pp-003/valuations" }
  }
}
```

**Validation Rules:**
- `arrangementType.code` - Required, must be "PERSONAL_PENSION"
- `provider.name` - Required
- `policyNumber` - Required
- `normalRetirementAge` - Required, typically 65-68
- Annual allowance tracking (£60,000 for 2025/26)
- Tapered annual allowance for high earners
- Tax-free cash capped at 25% of fund value

#### 13.4.2 State Pension

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/pensions/state-pension` | Create State Pension | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/state-pension` | List State Pensions | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/state-pension/{arrangementId}` | Get State Pension | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/pensions/state-pension/{arrangementId}` | Update State Pension | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/pensions/state-pension/{arrangementId}` | Delete State Pension | `arrangements:write` |

**State Pension-Specific Fields:**

```json
{
  "arrangementType": "STATE_PENSION",
  "nationalInsuranceNumber": "AB123456C",
  "qualifyingYears": 35,
  "yearsToStatePensionAge": 12,
  "statePensionAge": 67,
  "forecastAnnualAmount": {
    "amount": 11502.40,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "forecastWeeklyAmount": {
    "amount": 221.20,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "maxStatePension": {
    "amount": 11502.40,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "contracted Out": false,
  "deferralOptions": {
    "canDefer": true,
    "deferralIncrease": 5.8
  }
}
```

#### 13.4.3 Workplace Pension

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/pensions/workplace-pension` | Create Workplace Pension | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/workplace-pension` | List Workplace Pensions | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/workplace-pension/{arrangementId}` | Get Workplace Pension | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/pensions/workplace-pension/{arrangementId}` | Update Workplace Pension | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/pensions/workplace-pension/{arrangementId}` | Delete Workplace Pension | `arrangements:write` |

**Workplace Pension-Specific Fields:**

```json
{
  "employerName": "Tech Solutions Ltd",
  "employerRef": { "id": 456 },
  "employerContribution": {
    "percentage": 5.0,
    "amount": {
      "amount": 250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "employeeContribution": {
    "percentage": 5.0,
    "amount": {
      "amount": 250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "salaryForPension": {
    "amount": 60000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "salaryExchangeApplied": true,
  "autoEnrollmentDate": "2020-01-15",
  "optedOut": false
}
```

#### 13.4.4 SIPP (Self-Invested Personal Pension)

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/pensions/SIPP` | Create SIPP | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/SIPP` | List SIPPs | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/SIPP/{arrangementId}` | Get SIPP | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/pensions/SIPP/{arrangementId}` | Update SIPP | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/pensions/SIPP/{arrangementId}` | Delete SIPP | `arrangements:write` |

**SIPP-Specific Fields:**

```json
{
  "allowsCommercialProperty": true,
  "holdsCommercialProperty": false,
  "allowsDirectEquities": true,
  "directEquityHoldings": 15,
  "sippCharges": {
    "setupFee": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "annualFee": {
      "amount": 300.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "dealingCharges": {
      "amount": 9.95,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "investmentFlexibility": "HIGH"
}
```

#### 13.4.5 Final Salary (Defined Benefit)

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/pensions/final-salary` | Create Final Salary | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/final-salary` | List Final Salary Pensions | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/final-salary/{arrangementId}` | Get Final Salary | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/pensions/final-salary/{arrangementId}` | Update Final Salary | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/pensions/final-salary/{arrangementId}` | Delete Final Salary | `arrangements:write` |

**Create Final Salary Request:**

```json
{
  "arrangementType": "FINAL_SALARY",
  "provider": {
    "name": "NHS Pension Scheme",
    "reference": "NHS-PS-001"
  },
  "employer": "Royal London Hospital Trust",
  "sellingAdviser": {
    "id": 456,
    "name": "Jane Adviser",
    "firmName": "ABC Financial Services"
  },
  "agencyStatus": "NotUnderAgency",
  "agencyStatusDate": "2023-01-15",
  "productName": "NHS Pension Scheme (1995 Section)",
  "policyNumber": "NHS-DB-987654",
  "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
  "owners": [
    {
      "client": { "id": 123 },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "normalRetirementAge": 60,
  "earlyRetirementAge": 55,
  "accrualRate": "1/80th",
  "schemeType": "PUBLIC_SECTOR",
  "dateSchemeJoined": "1995-09-01",
  "expectedYearsOfService": 35.0,
  "totalService": 28.5,
  "pensionableService": 28.5,
  "additionalPurchasedYears": 0,
  "projectedServiceAtRetirement": 35.0,
  "pensionableSalary": {
    "amount": 65000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "finalSalary": {
    "amount": 65000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "projectedFinalSalary": {
    "amount": 72000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "isIndexed": true,
  "isPreserved": false,
  "prospectivePensionNoLumpSum": {
    "amount": 28875.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "prospectivePensionWithLumpSum": {
    "amount": 23100.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "prospectiveLumpSum": {
    "amount": 69300.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "gmpAmount": {
    "amount": 1250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "spousePension": {
    "percentage": 50.0,
    "amount": {
      "amount": 11550.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "escalationRate": "CPI",
  "escalationPercentage": 2.5,
  "revaluationMethod": "CAREER_AVERAGE",
  "cashEquivalentTransferValue": {
    "amount": 950000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "cetvDate": "2026-01-15",
  "transferValueExpiryDate": "2026-04-15",
  "transferAdviceRequired": true,
  "deathInServiceSpousalBenefits": "Spouse receives 50% of prospective pension plus return of contributions",
  "dependantBenefits": "Children's pensions available until age 23 if in full-time education",
  "earlyRetirementFactorConsiderations": "3% reduction per year before age 60. No early retirement permitted before age 55.",
  "canPurchaseAddedYears": true,
  "hasAffinityDCScheme": false,
  "indexationNotes": "CPI linked annual increases, capped at 5% p.a. Applied from scheme retirement date.",
  "additionalNotes": "Protected rights from pre-1997 contracting out included. Member has option to transfer to 2015 CARE scheme."
}
```

**Response (201 Created):**

```json
{
  "id": 4,
  "href": "/api/v2/factfinds/ff-456/arrangements/pensions/final-salary/arr-db-004",
  "arrangementType": "FINAL_SALARY",
  "arrangementCategory": "PENSION",
  "provider": {
    "name": "NHS Pension Scheme",
    "reference": "NHS-PS-001",
    "href": "/api/v2/providers/NHS-PS-001"
  },
  "employer": "Royal London Hospital Trust",
  "sellingAdviser": {
    "id": 456,
    "name": "Jane Adviser",
    "firmName": "ABC Financial Services",
    "href": "/api/v2/advisers/456"
  },
  "agencyStatus": "NotUnderAgency",
  "agencyStatusDate": "2023-01-15",
  "productName": "NHS Pension Scheme (1995 Section)",
  "policyNumber": "NHS-DB-987654",
  "currency": {
    "code": "GBP",
    "symbol": "£",
    "display": "British Pound"
  },
  "currentValue": {
    "amount": 950000.00,
    "currency": { "code": "GBP", "symbol": "£", "display": "British Pound" }
  },
  "valuationDate": "2026-01-15",
  "valuationType": "CETV",
  "owners": [
    {
      "client": {
        "id": 123,
        "fullName": "John Smith",
        "href": "/api/v2/factfinds/ff-456/clients/123"
      },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "normalRetirementAge": 60,
  "earlyRetirementAge": 55,
  "accrualRate": "1/80th",
  "schemeType": "PUBLIC_SECTOR",
  "dateSchemeJoined": "1995-09-01",
  "expectedYearsOfService": 35.0,
  "totalService": 28.5,
  "pensionableService": 28.5,
  "additionalPurchasedYears": 0,
  "projectedServiceAtRetirement": 35.0,
  "yearsToNormalRetirement": 6.5,
  "pensionableSalary": {
    "amount": 65000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "finalSalary": {
    "amount": 65000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "projectedFinalSalary": {
    "amount": 72000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "isIndexed": true,
  "isPreserved": false,
  "prospectivePensionNoLumpSum": {
    "amount": 28875.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "prospectivePensionWithLumpSum": {
    "amount": 23100.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "prospectiveLumpSum": {
    "amount": 69300.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "gmpAmount": {
    "amount": 1250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "spousePension": {
    "percentage": 50.0,
    "amount": {
      "amount": 11550.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "escalationRate": "CPI",
  "escalationPercentage": 2.5,
  "lifetimeValue": {
    "amount": 462000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "revaluationMethod": "CAREER_AVERAGE",
  "cashEquivalentTransferValue": {
    "amount": 950000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "cetvDate": "2026-01-15",
  "transferValueExpiryDate": "2026-04-15",
  "cetvMultiple": 41.1,
  "transferAdviceRequired": true,
  "adviceThreshold": {
    "amount": 30000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "deathInServiceSpousalBenefits": "Spouse receives 50% of prospective pension plus return of contributions",
  "dependantBenefits": "Children's pensions available until age 23 if in full-time education",
  "earlyRetirementFactorConsiderations": "3% reduction per year before age 60. No early retirement permitted before age 55.",
  "canPurchaseAddedYears": true,
  "hasAffinityDCScheme": false,
  "indexationNotes": "CPI linked annual increases, capped at 5% p.a. Applied from scheme retirement date.",
  "additionalNotes": "Protected rights from pre-1997 contracting out included. Member has option to transfer to 2015 CARE scheme.",
  "riskWarnings": [
    "Transfer value exceeds £30,000 - FCA regulated advice mandatory",
    "Loss of guaranteed income for life",
    "Loss of spouse's pension benefits",
    "Loss of inflation protection (CPI escalation)",
    "Scheme funded by employer - reduced counterparty risk"
  ],
  "concurrencyId": "h0e6f4d3-5i78-7h1e-2g6f-4d5e6f7g8h9i",
  "createdAt": "2026-02-18T10:45:00Z",
  "updatedAt": "2026-02-18T10:45:00Z",
    "factfind": { "href": "/api/v2/factfinds/ff-456" },
    "owner": { "href": "/api/v2/factfinds/ff-456/clients/123" },
    "provider": { "href": "/api/v2/providers/NHS-PS-001" },
    "sellingAdviser": { "href": "/api/v2/advisers/456" },
    "beneficiaries": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-db-004/beneficiaries" },
    "valuations": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-db-004/valuations" }
  }
}
```

**Enum Tables:**

**Agency Status Codes:**

| Code | Display Name |
|------|-------------|
| `NotUnderAgency` | Not Under Agency |
| `UnderAgencyInformationOnly` | Under Agency - Information Only |
| `UnderAgencyServicingAgent` | Under Agency - Servicing Agent |

**Scheme Type Codes:**

| Code | Display Name | Description |
|------|-------------|-------------|
| `PUBLIC_SECTOR` | Public Sector DB | NHS, Teachers, Civil Service, Police, Fire |
| `PRIVATE_SECTOR` | Private Sector DB | Corporate final salary schemes |
| `FUNDED` | Funded DB | Scheme backed by separate fund |
| `UNFUNDED` | Unfunded DB | Pay-as-you-go, typically public sector |
| `CARE` | Career Average (CARE) | Career Average Revalued Earnings |
| `HYBRID` | Hybrid DB/DC | Mixed benefit structure |

**Escalation Rate Codes:**

| Code | Display Name |
|------|-------------|
| `CPI` | CPI (Consumer Price Index) |
| `RPI` | RPI (Retail Price Index) |
| `LPI` | LPI (Limited Price Indexation) |
| `FIXED` | Fixed Rate Escalation |
| `NONE` | No Escalation |
| `SECTION_148` | Section 148 Orders |

**Revaluation Method Codes:**

| Code | Display Name |
|------|-------------|
| `FINAL_SALARY` | Final Salary |
| `CAREER_AVERAGE` | Career Average Revalued Earnings (CARE) |
| `AVERAGE_SALARY` | Average Salary |
| `BEST_CONSECUTIVE` | Best Consecutive Years |

**Preservation Status Codes:**

| Code | Display Name | Description |
|------|-------------|-------------|
| `ACTIVE` | Active - In Service | Member actively accruing benefits |
| `DEFERRED` | Deferred / Preserved | Member left scheme, benefits preserved |
| `PENSIONER` | Pensioner | Member retired, receiving pension |
| `EARLY_LEAVER` | Early Leaver - Transferred Out | Benefits transferred to another scheme |

**Validation Rules:**
- `arrangementType` - Required, must be "FINAL_SALARY"
- `provider.name` - Required
- `productName` - Required (scheme name)
- `policyNumber` - Required
- `owners` - Required, at least one owner with sum of ownershipPercentage = 100
- `normalRetirementAge` - Required, must be between 55 and 75
- `accrualRate` - Required (e.g., "1/60th", "1/80th", "1/120th")
- `dateSchemeJoined` - Required, must be a past date
- `pensionableSalary` - Required if status is ACTIVE
- At least one prospective pension field required (NoLumpSum or WithLumpSum)
- `cashEquivalentTransferValue` - Required if transfer being considered
- `transferValueExpiryDate` - Required if CETV provided (typically 3 months from CETV date)
- Transfer advice mandatory if CETV > £30,000 (FCA requirement)
- `isIndexed` - Required boolean
- `isPreserved` - Required boolean
- `spousePension.percentage` - Typically 50% or 66.67%
- `escalationRate` - Required if `isIndexed` = true
- `gmpAmount` - Required if member has guaranteed minimum pension rights
- `canPurchaseAddedYears` - Required boolean
- `hasAffinityDCScheme` - Required boolean

**Business Rules:**
- CETV multiple calculated as CETV / Annual Pension (prospectivePensionWithLumpSum)
- Typical DB multipliers: 20-25x for good schemes, 30-40x+ for transfer incentives
- Transfer advice required by FCA if CETV exceeds £30,000
- Early retirement reductions typically 3-5% per year before NRA
- Protected rights tracking for pre-1997 contracting out (include in additionalNotes)
- Pension input amount tracking for annual allowance purposes
- `yearsToNormalRetirement` - Calculated field: normalRetirementAge - member's current age
- `lifetimeValue` - Calculated: prospectivePensionWithLumpSum × expected years in retirement
- Provider vs Employer distinction:
  - `provider` = Pension scheme administrator (e.g., "NHS Pension Scheme")
  - `employer` = Actual employer organization (e.g., "Royal London Hospital Trust")
- Prospective pension calculations:
  - `prospectivePensionNoLumpSum` = Maximum annual pension if no lump sum taken
  - `prospectivePensionWithLumpSum` = Reduced annual pension if maximum lump sum taken
  - `prospectiveLumpSum` = Maximum tax-free lump sum available (typically 3x reduced pension)
- GMP (Guaranteed Minimum Pension):
  - Applies to members who contracted out of SERPS/S2P before April 2016
  - Must be paid at least at GMP rate from State Pension Age
  - Different escalation rules apply (fixed for pre-1988, capped at 3% for post-1988)
- Indexation:
  - Public sector schemes typically CPI-linked, often capped at 2.5% or 5%
  - Private sector schemes may have LPI (Limited Price Indexation) capped at 2.5%, 3%, or 5%
  - Escalation applies from retirement, not during deferment (unless CARE scheme)
- Added Years:
  - Some schemes allow purchase of additional years of service
  - Cost typically calculated by scheme actuary based on age and service
  - `canPurchaseAddedYears` indicates if this option is available
- Affinity DC Scheme:
  - Some DB schemes offer additional voluntary contributions (AVCs) via DC arrangement
  - `hasAffinityDCScheme` indicates if this option is available
  - If true, consider creating separate Personal Pension arrangement for AVC pot

**Field Mapping (Legacy to New):**

| Legacy Field Name | New Field Name | Notes |
|-------------------|----------------|-------|
| `startDate` | `dateSchemeJoined` | Clarifies this is scheme join date, not policy start |
| `schemeDetails.schemeName` | `productName` | Flattened, consistent with investment pattern |
| `schemeDetails.schemeType` | `schemeType` | Flattened |
| `schemeDetails.accrualRate` | `accrualRate` | Flattened |
| `schemeDetails.normalRetirementAge` | `normalRetirementAge` | Flattened |
| `schemeDetails.earlyRetirementAge` | `earlyRetirementAge` | Flattened |
| `schemeDetails.employerName` | `employer` | Flattened, renamed for consistency |
| `serviceDetails.totalService` | `totalService` | Flattened |
| `serviceDetails.pensionableService` | `pensionableService` | Flattened |
| `serviceDetails.additionalPurchasedYears` | `additionalPurchasedYears` | Flattened |
| `serviceDetails.projectedServiceAtRetirement` | `projectedServiceAtRetirement` | Flattened |
| `salaryDetails.currentPensionableSalary` | `pensionableSalary` | Flattened, renamed to match screenshot |
| `salaryDetails.finalSalary` | `finalSalary` | Flattened |
| `salaryDetails.projectedFinalSalary` | `projectedFinalSalary` | Flattened |
| `benefitDetails.guaranteedAnnualPension` | `prospectivePensionWithLumpSum` | Renamed to match screenshot label |
| `benefitDetails.taxFreeLumpSum` | `prospectiveLumpSum` | Renamed to match screenshot label |
| `benefitDetails.spousePension` | `spousePension` | Flattened |
| `benefitDetails.escalationRate` | `escalationRate` | Flattened |
| `benefitDetails.escalationPercentage` | `escalationPercentage` | Flattened |
| `transferValue.cetv` | `cashEquivalentTransferValue` | Flattened, full name for clarity |
| `transferValue.cetvDate` | `cetvDate` | Flattened |
| `transferValue.cetvExpiry` | `transferValueExpiryDate` | Flattened, renamed to match screenshot |
| N/A (new) | `prospectivePensionNoLumpSum` | New field from screenshot |
| N/A (new) | `gmpAmount` | New field from screenshot |
| N/A (new) | `isIndexed` | New boolean from screenshot |
| N/A (new) | `isPreserved` | New boolean from screenshot |
| N/A (new) | `deathInServiceSpousalBenefits` | New text field from screenshot |
| N/A (new) | `earlyRetirementFactorConsiderations` | New textarea from screenshot |
| N/A (new) | `dependantBenefits` | New text field from screenshot |
| N/A (new) | `canPurchaseAddedYears` | New boolean from screenshot |
| N/A (new) | `hasAffinityDCScheme` | New boolean from screenshot |
| N/A (new) | `indexationNotes` | New textarea from screenshot |
| N/A (new) | `additionalNotes` | New textarea from screenshot |
| N/A (new) | `sellingAdviser` | New object - matches investment pattern |
| N/A (new) | `agencyStatus` | New field - matches investment pattern |
| N/A (new) | `agencyStatusDate` | New field - matches investment pattern |
| N/A (new) | `employer` | New field - separate from provider |
| N/A (new) | `expectedYearsOfService` | New field from screenshot |

**Example: Preserved Final Salary Pension (Deferred Member)**

```json
{
  "id": 5,
  "href": "/api/v2/factfinds/ff-456/arrangements/pensions/final-salary/arr-db-005",
  "arrangementType": "FINAL_SALARY",
  "arrangementCategory": "PENSION",
  "provider": {
    "name": "Aviva Master Trust",
    "reference": "AVIVA-DB-001"
  },
  "employer": "Former Employer Ltd (scheme closed)",
  "sellingAdviser": null,
  "agencyStatus": null,
  "productName": "Company Pension Scheme",
  "policyNumber": "AVIVA-DB-445566",
  "currency": {
    "code": "GBP",
    "symbol": "£",
    "display": "British Pound"
  },
  "owners": [
    {
      "client": {
        "id": 125,
        "fullName": "Sarah Jones",
        "href": "/api/v2/factfinds/ff-456/clients/125"
      },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "DEFERRED",
  "normalRetirementAge": 65,
  "earlyRetirementAge": 55,
  "accrualRate": "1/60th",
  "schemeType": "PRIVATE_SECTOR",
  "dateSchemeJoined": "2005-04-01",
  "dateLeft": "2018-08-31",
  "expectedYearsOfService": 13.4,
  "totalService": 13.4,
  "pensionableService": 13.4,
  "additionalPurchasedYears": 0,
  "projectedServiceAtRetirement": 13.4,
  "yearsToNormalRetirement": 18.5,
  "pensionableSalary": {
    "amount": 42000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "finalSalary": {
    "amount": 42000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "projectedFinalSalary": {
    "amount": 42000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "isIndexed": true,
  "isPreserved": true,
  "prospectivePensionNoLumpSum": {
    "amount": 9380.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "prospectivePensionWithLumpSum": {
    "amount": 7035.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "prospectiveLumpSum": {
    "amount": 21105.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "gmpAmount": {
    "amount": 650.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "spousePension": {
    "percentage": 50.0,
    "amount": {
      "amount": 3517.50,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "escalationRate": "LPI",
  "escalationPercentage": 2.5,
  "revaluationMethod": "FINAL_SALARY",
  "cashEquivalentTransferValue": {
    "amount": 185000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "cetvDate": "2026-01-20",
  "transferValueExpiryDate": "2026-04-20",
  "cetvMultiple": 26.3,
  "transferAdviceRequired": true,
  "deathInServiceSpousalBenefits": "N/A - member no longer in service",
  "dependantBenefits": "Spouse receives 50% pension. No children's pensions.",
  "earlyRetirementFactorConsiderations": "5% reduction per year before age 65 (actuarially reduced). Scheme consent required for retirement before 60.",
  "canPurchaseAddedYears": false,
  "hasAffinityDCScheme": false,
  "indexationNotes": "LPI (CPI capped at 2.5% p.a.) on pension in payment. Deferred revaluation at Section 148 orders (currently CPI capped at 5%).",
  "additionalNotes": "Scheme closed to future accrual in 2015. All deferred members. GMP element from pre-1997 service.",
  "riskWarnings": [
    "Transfer value exceeds £30,000 - FCA regulated advice mandatory",
    "Loss of guaranteed income for life",
    "Loss of spouse's pension benefits",
    "Private sector scheme - potential employer covenant risk",
    "Scheme closed - may have higher transfer values to encourage transfers"
  ],
    "factfind": { "href": "/api/v2/factfinds/ff-456" },
    "owner": { "href": "/api/v2/factfinds/ff-456/clients/125" },
    "provider": { "href": "/api/v2/providers/AVIVA-DB-001" },
    "beneficiaries": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-db-005/beneficiaries" },
    "valuations": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-db-005/valuations" }
  }
}
```

#### 13.4.6 Pension Drawdown

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/pensions/drawdown` | Create Drawdown | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/drawdown` | List Drawdowns | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/drawdown/{arrangementId}` | Get Drawdown | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/pensions/drawdown/{arrangementId}` | Update Drawdown | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/pensions/drawdown/{arrangementId}` | Delete Drawdown | `arrangements:write` |

**Drawdown-Specific Fields:**

```json
{
  "crystallisedAmount": {
    "amount": 180000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxFreeCashTaken": {
    "amount": 60000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "drawdownIncome": {
    "annualAmount": {
      "amount": 12000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "nextReviewDate": "2026-06-01"
  },
  "sustainabilityAnalysis": {
    "projectedDepletionAge": 88,
    "sustainableWithdrawalRate": 4.2,
    "currentWithdrawalRate": 6.7
  },
  "moneyPurchaseAnnualAllowance": {
    "triggered": true,
    "allowance": {
      "amount": 10000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  }
}
```

#### 13.4.7 Annuity

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/pensions/annuity` | Create Annuity | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/annuity` | List Annuities | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/annuity/{arrangementId}` | Get Annuity | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/pensions/annuity/{arrangementId}` | Update Annuity | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/pensions/annuity/{arrangementId}` | Delete Annuity | `arrangements:write` |

**Annuity-Specific Fields:**

```json
{
  "annuityType": "LIFETIME",
  "guaranteedAnnualIncome": {
    "amount": 8500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "paymentFrequency": "MONTHLY",
  "escalation": {
    "type": "RPI",
    "rate": 3.0,
    "cappedAt": 5.0
  },
  "guaranteePeriod": {
    "years": 5,
    "endsOn": "2030-03-15"
  },
  "spouseBenefit": {
    "percentage": 66.67,
    "amount": {
      "amount": 5666.95,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "overlayBenefits": {
    "hasValueProtection": true,
    "hasGuaranteePeriod": true
  },
  "purchaseDetails": {
    "fundUsed": {
      "amount": 180000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "purchaseDate": "2025-03-15",
    "annuityRate": 4.72
  }
}
```

#### 13.4.8 Money Purchase

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/pensions/money-purchase` | Create Money Purchase | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/money-purchase` | List Money Purchase Pensions | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/pensions/money-purchase/{arrangementId}` | Get Money Purchase | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/pensions/money-purchase/{arrangementId}` | Update Money Purchase | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/pensions/money-purchase/{arrangementId}` | Delete Money Purchase | `arrangements:write` |

**Create Money Purchase Request:**

```json
{
  "arrangementType": "MONEY_PURCHASE",
  "provider": {
    "name": "Scottish Widows",
    "reference": "SW-001"
  },
  "employer": "ABC Corporation Ltd",
  "sellingAdviser": {
    "id": 789,
    "name": "Michael Smith",
    "firmName": "XYZ Wealth Management"
  },
  "agencyStatus": "NotUnderAgency",
  "agencyStatusDate": "2023-01-15",
  "contractType": "MoneyPurchaseContracted",
  "productName": "Executive Pension Plan",
  "policyNumber": "EPP-123456",
  "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
  "owners": [
    {
      "client": { "id": 123 },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "dateSchemeJoined": "2018-03-15",
  "retirementAge": 65,
  "taxWrapper": "RegisteredPension",
  "isIndexed": true,
  "isPreserved": false,
  "hasLifestylingStrategy": true,
  "currentValue": {
    "amount": 125000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "regularContributions": {
    "memberContribution": {
      "amount": 400.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "employerContribution": {
      "amount": 800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "Monthly"
  },
  "lumpSumContributions": {
    "amount": 5000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "employerMatchingDetails": "Employer matches up to 5% of salary. Additional 1% discretionary contribution if company performance targets met.",
  "gmpAmount": {
    "amount": 850.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "enhancedTaxFreeCash": {
    "amount": 45000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "guaranteedAnnuityRate": "4.5% at age 65 for single life annuity",
  "applicablePenalties": "Early exit penalty of 5% if withdrawn within 5 years of policy start date",
  "erfLoyaltyBonusTerminalBonus": "Terminal bonus of 0.5% added at retirement if policy held for 10+ years",
  "guaranteedGrowthRates": "Guaranteed 3% p.a. for first 5 years, then standard fund growth",
  "deathInServiceSpousalBenefits": "4x salary lump sum plus fund value payable to nominated beneficiaries",
  "deathBenefits": "Fund value payable to nominated beneficiaries tax-free before age 75. Subject to 45% tax after age 75.",
  "lifetimeAllowanceUsed": 45.5,
  "lifestylingStrategyDetails": "Automatic switch from equity funds to bonds and cash starting at age 60, completing by age 65",
  "optionsAtRetirement": "Full drawdown, phased drawdown, annuity purchase, or UFPLS (Uncrystallised Funds Pension Lump Sum) available. No obligation to purchase annuity.",
  "otherBenefitsOrMaterialFeatures": "Access to discounted fund platform with 0.2% p.a. rebate. Annual review included. Free switching between funds. Waiver of premium in event of critical illness.",
  "additionalNotes": "Policy includes protected tax-free cash rights from A-Day (6 April 2006) giving enhanced 30% tax-free entitlement instead of standard 25%."
}
```

**Response (201 Created):**

```json
{
  "id": 1,
  "href": "/api/v2/factfinds/ff-456/arrangements/pensions/money-purchase/arr-mp-001",
  "arrangementType": "MONEY_PURCHASE",
  "arrangementCategory": "PENSION",
  "provider": {
    "name": "Scottish Widows",
    "reference": "SW-001",
    "href": "/api/v2/providers/SW-001"
  },
  "employer": "ABC Corporation Ltd",
  "sellingAdviser": {
    "id": 789,
    "name": "Michael Smith",
    "firmName": "XYZ Wealth Management",
    "href": "/api/v2/advisers/789"
  },
  "agencyStatus": "NotUnderAgency",
  "agencyStatusDate": "2023-01-15",
  "contractType": "MoneyPurchaseContracted",
  "productName": "Executive Pension Plan",
  "policyNumber": "EPP-123456",
  "currency": {
    "code": "GBP",
    "symbol": "£",
    "display": "British Pound"
  },
  "owners": [
    {
      "client": {
        "id": 123,
        "fullName": "John Smith",
        "href": "/api/v2/factfinds/ff-456/clients/123"
      },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "dateSchemeJoined": "2018-03-15",
  "retirementAge": 65,
  "taxWrapper": "RegisteredPension",
  "isIndexed": true,
  "isPreserved": false,
  "hasLifestylingStrategy": true,
  "currentValue": {
    "amount": 125000.00,
    "currency": { "code": "GBP", "symbol": "£", "display": "British Pound" }
  },
  "valuationDate": "2026-02-18",
  "valuationType": "STATEMENT",
  "regularContributions": {
    "memberContribution": {
      "amount": 400.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "employerContribution": {
      "amount": 800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalMonthlyContribution": {
      "amount": 1200.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "annualisedContribution": {
      "amount": 14400.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "Monthly"
  },
  "lumpSumContributions": {
    "amount": 5000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "employerMatchingDetails": "Employer matches up to 5% of salary. Additional 1% discretionary contribution if company performance targets met.",
  "gmpAmount": {
    "amount": 850.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "enhancedTaxFreeCash": {
    "amount": 45000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "guaranteedAnnuityRate": "4.5% at age 65 for single life annuity",
  "applicablePenalties": "Early exit penalty of 5% if withdrawn within 5 years of policy start date",
  "erfLoyaltyBonusTerminalBonus": "Terminal bonus of 0.5% added at retirement if policy held for 10+ years",
  "guaranteedGrowthRates": "Guaranteed 3% p.a. for first 5 years, then standard fund growth",
  "deathInServiceSpousalBenefits": "4x salary lump sum plus fund value payable to nominated beneficiaries",
  "deathBenefits": "Fund value payable to nominated beneficiaries tax-free before age 75. Subject to 45% tax after age 75.",
  "lifetimeAllowanceUsed": 45.5,
  "lifestylingStrategyDetails": "Automatic switch from equity funds to bonds and cash starting at age 60, completing by age 65",
  "optionsAtRetirement": "Full drawdown, phased drawdown, annuity purchase, or UFPLS (Uncrystallised Funds Pension Lump Sum) available. No obligation to purchase annuity.",
  "otherBenefitsOrMaterialFeatures": "Access to discounted fund platform with 0.2% p.a. rebate. Annual review included. Free switching between funds. Waiver of premium in event of critical illness.",
  "additionalNotes": "Policy includes protected tax-free cash rights from A-Day (6 April 2006) giving enhanced 30% tax-free entitlement instead of standard 25%.",
  "projections": {
    "assumedGrowthRate": 5.0,
    "projectedValueAtRetirement": {
      "amount": 285000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "yearsToRetirement": 17.2
  },
  "annualAllowanceTracking": {
    "currentTaxYear": {
      "year": "2025/26",
      "contributionsToDate": {
        "amount": 19400.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "availableAllowance": {
        "amount": 40000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "carryForwardAvailable": {
        "amount": 15000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    }
  },
  "concurrencyId": "k3g7h9i2-9j12-5k8l-6m4n-8o9p1q2r3s4t",
  "createdAt": "2026-02-18T14:30:00Z",
  "updatedAt": "2026-02-18T14:30:00Z",
    "factfind": { "href": "/api/v2/factfinds/ff-456" },
    "owner": { "href": "/api/v2/factfinds/ff-456/clients/123" },
    "provider": { "href": "/api/v2/providers/SW-001" },
    "sellingAdviser": { "href": "/api/v2/advisers/789" },
    "beneficiaries": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-mp-001/beneficiaries" },
    "valuations": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-mp-001/valuations" },
    "contributions": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-mp-001/contributions" }
  }
}
```

**Enum Tables:**

**Contract Type Codes:**

| Code | Display Name |
|------|-------------|
| `AppropriatePersonalPension` | Appropriate Personal Pension |
| `AVS` | AVS |
| `CIMP` | CIMP |
| `COMP` | COMP |
| `EPABS` | EPABS |
| `ExecutivePensionPlan` | Executive Pension Plan |
| `FlexibleBenefits` | Flexible Benefits |
| `FUIBBS` | FUIBBS |
| `GroupCIMP` | Group CIMP |
| `GroupCOMP` | Group COMP |
| `GroupDependantsPension` | Group Dependants Pension |
| `GroupOffshorePensionScheme` | Group Offshore Pension Scheme |
| `GroupPersonalPension` | Group Personal Pension |
| `GroupS32BuyoutBond` | Group S32 Buyout Bond |
| `GroupSIPP` | Group SIPP |
| `GroupStakeholderPension` | Group Stakeholder Pension |
| `MasterTrustPension` | Master Trust Pension |
| `MoneyPurchaseContracted` | Money Purchase Contracted |
| `OMUPS` | OMUPS |
| `ORDPS` | ORDPS |
| `ROFPS` | ROFPS |
| `SSAS` | SSAS |
| `TrusteeInvestmentPlan` | Trustee Investment Plan |
| `TUMBS` | TUMBS |
| `WorkplacePensionScheme` | Workplace Pension Scheme |

**Agency Status Codes:**

| Code | Display Name |
|------|-------------|
| `NotUnderAgency` | Not Under Agency |
| `UnderAgencyInformationOnly` | Under Agency - Information Only |
| `UnderAgencyServicingAgent` | Under Agency - Servicing Agent |

**Contribution Frequency Codes:**

| Code | Display Name |
|------|-------------|
| `Monthly` | Monthly |
| `Quarterly` | Quarterly |
| `HalfYearly` | Half-Yearly |
| `Annually` | Annually |
| `Single` | Single Premium |
| `Irregular` | Irregular |

**Tax Wrapper Codes:**

| Code | Display Name | Description |
|------|-------------|-------------|
| `RegisteredPension` | Registered Pension | Standard UK registered pension scheme |
| `SIPP` | SIPP | Self-Invested Personal Pension |
| `SSAS` | SSAS | Small Self-Administered Scheme |
| `QualifyingRecognisedOverseasPensionScheme` | QROPS | Qualifying Recognised Overseas Pension Scheme |
| `Section32BuyOut` | Section 32 Buy-Out | Section 32 buy-out policy |
| `StakeholderPension` | Stakeholder Pension | Stakeholder pension scheme |

**Status Codes:**

| Code | Display Name | Description |
|------|-------------|-------------|
| `ACTIVE` | Active - Contributing | Member actively contributing to scheme |
| `ACTIVE_NON_CONTRIBUTING` | Active - Non-Contributing | Member still employed but not contributing |
| `PRESERVED` | Preserved | Member left scheme, benefits preserved |
| `PAID_UP` | Paid-Up | No further contributions, fund remains invested |
| `IN_DRAWDOWN` | In Drawdown | Member taking income via drawdown |
| `CRYSTALLISED` | Crystallised | Benefits accessed but not fully withdrawn |
| `CLOSED` | Closed | Policy closed or transferred out |

**Validation Rules:**

- `arrangementType` - Required, must be "MONEY_PURCHASE"
- `provider.name` - Required
- `productName` - Required
- `policyNumber` - Required
- `contractType` - Required, must be valid Contract Type Code
- `owners` - Required, at least one owner with sum of ownershipPercentage = 100
- `dateSchemeJoined` - Required, must be a past date
- `retirementAge` - Required, must be between 55 and 75
- `currency` - Required
- `currentValue` - Required if policy has accumulated value
- `valuationDate` - Required if currentValue provided, must be within last 12 months
- `taxWrapper` - Required
- `isIndexed` - Required boolean
- `isPreserved` - Required boolean
- `hasLifestylingStrategy` - Required boolean
- `regularContributions` - At least one of memberContribution or employerContribution required if status is ACTIVE
- `regularContributions.frequency` - Required if regularContributions provided
- `lifestylingStrategyDetails` - Recommended if hasLifestylingStrategy = true
- `lifetimeAllowanceUsed` - If provided, must be between 0 and 100 (percentage)
- `gmpAmount` - Required only if member has contracted-out rights pre-April 2016
- `enhancedTaxFreeCash` - Optional, only if member has protected rights from pre-A-Day
- `agencyStatus` - Optional, but if provided must be valid Agency Status Code
- `agencyStatusDate` - Required if agencyStatus provided

**Business Rules:**

**Employer Matching:**
- Employer matching details should clearly state the matching formula
- Total employer contribution may include base contribution plus matching
- Some schemes have tiered matching (e.g., 100% match up to 3%, then 50% match from 3-5%)
- `employerMatchingDetails` should capture all matching tiers and conditions

**Annual Allowance:**
- Standard annual allowance is £60,000 (2025/26 tax year)
- Tapered annual allowance may apply for high earners (adjusted income > £260,000)
- Money Purchase Annual Allowance (MPAA) of £10,000 applies if member has triggered it
- Unused allowance can be carried forward from previous 3 tax years
- Total contributions (member + employer + third party) count toward annual allowance
- Tax relief applies automatically for pension contributions up to 100% of earnings

**Lifetime Allowance:**
- Lifetime Allowance was abolished from 6 April 2024
- `lifetimeAllowanceUsed` percentage is relevant only for historical tracking
- Protected rights (LTA protections) still apply: Fixed Protection, Individual Protection, etc.
- Enhanced tax-free cash rights from protections should be noted in `enhancedTaxFreeCash`

**GMP (Guaranteed Minimum Pension):**
- Applies to members who contracted out of SERPS/S2P between 1978-1997
- Must be paid at State Pension Age at minimum GMP rate
- Different indexation rules: none for pre-1988 GMP, 3% for post-1988 GMP
- Include in `gmpAmount` as annual pension amount

**Enhanced Tax-Free Cash:**
- Standard tax-free cash is 25% of fund value
- Protected rights may allow higher percentage (e.g., 30% or fixed amount)
- Primary Protection (before A-Day 2006) may give enhanced entitlement
- Record protected amount in `enhancedTaxFreeCash` field

**Guaranteed Annuity Rates (GAR):**
- Valuable benefit if guaranteed rate significantly exceeds current market rates
- Example: "4.5% at age 65" means £4,500 p.a. income per £100,000 fund value
- Should be highlighted in adviser notes if GAR is materially valuable
- Consider impact on transfer value and retirement options

**Penalties:**
- Early exit penalties typically apply within first 5-10 years
- Market Value Reduction (MVR) may apply to with-profits funds
- Surrender penalties may be tiered (e.g., 5% year 1, reducing to 0% by year 5)
- Record all penalty structures in `applicablePenalties`

**ERF/Loyalty/Terminal Bonuses:**
- Enhancement Reserve Fund (ERF) payments may apply at retirement
- Loyalty bonuses reward long-term policy holding
- Terminal bonuses added at retirement for with-profits policies
- Include details and conditions in `erfLoyaltyBonusTerminalBonus`

**Guaranteed Growth Rates:**
- Some older policies guarantee minimum growth rates (e.g., 3% p.a.)
- Time-limited guarantees should specify duration
- Very valuable in low interest rate environment
- Include exact terms in `guaranteedGrowthRates`

**Death Benefits:**
- Pre-age 75: Fund value typically payable tax-free to beneficiaries
- Post-age 75: Fund value subject to beneficiary's marginal income tax rate (or 45% lump sum tax)
- Death in service benefits may include multiple of salary
- Spousal benefits may include ongoing pension or lump sum
- Record both death in service and standard death benefits separately

**Lifestyling Strategy:**
- Automatic de-risking approach as retirement approaches
- Typically switches from equities to bonds/cash over 5-10 years before retirement
- Should specify trigger age, completion age, and asset allocation glide path
- Member should review suitability, especially if not purchasing annuity
- If `hasLifestylingStrategy` = true, provide details in `lifestylingStrategyDetails`

**Options at Retirement:**
- Since pension freedoms (2015), members have full flexibility:
  - Full drawdown: Leave invested, take income as needed
  - Phased drawdown: Crystallise fund in stages
  - Annuity purchase: Buy guaranteed income for life
  - UFPLS: Take ad-hoc lump sums (25% tax-free, 75% taxable)
  - Full encashment: Take entire fund (25% tax-free, 75% taxable)
- No obligation to purchase annuity unless GAR is valuable
- Record available options in `optionsAtRetirement`

**Contribution Calculations:**
- `totalMonthlyContribution` = memberContribution + employerContribution
- `annualisedContribution` = totalMonthlyContribution × 12 (if monthly)
- Adjust for frequency: Quarterly × 4, Annually × 1, etc.
- Include net contribution (after tax relief) or gross equivalent consistently

**Provider vs Employer:**
- `provider` = Pension provider/administrator (e.g., "Scottish Widows", "Aviva")
- `employer` = Actual employer organization sponsoring the scheme
- Group schemes: provider administers, employer sponsors
- Personal pensions: provider manages, employer may contribute but doesn't sponsor

**Projected Values:**
- Projections should use FCA standardized growth rates (currently 5% real growth)
- Account for ongoing charges (e.g., AMC of 0.5-1.5% p.a.)
- Projection accuracy decreases with time horizon
- Update projections annually or when contributions change significantly

**Example: Preserved Personal Pension (Paid-Up Policy)**

```json
{
  "id": 2,
  "href": "/api/v2/factfinds/ff-789/arrangements/pensions/money-purchase/arr-mp-002",
  "arrangementType": "MONEY_PURCHASE",
  "arrangementCategory": "PENSION",
  "provider": {
    "name": "Standard Life",
    "reference": "SL-002",
    "href": "/api/v2/providers/SL-002"
  },
  "employer": null,
  "sellingAdviser": {
    "id": 234,
    "name": "David Brown",
    "firmName": "Legacy Financial Advisers",
    "href": "/api/v2/advisers/234"
  },
  "agencyStatus": null,
  "agencyStatusDate": null,
  "contractType": "AppropriatePersonalPension",
  "productName": "Personal Pension Plan",
  "policyNumber": "SL-APP-778899",
  "currency": {
    "code": "GBP",
    "symbol": "£",
    "display": "British Pound"
  },
  "owners": [
    {
      "client": {
        "id": 456,
        "fullName": "Emma Wilson",
        "href": "/api/v2/factfinds/ff-789/clients/456"
      },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "PAID_UP",
  "dateSchemeJoined": "2008-06-01",
  "dateContributionsStopped": "2015-12-31",
  "retirementAge": 65,
  "taxWrapper": "RegisteredPension",
  "isIndexed": false,
  "isPreserved": true,
  "hasLifestylingStrategy": false,
  "currentValue": {
    "amount": 42500.00,
    "currency": { "code": "GBP", "symbol": "£", "display": "British Pound" }
  },
  "valuationDate": "2026-01-31",
  "valuationType": "STATEMENT",
  "regularContributions": null,
  "lumpSumContributions": null,
  "employerMatchingDetails": null,
  "gmpAmount": null,
  "enhancedTaxFreeCash": null,
  "guaranteedAnnuityRate": null,
  "applicablePenalties": "No penalties apply - policy held for 10+ years",
  "erfLoyaltyBonusTerminalBonus": null,
  "guaranteedGrowthRates": null,
  "deathInServiceSpousalBenefits": null,
  "deathBenefits": "Fund value payable to nominated beneficiaries. Tax treatment depends on age at death: tax-free if under 75, taxable if over 75.",
  "lifetimeAllowanceUsed": 15.2,
  "lifestylingStrategyDetails": null,
  "optionsAtRetirement": "All pension freedoms options available: drawdown, annuity purchase, UFPLS, or full encashment. No GAR or protected benefits restricting options.",
  "otherBenefitsOrMaterialFeatures": "With-profits fund with potential for terminal bonus at retirement. Smoothing reduces volatility.",
  "additionalNotes": "Policy was originally established with regular contributions of £200/month until 2015. Now paid-up with fund remaining invested in Standard Life Pension With-Profits Fund. Annual management charge 1.0% p.a.",
  "historicalContributions": {
    "totalContributionsMade": {
      "amount": 22400.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "yearsContributing": 7.5
  },
  "projections": {
    "assumedGrowthRate": 4.0,
    "projectedValueAtRetirement": {
      "amount": 78500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "yearsToRetirement": 14.8
  },
  "fundComposition": [
    {
      "fundName": "Standard Life Pension With-Profits Fund",
      "value": {
        "amount": 42500.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 100.0
    }
  ],
  "charges": {
    "annualManagementCharge": 1.0,
    "policyFee": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalExpenseRatio": 1.0
  },
  "concurrencyId": "m5n8p2q4-3r7s-9t1u-4v6w-8x9y1z2a3b4c",
  "createdAt": "2026-02-18T15:00:00Z",
  "updatedAt": "2026-02-18T15:00:00Z",
    "factfind": { "href": "/api/v2/factfinds/ff-789" },
    "owner": { "href": "/api/v2/factfinds/ff-789/clients/456" },
    "provider": { "href": "/api/v2/providers/SL-002" },
    "sellingAdviser": { "href": "/api/v2/advisers/234" },
    "beneficiaries": { "href": "/api/v2/factfinds/ff-789/arrangements/arr-mp-002/beneficiaries" },
    "valuations": { "href": "/api/v2/factfinds/ff-789/arrangements/arr-mp-002/valuations" }
  }
}
```

### 11.5 Mortgage Arrangements

**Base Path:** `/api/v2/factfinds/{factfindId}/arrangements/mortgages`

**Purpose:** Manage mortgage arrangements including traditional mortgages and equity release products linked to property assets.

**Note on LTV (Loan-to-Value):** LTV is calculated automatically based on the property value and outstanding mortgage balance, and is stored as part of the mortgage arrangement contract. There is no separate LTV calculation endpoint - the LTV ratio is included in the mortgage arrangement response and updated whenever the property value or mortgage balance changes.

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/mortgages` | Create Mortgage | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/mortgages` | List Mortgages | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/mortgages/{arrangementId}` | Get Mortgage details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/mortgages/{arrangementId}` | Update Mortgage | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/mortgages/{arrangementId}` | Delete Mortgage | `arrangements:write` |

**Create Mortgage Request:**

```json
{
  "arrangementCategory": "MORTGAGE",
  "accountNumber": "NBS-MORT-123456",
  "owners": [
    {
      "id": 123,
      "href": "/api/v2/factfinds/ff-456/clients/123",
      "ownershipPercentage": 50.0
    },
    {
      "id": 124,
      "href": "/api/v2/factfinds/ff-456/clients/124",
      "ownershipPercentage": 50.0
    }
  ],
  "productType": "FixedRateMortgage",
  "lenderName": "Nationwide Building Society",
  "productName": "5 Year Fixed Rate Mortgage",
  "description": "Main residence mortgage",
  "loanAmounts": {
    "originalLoanAmount": {
      "amount": 300000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentBalance": {
      "amount": 245000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "depositAmount": {
      "amount": 100000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "originalPropertyValuation": {
      "amount": 400000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentPropertyValuation": {
      "amount": 425000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "loanToValue": {
      "percentage": 75.0,
      "propertyValue": {
        "amount": 400000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "loanAmount": {
        "amount": 300000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "calculatedOn": "2018-06-15"
    },
    "currentLTV": {
      "percentage": 57.65,
      "outstandingBalance": {
        "amount": 245000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "currentPropertyValue": {
        "amount": 425000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "calculatedOn": "2026-02-18"
    }
  },
  "interestTerms": {
    "interestRate": 4.25,
    "annualPercentageRate": 4.35,
    "rateType": "Fixed",
    "baseRateIndex": null,
    "reversionRate": 7.99,
    "hasCollarRate": false,
    "collarRate": null,
    "initialRatePeriodEndsOn": "2028-06-30",
    "initialTermYears": 5,
    "initialTermMonths": 0,
    "remainingTermYears": 17,
    "remainingTermMonths": 4
  },
  "repaymentStructure": {
    "repaymentMethod": "CapitalAndInterest",
    "capitalRepaymentAmount": {
      "amount": 300000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "capitalTermYears": 25,
    "capitalTermMonths": 0,
    "interestOnlyAmount": null,
    "interestOnlyTermYears": null,
    "interestOnlyTermMonths": null,
    "interestOnlyRepaymentVehicle": null,
    "lumpSumAdvance": null,
    "monthlyIncomeDrawdown": null,
    "regularAnnualOverpayment": null,
    "currentRepaymentVehicles": []
  },
  "feesAndCharges": {
    "lenderFees": {
      "amount": 999.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "ongoingContributions": null
  },
  "keyDates": {
    "startDate": "2018-06-15",
    "endDate": "2043-06-15",
    "completionDate": "2018-06-15",
    "exchangeDate": "2018-06-08",
    "nextPaymentDueDate": "2026-03-15",
    "nextReviewDate": "2028-01-01",
    "balanceAsOfDate": "2026-02-18",
    "applicationSubmittedDate": "2018-05-10",
    "valuationInstructedDate": "2018-05-12",
    "valuationDate": "2018-05-18",
    "valuationReceivedDate": "2018-05-22",
    "offerIssuedDate": "2018-05-28",
    "targetCompletionDate": "2018-06-15",
    "schemeEndDate": null
  },
  "redemptionTerms": {
    "hasEarlyRepaymentCharge": true,
    "earlyRepaymentTerms": "4% of outstanding balance until 2028-06-30",
    "earlyRepaymentChargeEndsOn": "2028-06-30",
    "earlyRepaymentCharge": {
      "amount": 9800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "earlyRepaymentChargeSecondCharge": null,
    "netProceedsOnRedemption": {
      "amount": 235200.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "specialFeatures": {
    "isFirstTimeBuyer": false,
    "isCurrentResidence": true,
    "hasGuarantor": false,
    "isPortable": true,
    "isPropertySold": false,
    "isRedeemed": false,
    "hasDischargeOnCompletion": false,
    "hasConsentToLet": false,
    "consentToLetExpiresOn": null,
    "hasDebtConsolidation": false,
    "incomeVerificationStatus": "Employed",
    "isIncomeEvidenced": true
  },
  "propertyDetail": {
    "id": 1,
    "href": "/api/v2/factfinds/ff-456/property-details/asset-prop-001"
  },
  "notes": "5 year fixed rate ends June 2028. Review remortgage options 6 months before."
}
```

**Response (201 Created):**

```json
{
  "id": 5,
  "href": "/api/v2/factfinds/ff-456/arrangements/mortgages/arr-secl-005",
  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/ff-456"
  },
  "arrangementCategory": "MORTGAGE",
  "accountNumber": "NBS-MORT-123456",
  "policyNumber": null,
  "illustrationReference": null,
  "owners": [
    {
      "id": 123,
      "href": "/api/v2/factfinds/ff-456/clients/123",
      "fullName": "John Smith",
      "ownershipPercentage": 50.0
    },
    {
      "id": 124,
      "href": "/api/v2/factfinds/ff-456/clients/124",
      "fullName": "Jane Smith",
      "ownershipPercentage": 50.0
    }
  ],
  "sellingAdviser": null,
  "agencyStatus": null,
  "agencyStatusDate": null,
  "productType": "FixedRateMortgage",
  "lenderName": "Nationwide Building Society",
  "productName": "5 Year Fixed Rate Mortgage",
  "description": "Main residence mortgage",
  "loanAmounts": {
    "originalLoanAmount": {
      "amount": 300000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentBalance": {
      "amount": 245000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "depositAmount": {
      "amount": 100000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "equityReleased": null,
    "originalPropertyValuation": {
      "amount": 400000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentPropertyValuation": {
      "amount": 425000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "loanToValue": {
      "percentage": 75.0,
      "propertyValue": {
        "amount": 400000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "loanAmount": {
        "amount": 300000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "calculatedOn": "2018-06-15"
    },
    "currentLTV": {
      "percentage": 57.65,
      "outstandingBalance": {
        "amount": 245000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "currentPropertyValue": {
        "amount": 425000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "calculatedOn": "2026-02-18"
    }
  },
  "interestTerms": {
    "interestRate": 4.25,
    "annualPercentageRate": 4.35,
    "rateType": "Fixed",
    "baseRateIndex": null,
    "reversionRate": 7.99,
    "hasCollarRate": false,
    "collarRate": null,
    "initialRatePeriodEndsOn": "2028-06-30",
    "initialTermYears": 5,
    "initialTermMonths": 0,
    "remainingTermYears": 17,
    "remainingTermMonths": 4
  },
  "repaymentStructure": {
    "repaymentMethod": "CapitalAndInterest",
    "capitalRepaymentAmount": {
      "amount": 300000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "capitalTermYears": 25,
    "capitalTermMonths": 0,
    "interestOnlyAmount": null,
    "interestOnlyTermYears": null,
    "interestOnlyTermMonths": null,
    "interestOnlyRepaymentVehicle": null,
    "lumpSumAdvance": null,
    "monthlyIncomeDrawdown": null,
    "regularAnnualOverpayment": null,
    "currentRepaymentVehicles": []
  },
  "feesAndCharges": {
    "lenderFees": {
      "amount": 999.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "ongoingContributions": null
  },
  "keyDates": {
    "startDate": "2018-06-15",
    "endDate": "2043-06-15",
    "completionDate": "2018-06-15",
    "exchangeDate": "2018-06-08",
    "nextPaymentDueDate": "2026-03-15",
    "nextReviewDate": "2028-01-01",
    "balanceAsOfDate": "2026-02-18",
    "applicationSubmittedDate": "2018-05-10",
    "valuationInstructedDate": "2018-05-12",
    "valuationDate": "2018-05-18",
    "valuationReceivedDate": "2018-05-22",
    "offerIssuedDate": "2018-05-28",
    "targetCompletionDate": "2018-06-15",
    "schemeEndDate": null
  },
  "redemptionTerms": {
    "hasEarlyRepaymentCharge": true,
    "earlyRepaymentTerms": "4% of outstanding balance until 2028-06-30",
    "earlyRepaymentChargeEndsOn": "2028-06-30",
    "earlyRepaymentCharge": {
      "amount": 9800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "earlyRepaymentChargeSecondCharge": null,
    "netProceedsOnRedemption": {
      "amount": 235200.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "specialFeatures": {
    "isFirstTimeBuyer": false,
    "isCurrentResidence": true,
    "hasGuarantor": false,
    "isPortable": true,
    "isPropertySold": false,
    "isRedeemed": false,
    "hasDischargeOnCompletion": false,
    "hasConsentToLet": false,
    "consentToLetExpiresOn": null,
    "hasDebtConsolidation": false,
    "incomeVerificationStatus": "Employed",
    "isIncomeEvidenced": true
  },
  "sharedOwnershipDetails": null,
  "offsetFeatures": null,
  "asset": null,
  "property": {
    "id": 1,
    "href": "/api/v2/factfinds/ff-456/properties/asset-prop-001",
    "address": "123 High Street, London"
  },
  "propertyDetail": {
    "id": 1,
    "href": "/api/v2/factfinds/ff-456/property-details/asset-prop-001"
  },
  "linkedArrangements": [],
  "notes": "5 year fixed rate ends June 2028. Review remortgage options 6 months before.",
  "createdAt": "2026-02-18T10:50:00Z",
  "updatedAt": "2026-02-18T10:50:00Z",
    "factfind": { "href": "/api/v2/factfinds/ff-456" },
    "property": { "href": "/api/v2/factfinds/ff-456/properties/asset-prop-001" },
    "propertyDetail": { "href": "/api/v2/factfinds/ff-456/property-details/asset-prop-001" },
    "owners": [
      { "href": "/api/v2/factfinds/ff-456/clients/123" },
      { "href": "/api/v2/factfinds/ff-456/clients/124" }
    ]
  }
}
```

**Validation Rules:**
- `arrangementCategory` - Required, must be "MORTGAGE"
- `productType` - Required, see Product Type Codes (FixedRateMortgage, LifetimeMortgage, etc.)
- `propertyDetail` - Required, must link to existing property detail record
- `owners` - Required, at least one owner with sum of ownershipPercentage = 100
- Product-specific validation applies (see Section 13.41 Validation Rules)
- `currentBalance` - Required, must be positive
- `monthlyPayment` - Required, must be positive
- `currentRate` - Required, must be > 0
- LTV cannot exceed 95% for residential, 85% for BTL

**Business Rules:**
- LTV = (Current Balance / Property Value) * 100
- Equity = Property Value - Current Balance
- Stress test typically at current rate + 3%
- ERC typically 1-5% of outstanding balance during fixed period
- Remortgage review when deal expiry within 6 months
- Affordability based on debt-to-income ratio (typically max 4.5x)

### 11.6 Protection Arrangements

**Base Path:** `/api/v2/factfinds/{factfindId}/arrangements/protections`

**Purpose:** Manage protection policies including life insurance, critical illness, income protection, and general insurance.

#### 11.6.1 Personal Protection (Life, CI, IP)

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/protections/personal-protection` | Create Personal Protection | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/protections/personal-protection` | List Personal Protection | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/protections/personal-protection/{arrangementId}` | Get Protection details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/protections/personal-protection/{arrangementId}` | Update Protection | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/protections/personal-protection/{arrangementId}` | Delete Protection | `arrangements:write` |

**Create Personal Protection Request:**

```json
{
  "arrangementType": "PROTECTION",
  "protectionType": "LIFE_COVER",
  "provider": {
    "name": "Legal & General",
    "reference": "LG-UK-001",
    "contactDetails": {
      "phone": "0800 783 4137",
      "email": "life@landg.com"
    }
  },
  "policyNumber": "LG-LIFE-789012",
  "startDate": "2020-04-01",
  "maturityDate": "2050-04-01",
  "owners": [
    {
      "client": { "id": 123 },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "coverDetails": {
    "coverAmount": {
      "amount": 500000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "coverType": "LEVEL_TERM",
    "coverPeriod": {
      "years": 30,
      "endsOn": "2050-04-01"
    }
  },
  "premiumDetails": {
    "monthlyPremium": {
      "amount": 35.50,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "annualPremium": {
      "amount": 426.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "paymentFrequency": "MONTHLY",
    "reviewable": false,
    "guaranteed": true
  },
  "beneficiaries": [
    {
      "name": "Jane Smith",
      "relationship": "SPOUSE",
      "percentage": 100.0,
      "ref": { "id": 124 }
    }
  ],
  "trustDetails": {
    "inTrust": true,
    "trustType": "SPLIT_TRUST",
    "trustees": [
      "Jane Smith",
      "David Smith"
    ]
  },
  "underwritingDetails": {
    "underwritingType": "FULL_MEDICAL",
    "loadings": [],
    "exclusions": []
  }
}
```

**Response (201 Created):**

```json
{
  "id": 6,
  "href": "/api/v2/factfinds/ff-456/arrangements/protections/personal-protection/arr-prot-006",
  "arrangementType": "PROTECTION",
  "arrangementCategory": "PROTECTION",
  "protectionType": "LIFE_COVER",
  "provider": {
    "name": "Legal & General",
    "reference": "LG-UK-001",
    "contactDetails": {
      "phone": "0800 783 4137",
      "email": "life@landg.com"
    }
  },
  "policyNumber": "LG-LIFE-789012",
  "startDate": "2020-04-01",
  "maturityDate": "2050-04-01",
  "currentValue": {
    "amount": 500000.00,
    "currency": { "code": "GBP", "symbol": "£", "display": "British Pound" }
  },
  "valuationDate": "2026-02-18",
  "owners": [
    {
      "client": {
        "id": 123,
        "fullName": "John Smith",
        "href": "/api/v2/factfinds/ff-456/clients/123"
      },
      "ownershipPercentage": 100.0
    }
  ],
  "status": "ACTIVE",
  "coverDetails": {
    "coverAmount": {
      "amount": 500000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "coverType": "LEVEL_TERM",
    "coverPeriod": {
      "years": 30,
      "endsOn": "2050-04-01"
    },
    "yearsRemaining": 24.1
  },
  "premiumDetails": {
    "monthlyPremium": {
      "amount": 35.50,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "annualPremium": {
      "amount": 426.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "paymentFrequency": "MONTHLY",
    "totalPremiumsPaid": {
      "amount": 2982.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "reviewable": false,
    "guaranteed": true,
    "nextReviewDate": null
  },
  "beneficiaries": [
    {
      "id": 1,
      "name": "Jane Smith",
      "relationship": "SPOUSE",
      "percentage": 100.0,
      "ref": {
        "id": 124,
        "href": "/api/v2/factfinds/ff-456/clients/124"
      }
    }
  ],
  "trustDetails": {
    "inTrust": true,
    "trustType": "SPLIT_TRUST",
    "trustees": [
      "Jane Smith",
      "David Smith"
    ],
    "ihtBenefit": "Policy proceeds excluded from estate for IHT purposes"
  },
  "underwritingDetails": {
    "underwritingType": "FULL_MEDICAL",
    "loadings": [],
    "exclusions": [],
    "terms": "Standard Terms"
  },
  "adequacyCheck": {
    "recommendedCover": {
      "amount": 650000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "shortfall": {
      "amount": 150000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "adequacyPercentage": 76.92
  },
  "concurrencyId": "j2g8h6f5-7k90-9j3g-4i8h-6f7g8h9i0j1k",
  "createdAt": "2026-02-18T10:55:00Z",
  "updatedAt": "2026-02-18T10:55:00Z",
    "factfind": { "href": "/api/v2/factfinds/ff-456" },
    "owner": { "href": "/api/v2/factfinds/ff-456/clients/123" },
    "beneficiaries": { "href": "/api/v2/factfinds/ff-456/arrangements/arr-prot-006/beneficiaries" }
  }
}
```

**Protection Type Variations:**

**Critical Illness Cover:**
```json
{
  "protectionType": "CRITICAL_ILLNESS",
  "coverDetails": {
    "conditionsCovered": 50,
    "partialPayment": true,
    "childrensCover": true
  }
}
```

**Income Protection:**
```json
{
  "protectionType": "INCOME_PROTECTION",
  "coverDetails": {
    "monthlyBenefit": {
      "amount": 3000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "deferredPeriod": {
      "weeks": 13
    },
    "benefitPeriod": "AGE_65",
    "indexation": true
  }
}
```

#### 11.6.2 General Insurance

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/v2/factfinds/{factfindId}/arrangements/protections/general-insurance` | Create General Insurance | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/protections/general-insurance` | List General Insurance | `arrangements:read` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/protections/general-insurance/{arrangementId}` | Get Insurance details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/protections/general-insurance/{arrangementId}` | Update Insurance | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/protections/general-insurance/{arrangementId}` | Delete Insurance | `arrangements:write` |

**General Insurance Types:**
- Buildings Insurance
- Contents Insurance
- Motor Insurance
- Travel Insurance
- Pet Insurance
- Private Medical Insurance

**Buildings Insurance Example:**

```json
{
  "arrangementType": "GENERAL_INSURANCE",
  "insuranceType": "BUILDINGS",
  "provider": {
    "name": "Aviva",
    "reference": "AVIVA-UK-001"
  },
  "policyNumber": "BLDG-456789",
  "coverAmount": {
    "amount": 425000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "annualPremium": {
    "amount": 285.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "excess": {
    "amount": 250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "renewalDate": "2026-06-15",
  "linkedAssetRef": {
    "id": 1
  }
}
```

### 11.7 Arrangement Sub-Resources

**Purpose:** Manage detailed transaction history and associated data for arrangements including contributions, withdrawals, beneficiaries, and valuations.

#### 11.7.1 Contributions

**Base Path:** `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/contributions`

**Purpose:** Track contributions made to investment and pension arrangements.

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/contributions` | List contributions | `arrangements:read` |
| POST | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/contributions` | Add contribution | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/contributions/{contributionId}` | Get contribution details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/contributions/{contributionId}` | Update contribution | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/contributions/{contributionId}` | Delete contribution | `arrangements:write` |

**Create Contribution Request:**

```json
{
  "contributionDate": "2026-02-15",
  "contributionType": "REGULAR",
  "grossAmount": {
    "amount": 625.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "netAmount": {
    "amount": 500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxRelief": {
    "amount": 125.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "employerContribution": {
    "amount": 250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "source": "SALARY",
  "notes": "Standard monthly contribution"
}
```

**Response (201 Created):**

```json
{
  "id": 1,
  "href": "/api/v2/factfinds/ff-456/arrangements/arr-pp-003/contributions/contrib-001",
  "arrangement": {
    "id": 3,
    "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003"
  },
  "contributionDate": "2026-02-15",
  "contributionType": "REGULAR",
  "grossAmount": {
    "amount": 625.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "netAmount": {
    "amount": 500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxRelief": {
    "amount": 125.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "employerContribution": {
    "amount": 250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "totalContribution": {
    "amount": 875.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "source": "SALARY",
  "taxYear": "2025/26",
  "annualAllowanceUsed": {
    "amount": 875.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "notes": "Standard monthly contribution",
  "createdAt": "2026-02-18T11:00:00Z",
  "updatedAt": "2026-02-18T11:00:00Z",
    "arrangement": { "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003" },
    "factfind": { "href": "/api/v2/factfinds/ff-456" }
  }
}
```

**List Contributions Response:**

```json
{
  "arrangement": {
    "id": 3,
    "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003"
  },
  "contributions": [
    {
      "id": 1,
      "contributionDate": "2026-02-15",
      "grossAmount": {
        "amount": 625.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "contributionType": "REGULAR"
      }
    },
    {
      "id": 2,
      "contributionDate": "2026-01-15",
      "grossAmount": {
        "amount": 625.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "contributionType": "REGULAR"
      }
    }
  ],
  "summary": {
    "totalContributions": 24,
    "totalAmount": {
      "amount": 21000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "thisYearContributions": {
      "amount": 1750.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "annualAllowanceUsed": {
      "amount": 1750.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "totalCount": 24,
    "arrangement": { "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003" }
  }
}
```

**Query Parameters:**
- `fromDate` - Filter contributions from this date
- `toDate` - Filter contributions to this date
- `contributionType` - Filter by type (REGULAR, AD_HOC, TRANSFER, EMPLOYER)
- `taxYear` - Filter by tax year (e.g., "2025/26")

#### 11.7.2 Withdrawals

**Base Path:** `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/withdrawals`

**Purpose:** Track withdrawals from investment, pension, and drawdown arrangements.

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/withdrawals` | List withdrawals | `arrangements:read` |
| POST | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/withdrawals` | Add withdrawal | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/withdrawals/{withdrawalId}` | Get withdrawal details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/withdrawals/{withdrawalId}` | Update withdrawal | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/withdrawals/{withdrawalId}` | Delete withdrawal | `arrangements:write` |

**Create Withdrawal Request (Pension Drawdown):**

```json
{
  "withdrawalDate": "2026-02-15",
  "withdrawalType": "INCOME",
  "grossAmount": {
    "amount": 1000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxDeducted": {
    "amount": 200.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "netAmount": {
    "amount": 800.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxCode": "1257L",
  "crystallisedFund": {
    "amount": 1000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedFund": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "reason": "REGULAR_INCOME",
  "notes": "Monthly drawdown payment"
}
```

**Response (201 Created):**

```json
{
  "id": 1,
  "href": "/api/v2/factfinds/ff-456/arrangements/arr-dd-007/withdrawals/withdraw-001",
  "arrangement": {
    "id": 7,
    "href": "/api/v2/factfinds/ff-456/arrangements/pensions/drawdown/arr-dd-007"
  },
  "withdrawalDate": "2026-02-15",
  "withdrawalType": "INCOME",
  "grossAmount": {
    "amount": 1000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxDeducted": {
    "amount": 200.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "netAmount": {
    "amount": 800.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxCode": "1257L",
  "effectiveTaxRate": 20.0,
  "crystallisedFund": {
    "amount": 1000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedFund": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxYear": "2025/26",
  "reason": "REGULAR_INCOME",
  "notes": "Monthly drawdown payment",
  "createdAt": "2026-02-18T11:05:00Z",
  "updatedAt": "2026-02-18T11:05:00Z",
    "arrangement": { "href": "/api/v2/factfinds/ff-456/arrangements/pensions/drawdown/arr-dd-007" },
    "factfind": { "href": "/api/v2/factfinds/ff-456" }
  }
}
```

**Create Withdrawal Request (Investment Bond 5% Rule):**

```json
{
  "withdrawalDate": "2026-02-15",
  "withdrawalType": "TAX_DEFERRED",
  "grossAmount": {
    "amount": 3750.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "netAmount": {
    "amount": 3750.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "fivePercentAllowanceUsed": {
    "amount": 3750.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "cumulativeAllowanceRemaining": {
    "amount": 15000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxYear": "2025/26",
  "reason": "INCOME_REQUIREMENT"
}
```

#### 11.7.3 Beneficiaries

**Base Path:** `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/beneficiaries`

**Purpose:** Manage beneficiary designations for pensions and protection policies.

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/beneficiaries` | List beneficiaries | `arrangements:read` |
| POST | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/beneficiaries` | Add beneficiary | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/beneficiaries/{beneficiaryId}` | Get beneficiary details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/beneficiaries/{beneficiaryId}` | Update beneficiary | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/beneficiaries/{beneficiaryId}` | Delete beneficiary | `arrangements:write` |

**Create Beneficiary Request:**

```json
{
  "beneficiaryType": "PERSON",
  "name": "Sarah Smith",
  "relationship": "CHILD",
  "dateOfBirth": "2005-08-15",
  "percentage": 50.0,
  "contingent": false,
  "contactRef": {
    "id": 789
  },
  "address": {
    "line1": "123 High Street",
    "city": "London",
    "postcode": "SW1A 1AA"
  },
  "notes": "Primary beneficiary - daughter"
}
```

**Response (201 Created):**

```json
{
  "id": 2,
  "href": "/api/v2/factfinds/ff-456/arrangements/arr-pp-003/beneficiaries/ben-002",
  "arrangement": {
    "id": 3,
    "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003"
  },
  "beneficiaryType": "PERSON",
  "name": "Sarah Smith",
  "relationship": "CHILD",
  "dateOfBirth": "2005-08-15",
  "age": 20,
  "percentage": 50.0,
  "contingent": false,
  "contactRef": {
    "id": 789,
    "href": "/api/v2/factfinds/ff-456/clients/123/dependents/dependent-789"
  },
  "address": {
    "line1": "123 High Street",
    "city": "London",
    "postcode": "SW1A 1AA"
  },
  "notes": "Primary beneficiary - daughter",
  "createdAt": "2026-02-18T11:10:00Z",
  "updatedAt": "2026-02-18T11:10:00Z",
    "arrangement": { "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003" },
    "dependent": { "href": "/api/v2/factfinds/ff-456/clients/123/dependents/dependent-789" }
  }
}
```

**List Beneficiaries Response:**

```json
{
  "arrangement": {
    "id": 3,
    "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003"
  },
  "beneficiaries": [
    {
      "id": 2,
      "name": "Sarah Smith",
      "relationship": "CHILD",
      "percentage": 50.0,
      "contingent": false
      }
    },
    {
      "id": 3,
      "name": "Michael Smith",
      "relationship": "CHILD",
      "percentage": 50.0,
      "contingent": false
      }
    }
  ],
  "totalCount": 2,
  "totalPercentage": 100.0,
    "arrangement": { "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003" }
  }
}
```

**Validation Rules:**
- Total percentage for non-contingent beneficiaries must equal 100%
- At least one beneficiary required for protection policies in trust
- Beneficiary age restrictions apply for certain arrangements
- Relationship to policyholder must be declared

#### 11.7.4 Valuations

**Base Path:** `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/valuations`

**Purpose:** Track historical valuation of arrangements over time for performance analysis.

**Operations:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/valuations` | List valuations | `arrangements:read` |
| POST | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/valuations` | Add valuation | `arrangements:write` |
| GET | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/valuations/{valuationId}` | Get valuation details | `arrangements:read` |
| PATCH | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/valuations/{valuationId}` | Update valuation | `arrangements:write` |
| DELETE | `/api/v2/factfinds/{factfindId}/arrangements/{arrangementId}/valuations/{valuationId}` | Delete valuation | `arrangements:write` |

**Create Valuation Request:**

```json
{
  "valuationDate": "2026-02-18",
  "valuationType": "STATEMENT",
  "value": {
    "amount": 125000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "source": "PROVIDER",
  "crystallisedValue": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedValue": {
    "amount": 125000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "document": "statement-2026-02.pdf",
  "notes": "Q4 2025/26 statement"
}
```

**Response (201 Created):**

```json
{
  "id": 1,
  "href": "/api/v2/factfinds/ff-456/arrangements/arr-pp-003/valuations/val-001",
  "arrangement": {
    "id": 3,
    "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003"
  },
  "valuationDate": "2026-02-18",
  "valuationType": "STATEMENT",
  "value": {
    "amount": 125000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "source": "PROVIDER",
  "crystallisedValue": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedValue": {
    "amount": 125000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "changeFromPrevious": {
    "amount": 5000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "percentageChange": 4.17,
  "document": "statement-2026-02.pdf",
  "notes": "Q4 2025/26 statement",
  "createdAt": "2026-02-18T11:15:00Z",
  "updatedAt": "2026-02-18T11:15:00Z",
    "arrangement": { "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003" },
    "document": { "href": "/api/v2/factfinds/ff-456/documents/statement-2026-02.pdf" }
  }
}
```

**List Valuations Response:**

```json
{
  "arrangement": {
    "id": 3,
    "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003"
  },
  "valuations": [
    {
      "id": 1,
      "valuationDate": "2026-02-18",
      "value": {
        "amount": 125000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "valuationType": "STATEMENT",
      "percentageChange": 4.17
      }
    },
    {
      "id": 2,
      "valuationDate": "2025-11-18",
      "value": {
        "amount": 120000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "valuationType": "STATEMENT",
      "percentageChange": 3.45
      }
    }
  ],
  "summary": {
    "totalValuations": 8,
    "latestValue": {
      "amount": 125000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "earliestValue": {
      "amount": 95000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalGrowth": {
      "amount": 30000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalGrowthPercentage": 31.58,
    "annualizedReturn": 6.2
  },
  "totalCount": 8,
    "arrangement": { "href": "/api/v2/factfinds/ff-456/arrangements/pensions/personal-pension/arr-pp-003" }
  }
}
```

**Query Parameters:**
- `fromDate` - Filter valuations from this date
- `toDate` - Filter valuations to this date
- `valuationType` - Filter by type (STATEMENT, PROJECTION, ESTIMATE)
- `sortBy` - Sort by date (asc/desc)

---

## Regulatory Compliance

### FCA Requirements

**COBS 9.2 - Suitability Assessment:**
- All arrangements must be assessed for suitability
- Client objectives, financial situation, and knowledge/experience must be considered
- Suitability reports must reference specific arrangements

**COBS 13 - Periodic Reporting:**
- Annual statements for investment-based products
- Performance reporting against objectives
- Cost and charges disclosure

**COBS 19.1 - Pension Transfers:**
- Transfer value analysis for defined benefit schemes
- CETV must be clearly disclosed
- Risk warnings mandatory for transfers exceeding £30,000

**IDD Compliance:**
- Insurance product governance
- Target market assessment
- Fair value assessment for protection products

### Data Protection

**GDPR Article 9 - Special Category Data:**
- Health information for underwriting (protection policies)
- Trade union membership (pension schemes)
- Consent required for processing

**Right to Erasure:**
- Soft delete maintains audit trail
- Regulatory retention periods respected (6 years minimum)

### Anti-Money Laundering

**MLR 2017:**
- Source of wealth verification for large contributions
- Enhanced due diligence for offshore arrangements
- Politically Exposed Persons (PEP) screening

---

## Error Responses

**Standard Error Format (RFC 7807):**

```json
{
  "type": "https://api.factfind.com/errors/validation-error",
  "title": "Validation Failed",
  "status": 400,
  "detail": "ISA allowance exceeded for tax year 2025/26",
  "instance": "/api/v2/factfinds/ff-456/arrangements/investments/ISA/arr-isa-002",
  "errors": [
    {
      "field": "isaAllowance.usedThisYear",
      "message": "Contribution would exceed annual ISA allowance of £20,000",
      "code": "ALLOWANCE_EXCEEDED",
      "value": 21500.00,
      "limit": 20000.00
    }
  ]
}
```

**Common Error Codes:**
- `ALLOWANCE_EXCEEDED` - Annual allowance limit breached
- `INVALID_OWNER` - Owner does not exist in fact-find
- `ARRANGEMENT_NOT_FOUND` - Arrangement ID not found
- `DUPLICATE_POLICY` - Policy number already exists
- `VALUATION_TOO_OLD` - Valuation date exceeds 12 months
- `BENEFICIARY_PERCENTAGE_INVALID` - Beneficiary percentages do not sum to 100%
- `TRANSFER_ADVICE_REQUIRED` - FCA advice mandatory (DB transfer > £30k)
- `PROPERTY_NOT_FOUND` - Linked property asset not found (mortgages)

---

## Total Endpoints Summary

**Investment Arrangements:** 35 endpoints (7 types × 5 operations)
**Pension Arrangements:** 40 endpoints (8 types × 5 operations)
**Mortgage Arrangements:** 5 endpoints
**Protection Arrangements:** 10 endpoints (2 types × 5 operations)
**Sub-Resources:** 20 endpoints (4 resources × 5 operations)

**Total Arrangement Endpoints:** 110

---
## 12. Risk Profile API

### 13.1 Overview

**Purpose:** Capture and manage client Attitude to Risk (ATR) assessment as an embedded part of the FactFind.

**Key Features:**
- **ATR is embedded in the FactFind entity** - No separate template management API required
- **Templates are reference data** - Risk questionnaire templates are system configuration, not managed via API
- **Simplified assessment flow** - Submit, view, and choose risk profiles directly on the fact find
- **Historical tracking** - Risk Replay mechanism for viewing past assessments and comparing changes

**Key Concepts:**

The ATR Assessment is a critical component of the FactFind that captures:
1. **15 Standard ATR Questions** - Time horizon, risk tolerance, investment experience, etc.
2. **45 Supplementary Questions** - Additional context (dependents, will status, emergency funds, etc.)
3. **Risk Profile Generation** - System generates 3 adjacent risk profiles based on scores
4. **Client Choice** - Client chooses their preferred profile from the 3 options
5. **Capacity for Loss Assessment** - Adviser assesses financial capacity to sustain losses
6. **Declarations** - Client and adviser declarations confirming assessment accuracy and suitability

**Aggregate Root:** FactFind (ATR is part of the FactFind lifecycle)

**Regulatory Compliance:**
- FCA COBS 9.2 (Assessing Suitability - Risk Assessment)
- MiFID II Article 25 (Assessment of Suitability and Appropriateness)
- ESMA Guidelines on Suitability Assessment
- FCA Handbook COBS 9 Annex 2 (Risk Profiling)
- Consumer Duty (Understanding Customer Risk Tolerance)

### 13.2 Operations Summary

**ATR Assessment Endpoints:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/factfinds/{factfindId}/atr-assessment` | Get current ATR assessment | `factfind:read` |
| PUT | `/api/v2/factfinds/{factfindId}/atr-assessment` | Submit/update ATR assessment | `factfind:write` |
| POST | `/api/v2/factfinds/{factfindId}/atr-assessment/choose-profile` | Choose risk profile from options | `factfind:write` |
| GET | `/api/v2/factfinds/{factfindId}/atr-assessment/history` | Get ATR history (Risk Replay) | `factfind:read` |
| GET | `/api/v2/factfinds/{factfindId}/atr-assessment/history/{assessmentId}` | Get specific historical assessment | `factfind:read` |
| GET | `/api/v2/factfinds/{factfindId}/atr-assessment/compare` | Compare two assessments | `factfind:read` |

**Reference Data Endpoints:**

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/v2/reference/atr-templates` | List available ATR templates | Public |
| GET | `/api/v2/reference/atr-templates/{templateId}` | Get template details | Public |

### 13.3 Key Endpoints

#### 13.3.1 Get Current ATR Assessment

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/atr-assessment`

**Description:** Retrieves the current ATR assessment for a fact find, including all questions, answers, risk profiles, and declarations.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier

**Response:**

```json
{
  "atrAssessment": {
    "templateRef": {
      "id": 5407,
      "version": "5.0",
      "name": "FCA Standard ATR 2025",
      "regulatoryApprovalDate": "2025-01-01"
    },
    "assessmentDate": "2026-02-18T10:30:00Z",
    "assessedBy": {
      "id": 789,
      "name": "Jane Doe"
    },
    "questions": [
      {
        "questionId": "Q1",
        "questionText": "How long do you plan to invest for?",
        "questionType": "SingleChoice",
        "answer": {
          "answerId": "A1-3",
          "answerText": "10-15 years",
          "score": 5
        }
      },
      {
        "questionId": "Q2",
        "questionText": "What is your attitude to investment risk?",
        "questionType": "Slider",
        "answer": {
          "value": 7,
          "minLabel": "Very Cautious",
          "maxLabel": "Very Adventurous",
          "score": 7
        }
      }
    ],
    "supplementaryQuestions": [
      {
        "category": "Risk",
        "questionId": "SQ-R1",
        "questionText": "Number of financial dependants",
        "answer": {
          "answerType": "Number",
          "value": 2
        }
      },
      {
        "category": "General",
        "questionId": "SQ-G1",
        "questionText": "Do you have a valid Will?",
        "answer": {
          "answerType": "Boolean",
          "value": true
        }
      }
    ],
    "riskProfiles": {
      "generated": [
        {
          "riskRating": "Balanced",
          "riskScore": 45,
          "scoreRange": "40-50",
          "description": "You have a balanced attitude to risk...",
          "assetAllocation": {
            "equities": 60,
            "bonds": 30,
            "cash": 5,
            "alternatives": 5
          },
          "volatilityTolerance": "Medium",
          "timePeriod": "10-15 years",
          "potentialLossAcceptance": "10-15%"
        },
        {
          "riskRating": "Cautious",
          "riskScore": 35,
          "scoreRange": "30-40",
          "description": "Adjacent lower risk option...",
          "assetAllocation": {
            "equities": 40,
            "bonds": 45,
            "cash": 10,
            "alternatives": 5
          }
        },
        {
          "riskRating": "Adventurous",
          "riskScore": 55,
          "scoreRange": "50-60",
          "description": "Adjacent higher risk option...",
          "assetAllocation": {
            "equities": 75,
            "bonds": 15,
            "cash": 5,
            "alternatives": 5
          }
        }
      ],
      "chosen": {
        "riskRating": "Balanced",
        "riskScore": 45,
        "chosenBy": "Client",
        "chosenDate": "2026-02-18T11:00:00Z",
        "reasonForChoice": "Matches my investment goals and risk tolerance",
        "adviserNotes": "Client comfortable with balanced approach, discussed volatility expectations"
      }
    },
    "totalScore": 67,
    "maxScore": 100,
    "capacityForLoss": {
      "canAffordLosses": true,
      "emergencyFundMonths": 6,
      "essentialExpensesCovered": true,
      "dependantsProvisionAdequate": true,
      "assessmentNotes": "Client has sufficient emergency fund and no debt"
    },
    "declarations": {
      "clientDeclaration": {
        "declarationType": "ATR_Accuracy",
        "declarationText": "I confirm that the answers I have provided...",
        "signed": true,
        "signedDate": "2026-02-18T11:05:00Z",
        "signatureType": "Electronic",
        "ipAddress": "192.168.1.100"
      },
      "adviserDeclaration": {
        "declarationType": "ATR_Suitable",
        "declarationText": "I confirm that the risk profile assessment...",
        "signed": true,
        "signedDate": "2026-02-18T11:10:00Z",
        "signedBy": {
          "id": 789,
          "name": "Jane Doe"
        }
      }
    },
    "completedAt": "2026-02-18T11:10:00Z",
    "reviewDate": "2027-02-18"
  },
    "factfind": { "href": "/api/v2/factfinds/123" },
    "history": { "href": "/api/v2/factfinds/123/atr-assessment/history" },
    "chooseProfile": { "href": "/api/v2/factfinds/123/atr-assessment/choose-profile", "method": "POST" }
  }
}
```

**Status Codes:**
- `200 OK` - ATR assessment retrieved successfully
- `404 Not Found` - Fact find not found or no ATR assessment exists
- `403 Forbidden` - User lacks permission to view this fact find

---

#### 13.3.2 Submit/Update ATR Assessment

**Endpoint:** `PUT /api/v2/factfinds/{factfindId}/atr-assessment`

**Description:** Submit or update the ATR assessment for a fact find. This includes all 15 standard questions, 45 supplementary questions, and capacity for loss assessment.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier

**Request Body:**

```json
{
  "templateRef": {
    "id": 5407,
    "version": "5.0"
  },
  "questions": [
    {
      "questionId": "Q1",
      "answer": {
        "answerId": "A1-3",
        "score": 5
      }
    }
  ],
  "supplementaryQuestions": [
    {
      "questionId": "SQ-R1",
      "answer": {
        "answerType": "Number",
        "value": 2
      }
    }
  ],
  "capacityForLoss": {
    "canAffordLosses": true,
    "emergencyFundMonths": 6,
    "essentialExpensesCovered": true,
    "dependantsProvisionAdequate": true,
    "assessmentNotes": "Client has sufficient emergency fund and no debt"
  },
  "declarations": {
    "clientDeclaration": {
      "declarationType": "ATR_Accuracy",
      "signed": true,
      "signatureType": "Electronic",
      "ipAddress": "192.168.1.100"
    },
    "adviserDeclaration": {
      "declarationType": "ATR_Suitable",
      "signed": true
    }
  }
}
```

**Response:**

```json
{
  "atrAssessment": {
    // ... full assessment with generated risk profiles
  },
    "factfind": { "href": "/api/v2/factfinds/123" },
    "chooseProfile": { "href": "/api/v2/factfinds/123/atr-assessment/choose-profile", "method": "POST" }
  }
}
```

**Status Codes:**
- `200 OK` - ATR assessment updated successfully
- `201 Created` - ATR assessment created for the first time
- `400 Bad Request` - Invalid request (missing required questions, invalid scores)
- `404 Not Found` - Fact find not found
- `403 Forbidden` - User lacks permission to update this fact find

**Business Rules:**
1. All 15 standard questions must be answered
2. Supplementary questions are optional but recommended
3. System automatically generates 3 adjacent risk profiles based on total score
4. Capacity for loss must be assessed before finalizing
5. Both client and adviser declarations required for completion

---

#### 13.3.3 Choose Risk Profile

**Endpoint:** `POST /api/v2/factfinds/{factfindId}/atr-assessment/choose-profile`

**Description:** Client chooses their preferred risk profile from the 3 generated options (main, lower, higher).

**Path Parameters:**
- `factfindId` (required) - The fact find identifier

**Request Body:**

```json
{
  "riskRating": "Balanced",
  "riskScore": 45,
  "chosenBy": "Client",
  "reasonForChoice": "Matches my investment goals and risk tolerance",
  "adviserNotes": "Client comfortable with balanced approach, discussed volatility expectations"
}
```

**Response:**

```json
{
  "atrAssessment": {
    // ... full assessment with chosen profile updated
    "riskProfiles": {
      "generated": [ /* ... */ ],
      "chosen": {
        "riskRating": "Balanced",
        "riskScore": 45,
        "chosenBy": "Client",
        "chosenDate": "2026-02-18T11:00:00Z",
        "reasonForChoice": "Matches my investment goals and risk tolerance",
        "adviserNotes": "Client comfortable with balanced approach"
      }
    }
  }
}
```

**Status Codes:**
- `200 OK` - Risk profile chosen successfully
- `400 Bad Request` - Invalid risk profile (not one of the 3 generated options)
- `404 Not Found` - Fact find or ATR assessment not found
- `403 Forbidden` - User lacks permission

---

#### 13.3.4 Get ATR Assessment History (Risk Replay)

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/atr-assessment/history`

**Description:** Retrieve historical ATR assessments for a fact find. Supports "Risk Replay" - the ability to review how a client's risk profile has changed over time.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier

**Query Parameters:**
- `fromDate` (optional) - Filter from date (ISO 8601)
- `toDate` (optional) - Filter to date (ISO 8601)
- `sortOrder` (optional) - `asc` or `desc` (default: desc - newest first)

**Response:**

```json
{
  "assessments": [
    {
      "assessmentId": "atr-20260218-001",
      "assessmentDate": "2026-02-18T10:30:00Z",
      "templateVersion": "5.0",
      "totalScore": 67,
      "chosenRiskRating": "Balanced",
      "chosenRiskScore": 45,
      "assessedBy": {
        "id": 789,
        "name": "Jane Doe"
      },
      "changeFromPrevious": {
        "scoreDifference": +5,
        "riskRatingChange": "Increased",
        "significantChange": false
      },
        "fullDetails": { "href": "/api/v2/factfinds/123/atr-assessment/history/atr-20260218-001" }
      }
    },
    {
      "assessmentId": "atr-20250215-001",
      "assessmentDate": "2025-02-15T14:20:00Z",
      "templateVersion": "4.0",
      "totalScore": 62,
      "chosenRiskRating": "Cautious",
      "chosenRiskScore": 40,
      "assessedBy": {
        "id": 789,
        "name": "Jane Doe"
      },
      "changeFromPrevious": null
      }
    }
  ],
  "pagination": {
    "page": 1,
    "pageSize": 20,
    "totalItems": 2,
    "totalPages": 1
  },
    "factfind": { "href": "/api/v2/factfinds/123" },
    "compare": { "href": "/api/v2/factfinds/123/atr-assessment/compare?from={assessmentId1}&to={assessmentId2}" }
  }
}
```

**Status Codes:**
- `200 OK` - History retrieved successfully
- `404 Not Found` - Fact find not found
- `403 Forbidden` - User lacks permission

**Use Cases:**
1. **Annual Review** - Compare current assessment with previous year
2. **Life Event Tracking** - See how major events (retirement, inheritance) changed risk profile
3. **Regulatory Audit** - Demonstrate appropriate risk profiling over time
4. **Suitability Documentation** - Evidence that risk profile was reassessed appropriately

---

### 13.4 ATR Templates Reference Data

**Purpose:** ATR questionnaire templates are system configuration and reference data. They are not managed via the main API but can be queried to see available templates.

**Key Points:**
- Templates are managed by system administrators, not via public API
- No create, update, delete operations for templates
- Templates include the full questionnaire structure, scoring algorithms, and risk rating categories
- Multiple template versions can exist but only one is "active" at any time

#### 13.4.1 List Available ATR Templates

**Endpoint:** `GET /api/v2/reference/atr-templates`

**Description:** List available ATR questionnaire templates with metadata.

**Response:**

```json
{
  "templates": [
    {
      "id": 5407,
      "version": "5.0",
      "name": "FCA Standard ATR 2025",
      "description": "Updated 15-question ATR with enhanced capacity for loss assessment",
      "status": "Active",
      "regulatoryApprovalDate": "2025-01-01",
      "questionCount": 15,
      "supplementaryQuestionCount": 45,
      "estimatedCompletionTime": 12,
      "riskRatingCategories": [
        "VeryLowRisk",
        "LowRisk",
        "Cautious",
        "Balanced",
        "Adventurous",
        "HighRisk",
        "VeryHighRisk"
      ]
    },
    {
      "id": 6130,
      "version": "4.0",
      "name": "FCA Standard ATR 2024",
      "description": "Previous version - still valid for existing assessments",
      "status": "Archived",
      "regulatoryApprovalDate": "2024-01-01",
      "questionCount": 12,
      "supplementaryQuestionCount": 40,
      "estimatedCompletionTime": 10,
      "riskRatingCategories": [
        "VeryLowRisk",
        "LowRisk",
        "MediumRisk",
        "HighRisk",
        "VeryHighRisk"
      ]
    }
  ]
}
```

---

#### 13.4.2 Get ATR Template Details

**Endpoint:** `GET /api/v2/reference/atr-templates/{templateId}`

**Description:** Get full details of an ATR template including all questions, answer options, and scoring.

**Path Parameters:**
- `templateId` (required) - The template identifier

**Response:**

```json
{
  "id": 5407,
  "version": "5.0",
  "name": "FCA Standard ATR 2025",
  "description": "Updated 15-question ATR with enhanced capacity for loss assessment",
  "status": "Active",
  "regulatoryApprovalDate": "2025-01-01",
  "questionCount": 15,
  "questions": [
    {
      "questionId": "Q1",
      "questionNumber": 1,
      "questionText": "How long do you plan to invest for?",
      "questionType": "SingleChoice",
      "required": true,
      "weight": 1.2,
      "answers": [
        {
          "answerId": "A1-1",
          "answerText": "Less than 3 years",
          "score": 1
        },
        {
          "answerId": "A1-2",
          "answerText": "3-5 years",
          "score": 3
        },
        {
          "answerId": "A1-3",
          "answerText": "10-15 years",
          "score": 5
        },
        {
          "answerId": "A1-4",
          "answerText": "More than 15 years",
          "score": 7
        }
      ]
    }
  ],
  "supplementaryQuestions": [
    {
      "category": "Risk",
      "questionId": "SQ-R1",
      "questionText": "Number of financial dependants",
      "answerType": "Number",
      "required": false
    },
    {
      "category": "General",
      "questionId": "SQ-G1",
      "questionText": "Do you have a valid Will?",
      "answerType": "Boolean",
      "required": false
    }
  ],
  "scoringAlgorithm": {
    "method": "WeightedAverage",
    "maxScore": 100,
    "riskBands": [
      {
        "riskRating": "VeryLowRisk",
        "scoreRange": { "min": 0, "max": 20 },
        "assetAllocation": { "equities": 10, "bonds": 70, "cash": 20, "alternatives": 0 }
      },
      {
        "riskRating": "LowRisk",
        "scoreRange": { "min": 21, "max": 30 },
        "assetAllocation": { "equities": 25, "bonds": 60, "cash": 10, "alternatives": 5 }
      },
      {
        "riskRating": "Cautious",
        "scoreRange": { "min": 31, "max": 40 },
        "assetAllocation": { "equities": 40, "bonds": 45, "cash": 10, "alternatives": 5 }
      },
      {
        "riskRating": "Balanced",
        "scoreRange": { "min": 41, "max": 50 },
        "assetAllocation": { "equities": 60, "bonds": 30, "cash": 5, "alternatives": 5 }
      },
      {
        "riskRating": "Adventurous",
        "scoreRange": { "min": 51, "max": 60 },
        "assetAllocation": { "equities": 75, "bonds": 15, "cash": 5, "alternatives": 5 }
      },
      {
        "riskRating": "HighRisk",
        "scoreRange": { "min": 61, "max": 80 },
        "assetAllocation": { "equities": 85, "bonds": 5, "cash": 5, "alternatives": 5 }
      },
      {
        "riskRating": "VeryHighRisk",
        "scoreRange": { "min": 81, "max": 100 },
        "assetAllocation": { "equities": 95, "bonds": 0, "cash": 0, "alternatives": 5 }
      }
    ]
  }
}
```

---

### 13.5 Risk Assessment History API

**Purpose:** Historical tracking and comparison of ATR assessments over time (Risk Replay).

**Key Capabilities:**
- View all historical assessments for a fact find
- Compare two assessments side-by-side
- Track risk profile changes over time
- Regulatory audit trail

See Section 13.3.4 for the main history endpoint.

#### 13.5.1 Compare Two Assessments

**Endpoint:** `GET /api/v2/factfinds/{factfindId}/atr-assessment/compare`

**Description:** Compare two ATR assessments to see what changed.

**Path Parameters:**
- `factfindId` (required) - The fact find identifier

**Query Parameters:**
- `from` (required) - First assessment ID
- `to` (required) - Second assessment ID

**Response:**

```json
{
  "comparison": {
    "fromAssessment": {
      "assessmentId": "atr-20250215-001",
      "assessmentDate": "2025-02-15T14:20:00Z",
      "totalScore": 62,
      "chosenRiskRating": "Cautious",
      "chosenRiskScore": 40
    },
    "toAssessment": {
      "assessmentId": "atr-20260218-001",
      "assessmentDate": "2026-02-18T10:30:00Z",
      "totalScore": 67,
      "chosenRiskRating": "Balanced",
      "chosenRiskScore": 45
    },
    "changes": {
      "scoreDifference": +5,
      "riskRatingChange": "Increased from Cautious to Balanced",
      "significantChange": true,
      "changedQuestions": [
        {
          "questionId": "Q3",
          "questionText": "How would you react to a 20% fall in your investment value?",
          "previousAnswer": "Sell immediately",
          "newAnswer": "Hold and wait for recovery",
          "scoreDifference": +2
        }
      ],
      "capacityForLossChange": {
        "previous": {
          "canAffordLosses": false,
          "emergencyFundMonths": 3
        },
        "current": {
          "canAffordLosses": true,
          "emergencyFundMonths": 6
        },
        "improved": true
      }
    }
  }
}
```

**Status Codes:**
- `200 OK` - Comparison retrieved successfully
- `400 Bad Request` - Invalid assessment IDs
- `404 Not Found` - One or both assessments not found
- `403 Forbidden` - User lacks permission

---

### 13.6 Integration with FactFind Workflow

**ATR Assessment Lifecycle:**

1. **Initiate FactFind** - Create fact find with client details
2. **Gather Circumstances** - Income, expenditure, arrangements, goals
3. **Conduct ATR Assessment** - Submit 15 questions + supplementary questions
4. **System Generates Profiles** - 3 adjacent risk profiles created automatically
5. **Client Chooses Profile** - Client selects preferred profile with adviser guidance
6. **Capacity for Loss** - Adviser assesses financial capacity
7. **Declarations** - Both parties sign off
8. **Complete FactFind** - ATR assessment is now part of the completed fact find

**Key Integration Points:**

- ATR assessment embedded in FactFind Contract (Section 12.2)
- No separate ATR entity - it's a complex value type on FactFind
- History maintained automatically when ATR is updated
- Risk profile influences product recommendations

**Business Rules:**

1. **ATR Required for Completion** - FactFind cannot be marked complete without ATR assessment
2. **Annual Review** - ATR should be reviewed annually or after life events
3. **Capacity vs. Tolerance** - Both must align; if capacity is lower, use capacity-based profile
4. **Three Options Rule** - Always present 3 adjacent profiles (main, +1 band, -1 band)
5. **Regulatory Documentation** - All assessments preserved for audit trail

---
## 13. Reference Data API

### 13.1 Performance Considerations

**Query Optimization:**
- Index all foreign keys for fast joins
- Index commonly filtered fields (status, clientType, dateOfBirth)
- Use covering indexes for list queries
- Implement query result caching (Redis)

**Lazy vs Eager Loading:**
- Default: Lazy load related entities
- Use `expand` query parameter for eager loading
- Limit expansion depth to 2 levels
- Cache expanded results aggressively

**Pagination:**
- Cursor-based pagination for large datasets (>10,000 records)
- Offset-based pagination acceptable for small datasets
- Default page size: 20
- Maximum page size: 100

### 13.2 Caching Strategy

**HTTP Caching:**
- ETags for all GET requests on single resources
- Cache-Control: private for user-specific data
- Cache-Control: public for reference data
- Vary header based on Accept-Language, Authorization

**Application Caching (Redis):**
- Reference data: 24 hours TTL
- Enum values: 7 days TTL
- Client lists: 5 minutes TTL
- Client details: 15 minutes TTL
- FactFind summaries: 5 minutes TTL

**Cache Invalidation:**
- Invalidate on write operations (POST, PUT, PATCH, DELETE)
- Publish cache invalidation events
- Subscribers update local caches

### 13.3 Rate Limiting

**Per-User Limits:**
- 1,000 requests per hour per user
- 100 requests per minute per user
- Burst allowance: 10 requests per second

**Per-Tenant Limits:**
- 10,000 requests per hour per tenant
- 1,000 requests per minute per tenant

**Headers:**
```http
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 847
X-RateLimit-Reset: 1708088400
```

**Rate Limit Exceeded Response:**
```http
HTTP/1.1 429 Too Many Requests
Retry-After: 3600

{
  "type": "https://api.factfind.com/problems/rate-limit-error",
  "title": "Rate Limit Exceeded",
  "status": 429,
  "detail": "You have exceeded the rate limit of 1000 requests per hour",
  "retryAfter": 3600
}
```

### 13.4 API Versioning

**Version Lifecycle:**
1. **Development** - Not publicly available
2. **Beta** - Available for early adopters, may change
3. **Stable** - Production-ready, fully supported
4. **Deprecated** - Maintenance mode, 12 months notice before sunset
5. **Sunset** - No longer available, returns 410 Gone

**Deprecation Process:**
1. Announce deprecation 12 months in advance
2. Include `Deprecation` header in responses
3. Provide migration guide
4. Support parallel versions during transition
5. Sunset after transition period

**Deprecation Header:**
```http
Deprecation: Sun, 01 Jan 2028 00:00:00 GMT
Sunset: Sun, 01 Jul 2028 00:00:00 GMT
Link: <https://docs.factfind.com/migration/v1-to-v2>; rel="deprecation"
```

### 13.5 Security Best Practices

**Input Validation:**
- Validate all inputs against schema
- Sanitize user input to prevent injection attacks
- Use parameterized queries for database access
- Validate content-type headers

**Output Encoding:**
- Encode all output to prevent XSS
- Use appropriate content-type headers
- Implement CSP (Content Security Policy)

**HTTPS/TLS:**
- Require TLS 1.2 or higher
- Use strong cipher suites
- Implement HSTS (HTTP Strict Transport Security)
- Certificate pinning for mobile apps

**API Keys & Tokens:**
- Rotate secrets regularly (90 days)
- Use short-lived access tokens (1 hour)
- Long-lived refresh tokens (30 days)
- Revoke tokens on logout or compromise

---


## 14. Entity Contracts

This section defines the unified entity contracts used throughout the FactFind API. Following the **Single Contract Principle** (Section 1.7), each entity has one canonical contract used for both requests (POST, PUT, PATCH) and responses (GET).

Each field is annotated with its behavioral characteristics:
- **required-on-create** - Must be provided when creating the entity
- **optional** - Can be omitted in any operation
- **read-only** - System-generated, cannot be set by clients
- **write-once** - Can only be set on create, immutable thereafter
- **updatable** - Can be modified via PUT/PATCH operations

### 14.1 Client Contract

The `Client` contract represents a client entity (Person, Corporate, or Trust) with all demographic, regulatory, and preference information using a **composition pattern** with conditional types.

**Reference Type:** Client is a reference type with identity (has `id` field).

**Composition Pattern Architecture:**
- **TClient** table contains common fields and `clientType` discriminator
- **PersonValue**, **CorporateValue**, **TrustValue** are conditional embedded types based on `clientType`
- Person-specific fields only present when `clientType="Person"`
- Corporate-specific fields only present when `clientType="Corporate"`
- Trust-specific fields only present when `clientType="Trust"`

**Key Features:**
- **Composition Pattern** - Conditional value types based on client type discriminator
- **PersonValue** - Person-specific demographics (DOB, gender, marital status, health, occupation, vulnerabilities)
- **CorporateValue** - Corporate-specific details (company name, registration, directors, shareholders)
- **TrustValue** - Trust-specific information (trust name, type, settlor, trustees, beneficiaries)
- **TerritorialProfile** - Territorial status, residency, domicile, citizenship (all client types)
- **Addresses** - Full address history embedded as value types
- **Contacts** - All contact methods (email, phone, mobile, work, website) embedded
- **Identity Verification** - KYC, AML checks, MLR compliance embedded
- **Vulnerabilities** - Client vulnerabilities embedded in PersonValue (Person only, Consumer Duty)
- **Data Protection** - GDPR consent and privacy management embedded
- **Marketing Preferences** - Channel preferences and interests embedded
- **Estate Planning** - Will, LPA, gifts, trusts, IHT embedded (Person only)

---

#### 14.1.1 Person Client Example

**Person client** with full PersonValue embedded:

```json
{
  "id": 123,
  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "clientNumber": "C00001234",
  "clientType": "Person",
  "personValue": {
    "title": "MR",
    "firstName": "John",
    "middleNames": "Michael Robert",
    "lastName": "Smith",
    "preferredName": "John",
    "fullName": "Mr John Michael Robert Smith",
    "salutation": "Mr Smith",
    "dateOfBirth": "1980-05-15",
    "age": 45,
    "gender": "M",
    "maritalStatus": {
      "code": "MAR",
      "display": "Married",
      "effectiveFrom": "2005-06-20"
    },
    "niNumber": "AB123456C",
    "smokingStatus": "NEVER",
    "healthMetrics": {
      "heightCm": 178.0,
      "weightKg": 82.5,
      "bmi": 26.04,
      "bmiCategory": "Overweight",
      "lastMeasured": "2026-01-15"
    },
    "occupation": "Senior Software Engineer",
    "occupationCode": {
      "code": "2136",
      "display": "Programmers and Software Development Professionals",
      "socVersion": "SOC2020"
    },
    "employmentStatus": "Employed",
    "isDeceased": false,
    "deceasedDate": null,
    "vulnerabilities": [
      {
        "vulnerabilityType": "HEALTH",
        "severity": "Medium",
        "description": "Requires large print documents due to visual impairment",
        "assessmentDate": "2020-01-15",
        "reviewDate": "2025-01-15",
        "adjustmentsRequired": [
          "Large print documents (16pt minimum)",
          "Extended appointment times (allow 90 minutes)",
          "Well-lit meeting rooms"
        ],
        "isActive": true,
        "recordedBy": {
          "id": 789,
          "name": "Jane Doe"
        }
      }
    ]
  },
  "territorialProfile": {
    "ukResident": true,
    "ukDomicile": true,
    "expatriate": false,
    "countryOfBirth": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "placeOfBirth": "London",
    "countryOfResidence": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countryOfDomicile": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countryOfOrigin": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countriesOfCitizenship": [
      {
        "country": {
          "code": "GB",
          "display": "United Kingdom",
          "alpha3": "GBR"
        },
        "isPrimary": true,
        "acquisitionDate": "1980-05-15",
        "acquisitionMethod": "BIRTH"
      }
    ]
  },
  "addresses": [
    {
      "addressType": "RES",
      "line1": "123 Main Street",
      "line2": "Apartment 4B",
      "line3": null,
      "line4": null,
      "city": "London",
      "county": "GLA",
      "postcode": "SW1A 1AA",
      "country": {
        "code": "GB",
        "display": "United Kingdom",
        "alpha3": "GBR"
      },
      "isPrimary": true,
      "fromDate": "2020-01-15",
      "toDate": null,
      "yearsAtAddress": 6
    },
    {
      "addressType": "PREV",
      "line1": "45 Old Road",
      "line2": null,
      "line3": null,
      "line4": null,
      "city": "Manchester",
      "county": "GTM",
      "postcode": "M1 1AA",
      "country": {
        "code": "GB",
        "display": "United Kingdom",
        "alpha3": "GBR"
      },
      "isPrimary": false,
      "fromDate": "2015-03-10",
      "toDate": "2020-01-14",
      "yearsAtAddress": 5
    }
  ],
  "contacts": [
    {
      "contactType": "EMAIL",
      "value": "john.smith@example.com",
      "isPrimary": true,
      "isVerified": true,
      "verifiedDate": "2020-01-15"
    },
    {
      "contactType": "MOBILE",
      "value": "+44 7700 900123",
      "isPrimary": true,
      "isVerified": true,
      "verifiedDate": "2020-01-15"
    },
    {
      "contactType": "PHONE",
      "value": "+44 20 7946 0958",
      "isPrimary": false,
      "isVerified": false
    },
    {
      "contactType": "WORK_PHONE",
      "value": "+44 20 7946 0123",
      "isPrimary": false,
      "isVerified": false
    }
  ],
  "identityVerification": {
    "verificationStatus": "Verified",
    "verificationDate": "2020-01-15",
    "expiryDate": "2025-01-15",
    "nextReviewDate": "2025-01-15",
    "verifiedBy": {
      "id": 789,
      "name": "Jane Doe"
    },
    "verificationMethod": "Electronic",
    "documents": [
      {
        "documentType": "Passport",
        "documentNumber": "502135321",
        "issueDate": "2020-05-15",
        "expiryDate": "2030-05-15",
        "issuingCountry": "GB",
        "verified": true,
        "verifiedDate": "2020-01-15",
        "verificationSource": "GOV.UK Verify"
      },
      {
        "documentType": "DrivingLicense",
        "documentNumber": "SMITH801055JM9IJ",
        "issueDate": "2020-05-15",
        "expiryDate": "2030-05-15",
        "issuingCountry": "GB",
        "verified": true,
        "verifiedDate": "2020-01-15",
        "verificationSource": "DVLA"
      }
    ],
    "amlChecks": {
      "lastCheckDate": "2020-01-15",
      "nextCheckDate": "2025-01-15",
      "riskRating": "Low",
      "sanctionsChecked": true,
      "sanctionsMatches": 0,
      "sanctionsCheckSource": "World-Check",
      "pepChecked": true,
      "isPep": false,
      "pepCheckSource": "World-Check",
      "adverseMediaChecked": true,
      "adverseMediaMatches": 0,
      "adverseMediaCheckSource": "LexisNexis",
      "overallStatus": "Clear",
      "checkPerformedBy": {
        "id": 789,
        "name": "Jane Doe"
      }
    },
    "mlrCompliance": {
      "kycCompliant": true,
      "kycComplianceDate": "2020-01-15",
      "cddCompleted": true,
      "cddCompletedDate": "2020-01-15",
      "eddRequired": false,
      "eddCompletedDate": null,
      "complianceStatus": "Compliant",
      "complianceDate": "2020-01-15",
      "reviewPeriod": "Annual",
      "lastReviewDate": "2025-01-15",
      "nextReviewDate": "2026-01-15"
    },
    "sourceOfWealth": {
      "primarySource": "Employment",
      "secondarySource": "Investments",
      "description": "Senior executive salary and investment portfolio",
      "evidenceProvided": true,
      "evidenceType": "Payslips, Investment Statements",
      "verifiedDate": "2020-01-15"
    },
    "sourceOfFunds": {
      "source": "Savings",
      "description": "Personal savings accumulated over 20 years",
      "evidenceProvided": true,
      "evidenceType": "Bank Statements",
      "verifiedDate": "2020-01-15"
    }
  },
  "dataProtection": {
    "gdprConsent": {
      "dataProcessing": {
        "consented": true,
        "consentDate": "2020-01-15",
        "consentMethod": "Explicit",
        "lawfulBasis": "Consent",
        "consentText": "I consent to my personal data being processed for financial advice services",
        "version": "1.0"
      },
      "marketing": {
        "consented": true,
        "consentDate": "2020-01-15",
        "consentMethod": "Explicit",
        "lawfulBasis": "Consent",
        "consentText": "I consent to receiving marketing communications",
        "version": "1.0"
      },
      "profiling": {
        "consented": false,
        "consentDate": null,
        "consentMethod": null,
        "lawfulBasis": null,
        "consentText": null,
        "version": null
      },
      "thirdPartySharing": {
        "consented": false,
        "consentDate": null,
        "consentMethod": null,
        "lawfulBasis": null,
        "consentText": null,
        "version": null
      }
    },
    "privacyPolicy": {
      "version": "2.1",
      "acceptedDate": "2020-01-15",
      "url": "https://api.factfind.com/privacy-policy",
      "acceptanceMethod": "Electronic"
    },
    "dataRetention": {
      "retentionPeriod": "7 years after relationship ends",
      "retentionBasis": "FCA Regulatory Requirement",
      "relationshipEndDate": null,
      "retentionEndDate": null,
      "archiveDate": null
    },
    "rightsExercised": {
      "dsarRequests": 0,
      "rectificationRequests": 0,
      "erasureRequests": 0,
      "portabilityRequests": 0,
      "restrictionRequests": 0,
      "objectionRequests": 0,
      "lastRequestDate": null,
      "lastRequestType": null
    },
    "breachNotifications": {
      "breachCount": 0,
      "lastBreachDate": null,
      "breachesNotified": []
    }
  },
  "marketingPreferences": {
    "channels": {
      "email": {
        "consented": true,
        "consentDate": "2020-01-15",
        "doubleOptInDate": "2020-01-15",
        "optOutDate": null,
        "frequency": "Monthly",
        "lastContactDate": "2026-02-01",
        "unsubscribed": false
      },
      "phone": {
        "consented": false,
        "consentDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": false,
        "tpsChecked": true,
        "tpsRegistered": false,
        "tpsCheckDate": "2020-01-15"
      },
      "sms": {
        "consented": true,
        "consentDate": "2020-01-15",
        "optOutDate": null,
        "frequency": "Quarterly",
        "lastContactDate": "2026-01-15",
        "unsubscribed": false
      },
      "post": {
        "consented": false,
        "consentDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": false,
        "mpsChecked": true,
        "mpsRegistered": false,
        "mpsCheckDate": "2020-01-15"
      },
      "socialMedia": {
        "consented": false,
        "consentDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": false
      }
    },
    "interests": [
      "Retirement Planning",
      "Investment Advice",
      "Tax Planning",
      "Estate Planning"
    ],
    "productInterests": [
      "Pensions",
      "ISAs",
      "Investments",
      "Protection"
    ],
    "suppressionList": false,
    "unsubscribeAll": false,
    "unsubscribeAllDate": null,
    "lastUpdated": "2020-01-15",
    "preferredContactTime": "Weekday Evenings",
    "doNotContact": false,
    "doNotContactReason": null
  },
  "estatePlanning": {
    "will": {
      "hasWill": true,
      "willDate": "2020-06-15",
      "lastReviewed": "2024-06-15",
      "nextReviewDate": "2027-06-15",
      "isUpToDate": true,
      "willType": "Simple Will",
      "willStoredWith": "Smith & Co Solicitors",
      "willStoredLocation": "London Office",
      "executors": [
        {
          "name": "Sarah Smith",
          "relationship": "Spouse",
          "type": "Primary",
          "contactDetails": "sarah.smith@example.com"
        },
        {
          "name": "David Smith",
          "relationship": "Brother",
          "type": "Substitute",
          "contactDetails": "david.smith@example.com"
        }
      ],
      "beneficiaries": [
        {
          "name": "Sarah Smith",
          "relationship": "Spouse",
          "percentage": 100,
          "notes": "Primary beneficiary"
        }
      ],
      "advisedByUs": true,
      "advisedDate": "2020-06-01"
    },
    "powerOfAttorney": {
      "hasLPA": true,
      "lpaType": "Property and Financial Affairs",
      "lpaDate": "2021-05-10",
      "lpaRegistered": true,
      "lpaRegistrationDate": "2021-05-15",
      "lpaExpiryDate": null,
      "attorneys": [
        {
          "name": "Sarah Smith",
          "relationship": "Spouse",
          "type": "Primary",
          "contactDetails": "sarah.smith@example.com"
        }
      ],
      "instructions": "Can act jointly and severally",
      "advisedByUs": true,
      "advisedDate": "2021-04-15"
    },
    "healthWelfareLPA": {
      "hasHealthWelfareLPA": true,
      "lpaDate": "2021-05-10",
      "lpaRegistered": true,
      "lpaRegistrationDate": "2021-05-15",
      "attorneys": [
        {
          "name": "Sarah Smith",
          "relationship": "Spouse",
          "type": "Primary",
          "contactDetails": "sarah.smith@example.com"
        }
      ]
    },
    "gifts": {
      "totalGiftsLastYear": {
        "amount": 6000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "annualExemptionUsed": {
        "amount": 6000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "annualExemptionAvailable": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "petsOutstanding": 2,
      "petDetails": [
        {
          "recipient": "Adult Child 1",
          "amount": {
            "amount": 10000.00,
            "currency": {
              "code": "GBP",
              "display": "British Pound",
              "symbol": "£"
            }
          },
          "dateOfGift": "2023-05-15",
          "survivePeriod": 7,
          "yearsRemaining": 4
        },
        {
          "recipient": "Adult Child 2",
          "amount": {
            "amount": 10000.00,
            "currency": {
              "code": "GBP",
              "display": "British Pound",
              "symbol": "£"
            }
          },
          "dateOfGift": "2024-05-15",
          "survivePeriod": 7,
          "yearsRemaining": 5
        }
      ],
      "regularGiftsFromIncome": {
        "hasRegularGifts": true,
        "amount": {
          "amount": 500.00,
          "currency": {
            "code": "GBP",
            "display": "British Pound",
            "symbol": "£"
          }
        },
        "frequency": "Monthly",
        "recipient": "Grandchildren"
      }
    },
    "trusts": {
      "hasTrusts": false,
      "numberOfTrusts": 0,
      "trustDetails": []
    },
    "ihtEstimate": {
      "estimatedEstate": {
        "amount": 650000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "nilRateBand": {
        "amount": 325000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "residenceNilRateBand": {
        "amount": 175000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "transferableNilRateBand": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "totalNilRateBand": {
        "amount": 500000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "taxableEstate": {
        "amount": 150000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "estimatedIHT": {
        "amount": 60000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "ihtRate": 0.40,
      "calculationDate": "2026-02-18",
      "nextReviewDate": "2027-02-18"
    },
    "lifeInsuranceInTrust": {
      "hasLifeInsuranceInTrust": true,
      "policies": [
        {
          "policyRef": "LI-123456",
          "sumAssured": {
            "amount": 250000.00,
            "currency": {
              "code": "GBP",
              "display": "British Pound",
              "symbol": "£"
            }
          },
          "trustType": "Discretionary Trust",
          "beneficiaries": ["Spouse", "Children"]
        }
      ]
    }
  },
  "isMatchingServiceProposition": false,
  "matchingServicePropositionReason": null,
  "isHeadOfFamilyGroup": true,
  "isJoint": true,
  "spouseRef": {
    "id": 124,
    "href": "/api/v2/factfinds/{factfindId}/clients/124",
    "name": "Sarah Smith",
    "clientNumber": "C00001235",
    "type": "Person"
  },
  "dependants": [
    {
      "name": "Emma Smith",
      "relationship": "Daughter",
      "dateOfBirth": "2010-03-15",
      "age": 16,
      "isFinanciallyDependent": true,
      "isDisabled": false
    },
    {
      "name": "Oliver Smith",
      "relationship": "Son",
      "dateOfBirth": "2012-08-22",
      "age": 14,
      "isFinanciallyDependent": true,
      "isDisabled": false
    }
  ],
  "serviceStatus": "Active",
  "serviceStatusDate": "2020-01-15",
  "clientSegment": "A",
  "clientSegmentDate": "2020-01-15",
  "clientCategory": "HighNetWorth",
  "financialProfile": {
    "grossAnnualIncome": {
      "amount": 75000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "householdIncome": {
      "amount": 120000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netWorth": {
      "amount": 450000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "householdNetWorth": {
      "amount": 650000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalAssets": {
      "amount": 500000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalJointAssets": {
      "amount": 200000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "calculatedAt": "2026-02-18T10:30:00Z",
    "lastReviewDate": "2026-02-18"
  },
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Jane Doe",
    "code": "ADV001"
  },
  "paraplannerRef": {
    "id": 790,
    "href": "/api/v2/advisers/790",
    "name": "Tom Johnson",
    "code": "PP001"
  },
  "officeRef": {
    "id": 1,
    "name": "London Office",
    "code": "LON"
  },
  "createdAt": "2020-01-15T10:30:00Z",
  "updatedAt": "2026-02-16T14:30:00Z",
  "createdBy": {
    "id": 789,
    "name": "Jane Doe"
  },
  "updatedBy": {
    "id": 789,
    "name": "Jane Doe"
  },
  "_etag": "W/\"v2-20260216-143000\""/clients/123" },
    "factfind": { "href": "/api/v2/factfinds/456" },
    "spouse": { "href": "/api/v2/factfinds/{factfindId}/clients/124" },
    "adviser": { "href": "/api/v2/advisers/789" }
  }
}
```

---

#### 14.1.2 Corporate Client Example

**Corporate client** with full CorporateValue embedded:

```json
{
  "id": 567,
  "factfind": {
    "id": 890,
    "href": "/api/v2/factfinds/890",
    "factFindNumber": "FF-2025-00456",
    "status": "INP"
  },
  "clientNumber": "C00005678",
  "clientType": "Corporate",
  "corporateValue": {
    "companyName": "TechVenture Solutions Ltd",
    "tradingName": "TechVenture",
    "registrationNumber": "09876543",
    "incorporationDate": "2015-03-20",
    "companyType": "LTD",
    "vatNumber": "GB123456789",
    "companyStatus": "ACTIVE",
    "sicCodes": [
      {
        "code": "62012",
        "display": "Business and domestic software development"
      },
      {
        "code": "62020",
        "display": "Information technology consultancy activities"
      }
    ],
    "numberOfEmployees": 45,
    "annualTurnover": {
      "amount": 3500000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "directors": [
      {
        "personRef": {
          "id": 568,
          "href": "/api/v2/factfinds/{factfindId}/clients/568",
          "name": "Robert Johnson",
          "clientNumber": "C00005679"
        },
        "appointedDate": "2015-03-20",
        "role": "Managing Director",
        "shareholding": 60.0,
        "isActive": true
      },
      {
        "personRef": {
          "id": 569,
          "href": "/api/v2/factfinds/{factfindId}/clients/569",
          "name": "Amanda Chen",
          "clientNumber": "C00005680"
        },
        "appointedDate": "2015-03-20",
        "role": "Technical Director",
        "shareholding": 40.0,
        "isActive": true
      }
    ],
    "shareholders": [
      {
        "shareholderRef": {
          "id": 568,
          "name": "Robert Johnson",
          "type": "Person"
        },
        "sharesHeld": 600,
        "shareClass": "Ordinary",
        "percentage": 60.0,
        "nominalValue": {
          "amount": 600.00,
          "currency": {
            "code": "GBP",
            "display": "British Pound",
            "symbol": "£"
          }
        }
      },
      {
        "shareholderRef": {
          "id": 569,
          "name": "Amanda Chen",
          "type": "Person"
        },
        "sharesHeld": 400,
        "shareClass": "Ordinary",
        "percentage": 40.0,
        "nominalValue": {
          "amount": 400.00,
          "currency": {
            "code": "GBP",
            "display": "British Pound",
            "symbol": "£"
          }
        }
      }
    ],
    "registeredOffice": {
      "line1": "Tech Park Building 5",
      "line2": "Silicon Street",
      "line3": null,
      "line4": null,
      "city": "London",
      "county": "GLA",
      "postcode": "EC2A 4DN",
      "country": {
        "code": "GB",
        "display": "United Kingdom",
        "alpha3": "GBR"
      }
    },
    "accountsFilingDate": "2026-12-31",
    "confirmationStatementDate": "2026-03-20",
    "financialYearEnd": "2026-12-31"
  },
  "addresses": [
    {
      "addressType": "REGISTERED",
      "line1": "Tech Park Building 5",
      "line2": "Silicon Street",
      "line3": null,
      "line4": null,
      "city": "London",
      "county": "GLA",
      "postcode": "EC2A 4DN",
      "country": {
        "code": "GB",
        "display": "United Kingdom",
        "alpha3": "GBR"
      },
      "isPrimary": true,
      "fromDate": "2015-03-20",
      "toDate": null,
      "yearsAtAddress": 11
    },
    {
      "addressType": "TRADING",
      "line1": "Innovation Hub",
      "line2": "25 Tech Square",
      "line3": null,
      "line4": null,
      "city": "London",
      "county": "GLA",
      "postcode": "E1 6AN",
      "country": {
        "code": "GB",
        "display": "United Kingdom",
        "alpha3": "GBR"
      },
      "isPrimary": false,
      "fromDate": "2020-06-01",
      "toDate": null,
      "yearsAtAddress": 6
    }
  ],
  "contacts": [
    {
      "contactType": "EMAIL",
      "value": "info@techventure.com",
      "isPrimary": true,
      "isVerified": true,
      "verifiedDate": "2015-03-20"
    },
    {
      "contactType": "PHONE",
      "value": "+44 20 7946 1234",
      "isPrimary": true,
      "isVerified": true,
      "verifiedDate": "2015-03-20"
    },
    {
      "contactType": "WEBSITE",
      "value": "https://www.techventure.com",
      "isPrimary": false,
      "isVerified": true,
      "verifiedDate": "2015-03-20"
    }
  ],
  "identityVerification": {
    "verificationStatus": "Verified",
    "verificationDate": "2015-03-20",
    "expiryDate": "2028-03-20",
    "nextReviewDate": "2027-03-20",
    "verifiedBy": {
      "id": 800,
      "name": "Michael Brown"
    },
    "verificationMethod": "Electronic",
    "documents": [
      {
        "documentType": "Certificate of Incorporation",
        "documentNumber": "09876543",
        "issueDate": "2015-03-20",
        "expiryDate": null,
        "issuingCountry": "GB",
        "verified": true,
        "verifiedDate": "2015-03-20",
        "verificationSource": "Companies House"
      },
      {
        "documentType": "VAT Registration Certificate",
        "documentNumber": "GB123456789",
        "issueDate": "2015-04-15",
        "expiryDate": null,
        "issuingCountry": "GB",
        "verified": true,
        "verifiedDate": "2015-04-20",
        "verificationSource": "HMRC"
      }
    ],
    "amlChecks": {
      "lastCheckDate": "2025-03-20",
      "nextCheckDate": "2028-03-20",
      "riskRating": "Low",
      "sanctionsChecked": true,
      "sanctionsMatches": 0,
      "sanctionsCheckSource": "Dow Jones",
      "pepChecked": true,
      "isPep": false,
      "pepCheckSource": "Dow Jones",
      "adverseMediaChecked": true,
      "adverseMediaMatches": 0,
      "adverseMediaCheckSource": "LexisNexis",
      "overallStatus": "Clear",
      "checkPerformedBy": {
        "id": 800,
        "name": "Michael Brown"
      }
    },
    "mlrCompliance": {
      "kycCompliant": true,
      "kycComplianceDate": "2015-03-20",
      "cddCompleted": true,
      "cddCompletedDate": "2015-03-20",
      "eddRequired": false,
      "eddCompletedDate": null,
      "complianceStatus": "Compliant",
      "complianceDate": "2015-03-20",
      "reviewPeriod": "Triennial",
      "lastReviewDate": "2025-03-20",
      "nextReviewDate": "2028-03-20"
    },
    "sourceOfWealth": {
      "primarySource": "Trading Activities",
      "secondarySource": "Retained Earnings",
      "description": "Software development and IT consulting services",
      "evidenceProvided": true,
      "evidenceType": "Annual Accounts, Management Accounts",
      "verifiedDate": "2025-03-20"
    },
    "sourceOfFunds": {
      "source": "Operating Profits",
      "description": "Revenue from software development contracts",
      "evidenceProvided": true,
      "evidenceType": "Bank Statements, Invoices",
      "verifiedDate": "2025-03-20"
    }
  },
  "territorialProfile": {
    "ukResident": true,
    "ukDomicile": true,
    "countryOfOrigin": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countryOfResidence": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countryOfDomicile": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    }
  },
  "dataProtection": {
    "gdprConsent": {
      "dataProcessing": {
        "consented": true,
        "consentDate": "2015-03-20",
        "consentMethod": "Written",
        "lawfulBasis": "Legitimate Interest",
        "consentText": "Company consents to data processing for corporate financial advice services",
        "version": "1.0"
      },
      "marketing": {
        "consented": true,
        "consentDate": "2015-03-20",
        "consentMethod": "Written",
        "lawfulBasis": "Consent",
        "consentText": "Company consents to receiving marketing communications",
        "version": "1.0"
      },
      "profiling": {
        "consented": false,
        "consentDate": null,
        "consentMethod": null,
        "lawfulBasis": null,
        "consentText": null,
        "version": null
      },
      "thirdPartySharing": {
        "consented": false,
        "consentDate": null,
        "consentMethod": null,
        "lawfulBasis": null,
        "consentText": null,
        "version": null
      }
    },
    "privacyPolicy": {
      "version": "2.1",
      "acceptedDate": "2015-03-20",
      "url": "https://api.factfind.com/privacy-policy",
      "acceptanceMethod": "Written"
    },
    "dataRetention": {
      "retentionPeriod": "7 years after relationship ends",
      "retentionBasis": "FCA Regulatory Requirement",
      "relationshipEndDate": null,
      "retentionEndDate": null,
      "archiveDate": null
    },
    "rightsExercised": {
      "dsarRequests": 0,
      "rectificationRequests": 0,
      "erasureRequests": 0,
      "portabilityRequests": 0,
      "restrictionRequests": 0,
      "objectionRequests": 0,
      "lastRequestDate": null,
      "lastRequestType": null
    },
    "breachNotifications": {
      "breachCount": 0,
      "lastBreachDate": null,
      "breachesNotified": []
    }
  },
  "marketingPreferences": {
    "channels": {
      "email": {
        "consented": true,
        "consentDate": "2015-03-20",
        "doubleOptInDate": "2015-03-20",
        "optOutDate": null,
        "frequency": "Quarterly",
        "lastContactDate": "2026-01-15",
        "unsubscribed": false
      },
      "phone": {
        "consented": true,
        "consentDate": "2015-03-20",
        "optOutDate": null,
        "frequency": "Annual",
        "lastContactDate": "2025-12-10",
        "unsubscribed": false,
        "tpsChecked": false,
        "tpsRegistered": false,
        "tpsCheckDate": null
      },
      "sms": {
        "consented": false,
        "consentDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": false
      },
      "post": {
        "consented": true,
        "consentDate": "2015-03-20",
        "optOutDate": null,
        "frequency": "Biannual",
        "lastContactDate": "2025-11-01",
        "unsubscribed": false,
        "mpsChecked": false,
        "mpsRegistered": false,
        "mpsCheckDate": null
      },
      "socialMedia": {
        "consented": false,
        "consentDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": false
      }
    },
    "interests": [
      "Corporate Pensions",
      "Group Life Assurance",
      "Key Person Insurance",
      "Business Protection"
    ],
    "productInterests": [
      "Group Pensions",
      "Group Life",
      "Keyman Protection",
      "Shareholder Protection"
    ],
    "suppressionList": false,
    "unsubscribeAll": false,
    "unsubscribeAllDate": null,
    "lastUpdated": "2015-03-20",
    "preferredContactTime": "Business Hours",
    "doNotContact": false,
    "doNotContactReason": null
  },
  "serviceStatus": "Active",
  "serviceStatusDate": "2015-03-20",
  "clientSegment": "B",
  "clientSegmentDate": "2015-03-20",
  "clientCategory": "SmallBusiness",
  "financialProfile": {
    "grossAnnualIncome": {
      "amount": 3500000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netWorth": {
      "amount": 1250000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalAssets": {
      "amount": 2100000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "calculatedAt": "2026-02-18T10:30:00Z",
    "lastReviewDate": "2026-02-18"
  },
  "adviser": {
    "id": 800,
    "href": "/api/v2/advisers/800",
    "name": "Michael Brown",
    "code": "ADV002"
  },
  "paraplannerRef": {
    "id": 801,
    "href": "/api/v2/advisers/801",
    "name": "Lisa Wong",
    "code": "PP002"
  },
  "officeRef": {
    "id": 2,
    "name": "Manchester Office",
    "code": "MAN"
  },
  "createdAt": "2015-03-20T09:00:00Z",
  "updatedAt": "2026-02-16T14:30:00Z",
  "createdBy": {
    "id": 800,
    "name": "Michael Brown"
  },
  "updatedBy": {
    "id": 800,
    "name": "Michael Brown"
  },
  "_etag": "W/\"v2-20260216-143000\""/clients/567" },
    "factfind": { "href": "/api/v2/factfinds/890" },
    "adviser": { "href": "/api/v2/advisers/800" }
  }
}
```

---

#### 14.1.3 Trust Client Example

**Trust client** with full TrustValue embedded:

```json
{
  "id": 999,
  "factfind": {
    "id": 1111,
    "href": "/api/v2/factfinds/1111",
    "factFindNumber": "FF-2025-00789",
    "status": "INP"
  },
  "clientNumber": "C00009999",
  "clientType": "Trust",
  "trustValue": {
    "trustName": "The Smith Family Discretionary Trust",
    "trustType": "DISCRETIONARY",
    "settlementDate": "2018-04-15",
    "trustRegistrationNumber": "TRN12345678",
    "taxReference": "1234567890",
    "trustDeed": {
      "document": "DEED-2018-04-15-SMITH",
      "documentUrl": "https://docs.example.com/trusts/deed-smith-2018.pdf",
      "executionDate": "2018-04-15",
      "storedWith": "Harrison & Partners Solicitors",
      "lastReviewedDate": "2024-04-15"
    },
    "settlor": {
      "personRef": {
        "id": 1000,
        "href": "/api/v2/factfinds/{factfindId}/clients/1000",
        "name": "William Smith",
        "clientNumber": "C00010000"
      },
      "settlementAmount": {
        "amount": 500000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "settlementDate": "2018-04-15",
      "isDeceased": false
    },
    "trustees": [
      {
        "personRef": {
          "id": 1001,
          "href": "/api/v2/factfinds/{factfindId}/clients/1001",
          "name": "Margaret Smith",
          "clientNumber": "C00010001"
        },
        "appointedDate": "2018-04-15",
        "role": "Principal Trustee",
        "isProfessionalTrustee": false,
        "isActive": true
      },
      {
        "personRef": {
          "id": 1002,
          "href": "/api/v2/factfinds/{factfindId}/clients/1002",
          "name": "James Harrison",
          "clientNumber": "C00010002"
        },
        "appointedDate": "2018-04-15",
        "role": "Professional Trustee",
        "isProfessionalTrustee": true,
        "professionalFirm": "Harrison & Partners Solicitors",
        "isActive": true
      }
    ],
    "beneficiaries": [
      {
        "personRef": {
          "id": 1003,
          "name": "Alexander Smith",
          "type": "Person"
        },
        "relationship": "Grandchild",
        "beneficiaryType": "Discretionary",
        "class": "Income and Capital",
        "percentage": null,
        "fromDate": "2018-04-15",
        "isActive": true
      },
      {
        "personRef": {
          "id": 1004,
          "name": "Emily Smith",
          "type": "Person"
        },
        "relationship": "Grandchild",
        "beneficiaryType": "Discretionary",
        "class": "Income and Capital",
        "percentage": null,
        "fromDate": "2018-04-15",
        "isActive": true
      },
      {
        "personRef": {
          "id": 1005,
          "name": "Sophie Smith",
          "type": "Person"
        },
        "relationship": "Grandchild",
        "beneficiaryType": "Discretionary",
        "class": "Income and Capital",
        "percentage": null,
        "fromDate": "2020-06-20",
        "isActive": true
      }
    ],
    "trustAssets": {
      "totalValue": {
        "amount": 650000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "assetBreakdown": [
        {
          "assetType": "Cash",
          "value": {
            "amount": 50000.00,
            "currency": {
              "code": "GBP",
              "display": "British Pound",
              "symbol": "£"
            }
          },
          "percentage": 7.69
        },
        {
          "assetType": "Investments",
          "value": {
            "amount": 450000.00,
            "currency": {
              "code": "GBP",
              "display": "British Pound",
              "symbol": "£"
            }
          },
          "percentage": 69.23
        },
        {
          "assetType": "Property",
          "value": {
            "amount": 150000.00,
            "currency": {
              "code": "GBP",
              "display": "British Pound",
              "symbol": "£"
            }
          },
          "percentage": 23.08
        }
      ],
      "valuationDate": "2026-01-31"
    },
    "taxStatus": {
      "taxYear": "2025/26",
      "ihtRelevantProperty": true,
      "lastIhtCharge": null,
      "nextIhtChargeDate": "2028-04-15",
      "cgtLiability": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "incomeTaxLiability": {
        "amount": 5600.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "trustRate": 45.0
    },
    "distributions": [
      {
        "beneficiaryRef": {
          "id": 1003,
          "name": "Alexander Smith"
        },
        "distributionDate": "2025-12-20",
        "amount": {
          "amount": 10000.00,
          "currency": {
            "code": "GBP",
            "display": "British Pound",
            "symbol": "£"
          }
        },
        "distributionType": "Discretionary Payment",
        "purpose": "Education Expenses"
      },
      {
        "beneficiaryRef": {
          "id": 1004,
          "name": "Emily Smith"
        },
        "distributionDate": "2025-12-20",
        "amount": {
          "amount": 8000.00,
          "currency": {
            "code": "GBP",
            "display": "British Pound",
            "symbol": "£"
          }
        },
        "distributionType": "Discretionary Payment",
        "purpose": "Education Expenses"
      }
    ],
    "accountingPeriodEnd": "2026-04-05",
    "nextReviewDate": "2027-04-15"
  },
  "addresses": [
    {
      "addressType": "TRUST_CORRESPONDENCE",
      "line1": "Harrison & Partners Solicitors",
      "line2": "Regency House",
      "line3": "25 High Street",
      "line4": null,
      "city": "London",
      "county": "GLA",
      "postcode": "WC2N 5DU",
      "country": {
        "code": "GB",
        "display": "United Kingdom",
        "alpha3": "GBR"
      },
      "isPrimary": true,
      "fromDate": "2018-04-15",
      "toDate": null,
      "yearsAtAddress": 8
    }
  ],
  "contacts": [
    {
      "contactType": "EMAIL",
      "value": "trustees@smithfamilytrust.com",
      "isPrimary": true,
      "isVerified": true,
      "verifiedDate": "2018-04-15"
    },
    {
      "contactType": "PHONE",
      "value": "+44 20 7946 5678",
      "isPrimary": true,
      "isVerified": true,
      "verifiedDate": "2018-04-15"
    }
  ],
  "identityVerification": {
    "verificationStatus": "Verified",
    "verificationDate": "2018-04-15",
    "expiryDate": "2028-04-15",
    "nextReviewDate": "2027-04-15",
    "verifiedBy": {
      "id": 810,
      "name": "Patricia Davies"
    },
    "verificationMethod": "Documentary",
    "documents": [
      {
        "documentType": "Trust Deed",
        "documentNumber": "DEED-2018-04-15-SMITH",
        "issueDate": "2018-04-15",
        "expiryDate": null,
        "issuingCountry": "GB",
        "verified": true,
        "verifiedDate": "2018-04-15",
        "verificationSource": "Solicitor Certification"
      },
      {
        "documentType": "HMRC Trust Registration",
        "documentNumber": "TRN12345678",
        "issueDate": "2018-04-20",
        "expiryDate": null,
        "issuingCountry": "GB",
        "verified": true,
        "verifiedDate": "2018-04-25",
        "verificationSource": "HMRC"
      }
    ],
    "amlChecks": {
      "lastCheckDate": "2025-04-15",
      "nextCheckDate": "2028-04-15",
      "riskRating": "Low",
      "sanctionsChecked": true,
      "sanctionsMatches": 0,
      "sanctionsCheckSource": "Dow Jones",
      "pepChecked": true,
      "isPep": false,
      "pepCheckSource": "Dow Jones",
      "adverseMediaChecked": true,
      "adverseMediaMatches": 0,
      "adverseMediaCheckSource": "LexisNexis",
      "overallStatus": "Clear",
      "checkPerformedBy": {
        "id": 810,
        "name": "Patricia Davies"
      }
    },
    "mlrCompliance": {
      "kycCompliant": true,
      "kycComplianceDate": "2018-04-15",
      "cddCompleted": true,
      "cddCompletedDate": "2018-04-15",
      "eddRequired": false,
      "eddCompletedDate": null,
      "complianceStatus": "Compliant",
      "complianceDate": "2018-04-15",
      "reviewPeriod": "Triennial",
      "lastReviewDate": "2025-04-15",
      "nextReviewDate": "2028-04-15"
    },
    "sourceOfWealth": {
      "primarySource": "Settlement by Settlor",
      "secondarySource": "Investment Growth",
      "description": "Initial settlement of £500,000 from William Smith, plus investment returns",
      "evidenceProvided": true,
      "evidenceType": "Trust Deed, Settlement Documentation, Investment Statements",
      "verifiedDate": "2018-04-15"
    },
    "sourceOfFunds": {
      "source": "Settlement Funds",
      "description": "Cash and securities transferred from settlor",
      "evidenceProvided": true,
      "evidenceType": "Bank Transfer Records, Securities Transfer Documentation",
      "verifiedDate": "2018-04-15"
    }
  },
  "territorialProfile": {
    "ukResident": true,
    "ukDomicile": true,
    "countryOfOrigin": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countryOfResidence": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countryOfDomicile": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    }
  },
  "dataProtection": {
    "gdprConsent": {
      "dataProcessing": {
        "consented": true,
        "consentDate": "2018-04-15",
        "consentMethod": "Written",
        "lawfulBasis": "Legitimate Interest",
        "consentText": "Trustees consent to data processing for trust administration and financial advice services",
        "version": "1.0"
      },
      "marketing": {
        "consented": false,
        "consentDate": null,
        "consentMethod": null,
        "lawfulBasis": null,
        "consentText": null,
        "version": null
      },
      "profiling": {
        "consented": false,
        "consentDate": null,
        "consentMethod": null,
        "lawfulBasis": null,
        "consentText": null,
        "version": null
      },
      "thirdPartySharing": {
        "consented": false,
        "consentDate": null,
        "consentMethod": null,
        "lawfulBasis": null,
        "consentText": null,
        "version": null
      }
    },
    "privacyPolicy": {
      "version": "2.1",
      "acceptedDate": "2018-04-15",
      "url": "https://api.factfind.com/privacy-policy",
      "acceptanceMethod": "Written"
    },
    "dataRetention": {
      "retentionPeriod": "10 years after trust dissolution",
      "retentionBasis": "Trust Law Requirement",
      "relationshipEndDate": null,
      "retentionEndDate": null,
      "archiveDate": null
    },
    "rightsExercised": {
      "dsarRequests": 0,
      "rectificationRequests": 0,
      "erasureRequests": 0,
      "portabilityRequests": 0,
      "restrictionRequests": 0,
      "objectionRequests": 0,
      "lastRequestDate": null,
      "lastRequestType": null
    },
    "breachNotifications": {
      "breachCount": 0,
      "lastBreachDate": null,
      "breachesNotified": []
    }
  },
  "marketingPreferences": {
    "channels": {
      "email": {
        "consented": false,
        "consentDate": null,
        "doubleOptInDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": true
      },
      "phone": {
        "consented": false,
        "consentDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": true,
        "tpsChecked": false,
        "tpsRegistered": false,
        "tpsCheckDate": null
      },
      "sms": {
        "consented": false,
        "consentDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": true
      },
      "post": {
        "consented": false,
        "consentDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": true,
        "mpsChecked": false,
        "mpsRegistered": false,
        "mpsCheckDate": null
      },
      "socialMedia": {
        "consented": false,
        "consentDate": null,
        "optOutDate": null,
        "frequency": null,
        "lastContactDate": null,
        "unsubscribed": true
      }
    },
    "interests": [],
    "productInterests": [],
    "suppressionList": false,
    "unsubscribeAll": true,
    "unsubscribeAllDate": "2018-04-15",
    "lastUpdated": "2018-04-15",
    "preferredContactTime": null,
    "doNotContact": true,
    "doNotContactReason": "Trust Entity - Professional Trustees Only"
  },
  "serviceStatus": "Active",
  "serviceStatusDate": "2018-04-15",
  "clientSegment": "C",
  "clientSegmentDate": "2018-04-15",
  "clientCategory": "Trust",
  "financialProfile": {
    "netWorth": {
      "amount": 650000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalAssets": {
      "amount": 650000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "calculatedAt": "2026-02-18T10:30:00Z",
    "lastReviewDate": "2026-02-18"
  },
  "adviser": {
    "id": 810,
    "href": "/api/v2/advisers/810",
    "name": "Patricia Davies",
    "code": "ADV003"
  },
  "paraplannerRef": {
    "id": 811,
    "href": "/api/v2/advisers/811",
    "name": "Andrew Wilson",
    "code": "PP003"
  },
  "officeRef": {
    "id": 1,
    "name": "London Office",
    "code": "LON"
  },
  "createdAt": "2018-04-15T10:00:00Z",
  "updatedAt": "2026-02-16T14:30:00Z",
  "createdBy": {
    "id": 810,
    "name": "Patricia Davies"
  },
  "updatedBy": {
    "id": 810,
    "name": "Patricia Davies"
  },
  "_etag": "W/\"v2-20260216-143000\""/clients/999" },
    "factfind": { "href": "/api/v2/factfinds/1111" },
    "adviser": { "href": "/api/v2/advisers/810" }
  }
}
```

---

#### 14.1.4 Field Behaviors (Composition Pattern)

| Field | Type | Required | Validation Rules | Notes |
|-------|------|----------|------------------|-------|
| `id` | string | Yes (read-only) | System-generated | Unique identifier (numeric) |
| `clientNumber` | string | Yes | Unique, max 20 chars | Business key |
| `clientType` | string | Yes | Enum: Person, Corporate, Trust | Discriminator field |
| `personValue` | PersonValue | Conditional | Required if clientType=Person | Person-specific fields |
| `corporateValue` | CorporateValue | Conditional | Required if clientType=Corporate | Corporate-specific fields |
| `trustValue` | TrustValue | Conditional | Required if clientType=Trust | Trust-specific fields |
| `addresses` | AddressValue[] | Yes | Min 1 address required | Full address history |
| `contacts` | ContactValue[] | Yes | Min 1 email or phone required | All contact methods |
| `identityVerification` | IdentityVerificationValue | Conditional | Required for KYC completion | KYC, AML, MLR compliance |
| `territorialProfile` | TerritorialProfileValue | No | | Territorial status, residency, domicile, citizenship |
| `dataProtection` | DataProtectionValue | Yes | Required for GDPR compliance | GDPR consent management |
| `marketingPreferences` | MarketingPreferencesValue | Yes | Required for marketing | Marketing opt-in/out |
| `estatePlanning` | EstatePlanningValue | Conditional | Only for Person clients | Will, LPA, gifts, IHT |
| `spouseRef` | ClientRef | Conditional | Only for Person clients | Spouse reference |
| `dependants` | DependantValue[] | Conditional | Only for Person clients | Financial dependants |

---

#### 14.1.5 PersonValue Type Definition

Embedded value type for Person-specific fields. Only present when `clientType="Person"`.

**Fields:**

```typescript
PersonValue {
  title: CodedValue                    // Mr, Mrs, Dr, etc.
  firstName: string                    // Required
  middleNames: string                  // Optional, multiple middle names
  lastName: string                     // Required
  preferredName: string                // Optional
  fullName: string                     // Calculated: "Title FirstName MiddleNames LastName"
  salutation: string                   // Calculated: "Title LastName"
  dateOfBirth: date                    // ISO 8601, Required
  age: integer                         // Calculated from dateOfBirth
  gender: CodedValue                   // M, F, O
  maritalStatus: MaritalStatusValue    // MAR, SIN, DIV, etc. with effectiveFrom
  niNumber: string                     // National Insurance Number (encrypted)
  smokingStatus: CodedValue            // NEVER, FORMER, CURRENT
  healthMetrics: HealthMetricsValue    // Height, weight, BMI
  occupation: string                   // Free text occupation
  occupationCode: OccupationCodeValue  // SOC code
  employmentStatus: CodedValue         // FT_EMP, PT_EMP, SELF_EMP, RETIRED, etc.
  isDeceased: boolean                  // Default false
  deceasedDate: date                   // Null if not deceased
  vulnerabilities: VulnerabilityValue[] // Client vulnerabilities (Consumer Duty)
}
```

**Health Metrics:**
```typescript
HealthMetricsValue {
  heightCm: decimal                    // Height in centimeters
  weightKg: decimal                    // Weight in kilograms
  bmi: decimal                         // Calculated: weight / (height^2)
  bmiCategory: string                  // Calculated: Underweight, Normal, Overweight, Obese
  lastMeasured: date                   // Date of last measurement
}
```

**Validation Rules:**
- `firstName` and `lastName` are required
- `dateOfBirth` is required and must be in the past
- `age` is system-calculated from `dateOfBirth`
- `niNumber` must match UK NI format: `^[A-Z]{2}[0-9]{6}[A-D]$`
- `bmi` is calculated as: `weightKg / (heightCm/100)^2`
- If `isDeceased=true`, `deceasedDate` is required

---

#### 14.1.6 CorporateValue Type Definition

Embedded value type for Corporate-specific fields. Only present when `clientType="Corporate"`.

**Fields:**

```typescript
CorporateValue {
  companyName: string                  // Required, official registered name
  tradingName: string                  // Optional, trading as name
  registrationNumber: string           // Optional, Companies House number
  incorporationDate: date              // Date of incorporation
  companyType: CodedValue              // LTD, PLC, LLP, etc.
  vatNumber: string                    // VAT registration number
  companyStatus: CodedValue            // ACTIVE, DISSOLVED, LIQUIDATION, etc.
  sicCodes: SicCodeValue[]             // SIC industry classification codes
  numberOfEmployees: integer           // Current employee count
  annualTurnover: MoneyValue           // Last reported annual turnover
  directors: DirectorValue[]           // Company directors
  shareholders: ShareholderValue[]     // Company shareholders
  registeredOffice: AddressValue       // Official registered office address
  accountsFilingDate: date             // Next accounts filing date
  confirmationStatementDate: date      // Next confirmation statement date
  financialYearEnd: date               // Financial year end date
}
```

**Director:**
```typescript
DirectorValue {
  personRef: ClientRef                 // Reference to Person client
  appointedDate: date                  // Date appointed as director
  role: string                         // Managing Director, Technical Director, etc.
  shareholding: decimal                // Percentage shareholding (0-100)
  isActive: boolean                    // Currently active
}
```

**Shareholder:**
```typescript
ShareholderValue {
  shareholderRef: EntityRef            // Reference to Person/Corporate/Trust
  sharesHeld: integer                  // Number of shares held
  shareClass: string                   // Ordinary, Preference, etc.
  percentage: decimal                  // Percentage of total shares (0-100)
  nominalValue: MoneyValue             // Nominal value of shares
}
```

**SIC Code:**
```typescript
SicCodeValue {
  code: string                         // 5-digit SIC code
  display: string                      // Description
}
```

**Validation Rules:**
- `companyName` is required
- `registrationNumber` must match UK Companies House format if provided: `^[A-Z0-9]{8}$`
- `vatNumber` must match UK VAT format if provided: `^GB[0-9]{9}$`
- Director shareholdings sum must not exceed 100%
- Shareholder percentages sum must equal 100%

---

#### 14.1.7 TrustValue Type Definition

Embedded value type for Trust-specific fields. Only present when `clientType="Trust"`.

**Fields:**

```typescript
TrustValue {
  trustName: string                    // Required, full trust name
  trustType: CodedValue                // DISCRETIONARY, LIFE_INTEREST, BARE, etc.
  settlementDate: date                 // Date trust was established
  trustRegistrationNumber: string      // HMRC Trust Registration Number
  taxReference: string                 // Trust tax reference (UTR)
  trustDeed: TrustDeedValue            // Trust deed document details
  settlor: SettlorValue                // Person who established the trust
  trustees: TrusteeValue[]             // Trust trustees
  beneficiaries: BeneficiaryValue[]    // Trust beneficiaries
  trustAssets: TrustAssetsValue        // Asset breakdown and valuation
  taxStatus: TrustTaxStatusValue       // IHT, CGT, income tax status
  distributions: DistributionValue[]   // Historical distributions
  accountingPeriodEnd: date            // Trust accounting period end date
  nextReviewDate: date                 // Next trust review date
}
```

**Trust Deed:**
```typescript
TrustDeedValue {
  documentRef: string                  // Document reference number
  documentUrl: string                  // URL to stored document
  executionDate: date                  // Date deed was executed
  storedWith: string                   // Where original is stored
  lastReviewedDate: date               // Last review date
}
```

**Settlor:**
```typescript
SettlorValue {
  personRef: ClientRef                 // Reference to Person client
  settlementAmount: MoneyValue         // Initial settlement amount
  settlementDate: date                 // Date of settlement
  isDeceased: boolean                  // Whether settlor is deceased
}
```

**Trustee:**
```typescript
TrusteeValue {
  personRef: ClientRef                 // Reference to Person client
  appointedDate: date                  // Date appointed as trustee
  role: string                         // Principal Trustee, Professional Trustee, etc.
  isProfessionalTrustee: boolean       // Whether professional trustee
  professionalFirm: string             // Firm name if professional
  isActive: boolean                    // Currently active
}
```

**Beneficiary:**
```typescript
BeneficiaryValue {
  personRef: EntityRef                 // Reference to Person/Corporate
  relationship: string                 // Child, Grandchild, etc.
  beneficiaryType: string              // Discretionary, Fixed, Contingent
  class: string                        // Income and Capital, Income Only, etc.
  percentage: decimal                  // Fixed percentage if applicable
  fromDate: date                       // Date became beneficiary
  isActive: boolean                    // Currently active
}
```

**Trust Assets:**
```typescript
TrustAssetsValue {
  totalValue: MoneyValue               // Total asset value
  assetBreakdown: AssetBreakdownValue[] // Breakdown by asset type
  valuationDate: date                  // Date of valuation
}

AssetBreakdownValue {
  assetType: string                    // Cash, Investments, Property, etc.
  value: MoneyValue                    // Value of this asset type
  percentage: decimal                  // Percentage of total (0-100)
}
```

**Trust Tax Status:**
```typescript
TrustTaxStatusValue {
  taxYear: string                      // e.g., "2025/26"
  ihtRelevantProperty: boolean         // Subject to 10-year IHT charges
  lastIhtCharge: date                  // Date of last IHT charge
  nextIhtChargeDate: date              // Next 10-year charge date
  cgtLiability: MoneyValue             // Estimated CGT liability
  incomeTaxLiability: MoneyValue       // Estimated income tax liability
  trustRate: decimal                   // Trust rate of tax (typically 45%)
}
```

**Distribution:**
```typescript
DistributionValue {
  beneficiaryRef: EntityRef            // Reference to beneficiary
  distributionDate: date               // Date of distribution
  amount: MoneyValue                   // Amount distributed
  distributionType: string             // Discretionary Payment, Income Distribution, etc.
  purpose: string                      // Purpose of distribution
}
```

**Validation Rules:**
- `trustName` is required
- `settlementDate` must be in the past
- `trustRegistrationNumber` must match HMRC format if provided: `^TRN[0-9]{8}$`
- At least one trustee is required
- At least one beneficiary is required
- Asset breakdown percentages must sum to 100%
- Distribution amounts must not exceed trust assets

---

#### 14.1.8 AddressValue Type

Embedded value type representing an address. Addresses have history (fromDate, toDate) but no separate identity.

```json
{
  "addressType": "RES",
  "line1": "123 Main Street",
  "line2": "Apartment 4B",
  "line3": null,
  "line4": null,
  "city": "London",
  "county": "GLA",
  "postcode": "SW1A 1AA",
  "country": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "isPrimary": true,
  "fromDate": "2020-01-15",
  "toDate": null,
  "yearsAtAddress": 6
}
```

**Address Types:**
- `RES` - Residential (Person)
- `WORK` - Work Address (Person)
- `PREV` - Previous Address (Person)
- `MAIL` - Mailing Address (All)
- `REGISTERED` - Registered Office (Corporate)
- `TRADING` - Trading Address (Corporate)
- `TRUST_CORRESPONDENCE` - Trust Correspondence Address (Trust)

**Fields:**
- `addressType` - Type of address
- `line1-4` - Address lines (line1 required)
- `city` - City/town (required)
- `county` - County/region
- `postcode` - Postal/ZIP code
- `country` - Country (required, default GB)
- `isPrimary` - Is this the primary address?
- `fromDate` - Date moved to this address
- `toDate` - Date moved from this address (null if current)
- `yearsAtAddress` - Calculated years at address (for affordability checks)

---

#### 14.1.9 ContactValue Type

Embedded value type representing a contact method.

```json
{
  "contactType": "EMAIL",
  "value": "john.smith@example.com",
  "isPrimary": true,
  "isVerified": true,
  "verifiedDate": "2020-01-15"
}
```

**Contact Types:**
- `EMAIL` - Email address
- `MOBILE` - Mobile phone
- `PHONE` - Home phone / Main office phone
- `WORK_PHONE` - Work phone
- `WEBSITE` - Website
- `LINKEDIN` - LinkedIn profile
- `FAX` - Fax number (legacy)

**Validation:**
- `EMAIL` must match email format
- Phone numbers should be in E.164 format: `+[country code][number]`
- `WEBSITE` must be valid URL

---

#### 14.1.10 IdentityVerificationValue Type

Embedded value type representing KYC, AML, and MLR compliance.

**Key Components:**
- **Verification Status** - Overall status (Verified, Pending, Failed, Expired)
- **Documents** - Passport, driving license, utility bills, company docs, trust deeds
- **AML Checks** - Sanctions, PEP, adverse media screening
- **MLR Compliance** - KYC, CDD, EDD status
- **Source of Wealth/Funds** - Evidence and verification

See full examples in the client JSON examples above.

---

#### 14.1.11 VulnerabilityValue Type

Embedded value type representing client vulnerabilities (Consumer Duty requirement). **Only applicable to Person clients** - embedded in `personValue.vulnerabilities` array.

```json
{
  "vulnerabilityType": "HEALTH",
  "severity": "Medium",
  "description": "Requires large print documents due to visual impairment",
  "assessmentDate": "2020-01-15",
  "reviewDate": "2025-01-15",
  "adjustmentsRequired": [
    "Large print documents (16pt minimum)",
    "Extended appointment times (allow 90 minutes)"
  ],
  "isActive": true
}
```

**Vulnerability Types:**
- `HEALTH` - Health-related (physical/mental health)
- `FINANCIAL` - Financial vulnerability (low income, high debt)
- `LIFE_EVENT` - Life event (bereavement, divorce, redundancy)
- `CAPABILITY` - Capability limitation (language, literacy, digital skills)
- `RESILIENCE` - Low resilience (multiple vulnerabilities)

**Note:** Vulnerabilities are only applicable to Person clients (Consumer Duty requirement). This array is embedded in `personValue.vulnerabilities` for Person clients only. Corporate and Trust clients do not have vulnerabilities.

---

#### 14.1.12 DataProtectionValue Type

Embedded value type representing GDPR compliance and data protection.

**Key Components:**
- **GDPR Consent** - Data processing, marketing, profiling, third-party sharing consents
- **Privacy Policy** - Version acceptance tracking
- **Data Retention** - Retention period and deletion dates
- **Rights Exercised** - DSAR, rectification, erasure, portability requests
- **Breach Notifications** - Any data breach notifications

See full examples in the client JSON examples above.

---

#### 14.1.13 MarketingPreferencesValue Type

Embedded value type representing marketing consent and preferences.

**Key Components:**
- **Channels** - Email, phone, SMS, post, social media preferences
- **Interests** - Topics of interest (retirement, investments, tax, estate planning)
- **Product Interests** - Product categories of interest
- **Frequency** - Preferred contact frequency per channel
- **TPS/MPS Checks** - Telephone/Mail Preference Service registration

See full examples in the client JSON examples above.

---

#### 14.1.14 EstatePlanningValue Type

Embedded value type representing estate planning information. **Only applicable to Person clients.**

**Key Components:**
- **Will** - Will details, executors, beneficiaries, review dates
- **Power of Attorney** - LPA for property/finance and health/welfare
- **Gifts** - Annual exemption usage, PETs, regular gifts from income
- **Trusts** - Trust structures and beneficiaries
- **IHT Estimate** - Inheritance tax calculation with nil-rate bands
- **Life Insurance in Trust** - Trust-based life insurance policies

See full example in the Person Client JSON above.

---

#### 14.1.15 FinancialProfileValue Type

Embedded value type representing client financial snapshot and computed wealth metrics. **Value type** with no identity, embedded in Client aggregate root.

**Purpose:** Store client financial position including income, net worth, and computed asset totals from arrangements.

**Type Classification:** Value Type (no identity, embedded in Client)

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `grossAnnualIncome` | MoneyValue | No | Individual's gross annual income (Person only) or company revenue (Corporate only) |
| `householdIncome` | MoneyValue | No | Combined household income (Person only) |
| `netWorth` | MoneyValue | No | Individual/entity net worth (assets - liabilities) |
| `householdNetWorth` | MoneyValue | No | Combined household net worth (Person only) |
| `totalAssets` | MoneyValue | No | **Computed** - Sum of all assets from arrangements (read-only) |
| `totalJointAssets` | MoneyValue | No | **Computed** - Sum of jointly held assets (read-only) |
| `calculatedAt` | timestamp | No | When financial metrics were last calculated |
| `lastReviewDate` | date | No | When financial position was last reviewed with client |

**Applicability by Client Type:**

- **Person clients:** All fields applicable
- **Corporate clients:** Only `grossAnnualIncome`, `netWorth`, `totalAssets` applicable (no household fields)
- **Trust clients:** Only `netWorth`, `totalAssets` applicable

**Example (Person Client):**

```json
{
  "financialProfile": {
    "grossAnnualIncome": {
      "amount": 75000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "householdIncome": {
      "amount": 120000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netWorth": {
      "amount": 450000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "householdNetWorth": {
      "amount": 650000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalAssets": {
      "amount": 500000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalJointAssets": {
      "amount": 200000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "calculatedAt": "2026-02-18T10:30:00Z",
    "lastReviewDate": "2026-02-18"
  }
}
```

**Validation Rules:**

- `totalAssets` and `totalJointAssets` are computed fields (read-only)
- All monetary amounts must be >= 0
- For Person clients: `householdIncome` >= `grossAnnualIncome` (if both provided)
- For Person clients: `householdNetWorth` >= `netWorth` (if both provided)
- `calculatedAt` is automatically set when computed fields are recalculated
- `lastReviewDate` should be set when financial position is reviewed with client

**Computed Field Calculation:**

- `totalAssets` = Sum of all asset values from arrangements (bank accounts, investments, pensions, properties, etc.)
- `totalJointAssets` = Sum of asset values where ownership = "Joint" or "JointTenants"

---

#### 14.1.16 TerritorialProfileValue Type

Embedded value type representing territorial status, residency, domicile, and citizenship information. **Value type** with no identity, embedded in Client aggregate root.

**Purpose:** Store territorial status, tax residency, domicile, and citizenship information for all client types (Person, Corporate, Trust).

**Type Classification:** Value Type (no identity, embedded in Client)

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `ukResident` | boolean | No | UK resident for tax purposes (HMRC definition) |
| `ukDomicile` | boolean | No | **Computed** - UK domiciled (countryOfDomicile.code === "GB") |
| `expatriate` | boolean | No | Is expatriate (living outside country of origin) - Person only |
| `countryOfBirth` | CodedValue | No | Country of birth (ISO 3166-1) - Person only |
| `placeOfBirth` | string | No | City/town of birth - Person only |
| `countryOfResidence` | CodedValue | No | Current country of residence (ISO 3166-1) - Person only |
| `countryOfDomicile` | CodedValue | No | Country of domicile for tax purposes (ISO 3166-1) - Person only |
| `countryOfOrigin` | CodedValue | No | Country of origin/nationality (Person), country of incorporation (Corporate), or jurisdiction of trust (Trust) (ISO 3166-1) |
| `countriesOfCitizenship` | CitizenshipValue[] | No | Array of citizenship countries (supports dual/multiple citizenship) - Person only |

**CitizenshipValue Structure:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `country` | CodedValue | Yes | Country of citizenship (ISO 3166-1) |
| `isPrimary` | boolean | No | Primary citizenship |
| `acquisitionDate` | date | No | Date citizenship acquired |
| `acquisitionMethod` | CodedValue | No | How acquired (Birth/Naturalization/Descent/Marriage) |

**Example (Person Client):**

```json
{
  "territorialProfile": {
    "ukResident": true,
    "ukDomicile": true,
    "expatriate": false,
    "countryOfBirth": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "placeOfBirth": "London",
    "countryOfResidence": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countryOfDomicile": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countryOfOrigin": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "countriesOfCitizenship": [
      {
        "country": {
          "code": "GB",
          "display": "United Kingdom",
          "alpha3": "GBR"
        },
        "isPrimary": true,
        "acquisitionDate": "1980-05-15",
        "acquisitionMethod": "BIRTH"
      }
    ]
  }
}
```

**Example (Corporate Client):**

```json
{
  "territorialProfile": {
    "ukResident": true,
    "countryOfOrigin": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    }
  }
}
```

**Example (Trust Client):**

```json
{
  "territorialProfile": {
    "ukResident": true,
    "countryOfOrigin": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    }
  }
}
```

**Applicability by Client Type:**

- **Person clients:** All fields applicable
  - `countryOfOrigin` represents nationality/citizenship country
  - Full territorial profile including birth, residence, domicile, and citizenship
- **Corporate clients:** Limited fields applicable
  - `ukResident` - for UK tax resident status
  - `countryOfOrigin` - country of incorporation
- **Trust clients:** Limited fields applicable
  - `ukResident` - for UK tax resident status
  - `countryOfOrigin` - jurisdiction where trust is registered/established

**Validation Rules:**

- `ukDomicile` is computed from `countryOfDomicile.code === "GB"` (read-only)
- For Person clients: `ukResident` should align with `countryOfResidence.code === "GB"` (but may differ for tax purposes)
- `expatriate` should be `true` if `countryOfResidence` differs from `countryOfOrigin`
- At least one citizenship is recommended for Person clients
- If multiple citizenships exist, exactly one should have `isPrimary: true`
- All country codes must be valid ISO 3166-1 codes (alpha-2 format)
- `acquisitionMethod` must be one of: Birth, Naturalization, Descent, Marriage

**Notes:**

- Territorial profile applies to all client types but with different field relevance
- For Person clients, this supports Consumer Duty requirements for understanding client circumstances
- For Corporate and Trust clients, primarily used for tax residency determination
- `ukDomicile` is computed to ensure consistency with `countryOfDomicile`
- Supports dual/multiple citizenship scenarios common in international clients

---

#### 14.1.17 Validation Rules by Client Type

**Person Client:**
- `personValue` is required
- `personValue.firstName` is required
- `personValue.lastName` is required
- `personValue.dateOfBirth` is required
- `personValue.vulnerabilities` is optional array (Consumer Duty)
- `estatePlanning` is optional but only valid for Person
- `spouseRef` is optional but only valid for Person
- `dependants` is optional but only valid for Person
- `territorialProfile` is optional but all Person-specific fields are available
- `territorialProfile.ukDomicile` is computed from `territorialProfile.countryOfDomicile.code === "GB"`
- `territorialProfile.countriesOfCitizenship` should have exactly one with `isPrimary: true` if multiple citizenships
- `financialProfile.householdIncome` >= `financialProfile.grossAnnualIncome` (if both provided)
- `financialProfile.householdNetWorth` >= `financialProfile.netWorth` (if both provided)
- `financialProfile.householdIncome` and `financialProfile.householdNetWorth` only valid for Person

**Corporate Client:**
- `corporateValue` is required
- `corporateValue.companyName` is required
- `corporateValue.directors` must have at least 1 director
- `corporateValue.shareholders` must have at least 1 shareholder
- `territorialProfile` is optional but only `ukResident` and `countryOfOrigin` fields are applicable
- `territorialProfile.countryOfOrigin` represents country of incorporation
- `personValue.vulnerabilities` must not be present (vulnerabilities only for Person clients)
- `estatePlanning` must not be present
- `spouseRef` must not be present
- `dependants` must not be present
- `financialProfile.householdIncome` must not be present
- `financialProfile.householdNetWorth` must not be present

**Trust Client:**
- `trustValue` is required
- `trustValue.trustName` is required
- `trustValue.trustees` must have at least 1 trustee
- `trustValue.beneficiaries` must have at least 1 beneficiary
- `territorialProfile` is optional but only `ukResident` and `countryOfOrigin` fields are applicable
- `territorialProfile.countryOfOrigin` represents jurisdiction where trust is registered
- `personValue.vulnerabilities` must not be present (vulnerabilities only for Person clients)
- `estatePlanning` must not be present
- `spouseRef` must not be present
- `dependants` must not be present
- `financialProfile.grossAnnualIncome` must not be present
- `financialProfile.householdIncome` must not be present
- `financialProfile.householdNetWorth` must not be present

**FinancialProfileValue Validation (All Client Types):**
- `totalAssets` and `totalJointAssets` are read-only computed fields
- All monetary amounts must be >= 0
- Computed fields are automatically calculated and cannot be set via API

---

#### 14.1.18 Usage Examples

**Creating a Person Client:**

```http
POST /api/v2/factfinds/{factfindId}/clients
Content-Type: application/json

{
  "clientNumber": "C00001234",
  "clientType": "Person",
  "personValue": {
    "title": "MR",
    "firstName": "John",
    "lastName": "Smith",
    "dateOfBirth": "1980-05-15",
    "gender": "M",
    "vulnerabilities": []
  },
  "territorialProfile": {
    "ukResident": true,
    "ukDomicile": true,
    "countryOfOrigin": { "code": "GB", "display": "United Kingdom", "alpha3": "GBR" },
    "countryOfResidence": { "code": "GB", "display": "United Kingdom", "alpha3": "GBR" }
  },
  "addresses": [
    {
      "addressType": "RES",
      "line1": "123 Main Street",
      "city": "London",
      "postcode": "SW1A 1AA",
      "country": { "code": "GB", "display": "United Kingdom", "alpha3": "GBR" },
      "isPrimary": true,
      "fromDate": "2020-01-15"
    }
  ],
  "contacts": [
    {
      "contactType": "EMAIL",
      "value": "john.smith@example.com",
      "isPrimary": true
    }
  ],
  "financialProfile": {
    "grossAnnualIncome": {
      "amount": 75000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netWorth": {
      "amount": 450000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "lastReviewDate": "2026-02-18"
  }
}
```

**Creating a Corporate Client:**

```http
POST /api/v2/factfinds/{factfindId}/clients
Content-Type: application/json

{
  "clientNumber": "C00005678",
  "clientType": "Corporate",
  "corporateValue": {
    "companyName": "TechVenture Solutions Ltd",
    "tradingName": "TechVenture",
    "registrationNumber": "09876543",
    "incorporationDate": "2015-03-20",
    "companyType": "LTD",
    "countryOfIncorporation": { "code": "GB", "display": "United Kingdom", "alpha3": "GBR" }
  },
  "addresses": [
    {
      "addressType": "REGISTERED",
      "line1": "Tech Park Building 5",
      "city": "London",
      "postcode": "EC2A 4DN",
      "country": { "code": "GB", "display": "United Kingdom", "alpha3": "GBR" },
      "isPrimary": true,
      "fromDate": "2015-03-20"
    }
  ],
  "contacts": [
    {
      "contactType": "EMAIL",
      "value": "info@techventure.com",
      "isPrimary": true
    }
  ],
  "financialProfile": {
    "grossAnnualIncome": {
      "amount": 3500000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netWorth": {
      "amount": 1250000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "lastReviewDate": "2026-02-18"
  }
}
```

**Creating a Trust Client:**

```http
POST /api/v2/factfinds/{factfindId}/clients
Content-Type: application/json

{
  "clientNumber": "C00009999",
  "clientType": "Trust",
  "trustValue": {
    "trustName": "The Smith Family Discretionary Trust",
    "trustType": "DISCRETIONARY",
    "settlementDate": "2018-04-15",
    "trustRegistrationNumber": "TRN12345678",
    "settlor": {
      "personRef": {
        "id": 1000,
        "name": "William Smith"
      },
      "settlementAmount": {
        "amount": 500000.00,
        "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
      },
      "settlementDate": "2018-04-15"
    }
  },
  "addresses": [
    {
      "addressType": "TRUST_CORRESPONDENCE",
      "line1": "Harrison & Partners Solicitors",
      "city": "London",
      "postcode": "WC2N 5DU",
      "country": { "code": "GB", "display": "United Kingdom", "alpha3": "GBR" },
      "isPrimary": true,
      "fromDate": "2018-04-15"
    }
  ],
  "contacts": [
    {
      "contactType": "EMAIL",
      "value": "trustees@smithfamilytrust.com",
      "isPrimary": true
    }
  ],
  "financialProfile": {
    "netWorth": {
      "amount": 650000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "lastReviewDate": "2026-02-18"
  }
}
```

---

### 14.2 FactFind Contract


**IMPORTANT NOTE:**
The FactFind Contract now includes an embedded `atrAssessment` object containing:
- 15 standard ATR questions with answers
- 45 supplementary questions
- System-generated risk profiles (3 adjacent options)
- Client's chosen risk profile
- Capacity for loss assessment
- Client and adviser declarations
- Review dates and history tracking

See Section 10 for complete ATR API documentation and example payloads.

**Example of embedded ATR in FactFind:**
```json
{
  "id": 123,
  "client": {...},
  "status": "InProgress",
  "atrAssessment": {
    "templateRef": { "id": 5407, "version": "5.0", "name": "FCA Standard ATR 2025" },
    "assessmentDate": "2026-02-18T10:30:00Z",
    "questions": [ /* 15 questions */ ],
    "supplementaryQuestions": [ /* 45 questions */ ],
    "riskProfiles": {
      "generated": [ /* 3 adjacent profiles */ ],
      "chosen": { "riskRating": "Balanced", "riskScore": 45, "chosenBy": "Client" }
    },
    "capacityForLoss": { "canAffordLosses": true, "emergencyFundMonths": 6 },
    "declarations": { /* client and adviser declarations */ },
    "completedAt": "2026-02-18T11:10:00Z"
  },
  "createdAt": "2026-02-15T09:00:00Z",
  "updatedAt": "2026-02-18T11:10:00Z"
}
```

For the complete FactFind Contract with full ATR assessment example, see Section 10.3.1 or Section 12.2 in the latest version.


The `FactFind` contract (also known as ADVICE_CASE) represents a fact-finding session and aggregate root for circumstances discovery.

**Reference Type:** FactFind is a reference type with identity (has `id` field).

Complete fact find aggregate root with summary calculations.

**Industry-Aligned Value Types:**
The FactFind contract groups related fields into industry-standard value types:
- **MeetingDetailsValue** (Section 12.2.1) - Meeting/consultation information (FCA/MiFID II terminology)
- **FinancialSummaryValue** (Section 12.2.2) - Computed financial totals and metrics (read-only snapshot)
- **AssetHoldingsValue** (Section 12.2.3) - Indicators of what financial products client holds (portfolio management terminology)
- **InvestmentCapacityValue** (Section 12.2.4) - Client's capacity and budget for new investments (FCA suitability terminology)
- **CompletionStatusValue** (Section 12.2.5) - Completion tracking and compliance checks

This grouping improves clarity, aligns with industry standards, and makes the contract easier to understand and maintain.

```json
{
  "id": 456,
  "factFindNumber": "FF001234",
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "jointClientRef": {
    "id": 124,
    "href": "/api/v2/factfinds/{factfindId}/clients/124",
    "name": "Sarah Smith",
    "clientNumber": "C00001235",
    "type": "Person"
  },
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Jane Doe",
    "code": "ADV001"
  },

  "meetingDetails": {
    "meetingDate": "2026-02-16",
    "meetingType": "INIT",
    "clientsPresent": "BothClients",
    "othersPresent": false,
    "othersPresentDetails": null,
    "scopeOfAdvice": {
      "retirementPlanning": true,
      "savingsAndInvestments": true,
      "protection": true,
      "mortgage": false,
      "estatePlanning": false
    }
  },

  "financialSummary": {
    "income": {
      "annualGross": {
        "amount": 120000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "monthlyNet": {
        "amount": 7500.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netRelevantEarnings": {
        "amount": 110000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "expenditure": {
      "monthlyTotal": {
        "amount": 4500.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "monthlyDisposable": {
        "amount": 3000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "liquidity": {
      "totalFundsAvailable": {
        "amount": 85000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "availableForAdvice": {
        "amount": 70000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "taxation": {
      "highestRate": {
        "code": "HIGHER",
        "display": "Higher Rate (40%)",
        "rate": 0.40
      }
    },
    "sourceOfFunds": "Savings from employment income over past 5 years",
    "calculatedAt": "2026-02-16T15:45:00Z"
  },

  "assetHoldings": {
    "employment": {
      "hasEmployments": true
    },
    "pensions": {
      "hasPersonalPension": true,
      "hasMoneyPurchasePension": true,
      "hasDefinedBenefitPension": false,
      "hasAnnuity": false
    },
    "investments": {
      "hasSavings": true,
      "hasInvestments": true
    },
    "borrowing": {
      "hasMortgage": true,
      "hasEquityRelease": false,
      "hasOtherLiabilities": true
    },
    "protection": {
      "hasProtection": true
    },
    "credit": {
      "hasAdverseCredit": false,
      "hasBeenRefusedCredit": false
    },
    "other": {
      "hasOtherAssets": true
    }
  },

  "investmentCapacity": {
    "emergencyFund": {
      "required": {
        "amount": 11400.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "committed": {
        "amount": 15000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "shortfall": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "status": "Adequate"
    },
    "regularContributions": {
      "agreedMonthlyBudget": {
        "amount": 1000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "sustainabilityRating": "High"
    },
    "lumpSumInvestment": {
      "agreedAmount": {
        "amount": 50000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "sourceOfFunds": "Savings from employment"
    },
    "futureChanges": {
      "incomeChangesExpected": false,
      "expenditureChangesExpected": false,
      "details": null
    },
    "assessmentDate": "2026-02-16"
  },

  "completionStatus": {
    "isComplete": false,
    "status": "INPROG",
    "completionDate": null,
    "declarationSignedDate": null,
    "compliance": {
      "idCheckedDate": "2026-02-16",
      "amlCheckedDate": "2026-02-16",
      "allChecksComplete": true
    }
  },

  "atrAssessment": {
    "templateRef": {
      "id": 5407,
      "version": "5.0",
      "name": "FCA Standard ATR 2025"
    },
    "assessmentDate": "2026-02-16T10:30:00Z",
    "questions": [
      {
        "questionId": "Q1",
        "text": "What is your investment experience?",
        "answer": "EXPERIENCED",
        "score": 4
      }
    ],
    "supplementaryQuestions": [],
    "riskProfiles": {
      "generated": [
        {
          "riskRating": "Cautious",
          "riskScore": 35,
          "description": "Lower risk, lower potential returns"
        },
        {
          "riskRating": "Balanced",
          "riskScore": 45,
          "description": "Medium risk, medium potential returns"
        },
        {
          "riskRating": "Adventurous",
          "riskScore": 55,
          "description": "Higher risk, higher potential returns"
        }
      ],
      "chosen": {
        "riskRating": "Balanced",
        "riskScore": 45,
        "chosenBy": "Client",
        "chosenAt": "2026-02-16T10:45:00Z"
      }
    },
    "capacityForLoss": {
      "canAffordLosses": true,
      "emergencyFundMonths": 6,
      "assessmentNotes": "Client has adequate emergency fund and stable income"
    },
    "declarations": {
      "clientDeclaration": {
        "agreed": true,
        "agreedAt": "2026-02-16T10:50:00Z"
      },
      "adviserDeclaration": {
        "agreed": true,
        "agreedAt": "2026-02-16T11:00:00Z",
        "adviser": {
          "id": 789,
          "name": "Jane Doe"
        }
      }
    },
    "completedAt": "2026-02-16T11:10:00Z",
    "nextReviewDate": "2027-02-16"
  },

  "notes": "Clients seeking to consolidate pensions and review protection cover",
  "additionalNotes": null,
  "customQuestions": [
    {
      "question": "What are your main financial concerns?",
      "answer": "Ensuring sufficient retirement income and protecting family"
    }
  ],

  "createdAt": "2026-02-16T14:30:00Z",
  "updatedAt": "2026-02-16T15:45:00Z",
    "complete": { "href": "/api/v2/factfinds/456/complete", "method": "POST" },
    "summary": { "href": "/api/v2/factfinds/456/summary" },
    "employment": { "href": "/api/v2/factfinds/456/employment" },
    "income": { "href": "/api/v2/factfinds/456/income" },
    "expenditure": { "href": "/api/v2/factfinds/456/expenditure" },
    "affordability": { "href": "/api/v2/factfinds/456/affordability" }
  }
}
```

**Field Behaviors:**

| Field | Type | Create | Update | Response | Notes |
|-------|------|--------|--------|----------|-------|
| `id` | uuid | ignored | ignored | included | read-only, server-generated |
| `factFindNumber` | string | optional | ignored | included | write-once, business identifier |
| `client` | ClientRef | required | ignored | included | write-once, reference to Client |
| `jointClientRef` | ClientRef | optional | ignored | included | write-once, reference to Client |
| `adviser` | AdviserRef | required | updatable | included | Reference type: Primary adviser |
| **`meetingDetails`** | **MeetingDetailsValue** | **required** | **updatable** | **included** | **Value type group (Section 12.2.1)** |
| **`financialSummary`** | **FinancialSummaryValue** | **ignored** | **ignored** | **included** | **read-only, computed value type (Section 12.2.2)** |
| **`assetHoldings`** | **AssetHoldingsValue** | **ignored** | **partial** | **included** | **Mostly computed, credit fields updatable (Section 12.2.3)** |
| **`investmentCapacity`** | **InvestmentCapacityValue** | **optional** | **updatable** | **included** | **Value type group (Section 12.2.4)** |
| **`completionStatus`** | **CompletionStatusValue** | **optional** | **updatable** | **included** | **Value type group (Section 12.2.5)** |
| `atrAssessment` | ATRAssessmentValue | optional | updatable | included | Embedded ATR assessment (Section 10) |
| `notes` | string | optional | updatable | included | - |
| `additionalNotes` | string | optional | updatable | included | - |
| `customQuestions` | array | optional | updatable | included | - |
| `createdAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `updatedAt` | timestamp | ignored | ignored | included | read-only, server-generated |

**Usage Examples:**

**Creating a FactFind (POST /api/v2/factfinds):**
```json
{
  "client": { "id": 123 },
  "jointClientRef": { "id": 124 },
  "adviser": { "id": 789 },
  "meetingDetails": {
    "meetingDate": "2026-02-16",
    "meetingType": "INIT",
    "scopeOfAdvice": {
      "retirementPlanning": true,
      "protection": true
    }
  },
  "investmentCapacity": {
    "regularContributions": {
      "agreedMonthlyBudget": {
        "amount": 1000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    }
  }
}
```

**Updating a FactFind (PATCH /api/v2/factfinds/456):**
```json
{
  "completionStatus": {
    "status": "COM",
    "completionDate": "2026-02-16"
  },
  "investmentCapacity": {
    "regularContributions": {
      "agreedMonthlyBudget": {
        "amount": 1500.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    }
  }
}
```

---

#### 14.2.1 MeetingDetailsValue Type

The `MeetingDetailsValue` groups all information related to the consultation meeting itself. This aligns with FCA and MiFID II requirements for documenting client interactions.

**Purpose:** Capture meeting/consultation information as required for regulatory compliance and audit trails.

**Structure:**
```json
{
  "meetingDate": "2026-02-16",
  "meetingType": "INIT",
  "clientsPresent": "BothClients",
  "othersPresent": false,
  "othersPresentDetails": null,
  "scopeOfAdvice": {
    "retirementPlanning": true,
    "savingsAndInvestments": true,
    "protection": true,
    "mortgage": false,
    "estatePlanning": false
  }
}
```

**Field Definitions:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `meetingDate` | date | Yes | Date when the fact-finding meeting took place |
| `meetingType` | CodedValue | Yes | Type of meeting: Initial/Review/Annual |
| `clientsPresent` | string | No | Who attended: BothClients/ClientOnly/JointOnly |
| `othersPresent` | boolean | No | Whether anyone else was present besides clients and adviser |
| `othersPresentDetails` | string | No | Details of who else was present (if othersPresent = true) |
| `scopeOfAdvice` | object | No | Areas of advice covered in this fact find session |

**Validation Rules:**
- `meetingDate` cannot be in the future
- If `othersPresent` is true, `othersPresentDetails` should be provided
- At least one `scopeOfAdvice` area should be true

---

#### 14.2.2 FinancialSummaryValue Type

The `FinancialSummaryValue` provides a read-only snapshot of the client's financial position, computed from child entities. This aligns with wealth management platform terminology.

**Purpose:** Provide computed financial totals and metrics as a convenience for UI display and decision-making, without requiring clients to traverse child collections.

**Behavior:** This is a **read-only** value type. All fields are computed by the system and cannot be updated directly. To change these values, update the underlying Income and Expenditure entities.

**Structure:**
```json
{
  "income": {
    "annualGross": {
      "amount": 120000.00,
      "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
    },
    "monthlyNet": {
      "amount": 7500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netRelevantEarnings": {
      "amount": 110000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "expenditure": {
    "monthlyTotal": {
      "amount": 4500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "monthlyDisposable": {
      "amount": 3000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "liquidity": {
    "totalFundsAvailable": {
      "amount": 85000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "availableForAdvice": {
      "amount": 70000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "taxation": {
    "highestRate": {
      "code": "HIGHER",
      "display": "Higher Rate (40%)",
      "rate": 0.40
    }
  },
  "sourceOfFunds": "Savings from employment income over past 5 years",
  "calculatedAt": "2026-02-16T15:45:00Z"
}
```

**Field Definitions:**

| Field | Computed From | Description |
|-------|---------------|-------------|
| `income.annualGross` | Sum of all Employment Income (gross, annualized) | Total earned annual income before tax |
| `income.monthlyNet` | Sum of all Income (net, monthly) | Total net monthly income after tax |
| `income.netRelevantEarnings` | Computed from earned income | Total net relevant earnings for pension purposes |
| `expenditure.monthlyTotal` | Sum of all Expenditure (monthly) | Total monthly expenditure |
| `expenditure.monthlyDisposable` | income.monthlyNet - expenditure.monthlyTotal | Monthly disposable income (surplus/deficit) |
| `liquidity.totalFundsAvailable` | Sum of liquid Assets | Total funds available across all accounts |
| `liquidity.availableForAdvice` | totalFundsAvailable - emergencyFund.committed | Funds available after emergency fund |
| `taxation.highestRate` | Derived from income bands | Highest tax rate applicable to client |
| `sourceOfFunds` | User-provided | Source of investment funds (AML requirement) |
| `calculatedAt` | System timestamp | When these calculations were last performed |

**Calculation Rules:**
- All monetary values use the same currency across the fact find
- Income values are normalized to annual/monthly as indicated
- Disposable income can be negative (deficit scenario)
- Emergency fund committed amount is subtracted from available funds
- Calculations are performed asynchronously when Income/Expenditure entities change

---

#### 14.2.3 AssetHoldingsValue Type

The `AssetHoldingsValue` provides boolean indicators of what financial products and arrangements the client currently holds. This uses standard portfolio management terminology.

**Purpose:** Quick overview of client's existing product holdings to guide advice scope and product recommendations.

**Behavior:** Most fields are **read-only** (computed from child Arrangement entities). The `credit` fields (`hasAdverseCredit`, `hasBeenRefusedCredit`) are **updatable** as they're typically captured during the fact-finding interview.

**Structure:**
```json
{
  "employment": {
    "hasEmployments": true
  },
  "pensions": {
    "hasPersonalPension": true,
    "hasMoneyPurchasePension": true,
    "hasDefinedBenefitPension": false,
    "hasAnnuity": false
  },
  "investments": {
    "hasSavings": true,
    "hasInvestments": true
  },
  "borrowing": {
    "hasMortgage": true,
    "hasEquityRelease": false,
    "hasOtherLiabilities": true
  },
  "protection": {
    "hasProtection": true
  },
  "credit": {
    "hasAdverseCredit": false,
    "hasBeenRefusedCredit": false
  },
  "other": {
    "hasOtherAssets": true
  }
}
```

**Field Definitions:**

| Field | Computed From | Updatable | Description |
|-------|---------------|-----------|-------------|
| `employment.hasEmployments` | Employment entities exist | No | Client has employment records |
| `pensions.hasPersonalPension` | Arrangement type = Personal Pension | No | Has personal pension plan |
| `pensions.hasMoneyPurchasePension` | Arrangement type = Money Purchase | No | Has money purchase pension |
| `pensions.hasDefinedBenefitPension` | Arrangement type = DB Pension | No | Has defined benefit pension |
| `pensions.hasAnnuity` | Arrangement type = Annuity | No | Has annuity in payment |
| `investments.hasSavings` | Arrangement type = Savings | No | Has savings accounts |
| `investments.hasInvestments` | Arrangement type = Investment | No | Has investment accounts/ISAs |
| `borrowing.hasMortgage` | Liability type = Mortgage | No | Has active mortgage |
| `borrowing.hasEquityRelease` | Arrangement type = Equity Release | No | Has equity release product |
| `borrowing.hasOtherLiabilities` | Liability entities exist | No | Has other liabilities |
| `protection.hasProtection` | Arrangement type = Protection | No | Has protection policies |
| `credit.hasAdverseCredit` | User input | **Yes** | Client has adverse credit history |
| `credit.hasBeenRefusedCredit` | User input | **Yes** | Client has been refused credit |
| `other.hasOtherAssets` | Asset entities exist | No | Has other assets |

**Usage Notes:**
- These flags are typically updated automatically when Arrangement entities are created/deleted
- The credit flags must be explicitly set during fact-finding as they're self-declared
- Use these flags in UI to conditionally display sections of the fact find

---

#### 14.2.4 InvestmentCapacityValue Type

The `InvestmentCapacityValue` captures the client's capacity and budget for new investments or advice. This aligns with FCA suitability terminology around "capacity for loss" and "investment capacity."

**Purpose:** Assess client's financial capacity to make new investments, considering emergency fund requirements and ongoing commitments.

**Structure:**
```json
{
  "emergencyFund": {
    "required": {
      "amount": 11400.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "committed": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "shortfall": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "status": "Adequate"
  },
  "regularContributions": {
    "agreedMonthlyBudget": {
      "amount": 1000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "sustainabilityRating": "High"
  },
  "lumpSumInvestment": {
    "agreedAmount": {
      "amount": 50000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "sourceOfFunds": "Savings from employment"
  },
  "futureChanges": {
    "incomeChangesExpected": false,
    "expenditureChangesExpected": false,
    "details": null
  },
  "assessmentDate": "2026-02-16"
}
```

**Field Definitions:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `emergencyFund.required` | MoneyValue | No | Calculated emergency fund requirement (typically 3-6 months expenses) |
| `emergencyFund.committed` | MoneyValue | No | Amount client has committed to emergency fund |
| `emergencyFund.shortfall` | MoneyValue | No | Shortfall if committed < required (computed) |
| `emergencyFund.status` | string | No | Adequate/Shortfall/Not Set |
| `regularContributions.agreedMonthlyBudget` | MoneyValue | No | Monthly amount client agrees to invest regularly |
| `regularContributions.sustainabilityRating` | string | No | High/Medium/Low - sustainability assessment |
| `lumpSumInvestment.agreedAmount` | MoneyValue | No | Lump sum amount client agrees to invest |
| `lumpSumInvestment.sourceOfFunds` | string | No | Where the lump sum comes from (AML) |
| `futureChanges.incomeChangesExpected` | boolean | No | Whether income changes are expected |
| `futureChanges.expenditureChangesExpected` | boolean | No | Whether expenditure changes are expected |
| `futureChanges.details` | string | No | Details of expected changes |
| `assessmentDate` | date | No | When this assessment was completed |

**Validation Rules:**
- `emergencyFund.shortfall` is computed: max(0, required - committed)
- `emergencyFund.status` is computed based on shortfall
- `regularContributions.agreedMonthlyBudget` should not exceed monthly disposable income
- If future changes expected, details should be provided

**Emergency Fund Calculation:**
- Default requirement: 3 months of monthly expenditure
- Can be overridden based on client circumstances (e.g., stable employment = 3 months, self-employed = 6 months)
- Shortfall must be addressed before recommending investments (FCA requirement)

---

#### 14.2.5 CompletionStatusValue Type

The `CompletionStatusValue` tracks the completion status of the fact find and associated compliance checks.

**Purpose:** Track workflow status and ensure all regulatory compliance checks are completed before advice can be provided.

**Structure:**
```json
{
  "isComplete": false,
  "status": "INPROG",
  "completionDate": null,
  "declarationSignedDate": null,
  "compliance": {
    "idCheckedDate": "2026-02-16",
    "amlCheckedDate": "2026-02-16",
    "allChecksComplete": true
  }
}
```

**Field Definitions:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `isComplete` | boolean | No | Whether fact find is complete (computed from status) |
| `status` | CodedValue | No | Current status: Draft/InProgress/Complete/Archived |
| `completionDate` | date | No | Date when fact find was marked complete |
| `declarationSignedDate` | date | No | Date when client signed fact find declaration |
| `compliance.idCheckedDate` | date | No | Date when ID verification was completed |
| `compliance.amlCheckedDate` | date | No | Date when AML checks were completed |
| `compliance.allChecksComplete` | boolean | No | Whether all compliance checks are done (computed) |

**Validation Rules:**
- `isComplete` is computed: true if status.code = "COM" (Complete)
- `compliance.allChecksComplete` is computed: true if both idCheckedDate and amlCheckedDate are set
- Cannot mark fact find complete unless allChecksComplete is true
- `completionDate` is automatically set when status changes to Complete

**Status Codes:**
- `DRAFT` - Initial draft, not yet started
- `INPROG` - In progress
- `COM` - Complete and signed
- `ARCHIVED` - Archived (historical record)

---

### 14.3 Address Contract

The `Address` contract represents a client's address with additional metadata for residency tracking. When an address needs independent lifecycle management (e.g., address history), it becomes a reference type with identity.

**Reference Type:** Address is a reference type with identity when managed as a separate resource (has `id` field).

**Note:** For simple embedded addresses (like `primaryAddress` in Client), use `AddressValue` (see Section 12.10.2) which has no `id` and is embedded directly.

```json
{
  "id": 789,
  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "addressType": "Residential",
  "address": {
    "line1": "123 High Street",
    "line2": "Apartment 4B",
    "city": "London",
    "county": "Greater London",
    "postcode": "SW1A 1AA",
    "country": "GB"
  },
  "isCorrespondenceAddress": true,
  "residencyPeriod": {
    "startDate": "2020-01-15",
    "endDate": null
  },
  "residencyStatus": "Owner",
  "isOnElectoralRoll": true,
  "createdAt": "2020-01-15T10:30:00Z",
  "updatedAt": "2026-02-16T14:30:00Z"
}
```

**Key Field Behaviors:**
- `id` - read-only, server-generated (uuid)
- `factfind` - required-on-create, write-once, reference to FactFind (owning aggregate)
- `client` - write-once, reference to Client
- `addressType` - required-on-create, updatable
- `address` - required-on-create, updatable (AddressValue embedded)
- `isCorrespondenceAddress` - optional, updatable (boolean)
- `residencyPeriod` - optional, updatable (DateRangeValue)
- `residencyStatus` - optional, updatable
- `isOnElectoralRoll` - optional, updatable
- `createdAt`, `updatedAt` - read-only

---

### 14.4 Income Contract

The `Income` contract represents an income source within a FactFind.

**Reference Type:** Income is a reference type with identity (has `id` field).

```json
{
  "id": 101,
  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456",
    "factFindNumber": "FF001234",
    "status": "InProgress"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "employment": {
    "id": 222,
    "href": "/api/v2/employments/222",
    "employerName": "Tech Corp Ltd",
    "status": "Current"
  },
  "incomeType": "Employment",
  "description": "Salary from Tech Corp Ltd",
  "isTaxable": true,
  "asset": null,
  "grossAmount": {
    "amount": 75000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "netAmount": {
    "amount": 55000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": {
    "code": "A",
    "display": "Annually",
    "periodsPerYear": 1
  },
  "incomePeriod": {
    "startDate": "2020-01-15",
    "endDate": null
  },
  "isOngoing": true,
  "isPrimary": true,
  "isGuaranteed": true,
  "taxDeducted": {
    "amount": 15000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "nationalInsuranceDeducted": {
    "amount": 5000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "notes": "Annual bonus typically £10k",
  "createdAt": "2026-02-16T14:30:00Z",
  "updatedAt": "2026-02-16T15:45:00Z"
}
```

**Key Field Behaviors:**
- `id` - read-only, server-generated (uuid)
- `factfind` - write-once, reference to FactFind (set from URL path parameter)
- `client` - required-on-create, write-once, reference to Client
- `employment` - optional, updatable, reference to Employment
- `incomeType` - required-on-create, updatable
- `description` - optional, updatable
- `isTaxable` - optional, updatable (boolean, defaults to true)
- `asset` - optional, updatable, reference to Asset/Arrangement
- `grossAmount` - required-on-create, updatable (MoneyValue)
- `netAmount` - optional, updatable (MoneyValue)
- `frequency` - required-on-create, updatable
- `incomePeriod` - optional, updatable (DateRangeValue)
- `isOngoing`, `isPrimary`, `isGuaranteed` - optional, updatable
- `taxDeducted`, `nationalInsuranceDeducted` - optional, updatable (MoneyValue)
- `createdAt`, `updatedAt` - read-only

**Field Definitions:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `isTaxable` | boolean | optional, updatable | Indicates whether the income is subject to taxation. Defaults to `true` if not specified. Set to `false` for tax-free income such as certain benefits, ISA income, or other non-taxable sources. Required for accurate affordability assessments and tax calculations. |
| `asset` | AssetReference | optional, updatable | Reference to the asset that generates this income. Required for rental income (links to property), dividend income (links to investment), interest income (links to savings), or business profit (links to business). Includes `id`, `href`, `assetType`, and `description`. Enables traceability between income and underlying assets. |

**AssetReference Structure:**

```json
{
  "id": 5001,
  "href": "/api/v2/factfinds/{factfindId}/assets/5001",
  "assetType": "Property",
  "description": "Rental Property - 45 High Street, Manchester"
}
```

**Validation Rules:**

**Tax Status Validation:**
- `isTaxable` is optional; if omitted, defaults to `true`
- For accurate affordability assessments, should be explicitly set for all income sources
- Non-taxable income examples: Child Benefit (under threshold), Premium Bonds winnings, certain disability benefits, ISA interest/dividends
- Taxable income examples: Employment income, self-employment profit, rental income, dividends (above allowance), interest (above allowance), pension income

**Asset Reference Validation:**
- `asset` is required when `incomeType` is one of: "Rental", "Dividend", "Interest", "BusinessProfit"
- `asset.id` must reference an existing asset or arrangement in the factfind
- `asset.assetType` must match the income type:
  - "Rental" income → "Property" asset
  - "Dividend" or "Interest" income → "Investment" asset
  - "BusinessProfit" income → "Business" asset
- `asset` should be `null` for income types that don't originate from assets (Employment, Pension, Benefits, etc.)

**Business Rules:**

**Tax Calculation:**
- Taxable income (`isTaxable: true`) is included in tax liability calculations
- Non-taxable income (`isTaxable: false`) is excluded from tax calculations but included in gross income totals
- Mortgage affordability assessments may treat taxable and non-taxable income differently

**Asset Linkage:**
- When `asset` is provided, the income is directly associated with the generating asset
- Enables impact analysis: if asset is sold, associated income ceases
- Supports portfolio analysis: total return from an asset = capital growth + income generated
- Required for regulatory reporting of asset-generated income

**UK Tax-Free Income Types:**

Common non-taxable income sources in the UK:
- **ISA Income** - Interest and dividends from Individual Savings Accounts (ISAs) are tax-free
- **Premium Bonds Prizes** - Winnings from NS&I Premium Bonds are not subject to income tax
- **Child Benefit** - Tax-free if household income is under £50,000; subject to High Income Child Benefit Charge above this threshold
- **Certain Disability Benefits** - Personal Independence Payment (PIP), Disability Living Allowance (DLA)
- **Guardian's Allowance** - Financial support for children whose parents have died
- **Bereavement Benefits** - Some bereavement benefits are tax-free
- **Child Trust Fund Income** - Income generated within a Child Trust Fund is tax-free
- **Scholarship Income** - In some cases, scholarship or grant income may be non-taxable

**Income-Asset Relationships:**

Income types that typically have asset references:

| Income Type | Asset Type | Example |
|-------------|-----------|---------|
| **Rental Income** | Property Asset | Residential or commercial property generating rental income |
| **Dividend Income** | Investment/Share Portfolio | Stocks, shares, or investment accounts paying dividends |
| **Interest Income** | Savings Account or Investment | Bank accounts, bonds, or other interest-bearing investments |
| **Business Profit** | **Capital Growth/Gains** | Any Investment or Property | Realized or unrealized gains from asset appreciation |

Income types that typically do NOT have asset references:
- Employment income (salary, wages, bonuses)
- Pension income (state pension, private pension in payment)
- Benefits (state benefits, welfare payments)
- Other income sources not tied to specific assets

**Example Scenarios:**

**Example 1: Rental Income (with asset, taxable)**
```json
{
  "id": 2001,
  "href": "/api/v2/factfinds/679/clients/456/incomes/2001",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/679/clients/456",
    "name": "John Smith",
    "clientNumber": "C00123",
    "type": "Person"
  },
  "employment": null,
  "incomeType": "Rental",
  "description": "Rental income from investment property",
  "isTaxable": true,
  "asset": {
    "id": 5001,
    "href": "/api/v2/factfinds/679/assets/5001",
    "assetType": "Property",
    "description": "Rental Property - 45 High Street, Manchester"
  },
  "grossAmount": {
    "amount": 18000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "netAmount": {
    "amount": 14400.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": {
    "code": "M",
    "display": "Monthly",
    "periodsPerYear": 12
  },
  "incomePeriod": {
    "startDate": "2020-06-01",
    "endDate": null
  },
  "isOngoing": true,
  "isPrimary": false,
  "isGuaranteed": false,
  "taxDeducted": {
    "amount": 3600.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "nationalInsuranceDeducted": null,
  "notes": "Buy-to-let property - managed by letting agent",
  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

**Example 2: Child Benefit (no asset, non-taxable under threshold)**
```json
{
  "id": 2002,
  "href": "/api/v2/factfinds/679/clients/456/incomes/2002",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/679/clients/456",
    "name": "John Smith",
    "clientNumber": "C00123",
    "type": "Person"
  },
  "employment": null,
  "incomeType": "Benefit",
  "description": "Child Benefit - 2 children",
  "isTaxable": false,
  "asset": null,
  "grossAmount": {
    "amount": 2074.80,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "netAmount": {
    "amount": 2074.80,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": {
    "code": "A",
    "display": "Annually",
    "periodsPerYear": 1
  },
  "incomePeriod": {
    "startDate": "2022-01-15",
    "endDate": null
  },
  "isOngoing": true,
  "isPrimary": false,
  "isGuaranteed": true,
  "taxDeducted": null,
  "nationalInsuranceDeducted": null,
  "notes": "Income under £50,000 - no high income charge applies",
  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

**Example 3: Dividend Income (with asset, taxable)**
```json
{
  "id": 2003,
  "href": "/api/v2/factfinds/679/clients/456/incomes/2003",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/679/clients/456",
    "name": "John Smith",
    "clientNumber": "C00123",
    "type": "Person"
  },
  "employment": null,
  "incomeType": "Dividend",
  "description": "Dividends from share portfolio",
  "isTaxable": true,
  "asset": {
    "id": 13001,
    "href": "/api/v2/factfinds/679/arrangements/investments/13001",
    "assetType": "Investment",
    "description": "Vanguard Investment Account"
  },
  "grossAmount": {
    "amount": 8500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "netAmount": {
    "amount": 7437.50,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": {
    "code": "Q",
    "display": "Quarterly",
    "periodsPerYear": 4
  },
  "incomePeriod": {
    "startDate": "2021-04-01",
    "endDate": null
  },
  "isOngoing": true,
  "isPrimary": false,
  "isGuaranteed": false,
  "taxDeducted": {
    "amount": 1062.50,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "nationalInsuranceDeducted": null,
  "notes": "Dividend income above £500 allowance - subject to dividend tax",
  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

---

### 14.5 Arrangement Contract

The `Arrangement` contract represents financial products (pensions, investments, protection, mortgages). This is a polymorphic contract with type-specific fields.

**Reference Type:** Arrangement is a reference type with identity (has `id` field).

```json
{
  "id": 555,
  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "arrangementNumber": "ARR123456",
  "arrangementCategory": "PENSION",
  "pensionType": "PERSONAL_PENSION",
  "clientOwners": [
    {
      "id": 123,
      "href": "/api/v2/factfinds/{factfindId}/clients/123",
      "name": "John Smith",
      "clientNumber": "C00001234",
      "type": "Person"
    }
  ],
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Jane Doe",
    "code": "ADV001"
  },
  "productName": "ABC SIPP",
  "provider": {
    "id": 456,
    "href": "/api/v2/providers/456",
    "name": "ABC Pension Provider Ltd",
    "frnNumber": "123456"
  },
  "policyNumber": "POL123456",
  "status": "ACT",
  "arrangementPeriod": {
    "startDate": "2015-01-01",
    "endDate": null
  },
  "currentValue": {
    "amount": 125000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "valuationDate": "2026-02-01",
  "regularContribution": {
    "amount": 500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "contributionFrequency": {
    "code": "M",
    "display": "Monthly",
    "periodsPerYear": 12
  },
  "isInDrawdown": false,
  "expectedRetirementAge": 67,
  "projectedValueAtRetirement": {
    "amount": 450000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "hasGuaranteedAnnuityRate": false,
  "hasProtectedTaxFreeAmount": false,
  "isSalarySacrifice": false,
  "notes": "Consolidated from previous workplace pensions",
  "createdAt": "2015-01-01T10:00:00Z",
  "updatedAt": "2026-02-16T14:30:00Z"/arrangements/555" },
    "contributions": { "href": "/api/v2/factfinds/{factfindId}/arrangements/555/contributions" },
    "valuations": { "href": "/api/v2/factfinds/{factfindId}/arrangements/555/valuations" }
  }
}
```

**Key Field Behaviors:**
- `id` - read-only, server-generated
- `factfind` - required-on-create, write-once, reference to FactFind (owning aggregate)
- `arrangementCategory` - required-on-create, write-once (discriminator)
- `pensionType`, `investmentType`, `protectionType`, `mortgageType` - required-on-create (type-specific), write-once
- `clientId` - required-on-create, write-once
- `productName`, `providerName`, `policyNumber` - required-on-create, updatable
- `status` - optional, updatable
- `startDate`, `endDate` - optional, updatable
- `currentValue` - optional, updatable
- `valuationDate` - optional, updatable (should match currentValue update)
- Type-specific fields - vary by arrangementCategory
- `createdAt`, `updatedAt` - read-only

---

### 14.6 Goal Contract

The `Goal` contract represents a client's financial goal.

**Reference Type:** Goal is a reference type with identity (has `id` field).

```json
{
  "id": 888,
  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "goalType": "Retirement",
  "goalName": "Comfortable retirement at age 65",
  "description": "Build sufficient pension pot to support £40k annual income in retirement",
  "priority": "High",
  "targetAmount": {
    "amount": 500000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "targetDate": "2045-05-15",
  "yearsToGoal": 19,
  "currentSavings": {
    "amount": 125000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "monthlyContribution": {
    "amount": 500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "projectedShortfall": {
    "amount": 150000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "isAchievable": false,
  "status": "InProgress",
  "notes": "May need to increase contributions or adjust target",
  "createdAt": "2026-02-16T14:30:00Z",
  "updatedAt": "2026-02-16T15:45:00Z"
}
```

**Key Field Behaviors:**
- `id` - read-only, server-generated (uuid)
- `factfind` - required-on-create, write-once, reference to FactFind (owning aggregate)
- `client` - write-once, reference to Client
- `goalType` - required-on-create, updatable
- `goalName` - required-on-create, updatable
- `description` - optional, updatable
- `priority` - optional, updatable
- `targetAmount` - required-on-create, updatable (MoneyValue)
- `targetDate` - required-on-create, updatable
- `yearsToGoal` - read-only, computed from targetDate
- `currentSavings`, `monthlyContribution` - optional, updatable (MoneyValue)
- `projectedShortfall` - read-only, computed (MoneyValue)
- `isAchievable` - read-only, computed
- `status` - optional, updatable
- `createdAt`, `updatedAt` - read-only

---

### 14.7 RiskProfile Contract

The `RiskProfile` contract represents a client's risk assessment and attitude to risk.

**Reference Type:** RiskProfile is a reference type with identity (has `id` field).

```json
{
  "id": 999,
  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Jane Doe",
    "code": "ADV001"
  },
  "assessmentDate": "2026-02-16",
  "assessmentType": "ATR",
  "attitudeToRiskScore": 6,
  "attitudeToRiskRating": "Balanced",
  "capacityForLossScore": 7,
  "capacityForLossRating": "Medium",
  "overallRiskRating": "Balanced",
  "timeHorizon": "LongTerm",
  "yearsToRetirement": 19,
  "investmentExperience": "Moderate",
  "hasInvestedBefore": true,
  "understandsRisk": true,
  "comfortableWithVolatility": true,
  "wouldAcceptLosses": false,
  "notes": "Client understands market volatility but nervous about large losses",
  "questionsAndAnswers": [
    {
      "question": "How would you react to a 20% fall in your portfolio?",
      "answer": "Hold steady and wait for recovery",
      "score": 6
    }
  ],
  "validUntil": "2027-02-16",
  "reviewDate": "2027-02-16",
  "isValid": true,
  "createdAt": "2026-02-16T14:30:00Z",
  "updatedAt": "2026-02-16T15:45:00Z"
}
```

**Key Field Behaviors:**
- `id` - read-only, server-generated
- `factfind` - required-on-create, write-once, reference to FactFind (owning aggregate)
- `clientId` - write-once, set from URL or required-on-create
- `assessmentDate` - required-on-create, updatable
- `assessmentType` - required-on-create, write-once
- `attitudeToRiskScore`, `capacityForLossScore` - required-on-create, updatable
- `attitudeToRiskRating`, `capacityForLossRating`, `overallRiskRating` - read-only, computed from scores
- `timeHorizon`, `yearsToRetirement` - optional, updatable
- `investmentExperience` - optional, updatable
- Boolean fields (`hasInvestedBefore`, `understandsRisk`, etc.) - optional, updatable
- `questionsAndAnswers` - optional, updatable (array)
- `validUntil`, `reviewDate` - optional, updatable
- `isValid` - read-only, computed from validUntil date
- `createdAt`, `updatedAt` - read-only

---

### 14.8 Investment Contract

The `Investment` contract extends the Arrangement contract with investment-specific fields for ISAs, GIAs, Bonds, and Investment Trusts.

**Reference Type:** Investment is a reference type with identity (has `id` field).

```json
{
  "id": 789,
  "arrangementId": 456,
  "factfind": {
    "id": 123,
    "href": "/api/v2/factfinds/123",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "arrangementCategory": "INVESTMENT",
  "investmentType": "STOCKS_SHARES_ISA",
  "provider": {
    "code": "VANGUARD",
    "display": "Vanguard Asset Management",
    "frnNumber": "123456"
  },
  "policyNumber": "ISA-987654321",
  "accountNumber": "ACC-12345678",
  "planName": "Vanguard ISA Portfolio",
  "startDate": "2020-04-06",
  "maturityDate": null,
  "status": "ACTIVE",
  "isaType": "STOCKS_SHARES",
  "taxYear": "2025/2026",
  "annualIsaAllowance": {
    "amount": 20000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "isaAllowanceUsed": {
    "amount": 15000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "isaAllowanceRemaining": {
    "amount": 5000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "taxWrapperType": "ISA",
  "isTaxable": false,
  "currentValue": {
    "amount": 185000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "valuationDate": "2026-02-16",
  "costBasis": {
    "amount": 150000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "unrealizedGain": {
    "amount": 35000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "unrealizedGainPercentage": 23.33,
  "realizedGain": {
    "amount": 8500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "totalReturn": {
    "amount": 43500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "totalReturnPercentage": 29.00,
  "annualizedReturn": 5.87,
  "timeWeightedReturn": 6.12,
  "moneyWeightedReturn": 5.65,
  "inceptionDate": "2020-04-06",
  "yearsHeld": 5.87,
  "assetAllocation": {
    "equities": {
      "percentage": 65.00,
      "value": {
        "amount": 120250.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "bonds": {
      "percentage": 25.00,
      "value": {
        "amount": 46250.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "cash": {
      "percentage": 5.00,
      "value": {
        "amount": 9250.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "alternatives": {
      "percentage": 5.00,
      "value": {
        "amount": 9250.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    }
  },
  "geographicAllocation": {
    "uk": {
      "percentage": 30.00,
      "value": {
        "amount": 55500.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "northAmerica": {
      "percentage": 45.00,
      "value": {
        "amount": 83250.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "europe": {
      "percentage": 15.00,
      "value": {
        "amount": 27750.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "asiaPacific": {
      "percentage": 8.00,
      "value": {
        "amount": 14800.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "emergingMarkets": {
      "percentage": 2.00,
      "value": {
        "amount": 3700.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    }
  },
  "holdings": [
    {
      "holdingId": "holding-001",
      "isin": "GB00B3X7QG63",
      "sedol": "B3X7QG6",
      "fundName": "Vanguard FTSE Global All Cap Index Fund",
      "ticker": "VWRL",
      "fundType": "INDEX",
      "assetClass": "EQUITY",
      "units": 15000.00,
      "unitPrice": {
        "amount": 6.25,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "currentValue": {
        "amount": 93750.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "costBasis": {
        "amount": 75000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "unrealizedGain": {
        "amount": 18750.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "unrealizedGainPercentage": 25.00,
      "percentageOfPortfolio": 50.68,
      "ocf": 0.23,
      "lastUpdated": "2026-02-16T16:00:00Z"
    },
    {
      "holdingId": "holding-002",
      "isin": "GB00B4PQW151",
      "sedol": "B4PQW15",
      "fundName": "Vanguard U.K. Government Bond Index Fund",
      "ticker": "VGOV",
      "fundType": "INDEX",
      "assetClass": "BOND",
      "units": 28000.00,
      "unitPrice": {
        "amount": 1.65,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "currentValue": {
        "amount": 46200.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "costBasis": {
        "amount": 42000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "unrealizedGain": {
        "amount": 4200.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "unrealizedGainPercentage": 10.00,
      "percentageOfPortfolio": 24.97,
      "ocf": 0.15,
      "lastUpdated": "2026-02-16T16:00:00Z"
    },
    {
      "holdingId": "holding-003",
      "isin": "GB00BPN5P238",
      "sedol": "BPN5P23",
      "fundName": "Vanguard LifeStrategy 60% Equity Fund",
      "ticker": "VLS60",
      "fundType": "MIXED",
      "assetClass": "MIXED",
      "units": 12500.00,
      "unitPrice": {
        "amount": 2.80,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "currentValue": {
        "amount": 35000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "costBasis": {
        "amount": 25000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "unrealizedGain": {
        "amount": 10000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "unrealizedGainPercentage": 40.00,
      "percentageOfPortfolio": 18.92,
      "ocf": 0.22,
      "lastUpdated": "2026-02-16T16:00:00Z"
    },
    {
      "holdingId": "holding-004",
      "isin": "CASH001",
      "fundName": "Cash Holding",
      "fundType": "CASH",
      "assetClass": "CASH",
      "currentValue": {
        "amount": 10050.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "costBasis": {
        "amount": 8000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "unrealizedGain": {
        "amount": 2050.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "unrealizedGainPercentage": 25.63,
      "percentageOfPortfolio": 5.43,
      "interestRate": 4.50,
      "lastUpdated": "2026-02-16T16:00:00Z"
    }
  ],
  "totalHoldings": 4,
  "contributions": [
    {
      "contributionId": "contrib-001",
      "date": "2025-04-06",
      "amount": {
        "amount": 20000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "type": "REGULAR",
      "taxYear": "2025/2026",
      "notes": "Annual ISA contribution for tax year 2025/26"
    },
    {
      "contributionId": "contrib-002",
      "date": "2024-04-06",
      "amount": {
        "amount": 20000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "type": "REGULAR",
      "taxYear": "2024/2025",
      "notes": "Annual ISA contribution for tax year 2024/25"
    }
  ],
  "totalContributions": {
    "amount": 150000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "withdrawals": [
    {
      "withdrawalId": "withdraw-001",
      "date": "2025-09-15",
      "amount": {
        "amount": 5000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "type": "ADHOC",
      "reason": "Home improvement",
      "taxableAmount": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "notes": "Tax-free ISA withdrawal"
    }
  ],
  "totalWithdrawals": {
    "amount": 5000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "netContributions": {
    "amount": 145000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "regularContribution": {
    "amount": 500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "regularContributionFrequency": "MONTHLY",
  "nextContributionDate": "2026-03-01",
  "isRegularContributionActive": true,
  "taxFields": {
    "capitalGainsUsed": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "capitalGainsAllowance": {
      "amount": 3000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "dividendsReceived": {
      "amount": 8500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "dividendsAllowance": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxPaid": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxRelief": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "isTaxExempt": true,
    "taxExemptReason": "Stocks & Shares ISA - tax wrapper"
  },
  "charges": {
    "annualManagementCharge": 0.15,
    "platformFee": 0.25,
    "totalExpenseRatio": 0.40,
    "transactionFees": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "exitFees": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "riskRating": {
    "code": "MODERATE",
    "display": "Moderate Risk",
    "numericScore": 5,
    "scale": "1-7"
  },
  "investmentObjective": "Long-term capital growth with moderate risk exposure",
  "benchmarkIndex": "FTSE All-World Index",
  "rebalancingFrequency": "QUARTERLY",
  "lastRebalancingDate": "2026-01-15",
  "nextRebalancingDate": "2026-04-15",
  "isAdvised": true,
  "adviceType": "ONGOING",
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Jane Doe",
    "code": "ADV001"
  },
  "lastReviewDate": "2026-01-15",
  "nextReviewDate": "2027-01-15",
  "notes": "Client prefers sustainable investing, ESG funds where possible",
  "documents": [
    {
      "documentId": 1,
      "type": "STATEMENT",
      "name": "ISA Annual Statement 2025",
      "date": "2025-12-31",
      "url": "/api/v2/documents/doc-001"
    }
  ],
  "createdAt": "2020-04-06T10:00:00Z",
  "updatedAt": "2026-02-16T16:30:00Z",
  "createdBy": {
    "id": 789,
    "name": "Jane Doe"
  },
  "updatedBy": {
    "id": 789,
    "name": "Jane Doe"
  },
    "update": { "href": "/api/v2/investments/789", "method": "PUT" },
    "delete": { "href": "/api/v2/investments/789", "method": "DELETE" },
    "arrangement": { "href": "/api/v2/factfinds/{factfindId}/arrangements/456" },
    "client": { "href": "/api/v2/factfinds/{factfindId}/clients/123" },
    "factfind": { "href": "/api/v2/factfinds/123" },
    "holdings": { "href": "/api/v2/investments/789/holdings" },
    "contributions": { "href": "/api/v2/investments/789/contributions" },
    "withdrawals": { "href": "/api/v2/investments/789/withdrawals" },
    "transactions": { "href": "/api/v2/investments/789/transactions" },
    "documents": { "href": "/api/v2/investments/789/documents" },
    "performance": { "href": "/api/v2/investments/789/performance" }
  }
}
```

**Field Behaviors:**

| Field | Type | Create | Update | Response | Notes |
|-------|------|--------|--------|----------|-------|
| `id` | uuid | ignored | ignored | included | read-only, server-generated |
| `arrangementId` | uuid | required | ignored | included | write-once, link to parent Arrangement |
| `factfind` | FactFindRef | required | ignored | included | Reference to owning FactFind, write-once |
| `client` | ClientRef | required | ignored | included | Reference to client, write-once |
| `arrangementCategory` | string | required | ignored | included | write-once, discriminator field (INVESTMENT) |
| `investmentType` | string (enum) | required | ignored | included | write-once, specific type (GIA/ISA/Bond/etc) |
| `provider` | ProviderValue | required | updatable | included | Provider details with FRN |
| `policyNumber` | string | required | ignored | included | write-once, unique identifier |
| `accountNumber` | string | optional | updatable | included | Account reference number |
| `planName` | string | optional | updatable | included | Name of investment plan |
| `startDate` | date | required | ignored | included | write-once, inception date |
| `maturityDate` | date | optional | updatable | included | For fixed-term investments |
| `status` | string | optional | updatable | included | Active/Closed/Suspended |
| `investmentType` | string | required | updatable | included | Detailed investment classification |
| `isaType` | string | optional | updatable | included | If ISA: Stocks/Cash/Innovative/Lifetime |
| `taxYear` | string | optional | updatable | included | Current tax year for ISA allowance |
| `annualIsaAllowance` | MoneyValue | optional | updatable | included | Annual ISA contribution limit |
| `isaAllowanceUsed` | MoneyValue | optional | updatable | included | Amount of allowance used this year |
| `isaAllowanceRemaining` | MoneyValue | ignored | ignored | included | read-only, computed |
| `taxWrapperType` | string | optional | updatable | included | ISA/SIPP/other tax wrapper |
| `isTaxable` | boolean | optional | updatable | included | Whether gains are taxable |
| `currentValue` | MoneyValue | required | updatable | included | Current market value |
| `valuationDate` | date | required | updatable | included | Date of valuation |
| `costBasis` | MoneyValue | optional | updatable | included | Total cost of investments |
| `unrealizedGain` | MoneyValue | ignored | ignored | included | read-only, currentValue - costBasis |
| `unrealizedGainPercentage` | decimal | ignored | ignored | included | read-only, percentage gain/loss |
| `realizedGain` | MoneyValue | optional | updatable | included | Gains from sales |
| `totalReturn` | MoneyValue | ignored | ignored | included | read-only, unrealized + realized |
| `totalReturnPercentage` | decimal | ignored | ignored | included | read-only, total return % |
| `annualizedReturn` | decimal | ignored | ignored | included | read-only, compound annual growth rate |
| `timeWeightedReturn` | decimal | optional | updatable | included | TWR performance metric |
| `moneyWeightedReturn` | decimal | optional | updatable | included | MWR performance metric |
| `inceptionDate` | date | required | ignored | included | write-once, first investment date |
| `yearsHeld` | decimal | ignored | ignored | included | read-only, computed from inceptionDate |
| `assetAllocation` | object | optional | updatable | included | Equities/bonds/cash/alternatives breakdown |
| `geographicAllocation` | object | optional | updatable | included | Regional allocation breakdown |
| `holdings` | array | optional | updatable | included | Array of fund holdings with ISIN/value |
| `totalHoldings` | integer | ignored | ignored | included | read-only, count of holdings |
| `contributions` | array | optional | updatable | included | Array of contribution transactions |
| `totalContributions` | MoneyValue | ignored | ignored | included | read-only, sum of contributions |
| `withdrawals` | array | optional | updatable | included | Array of withdrawal transactions |
| `totalWithdrawals` | MoneyValue | ignored | ignored | included | read-only, sum of withdrawals |
| `netContributions` | MoneyValue | ignored | ignored | included | read-only, contributions - withdrawals |
| `regularContribution` | MoneyValue | optional | updatable | included | Regular monthly/annual contribution |
| `regularContributionFrequency` | string | optional | updatable | included | Monthly/Quarterly/Annual |
| `nextContributionDate` | date | optional | updatable | included | Next scheduled contribution |
| `isRegularContributionActive` | boolean | optional | updatable | included | Whether regular contributions are active |
| `taxFields` | object | optional | updatable | included | Capital gains, dividends, tax paid |
| `charges` | object | optional | updatable | included | AMC, platform fees, TER |
| `riskRating` | string | optional | updatable | included | Investment risk rating |
| `investmentObjective` | string | optional | updatable | included | Stated investment goal |
| `benchmarkIndex` | string | optional | updatable | included | Performance benchmark |
| `rebalancingFrequency` | string | optional | updatable | included | Quarterly/Semi-annual/Annual |
| `lastRebalancingDate` | date | optional | updatable | included | Last portfolio rebalance |
| `nextRebalancingDate` | date | optional | updatable | included | Next scheduled rebalance |
| `isAdvised` | boolean | optional | updatable | included | Whether investment is advised |
| `adviceType` | string | optional | updatable | included | Ongoing/One-off advice |
| `adviser` | AdviserRef | optional | updatable | included | Reference to adviser |
| `lastReviewDate` | date | optional | updatable | included | Last review date |
| `nextReviewDate` | date | optional | updatable | included | Next scheduled review |
| `notes` | string | optional | updatable | included | Additional notes |
| `documents` | array | optional | updatable | included | Array of document references |
| `createdAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `updatedAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `createdBy` | object | ignored | ignored | included | read-only, audit trail |
| `updatedBy` | object | ignored | ignored | included | read-only, audit trail |

**Usage Examples:**

**Creating an Investment ISA (POST /api/v2/investments):**
```json
{
  "arrangementId": 456,
  "factfind": { "id": 123 },
  "client": { "id": 123 },
  "arrangementCategory": "INVESTMENT",
  "provider": "VANGUARD",
  "policyNumber": "ISA-987654321",
  "startDate": "2020-04-06",
  "inceptionDate": "2020-04-06",
  "investmentType": "STOCKS_SHARES_ISA",
  "isaType": "STOCKS_SHARES",
  "taxYear": "2025/2026",
  "currentValue": { "amount": 185000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
  "valuationDate": "2026-02-16",
  "costBasis": { "amount": 150000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } }
}
```
Server generates `id`, `createdAt`, `updatedAt`, and computes read-only fields like `unrealizedGain`, `totalReturn`, etc. Returns complete contract.

**Updating Asset Allocation (PUT /api/v2/investments/investment-789):**
```json
{
  "currentValue": { "amount": 190000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
  "valuationDate": "2026-02-18",
  "assetAllocation": {
    "equities": { "percentage": 70.00, "value": { "amount": 133000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } } },
    "bonds": { "percentage": 20.00, "value": { "amount": 38000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } } },
    "cash": { "percentage": 5.00, "value": { "amount": 9500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } } },
    "alternatives": { "percentage": 5.00, "value": { "amount": 9500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } } }
  }
}
```
Server updates `updatedAt` and recalculates computed fields. Returns complete contract.

**Adding a Holding (PATCH /api/v2/investments/investment-789):**
```json
{
  "holdings": [
    {
      "isin": "GB00B3X7QG63",
      "fundName": "Vanguard FTSE Global All Cap Index Fund",
      "units": 15000.00,
      "unitPrice": { "amount": 6.25, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "currentValue": { "amount": 93750.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "costBasis": { "amount": 75000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } }
    }
  ]
}
```
Only specified fields are updated. Returns complete contract with new holding added.

**Validation Rules:**

1. **Required Fields on Create:** `arrangementId`, `factfind`, `client`, `arrangementCategory`, `investmentType`, `provider`, `policyNumber`, `startDate`, `inceptionDate`, `currentValue`, `valuationDate`
2. **Write-Once Fields:** Cannot be changed after creation: `arrangementId`, `factfind`, `client`, `arrangementCategory`, `investmentType`, `policyNumber`, `startDate`, `inceptionDate`
3. **ISA Validation:** If `productType` is ISA, `isaType` must be provided (Stocks/Cash/Innovative/Lifetime)
4. **ISA Allowance:** `isaAllowanceUsed` cannot exceed `annualIsaAllowance` (£20,000 for 2025/26)
5. **Asset Allocation:** Sum of percentages in `assetAllocation` must equal 100%
6. **Geographic Allocation:** Sum of percentages in `geographicAllocation` must equal 100%
7. **Holdings Validation:** Each holding must have `isin` or `sedol`, `fundName`, and `currentValue`
8. **Date Logic:** `startDate` must be <= `valuationDate`, `maturityDate` (if provided) must be > `startDate`
9. **Contribution Limits:** For ISAs, total contributions in a tax year cannot exceed annual allowance
10. **Reference Integrity:** `arrangementId`, `client.id`, `factfind.id`, `adviserRef.id` must reference existing entities

---

### 14.9 Property Contract

The `Property` contract represents a property asset with valuation tracking, mortgage linking, and rental income management.

**Reference Type:** Property is a reference type with identity (has `id` field).

```json
{
  "id": 456,
  "factfind": {
    "id": 123,
    "href": "/api/v2/factfinds/123",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "propertyType": "BTL",
  "propertySubType": "APARTMENT",
  "ownershipType": "FREEHOLD",
  "address": {
    "line1": "Flat 12, Riverside Apartments",
    "line2": "45 Thames Street",
    "city": "London",
    "county": "GLA",
    "postcode": "SE1 9PH",
    "country": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "addressType": "BTL",
    "uprn": "100023456789",
    "coordinates": {
      "latitude": 51.5074,
      "longitude": -0.1278
    }
  },
  "propertyDescription": "Two bedroom apartment with river views, modern kitchen and bathroom, secure parking",
  "numberOfBedrooms": 2,
  "numberOfBathrooms": 1,
  "numberOfReceptionRooms": 1,
  "floorArea": {
    "value": 850,
    "unit": "sqft"
  },
  "tenure": "LEASEHOLD",
  "leaseRemaining": 95,
  "groundRent": {
    "amount": 250.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    },
    "frequency": "ANNUAL"
  },
  "serviceCharge": {
    "amount": 150.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    },
    "frequency": "MONTHLY"
  },
  "purchaseDate": "2018-06-15",
  "purchasePrice": {
    "amount": 325000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "purchaseCosts": {
    "stampDuty": {
      "amount": 9750.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "legalFees": {
      "amount": 1500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "surveyFees": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "estateAgentFees": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "otherCosts": {
      "amount": 250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalCosts": {
      "amount": 12000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "totalInvestment": {
    "amount": 337000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "owners": [
    {
      "client": {
        "id": 123,
        "href": "/api/v2/factfinds/{factfindId}/clients/123",
        "name": "John Smith",
        "clientNumber": "C00001234",
        "type": "Person"
      },
      "ownershipPercentage": 100.00,
      "isPrimaryOwner": true,
      "ownershipType": "SOLE"
    }
  ],
  "ownershipStructure": "SOLE",
  "isJointOwnership": false,
  "jointOwnershipType": null,
  "currentValue": {
    "amount": 425000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "valuationDate": "2026-02-10",
  "valuationType": "DESKTOP",
  "valuationProvider": "Zoopla",
  "valuationReference": "VAL-2026-02-12345",
  "previousValuation": {
    "amount": 410000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "previousValuationDate": "2025-02-10",
  "valuationChange": {
    "amount": 15000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "valuationChangePercentage": 3.66,
  "capitalGrowth": {
    "amount": 100000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "capitalGrowthPercentage": 30.77,
  "annualizedGrowth": 3.94,
  "mortgages": [
    {
      "mortgage": {
        "id": 789,
        "href": "/api/v2/factfinds/{factfindId}/arrangements/789",
        "arrangementType": "Mortgage",
        "provider": "Nationwide Building Society",
        "policyNumber": "MTG-987654321"
      },
      "outstandingBalance": {
        "amount": 240000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "monthlyPayment": {
        "amount": 1250.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "interestRate": 3.75,
      "isPrimary": true
    }
  ],
  "totalMortgageBalance": {
    "amount": 240000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "equityAmount": {
    "amount": 185000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "equityPercentage": 43.53
  "isPrimaryResidence": false,
  "isRented": true,
  "isBuyToLet": true,
  "rentalIncome": {
    "monthlyRent": {
      "amount": 1650.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "annualRent": {
      "amount": 19800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "tenancyType": "AST",
    "tenancyStartDate": "2025-08-01",
    "tenancyEndDate": "2026-07-31",
    "tenancyRenewalDate": "2026-07-31",
    "isFixedTerm": true,
    "tenantName": "Emma Johnson",
    "tenantContactEmail": "emma.j@example.com",
    "depositAmount": {
      "amount": 1650.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "depositScheme": "Deposit Protection Service",
    "depositReference": "DPS-123456789",
    "rentalYieldGross": 4.66,
    "rentalYieldNet": 2.35,
    "voidPeriodsDays": 45,
    "lastRentReviewDate": "2025-08-01",
    "nextRentReviewDate": "2026-08-01"
  },
  "expenses": [
    {
      "expenseType": "MORTGAGE_INTEREST",
      "amount": {
        "amount": 750.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "MONTHLY",
      "annualAmount": {
        "amount": 9000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "isTaxDeductible": true,
      "notes": "Interest-only mortgage"
    },
    {
      "expenseType": "BUILDINGS_INSURANCE",
      "amount": {
        "amount": 35.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "MONTHLY",
      "annualAmount": {
        "amount": 420.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "isTaxDeductible": true,
      "notes": "Landlord buildings insurance"
    },
    {
      "expenseType": "LANDLORD_INSURANCE",
      "amount": {
        "amount": 25.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "MONTHLY",
      "annualAmount": {
        "amount": 300.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "isTaxDeductible": true,
      "notes": "Rent guarantee and legal expenses"
    },
    {
      "expenseType": "LETTING_AGENT",
      "amount": {
        "amount": 165.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "MONTHLY",
      "annualAmount": {
        "amount": 1980.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "isTaxDeductible": true,
      "notes": "10% management fee"
    },
    {
      "expenseType": "GROUND_RENT",
      "amount": {
        "amount": 20.83,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "MONTHLY",
      "annualAmount": {
        "amount": 250.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "isTaxDeductible": true,
      "notes": "Annual ground rent"
    },
    {
      "expenseType": "SERVICE_CHARGE",
      "amount": {
        "amount": 150.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "MONTHLY",
      "annualAmount": {
        "amount": 1800.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "isTaxDeductible": true,
      "notes": "Building maintenance and communal areas"
    },
    {
      "expenseType": "REPAIRS_MAINTENANCE",
      "amount": {
        "amount": 83.33,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "frequency": "MONTHLY",
      "annualAmount": {
        "amount": 1000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "isTaxDeductible": true,
      "notes": "Average annual maintenance budget"
    }
  ],
  "totalMonthlyExpenses": {
    "amount": 1229.16,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "totalAnnualExpenses": {
    "amount": 14750.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "netMonthlyIncome": {
    "amount": 420.84,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "netAnnualIncome": {
    "amount": 5050.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "taxFields": {
    "stampDutyPaid": {
      "amount": 9750.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "stampDutyRate": 3.00,
    "eligibleForPRR": false,
    "prrYears": 0,
    "lettingsRelief": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "estimatedCGTBaseValue": {
      "amount": 325000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "capitalGainsLiability": {
      "amount": 100000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "capitalGainsTaxEstimate": {
      "amount": 28000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "rentalIncomeTaxable": {
      "amount": 5050.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxYearReported": "2025/2026"
  },
  "energyPerformanceCertificate": {
    "epcRating": "C",
    "epcScore": 72,
    "epcValidUntil": "2028-06-15",
    "epcReference": "1234-5678-9012-3456-7890"
  },
  "councilTaxBand": "D",
  "councilTaxAnnual": {
    "amount": 1800.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "improvements": [
    {
      "improvementType": "Kitchen Renovation",
      "date": "2020-03-15",
      "cost": {
        "amount": 8000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "description": "Full kitchen replacement with new appliances"
    },
    {
      "improvementType": "Bathroom Renovation",
      "date": "2021-07-20",
      "cost": {
        "amount": 5000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "description": "New bathroom suite and tiling"
    }
  ],
  "totalImprovementsCost": {
    "amount": 13000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "comparables": [
    {
      "address": "Flat 8, Riverside Apartments, Thames Street",
      "soldDate": "2025-11-15",
      "soldPrice": {
        "amount": 418000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "bedrooms": 2,
      "propertyType": "Apartment"
    },
    {
      "address": "Flat 15, Thames View, 50 River Lane",
      "soldDate": "2025-12-10",
      "soldPrice": {
        "amount": 435000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "bedrooms": 2,
      "propertyType": "Apartment"
    }
  ],
  "plannedSaleDate": null,
  "estimatedSalePrice": null,
  "intendToSell": false,
  "intendToRefinance": false,
  "notes": "Well-maintained property in popular riverside development. Excellent rental demand in area.",
  "documents": [
    {
      "documentId": 1,
      "type": "VALUATION",
      "name": "Desktop Valuation February 2026",
      "date": "2026-02-10",
      "url": "/api/v2/documents/doc-prop-001"
    }
  ],
  "createdAt": "2018-06-15T10:00:00Z",
  "updatedAt": "2026-02-16T14:30:00Z",
  "createdBy": {
    "id": 789,
    "name": "Jane Doe"
  },
  "updatedBy": {
    "id": 789,
    "name": "Jane Doe"
  }/assets/456" },
    "update": { "href": "/api/v2/factfinds/{factfindId}/assets/456", "method": "PUT" },
    "delete": { "href": "/api/v2/factfinds/{factfindId}/assets/456", "method": "DELETE" },
    "factfind": { "href": "/api/v2/factfinds/123" },
    "owners": { "href": "/api/v2/factfinds/{factfindId}/assets/456/owners" },
    "mortgages": { "href": "/api/v2/factfinds/{factfindId}/assets/456/mortgages" },
    "expenses": { "href": "/api/v2/factfinds/{factfindId}/assets/456/expenses" },
    "rental": { "href": "/api/v2/factfinds/{factfindId}/assets/456/rental" },
    "valuations": { "href": "/api/v2/factfinds/{factfindId}/assets/456/valuations" },
    "documents": { "href": "/api/v2/factfinds/{factfindId}/assets/456/documents" }
  }
}
```

**Field Behaviors:**

| Field | Type | Create | Update | Response | Notes |
|-------|------|--------|--------|----------|-------|
| `id` | uuid | ignored | ignored | included | read-only, server-generated |
| `factfind` | FactFindRef | required | ignored | included | Reference to owning FactFind, write-once |
| `propertyType` | string | required | ignored | included | write-once, PrimaryResidence/BuyToLet/SecondHome/Commercial |
| `propertySubType` | string | optional | updatable | included | Detached/SemiDetached/Terraced/Apartment/Bungalow |
| `ownershipType` | string | optional | updatable | included | Freehold/Leasehold/Shared Ownership |
| `address` | AddressValue | required | updatable | included | Full property address with UPRN and coordinates |
| `propertyDescription` | string | optional | updatable | included | Free text description |
| `numberOfBedrooms` | integer | optional | updatable | included | Number of bedrooms |
| `numberOfBathrooms` | integer | optional | updatable | included | Number of bathrooms |
| `numberOfReceptionRooms` | integer | optional | updatable | included | Number of reception rooms |
| `floorArea` | object | optional | updatable | included | Floor area with unit (sqft/sqm) |
| `tenure` | string | optional | updatable | included | Freehold/Leasehold |
| `leaseRemaining` | integer | optional | updatable | included | Years remaining on lease |
| `groundRent` | object | optional | updatable | included | Annual ground rent with frequency |
| `serviceCharge` | object | optional | updatable | included | Monthly/annual service charge |
| `purchaseDate` | date | required | ignored | included | write-once, date property purchased |
| `purchasePrice` | MoneyValue | required | ignored | included | write-once, original purchase price |
| `purchaseCosts` | object | optional | updatable | included | Breakdown of purchase costs (stamp duty, legal, etc.) |
| `totalInvestment` | MoneyValue | ignored | ignored | included | read-only, purchasePrice + purchaseCosts.totalCosts |
| `owners` | array | required | updatable | included | Array of owners with percentage ownership |
| `ownershipStructure` | string | required | updatable | included | Sole/Joint/Tenants in Common |
| `isJointOwnership` | boolean | ignored | ignored | included | read-only, computed from owners array |
| `jointOwnershipType` | string | optional | updatable | included | If joint: Joint Tenants/Tenants in Common |
| `currentValue` | MoneyValue | required | updatable | included | Current market value |
| `valuationDate` | date | required | updatable | included | Date of valuation |
| `valuationType` | string | required | updatable | included | Desktop/Surveyor/EstateAgent/RICS |
| `valuationProvider` | string | optional | updatable | included | Name of valuation provider |
| `valuationReference` | string | optional | updatable | included | Reference number for valuation |
| `previousValuation` | MoneyValue | optional | updatable | included | Previous valuation amount |
| `previousValuationDate` | date | optional | updatable | included | Previous valuation date |
| `valuationChange` | MoneyValue | ignored | ignored | included | read-only, currentValue - previousValuation |
| `valuationChangePercentage` | decimal | ignored | ignored | included | read-only, percentage change |
| `capitalGrowth` | MoneyValue | ignored | ignored | included | read-only, currentValue - purchasePrice |
| `capitalGrowthPercentage` | decimal | ignored | ignored | included | read-only, percentage growth |
| `annualizedGrowth` | decimal | ignored | ignored | included | read-only, CAGR from purchase |
| `mortgages` | array | optional | updatable | included | Array of mortgage references |
| `totalMortgageBalance` | MoneyValue | ignored | ignored | included | read-only, sum of mortgage balances |
| `equityAmount` | MoneyValue | ignored | ignored | included | read-only, currentValue - totalMortgageBalance |
| `equityPercentage` | decimal | ignored | ignored | included | read-only, equity as % of value |
| `isPrimaryResidence` | boolean | optional | updatable | included | Whether this is primary residence |
| `isRented` | boolean | optional | updatable | included | Whether property is rented |
| `isBuyToLet` | boolean | optional | updatable | included | Whether this is a BTL property |
| `rentalIncome` | object | optional | updatable | included | Full rental details including tenancy info |
| `expenses` | array | optional | updatable | included | Array of property expenses |
| `totalMonthlyExpenses` | MoneyValue | ignored | ignored | included | read-only, sum of monthly expenses |
| `totalAnnualExpenses` | MoneyValue | ignored | ignored | included | read-only, sum of annual expenses |
| `netMonthlyIncome` | MoneyValue | ignored | ignored | included | read-only, rental income - expenses |
| `netAnnualIncome` | MoneyValue | ignored | ignored | included | read-only, annual rental - annual expenses |
| `taxFields` | object | optional | updatable | included | Tax details including CGT, PRR, stamp duty |
| `energyPerformanceCertificate` | object | optional | updatable | included | EPC rating and details |
| `councilTaxBand` | string | optional | updatable | included | Council tax band |
| `councilTaxAnnual` | MoneyValue | optional | updatable | included | Annual council tax |
| `improvements` | array | optional | updatable | included | Array of property improvements |
| `totalImprovementsCost` | MoneyValue | ignored | ignored | included | read-only, sum of improvement costs |
| `comparables` | array | optional | updatable | included | Array of comparable property sales |
| `plannedSaleDate` | date | optional | updatable | included | Planned sale date if applicable |
| `estimatedSalePrice` | MoneyValue | optional | updatable | included | Estimated sale price |
| `intendToSell` | boolean | optional | updatable | included | Whether client intends to sell |
| `intendToRefinance` | boolean | optional | updatable | included | Whether client intends to refinance |
| `notes` | string | optional | updatable | included | Additional notes |
| `documents` | array | optional | updatable | included | Array of document references |
| `createdAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `updatedAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `createdBy` | object | ignored | ignored | included | read-only, audit trail |
| `updatedBy` | object | ignored | ignored | included | read-only, audit trail |

**Usage Examples:**

**Creating a Buy-To-Let Property (POST /api/v2/factfinds/{factfindId}/assets):**
```json
{
  "factfind": { "id": 123 },
  "propertyType": "BTL",
  "address": {
    "line1": "Flat 12, Riverside Apartments",
    "line2": "45 Thames Street",
    "city": "London",
    "postcode": "SE1 9PH",
    "country": { "code": "GB" }
  },
  "purchaseDate": "2018-06-15",
  "purchasePrice": { "amount": 325000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
  "currentValue": { "amount": 425000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
  "valuationDate": "2026-02-10",
  "valuationType": "DESKTOP",
  "owners": [
    {
      "client": { "id": 123 },
      "ownershipPercentage": 100.00,
      "isPrimaryOwner": true
    }
  ],
  "ownershipStructure": "SOLE",
  "isBuyToLet": true,
  "isRented": true
}
```
Server generates `id`, `createdAt`, `updatedAt`, and computes read-only fields. Returns complete contract.

**Updating Property Valuation (PUT /api/v2/properties/456):**
```json
{
  "currentValue": { "amount": 435000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
  "valuationDate": "2026-06-15",
  "valuationType": "SURVEYOR",
  "valuationProvider": "Knight Frank",
  "previousValuation": { "amount": 425000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
  "previousValuationDate": "2026-02-10"
}
```
Server updates `updatedAt` and recalculates equity, LTV, capital growth. Returns complete contract.

**Updating Rental Income (PATCH /api/v2/properties/456):**
```json
{
  "rentalIncome": {
    "monthlyRent": { "amount": 1750.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
    "tenancyStartDate": "2026-08-01",
    "tenancyEndDate": "2027-07-31",
    "tenantName": "Michael Brown"
  }
}
```
Only specified fields are updated. Server recalculates rental yield and net income. Returns complete contract.

**Validation Rules:**

1. **Required Fields on Create:** `factfind`, `propertyType`, `address`, `purchaseDate`, `purchasePrice`, `currentValue`, `valuationDate`, `valuationType`, `owners`, `ownershipStructure`
2. **Write-Once Fields:** Cannot be changed after creation: `factfind`, `propertyType`, `purchaseDate`, `purchasePrice`
3. **Ownership Validation:** Sum of `owners[].ownershipPercentage` must equal 100%
4. **Date Logic:** `purchaseDate` must be <= `valuationDate`, `tenancyEndDate` must be > `tenancyStartDate`
5. **Rental Validation:** If `isRented` is true, `rentalIncome` must be provided
6. **Buy-To-Let Validation:** If `isBuyToLet` is true, `propertyType` must be "BTL"
7. **Leasehold Validation:** If `tenure` is "Leasehold", `leaseRemaining` should be provided
8. **Mortgage Linking:** `mortgages[].mortgageRef.id` must reference valid Arrangement entities
9. **Valuation Requirements:** `currentValue` must be > 0, `valuationDate` must not be in future
10. **Reference Integrity:** `factfind.id`, `owners[].client.id` must reference existing entities

---

### 14.10 Equity Contract

The `Equity` contract represents a direct stock holding with performance tracking and dividend history.

**Reference Type:** Equity is a reference type with identity (has `id` field).

```json
{
  "id": 321,
  "factfind": {
    "id": 123,
    "href": "/api/v2/factfinds/123",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "ticker": "BP.L",
  "isin": "GB0007980591",
  "sedol": "0798059",
  "cusip": null,
  "companyName": "BP plc",
  "companyDescription": "British multinational oil and gas company",
  "exchange": {
    "code": "LSE",
    "display": "London Stock Exchange",
    "mic": "XLON"
  },
  "sector": {
    "code": "ENERGY",
    "display": "Energy",
    "subSector": "Oil & Gas Producers"
  },
  "industry": "Integrated Oil & Gas",
  "currency": {
    "code": "GBP",
    "display": "British Pound",
    "symbol": "£"
  },
  "country": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "holdings": {
    "quantity": 5000,
    "averagePurchasePrice": {
      "amount": 4.25,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalCostBasis": {
      "amount": 21250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentPrice": {
      "amount": 5.15,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentValue": {
      "amount": 25750.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "priceDate": "2026-02-16T16:00:00Z"
  },
  "performance": {
    "unrealizedGain": {
      "amount": 4500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "unrealizedGainPercentage": 21.18,
    "realizedGain": {
      "amount": 1250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalGain": {
      "amount": 5750.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalReturn": 27.06,
    "dayChange": {
      "amount": 0.08,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "dayChangePercentage": 1.58,
    "annualizedReturn": 5.41,
    "totalDividendsReceived": {
      "amount": 3750.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "dividendYield": 4.85,
    "totalReturnWithDividends": {
      "amount": 9500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalReturnWithDividendsPercentage": 44.71
  },
  "purchases": [
    {
      "transactionId": "txn-001",
      "date": "2021-03-15",
      "transactionType": "BUY",
      "quantity": 3000,
      "price": {
        "amount": 4.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "grossAmount": {
        "amount": 12000.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "commission": {
        "amount": 10.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "stampDuty": {
        "amount": 60.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "otherCosts": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "totalCost": {
        "amount": 12070.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "broker": "Hargreaves Lansdown",
      "notes": "Initial purchase"
    },
    {
      "transactionId": "txn-002",
      "date": "2022-06-20",
      "transactionType": "BUY",
      "quantity": 2000,
      "price": {
        "amount": 4.60,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "grossAmount": {
        "amount": 9200.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "commission": {
        "amount": 10.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "stampDuty": {
        "amount": 46.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "otherCosts": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "totalCost": {
        "amount": 9256.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "broker": "Hargreaves Lansdown",
      "notes": "Additional purchase during market dip"
    }
  ],
  "sales": [
    {
      "transactionId": "txn-003",
      "date": "2024-09-10",
      "transactionType": "SELL",
      "quantity": 500,
      "price": {
        "amount": 5.50,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "grossAmount": {
        "amount": 2750.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "commission": {
        "amount": 10.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "otherCosts": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netProceeds": {
        "amount": 2740.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "costBasisOfSharesSold": {
        "amount": 2125.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "realizedGain": {
        "amount": 615.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "broker": "Hargreaves Lansdown",
      "notes": "Partial profit taking"
    }
  ],
  "dividends": [
    {
      "dividendId": "div-001",
      "exDividendDate": "2021-08-05",
      "paymentDate": "2021-09-27",
      "dividendType": "ORDINARY",
      "amountPerShare": {
        "amount": 0.05175,
        "currency": {
          "code": "USD",
          "display": "US Dollar",
          "symbol": "$"
        }
      },
      "amountPerShareGBP": {
        "amount": 0.0375,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "quantityHeld": 3000,
      "grossDividend": {
        "amount": 112.50,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "withholdingTax": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netDividend": {
        "amount": 112.50,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "reinvested": false,
      "taxYear": "2021/2022",
      "notes": "Q3 2021 dividend"
    },
    {
      "dividendId": "div-002",
      "exDividendDate": "2021-11-04",
      "paymentDate": "2021-12-20",
      "dividendType": "ORDINARY",
      "amountPerShare": {
        "amount": 0.05250,
        "currency": {
          "code": "USD",
          "display": "US Dollar",
          "symbol": "$"
        }
      },
      "amountPerShareGBP": {
        "amount": 0.0390,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "quantityHeld": 3000,
      "grossDividend": {
        "amount": 117.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "withholdingTax": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netDividend": {
        "amount": 117.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "reinvested": false,
      "taxYear": "2021/2022",
      "notes": "Q4 2021 dividend"
    },
    {
      "dividendId": "div-003",
      "exDividendDate": "2025-11-07",
      "paymentDate": "2025-12-23",
      "dividendType": "ORDINARY",
      "amountPerShare": {
        "amount": 0.08010,
        "currency": {
          "code": "USD",
          "display": "US Dollar",
          "symbol": "$"
        }
      },
      "amountPerShareGBP": {
        "amount": 0.0625,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "quantityHeld": 5000,
      "grossDividend": {
        "amount": 312.50,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "withholdingTax": {
        "amount": 0.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "netDividend": {
        "amount": 312.50,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "reinvested": false,
      "taxYear": "2025/2026",
      "notes": "Q4 2025 dividend - increased payout"
    }
  ],
  "corporateActions": [
    {
      "actionId": "action-001",
      "date": "2023-05-15",
      "actionType": "STOCK_SPLIT",
      "ratio": "2:1",
      "description": "2-for-1 stock split",
      "quantityBefore": 2500,
      "quantityAfter": 5000,
      "impact": "Holdings doubled, cost basis per share halved"
    },
    {
      "actionId": "action-002",
      "date": "2024-03-20",
      "actionType": "RIGHTS_ISSUE",
      "ratio": "1:10",
      "description": "Rights issue at £4.00 per share",
      "pricePerShare": {
        "amount": 4.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "quantityOffered": 500,
      "quantityTaken": 0,
      "impact": "Rights not taken up"
    }
  ],
  "taxCalculation": {
    "costBasisMethod": "SECTION104",
    "section104Pool": {
      "quantity": 5000,
      "pooledCost": {
        "amount": 21250.00,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      },
      "averageCostPerShare": {
        "amount": 4.25,
        "currency": {
          "code": "GBP",
          "display": "British Pound",
          "symbol": "£"
        }
      }
    },
    "capitalGainsRealized": {
      "amount": 1250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "capitalGainsUnrealized": {
      "amount": 4500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalCapitalGains": {
      "amount": 5750.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "capitalGainsAllowance": {
      "amount": 3000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxableCGT": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "dividendsTaxable": {
      "amount": 3250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "dividendsAllowance": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxYear": "2025/2026"
  },
  "marketData": {
    "lastUpdated": "2026-02-16T16:00:00Z",
    "bid": {
      "amount": 5.14,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "ask": {
      "amount": 5.16,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "open": {
      "amount": 5.07,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "high": {
      "amount": 5.18,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "low": {
      "amount": 5.05,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "close": {
      "amount": 5.15,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "volume": 12500000,
    "52WeekHigh": {
      "amount": 5.85,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "52WeekLow": {
      "amount": 4.15,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "marketCap": {
      "amount": 95000000000,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "peRatio": 12.5,
    "eps": {
      "amount": 0.412,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "beta": 1.15
  },
  "accountType": "GIA",
  "broker": {
    "name": "Hargreaves Lansdown",
    "accountNumber": "HL-12345678"
  },
  "isAdvised": true,
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Jane Doe",
    "code": "ADV001"
  },
  "investmentObjective": "Long-term income and capital growth from UK blue-chip dividend stock",
  "notes": "Core UK equity holding for dividend income. Monitor oil price exposure.",
  "documents": [
    {
      "documentId": 1,
      "type": "CONTRACT_NOTE",
      "name": "Purchase Contract Note - March 2021",
      "date": "2021-03-15",
      "url": "/api/v2/documents/doc-eq-001"
    }
  ],
  "createdAt": "2021-03-15T10:00:00Z",
  "updatedAt": "2026-02-16T16:30:00Z",
  "createdBy": {
    "id": 789,
    "name": "Jane Doe"
  },
  "updatedBy": {
    "id": 789,
    "name": "Jane Doe"
  }/assets/equity-321" },
    "update": { "href": "/api/v2/factfinds/{factfindId}/assets/equity-321", "method": "PUT" },
    "delete": { "href": "/api/v2/factfinds/{factfindId}/assets/equity-321", "method": "DELETE" },
    "client": { "href": "/api/v2/factfinds/{factfindId}/clients/123" },
    "factfind": { "href": "/api/v2/factfinds/123" },
    "transactions": { "href": "/api/v2/factfinds/{factfindId}/assets/equity-321/transactions" },
    "dividends": { "href": "/api/v2/factfinds/{factfindId}/assets/equity-321/dividends" },
    "corporateActions": { "href": "/api/v2/factfinds/{factfindId}/assets/equity-321/corporate-actions" },
    "performance": { "href": "/api/v2/factfinds/{factfindId}/assets/equity-321/performance" },
    "documents": { "href": "/api/v2/factfinds/{factfindId}/assets/equity-321/documents" }
  }
}
```

**Field Behaviors:**

| Field | Type | Create | Update | Response | Notes |
|-------|------|--------|--------|----------|-------|
| `id` | uuid | ignored | ignored | included | read-only, server-generated |
| `factfind` | FactFindRef | required | ignored | included | Reference to owning FactFind, write-once |
| `client` | ClientRef | required | ignored | included | Reference to client, write-once |
| `ticker` | string | required | ignored | included | write-once, stock ticker symbol |
| `isin` | string | required | ignored | included | write-once, International Securities ID |
| `sedol` | string | optional | ignored | included | write-once, Stock Exchange Daily Official List |
| `cusip` | string | optional | ignored | included | write-once, CUSIP identifier (US stocks) |
| `companyName` | string | required | updatable | included | Name of company |
| `companyDescription` | string | optional | updatable | included | Brief description of company |
| `exchange` | string | required | updatable | included | Stock exchange where traded |
| `sector` | string | optional | updatable | included | Sector and sub-sector classification |
| `industry` | string | optional | updatable | included | Industry classification |
| `currency` | CurrencyValue | required | updatable | included | Trading currency |
| `country` | CountryValue | optional | updatable | included | Country of domicile |
| `holdings` | object | required | updatable | included | Current holdings with quantity and values |
| `performance` | object | ignored | ignored | included | read-only, computed performance metrics |
| `purchases` | array | optional | updatable | included | Array of purchase transactions |
| `sales` | array | optional | updatable | included | Array of sale transactions |
| `dividends` | array | optional | updatable | included | Array of dividend payments |
| `corporateActions` | array | optional | updatable | included | Array of corporate actions (splits, rights issues) |
| `taxCalculation` | object | optional | updatable | included | Tax calculation details including Section 104 pool |
| `marketData` | object | optional | updatable | included | Current market data and statistics |
| `accountType` | string | optional | updatable | included | ISA/GIA/SIPP account type |
| `broker` | object | optional | updatable | included | Broker details and account number |
| `isAdvised` | boolean | optional | updatable | included | Whether holding is advised |
| `adviser` | AdviserRef | optional | updatable | included | Reference to adviser |
| `investmentObjective` | string | optional | updatable | included | Investment objective for this holding |
| `notes` | string | optional | updatable | included | Additional notes |
| `documents` | array | optional | updatable | included | Array of document references |
| `createdAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `updatedAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `createdBy` | object | ignored | ignored | included | read-only, audit trail |
| `updatedBy` | object | ignored | ignored | included | read-only, audit trail |

**Usage Examples:**

**Creating an Equity Holding (POST /api/v2/factfinds/{factfindId}/assets):**
```json
{
  "factfind": { "id": 123 },
  "client": { "id": 123 },
  "ticker": "BP.L",
  "isin": "GB0007980591",
  "sedol": "0798059",
  "companyName": "BP plc",
  "exchange": "LSE",
  "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
  "holdings": {
    "quantity": 3000,
    "averagePurchasePrice": { "amount": 4.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
    "totalCostBasis": { "amount": 12000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
    "currentPrice": { "amount": 5.15, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
    "currentValue": { "amount": 15450.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } }
  },
  "accountType": "GIA"
}
```
Server generates `id`, `createdAt`, `updatedAt`, and computes performance metrics. Returns complete contract.

**Recording a Purchase (PUT /api/v2/equities/equity-321):**
```json
{
  "purchases": [
    {
      "date": "2026-02-18",
      "transactionType": "BUY",
      "quantity": 1000,
      "price": { "amount": 5.20, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "grossAmount": { "amount": 5200.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "commission": { "amount": 10.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "stampDuty": { "amount": 26.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "totalCost": { "amount": 5236.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } }
    }
  ],
  "holdings": {
    "quantity": 6000,
    "totalCostBasis": { "amount": 26486.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } }
  }
}
```
Server updates `updatedAt`, recalculates performance and Section 104 pool. Returns complete contract.

**Recording a Dividend (PATCH /api/v2/equities/equity-321):**
```json
{
  "dividends": [
    {
      "exDividendDate": "2026-02-14",
      "paymentDate": "2026-03-28",
      "dividendType": "ORDINARY",
      "amountPerShare": { "amount": 0.0650, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "quantityHeld": 5000,
      "grossDividend": { "amount": 325.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "netDividend": { "amount": 325.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      } },
      "reinvested": false
    }
  ]
}
```
Only specified fields are updated. Server recalculates total dividends and yield. Returns complete contract.

**Validation Rules:**

1. **Required Fields on Create:** `factfind`, `client`, `ticker`, `isin`, `companyName`, `exchange`, `currency`, `holdings`
2. **Write-Once Fields:** Cannot be changed after creation: `factfind`, `client`, `ticker`, `isin`, `sedol`, `cusip`
3. **Holdings Validation:** `holdings.quantity` must be > 0, `currentValue` must equal `quantity * currentPrice`
4. **Transaction Validation:** Each purchase/sale must have `date`, `quantity`, `price`, `totalCost`/`netProceeds`
5. **Dividend Validation:** Each dividend must have `exDividendDate`, `paymentDate`, `amountPerShare`, `quantityHeld`
6. **Section 104 Pool:** For UK equities, `taxCalculation.section104Pool` must track pooled cost accurately
7. **Corporate Actions:** Stock splits must maintain cost basis (quantity doubles, cost per share halves)
8. **Date Logic:** `exDividendDate` must be before `paymentDate`, transaction dates must be in past
9. **Market Data:** `marketData.lastUpdated` must not be in future
10. **Reference Integrity:** `factfind.id`, `client.id`, `adviserRef.id` must reference existing entities

---

### 14.11 IdentityVerification Contract

The `IdentityVerification` contract represents identity verification status with KYC and AML checks.

**Reference Type:** IdentityVerification is a reference type with identity (has `id` field).

```json
{
  "id": 987,
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "factfind": {
    "id": 123,
    "href": "/api/v2/factfinds/123",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "verificationType": "KYC_AML",
  "verificationLevel": "ENHANCED",
  "verificationStatus": "VERIFIED",
  "verificationDate": "2026-02-10T14:30:00Z",
  "verificationExpiryDate": "2027-02-10",
  "isExpired": false,
  "daysUntilExpiry": 365,
  "documents": [
    {
      "documentId": 1,
      "documentType": "PASSPORT",
      "documentNumber": "502135321",
      "issuingCountry": {
        "code": "GB",
        "display": "United Kingdom",
        "alpha3": "GBR"
      },
      "issueDate": "2020-05-15",
      "expiryDate": "2030-05-15",
      "documentStatus": "VERIFIED",
      "verifiedDate": "2026-02-10T14:30:00Z",
      "documentImageUrl": "https://secure.documents.example.com/id/doc-001-encrypted",
      "isExpired": false,
      "isPrimary": true
    },
    {
      "documentId": 2,
      "documentType": "UTILITY_BILL",
      "utilityType": "Electricity",
      "issueDate": "2026-01-15",
      "documentStatus": "VERIFIED",
      "verifiedDate": "2026-02-10T14:30:00Z",
      "address": {
        "line1": "123 Main Street",
        "line2": "Apartment 4B",
        "city": "London",
        "postcode": "SW1A 1AA",
        "country": "GB"
      },
      "addressMatched": true,
      "documentImageUrl": "https://secure.documents.example.com/id/doc-002-encrypted",
      "isPrimary": false
    }
  ],
  "identityProvider": {
    "provider": {
      "code": "ONFIDO",
      "display": "Onfido",
      "website": "https://onfido.com"
    },
    "providerReference": "ONFIDO-CHK-123456789",
    "providerCheckId": "chk_abc123def456ghi789",
    "providerScore": 98,
    "providerDecision": "CLEAR",
    "providerReportUrl": "https://dashboard.onfido.com/checks/chk_abc123def456ghi789",
    "providerResponseDate": "2026-02-10T14:30:00Z"
  },
  "biometricVerification": {
    "faceMatch": {
      "status": "MATCHED",
      "confidence": 99.5,
      "matchDate": "2026-02-10T14:30:00Z"
    },
    "livenessCheck": {
      "status": "PASSED",
      "confidence": 98.2,
      "checkDate": "2026-02-10T14:30:00Z"
    }
  },
  "addressVerification": {
    "addressVerified": true,
    "verificationMethod": "DOCUMENT",
    "verifiedAddress": {
      "line1": "123 Main Street",
      "line2": "Apartment 4B",
      "city": "London",
      "postcode": "SW1A 1AA",
      "country": "GB"
    },
    "addressMatchScore": 100,
    "verificationDate": "2026-02-10T14:30:00Z"
  },
  "amlChecks": {
    "amlStatus": "CLEAR",
    "amlCheckDate": "2026-02-10T14:30:00Z",
    "amlProvider": {
      "code": "WORLDCHECK",
      "display": "World-Check (Refinitiv)",
      "website": "https://www.refinitiv.com/en/products/world-check-kyc-screening"
    },
    "amlProviderReference": "WC-2026-02-987654321",
    "sanctionsScreening": {
      "status": "CLEAR",
      "listsChecked": [
        "UN Security Council",
        "EU Sanctions",
        "OFAC SDN",
        "UK HM Treasury",
        "Interpol"
      ],
      "matches": [],
      "checkDate": "2026-02-10T14:30:00Z"
    },
    "pepScreening": {
      "status": "NOT_PEP",
      "isPep": false,
      "pepCategory": null,
      "pepRelationship": null,
      "pepSource": null,
      "checkDate": "2026-02-10T14:30:00Z"
    },
    "adverseMediaScreening": {
      "status": "CLEAR",
      "adverseMediaChecked": true,
      "adverseMediaMatches": [],
      "checkDate": "2026-02-10T14:30:00Z"
    },
    "watchlistScreening": {
      "status": "CLEAR",
      "watchlistsChecked": [
        "FBI Most Wanted",
        "Europol Most Wanted",
        "OFAC Non-SDN Lists",
        "Specially Designated Nationals"
      ],
      "matches": [],
      "checkDate": "2026-02-10T14:30:00Z"
    }
  },
  "riskAssessment": {
    "overallRiskRating": "LOW",
    "riskScore": 15,
    "riskScoreMax": 100,
    "riskFactors": [
      {
        "factor": "CLEAR_AML",
        "impact": "POSITIVE",
        "weight": -10
      },
      {
        "factor": "VERIFIED_IDENTITY",
        "impact": "POSITIVE",
        "weight": -15
      },
      {
        "factor": "HIGH_CONFIDENCE_BIOMETRIC",
        "impact": "POSITIVE",
        "weight": -10
      }
    ],
    "riskNotes": "Low risk client with clear AML checks, verified identity, and high confidence biometric match"
  },
  "regulatoryCompliance": {
    "mlrCompliance": {
      "isCompliant": true,
      "regulationReference": "Money Laundering Regulations 2017",
      "complianceDate": "2026-02-10",
      "notes": "Compliant with UK Money Laundering Regulations 2017"
    },
    "fcaCompliance": {
      "isCompliant": true,
      "regulationReference": "FCA Handbook SYSC 3.2",
      "complianceDate": "2026-02-10",
      "notes": "Compliant with FCA systems and controls requirements"
    },
    "kycCompliance": {
      "isCompliant": true,
      "standardReference": "JMLSG Guidance Part I Chapter 5",
      "complianceDate": "2026-02-10",
      "notes": "Compliant with JMLSG KYC guidance"
    },
    "gdprCompliance": {
      "isCompliant": true,
      "regulationReference": "GDPR Article 6(1)(c)",
      "lawfulBasis": "Legal obligation",
      "complianceDate": "2026-02-10"
    }
  },
  "verificationHistory": [
    {
      "historyId": "hist-001",
      "verificationType": "INITIAL_KYC",
      "verificationDate": "2020-01-10T10:00:00Z",
      "status": "VERIFIED",
      "provider": "Experian",
      "providerReference": "EXP-KYC-2020-01-123",
      "expiryDate": "2021-01-10",
      "notes": "Initial client onboarding verification"
    },
    {
      "historyId": "hist-002",
      "verificationType": "ANNUAL_REVIEW",
      "verificationDate": "2021-01-15T09:00:00Z",
      "status": "VERIFIED",
      "provider": "Experian",
      "providerReference": "EXP-KYC-2021-01-456",
      "expiryDate": "2022-01-15",
      "notes": "Annual KYC review - no changes"
    },
    {
      "historyId": "hist-003",
      "verificationType": "ENHANCED_DD",
      "verificationDate": "2026-02-10T14:30:00Z",
      "status": "VERIFIED",
      "provider": "Onfido",
      "providerReference": "ONFIDO-CHK-123456789",
      "expiryDate": "2027-02-10",
      "notes": "Enhanced verification with biometric checks"
    }
  ],
  "nextReviewDate": "2027-02-10",
  "reviewFrequency": "ANNUAL",
  "verifiedBy": {
    "id": 789,
    "name": "Jane Doe",
    "role": "Compliance Officer"
  },
  "verifiedAt": "2026-02-10T14:30:00Z",
  "verificationIpAddress": "192.168.1.100",
  "verificationUserAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
  "consentGiven": true,
  "consentDate": "2026-02-10T14:00:00Z",
  "consentReference": "consent-123",
  "dataProtectionNoticeProvided": true,
  "dataProtectionNoticeVersion": "2.1",
  "dataProtectionNoticeDate": "2026-02-10T14:00:00Z",
  "notes": "Enhanced verification completed successfully. All checks clear. High confidence biometric match. No adverse findings.",
  "documents": [
    {
      "documentId": 1,
      "type": "VERIFICATION_REPORT",
      "name": "Onfido Verification Report - Feb 2026",
      "date": "2026-02-10",
      "url": "/api/v2/documents/doc-verify-001"
    },
    {
      "documentId": 2,
      "type": "AML_REPORT",
      "name": "World-Check AML Report - Feb 2026",
      "date": "2026-02-10",
      "url": "/api/v2/documents/doc-verify-002"
    }
  ],
  "createdAt": "2026-02-10T14:30:00Z",
  "updatedAt": "2026-02-10T15:00:00Z",
  "createdBy": {
    "id": 789,
    "name": "Jane Doe"
  },
  "updatedBy": {
    "id": 789,
    "name": "Jane Doe"
  },
    "update": { "href": "/api/v2/identity-verification/idverify-987", "method": "PUT" },
    "delete": { "href": "/api/v2/identity-verification/idverify-987", "method": "DELETE" },
    "client": { "href": "/api/v2/factfinds/{factfindId}/clients/123" },
    "factfind": { "href": "/api/v2/factfinds/123" },
    "verificationReport": { "href": "/api/v2/documents/doc-verify-001" },
    "amlReport": { "href": "/api/v2/documents/doc-verify-002" },
    "history": { "href": "/api/v2/identity-verification/idverify-987/history" },
    "renew": { "href": "/api/v2/identity-verification/idverify-987/renew", "method": "POST" }
  }
}
```

**Field Behaviors:**

| Field | Type | Create | Update | Response | Notes |
|-------|------|--------|--------|----------|-------|
| `id` | uuid | ignored | ignored | included | read-only, server-generated |
| `client` | ClientRef | required | ignored | included | Reference to client, write-once |
| `factfind` | FactFindRef | optional | ignored | included | Reference to owning FactFind, write-once |
| `verificationType` | string | required | ignored | included | write-once, KYC/AML/EnhancedDueDiligence |
| `verificationLevel` | string | optional | updatable | included | Standard/Enhanced/Simplified |
| `verificationStatus` | string | required | updatable | included | Pending/InProgress/Verified/Failed/Expired |
| `verificationDate` | timestamp | required | updatable | included | Date/time of verification |
| `verificationExpiryDate` | date | optional | updatable | included | Verification expiry date |
| `isExpired` | boolean | ignored | ignored | included | read-only, computed from expiryDate |
| `daysUntilExpiry` | integer | ignored | ignored | included | read-only, computed |
| `documents` | array | required | updatable | included | Array of identity documents |
| `identityProvider` | object | optional | updatable | included | Third-party verification provider details |
| `biometricVerification` | object | optional | updatable | included | Face match and liveness check results |
| `addressVerification` | object | optional | updatable | included | Address verification details |
| `amlChecks` | object | required | updatable | included | AML checks including sanctions, PEP, adverse media |
| `riskAssessment` | object | optional | updatable | included | Overall risk rating and factors |
| `regulatoryCompliance` | object | optional | updatable | included | Compliance with MLR, FCA, KYC, GDPR |
| `verificationHistory` | array | optional | updatable | included | Historical verification records |
| `nextReviewDate` | date | optional | updatable | included | Next scheduled review date |
| `reviewFrequency` | string | optional | updatable | included | Monthly/Quarterly/Annual |
| `verifiedBy` | object | required | updatable | included | User who performed verification |
| `verifiedAt` | timestamp | required | updatable | included | Verification timestamp |
| `verificationIpAddress` | string | optional | updatable | included | IP address of verification |
| `verificationUserAgent` | string | optional | updatable | included | User agent of verification |
| `consentGiven` | boolean | required | updatable | included | Whether consent was given |
| `consentDate` | timestamp | optional | updatable | included | Date of consent |
| `consentReference` | string | optional | updatable | included | Reference to consent record |
| `dataProtectionNoticeProvided` | boolean | optional | updatable | included | Whether data protection notice was provided |
| `dataProtectionNoticeVersion` | string | optional | updatable | included | Version of data protection notice |
| `dataProtectionNoticeDate` | timestamp | optional | updatable | included | Date notice was provided |
| `notes` | string | optional | updatable | included | Additional notes |
| `documents` | array | optional | updatable | included | Array of document references |
| `createdAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `updatedAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `createdBy` | object | ignored | ignored | included | read-only, audit trail |
| `updatedBy` | object | ignored | ignored | included | read-only, audit trail |

**Usage Examples:**

**Submitting Identity Verification (POST /api/v2/identity-verification):**
```json
{
  "client": { "id": 123 },
  "factfind": { "id": 123 },
  "verificationType": "KYC_AML",
  "verificationLevel": "ENHANCED",
  "verificationStatus": "PENDING",
  "verificationDate": "2026-02-10T14:30:00Z",
  "documents": [
    {
      "documentType": "PASSPORT",
      "documentNumber": "502135321",
      "issuingCountry": "GB",
      "issueDate": "2020-05-15",
      "expiryDate": "2030-05-15",
      "isPrimary": true
    }
  ],
  "amlChecks": {
    "amlStatus": "PENDING"
  },
  "consentGiven": true,
  "consentDate": "2026-02-10T14:00:00Z",
  "verifiedBy": { "id": 789 },
  "verifiedAt": "2026-02-10T14:30:00Z"
}
```
Server generates `id`, `createdAt`, `updatedAt`. Returns complete contract.

**Updating Verification Status (PUT /api/v2/identity-verification/idverify-987):**
```json
{
  "verificationStatus": "VERIFIED",
  "verificationDate": "2026-02-10T14:30:00Z",
  "verificationExpiryDate": "2027-02-10",
  "identityProvider": {
    "provider": "ONFIDO",
    "providerReference": "ONFIDO-CHK-123456789",
    "providerScore": 98,
    "providerDecision": "CLEAR"
  },
  "amlChecks": {
    "amlStatus": "CLEAR",
    "amlCheckDate": "2026-02-10T14:30:00Z",
    "sanctionsScreening": {
      "status": "CLEAR"
    },
    "pepScreening": {
      "status": "NOT_PEP",
      "isPep": false
    }
  },
  "riskAssessment": {
    "overallRiskRating": "LOW",
    "riskScore": 15
  }
}
```
Server updates `updatedAt`. Returns complete contract with verification complete.

**Adding AML Result (PATCH /api/v2/identity-verification/idverify-987):**
```json
{
  "amlChecks": {
    "amlStatus": "CLEAR",
    "amlProvider": "WORLDCHECK",
    "amlProviderReference": "WC-2026-02-987654321",
    "sanctionsScreening": {
      "status": "CLEAR",
      "matches": []
    },
    "adverseMediaScreening": {
      "status": "CLEAR",
      "adverseMediaMatches": []
    }
  }
}
```
Only specified fields are updated. Returns complete contract.

**Validation Rules:**

1. **Required Fields on Create:** `client`, `verificationType`, `verificationStatus`, `verificationDate`, `documents`, `amlChecks`, `consentGiven`, `verifiedBy`, `verifiedAt`
2. **Write-Once Fields:** Cannot be changed after creation: `client`, `factfind`, `verificationType`
3. **Consent Validation:** `consentGiven` must be true before verification can be performed
4. **Document Validation:** At least one primary identity document (Passport/DrivingLicense) must be provided
5. **Document Expiry:** Identity documents must not be expired (expiryDate must be in future)
6. **AML Requirements:** For `verificationStatus` = "VERIFIED", `amlChecks.amlStatus` must be "CLEAR" or "REVIEW"
7. **Biometric Validation:** If biometric verification is used, confidence scores must be > 90%
8. **Address Match:** For address verification, `addressMatchScore` should be > 80%
9. **Date Logic:** `verificationDate` must not be in future, `verificationExpiryDate` must be > `verificationDate`
10. **Reference Integrity:** `client.id`, `factfind.id` must reference existing entities

---

### 14.12 Consent Contract

The `Consent` contract represents GDPR consent tracking with purpose-specific consents and audit trail.

**Reference Type:** Consent is a reference type with identity (has `id` field).

```json
{
  "id": 555,
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  },
  "factfind": {
    "id": 123,
    "href": "/api/v2/factfinds/123",
    "factFindNumber": "FF-2025-00123",
    "status": "INP"
  },
  "consentPurpose": "DATA_PROCESSING",
  "consentPurposeDescription": "Processing of personal and financial data for the purpose of financial advice and planning",
  "consentStatus": "GIVEN",
  "consentGivenDate": "2026-02-10T14:00:00Z",
  "consentWithdrawnDate": null,
  "consentExpiryDate": "2028-02-10",
  "isExpired": false,
  "daysUntilExpiry": 730,
  "isActive": true,
  "consentMethod": "EXPLICIT",
  "consentChannel": "WEB",
  "consentVersion": "2.1",
  "consentText": "I consent to the collection, storage, and processing of my personal and financial data for the purpose of receiving financial advice and planning services. I understand that my data will be processed in accordance with the Privacy Policy and GDPR regulations.",
  "lawfulBasis": "CONSENT",
  "lawfulBasisDetails": "Consent freely given for data processing under GDPR Article 6(1)(a)",
  "specialCategoryData": {
    "isSpecialCategory": false,
    "specialCategoryTypes": [],
    "lawfulBasisSpecialCategory": null
  },
  "dataProcessing": {
    "dataCategories": [
      {
        "category": "PERSONAL_IDENTITY",
        "dataTypes": [
          "Name",
          "Date of Birth",
          "Address",
          "Contact Details",
          "National Insurance Number"
        ]
      },
      {
        "category": "FINANCIAL",
        "dataTypes": [
          "Income",
          "Expenditure",
          "Assets",
          "Liabilities",
          "Investment Holdings",
          "Pension Details"
        ]
      },
      {
        "category": "EMPLOYMENT",
        "dataTypes": [
          "Employer Details",
          "Employment History",
          "Salary Information"
        ]
      }
    ],
    "processingActivities": [
      {
        "activity": "STORAGE",
        "description": "Secure storage of client data in encrypted databases",
        "purpose": "Maintaining client records for advice delivery"
      },
      {
        "activity": "ANALYSIS",
        "description": "Analysis of financial circumstances for advice purposes",
        "purpose": "Delivering personalized financial advice"
      },
      {
        "activity": "COMMUNICATION",
        "description": "Sending advice recommendations and updates to client",
        "purpose": "Ongoing client service and advice delivery"
      }
    ],
    "dataRetentionPeriod": {
      "value": 7,
      "unit": "years",
      "reason": "Regulatory requirement - FCA indefinite retention for advised products"
    },
    "dataSharedWith": [
      {
        "recipient": "PRODUCT_PROVIDER",
        "recipientName": "Various Insurance and Investment Providers",
        "purpose": "Product application and policy administration",
        "dataCategories": [
          "Personal Identity Data",
          "Financial Data",
          "Health Data (for protection products)"
        ],
        "legalBasis": "Contract fulfillment",
        "isOutsideEEA": false
      },
      {
        "recipient": "REGULATOR",
        "recipientName": "Financial Conduct Authority (FCA)",
        "purpose": "Regulatory compliance and oversight",
        "dataCategories": [
          "Personal Identity Data",
          "Financial Data",
          "Advice Records"
        ],
        "legalBasis": "Legal obligation",
        "isOutsideEEA": false
      },
      {
        "recipient": "IT_PROVIDER",
        "recipientName": "Microsoft Azure, AWS",
        "purpose": "Cloud hosting and data processing",
        "dataCategories": [
          "All client data"
        ],
        "legalBasis": "Data Processing Agreement",
        "isOutsideEEA": false,
        "adequacyDecision": "EU-US Data Privacy Framework"
      }
    ]
  },
  "marketingConsent": {
    "hasMarketingConsent": true,
    "marketingConsentDate": "2026-02-10T14:00:00Z",
    "marketingChannels": [
      {
        "channel": "EMAIL",
        "isConsented": true,
        "consentDate": "2026-02-10T14:00:00Z"
      },
      {
        "channel": "PHONE",
        "isConsented": false,
        "consentDate": null
      },
      {
        "channel": "SMS",
        "isConsented": false,
        "consentDate": null
      },
      {
        "channel": "POST",
        "isConsented": true,
        "consentDate": "2026-02-10T14:00:00Z"
      }
    ],
    "marketingFrequency": "MONTHLY",
    "marketingInterests": [
      "Investment Opportunities",
      "Retirement Planning",
      "Tax Planning",
      "Estate Planning"
    ],
    "thirdPartyMarketing": {
      "isConsented": false,
      "consentDate": null
    }
  },
  "profilingConsent": {
    "hasProfilingConsent": true,
    "profilingConsentDate": "2026-02-10T14:00:00Z",
    "profilingPurpose": "Risk profiling and investment suitability assessment",
    "automatedDecisionMaking": {
      "isUsed": true,
      "description": "Automated risk assessment questionnaire scoring",
      "humanReview": true
    }
  },
  "thirdPartySharing": {
    "hasThirdPartyConsent": true,
    "thirdPartyConsentDate": "2026-02-10T14:00:00Z",
    "thirdParties": [
      "Product Providers (for applications)",
      "Credit Reference Agencies (for creditworthiness)",
      "Identity Verification Providers"
    ]
  },
  "privacyPolicy": {
    "privacyPolicyVersion": "2.1",
    "privacyPolicyUrl": "https://www.example-advisor.com/privacy-policy",
    "privacyPolicyAcceptedDate": "2026-02-10T14:00:00Z",
    "privacyPolicyEffectiveDate": "2026-01-01",
    "privacyPolicyLastUpdated": "2026-01-01",
    "privacyNoticeProvided": true,
    "privacyNoticeMethod": "ONLINE"
  },
  "dataSubjectRights": {
    "rightsInformed": true,
    "rightsInformedDate": "2026-02-10T14:00:00Z",
    "rightToAccess": {
      "rightExplained": true,
      "requestsReceived": 0,
      "lastRequestDate": null
    },
    "rightToRectification": {
      "rightExplained": true,
      "requestsReceived": 0,
      "lastRequestDate": null
    },
    "rightToErasure": {
      "rightExplained": true,
      "requestsReceived": 0,
      "lastRequestDate": null,
      "limitations": "Data may be retained for regulatory compliance (FCA rules)"
    },
    "rightToRestriction": {
      "rightExplained": true,
      "requestsReceived": 0,
      "lastRequestDate": null
    },
    "rightToDataPortability": {
      "rightExplained": true,
      "requestsReceived": 0,
      "lastRequestDate": null
    },
    "rightToObject": {
      "rightExplained": true,
      "requestsReceived": 0,
      "lastRequestDate": null
    },
    "rightToWithdrawConsent": {
      "rightExplained": true,
      "canWithdraw": true,
      "withdrawalMethod": "Email, phone, or written request",
      "withdrawalImpact": "May affect ability to provide advice services"
    }
  },
  "dsarHistory": [
    {
      "requestId": "dsar-001",
      "requestType": "ACCESS",
      "requestDate": "2025-06-15T10:00:00Z",
      "requestMethod": "EMAIL",
      "responseDate": "2025-07-10T16:00:00Z",
      "responseMethod": "SECURE_PORTAL",
      "status": "COMPLETED",
      "notes": "Full data export provided within 30 days"
    }
  ],
  "consentRenewal": {
    "renewalRequired": true,
    "renewalDate": "2028-02-10",
    "renewalFrequency": "BIENNIAL",
    "renewalReminderSent": false,
    "renewalReminderDate": null,
    "renewalHistory": [
      {
        "renewalId": "ren-001",
        "previousConsentDate": "2024-02-10",
        "renewalDate": "2026-02-10",
        "renewalMethod": "ONLINE",
        "changesFromPrevious": "Updated privacy policy version, added cloud provider information"
      }
    ]
  },
  "audit": {
    "consentRecordedBy": {
      "id": 789,
      "name": "Jane Doe",
      "role": "Financial Adviser"
    },
    "consentRecordedAt": "2026-02-10T14:00:00Z",
    "ipAddress": "192.168.1.100",
    "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
    "deviceType": "Desktop",
    "location": {
      "country": "United Kingdom",
      "city": "London"
    },
    "consentEvidence": {
      "evidenceType": "CHECKBOX",
      "evidenceUrl": "/api/v2/consent-evidence/consent-555",
      "evidenceTimestamp": "2026-02-10T14:00:00Z",
      "witnessRequired": false
    },
    "verificationMethod": "EMAIL_VERIFIED"
  },
  "complianceChecks": {
    "gdprCompliant": true,
    "gdprComplianceDate": "2026-02-10",
    "pecompliant": true,
    "peComplianceDate": "2026-02-10",
    "fcaCompliant": true,
    "fcaComplianceDate": "2026-02-10",
    "lastComplianceReview": "2026-02-10",
    "nextComplianceReview": "2027-02-10"
  },
  "relatedConsents": [
    {
      "consentId": "consent-556",
      "consentPurpose": "MARKETING",
      "href": "/api/v2/consents/consent-556"
    },
    {
      "consentId": "consent-557",
      "consentPurpose": "THIRD_PARTY_SHARING",
      "href": "/api/v2/consents/consent-557"
    }
  ],
  "notes": "Initial consent obtained during client onboarding. Client fully informed of data processing activities and rights. Marketing consent given for email and post only.",
  "documents": [
    {
      "documentId": 1,
      "type": "CONSENT_FORM",
      "name": "Data Processing Consent Form - Signed",
      "date": "2026-02-10",
      "url": "/api/v2/documents/doc-consent-001"
    },
    {
      "documentId": 2,
      "type": "PRIVACY_NOTICE",
      "name": "Privacy Notice",
      "date": "2026-01-01",
      "url": "/api/v2/documents/doc-consent-002"
    }
  ],
  "createdAt": "2026-02-10T14:00:00Z",
  "updatedAt": "2026-02-10T14:30:00Z",
  "createdBy": {
    "id": 789,
    "name": "Jane Doe"
  },
  "updatedBy": {
    "id": 789,
    "name": "Jane Doe"
  },
    "update": { "href": "/api/v2/consents/consent-555", "method": "PUT" },
    "withdraw": { "href": "/api/v2/consents/consent-555/withdraw", "method": "POST" },
    "renew": { "href": "/api/v2/consents/consent-555/renew", "method": "POST" },
    "delete": { "href": "/api/v2/consents/consent-555", "method": "DELETE" },
    "client": { "href": "/api/v2/factfinds/{factfindId}/clients/123" },
    "factfind": { "href": "/api/v2/factfinds/123" },
    "consentForm": { "href": "/api/v2/documents/doc-consent-001" },
    "privacyNotice": { "href": "/api/v2/documents/doc-consent-002" },
    "evidence": { "href": "/api/v2/consent-evidence/consent-555" },
    "dsarRequests": { "href": "/api/v2/consents/consent-555/dsar-requests" },
    "history": { "href": "/api/v2/consents/consent-555/history" }
  }
}
```

**Field Behaviors:**

| Field | Type | Create | Update | Response | Notes |
|-------|------|--------|--------|----------|-------|
| `id` | uuid | ignored | ignored | included | read-only, server-generated |
| `client` | ClientRef | required | ignored | included | Reference to client, write-once |
| `factfind` | FactFindRef | optional | ignored | included | Reference to owning FactFind, write-once |
| `consentPurpose` | string | required | ignored | included | write-once, DataProcessing/Marketing/Profiling/ThirdPartySharing |
| `consentPurposeDescription` | string | optional | updatable | included | Detailed description of purpose |
| `consentStatus` | string | required | updatable | included | Given/Withdrawn/Expired |
| `consentGivenDate` | timestamp | required | updatable | included | Date/time consent was given |
| `consentWithdrawnDate` | timestamp | optional | updatable | included | Date/time consent was withdrawn |
| `consentExpiryDate` | date | optional | updatable | included | Consent expiry date |
| `isExpired` | boolean | ignored | ignored | included | read-only, computed from expiryDate |
| `daysUntilExpiry` | integer | ignored | ignored | included | read-only, computed |
| `isActive` | boolean | ignored | ignored | included | read-only, status is Given and not expired |
| `consentMethod` | string | required | updatable | included | Explicit/Implicit/LegitimateInterest |
| `consentChannel` | string | required | updatable | included | Web/Mobile/InPerson/Email/Phone |
| `consentVersion` | string | optional | updatable | included | Version of consent form |
| `consentText` | string | optional | updatable | included | Actual consent text shown to client |
| `lawfulBasis` | string | required | updatable | included | GDPR lawful basis (Consent/Contract/LegalObligation/etc) |
| `lawfulBasisDetails` | string | optional | updatable | included | Details of lawful basis |
| `specialCategoryData` | object | optional | updatable | included | Special category data processing details |
| `dataProcessing` | object | required | updatable | included | Data categories, processing activities, retention |
| `marketingConsent` | object | optional | updatable | included | Marketing consent with channels and preferences |
| `profilingConsent` | object | optional | updatable | included | Profiling and automated decision making consent |
| `thirdPartySharing` | object | optional | updatable | included | Third party data sharing consent |
| `privacyPolicy` | object | required | updatable | included | Privacy policy details and acceptance |
| `dataSubjectRights` | object | required | updatable | included | Data subject rights information and exercise history |
| `dsarHistory` | array | optional | updatable | included | Data Subject Access Request history |
| `consentRenewal` | object | optional | updatable | included | Consent renewal requirements and history |
| `audit` | object | required | updatable | included | Audit trail of consent recording |
| `complianceChecks` | object | optional | updatable | included | GDPR, PECR, FCA compliance checks |
| `relatedConsents` | array | optional | updatable | included | References to related consent records |
| `notes` | string | optional | updatable | included | Additional notes |
| `documents` | array | optional | updatable | included | Array of document references |
| `createdAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `updatedAt` | timestamp | ignored | ignored | included | read-only, server-generated |
| `createdBy` | object | ignored | ignored | included | read-only, audit trail |
| `updatedBy` | object | ignored | ignored | included | read-only, audit trail |

**Usage Examples:**

**Recording Consent (POST /api/v2/consents):**
```json
{
  "client": { "id": 123 },
  "factfind": { "id": 123 },
  "consentPurpose": "DATA_PROCESSING",
  "consentPurposeDescription": "Processing of personal and financial data for financial advice",
  "consentStatus": "GIVEN",
  "consentGivenDate": "2026-02-10T14:00:00Z",
  "consentMethod": "EXPLICIT",
  "consentChannel": "WEB",
  "lawfulBasis": "CONSENT",
  "dataProcessing": {
    "dataCategories": [
      {
        "category": "PERSONAL_IDENTITY",
        "dataTypes": ["Name", "Date of Birth", "Address"]
      }
    ],
    "dataRetentionPeriod": {
      "value": 7,
      "unit": "years"
    }
  },
  "privacyPolicy": {
    "privacyPolicyVersion": "2.1",
    "privacyPolicyUrl": "https://www.example-advisor.com/privacy-policy",
    "privacyPolicyAcceptedDate": "2026-02-10T14:00:00Z"
  },
  "dataSubjectRights": {
    "rightsInformed": true,
    "rightsInformedDate": "2026-02-10T14:00:00Z"
  },
  "audit": {
    "consentRecordedBy": { "id": 789 },
    "consentRecordedAt": "2026-02-10T14:00:00Z",
    "ipAddress": "192.168.1.100"
  }
}
```
Server generates `id`, `createdAt`, `updatedAt`. Returns complete contract.

**Updating Marketing Preferences (PUT /api/v2/consents/consent-555):**
```json
{
  "marketingConsent": {
    "hasMarketingConsent": true,
    "marketingChannels": [
      {
        "channel": "EMAIL",
        "isConsented": true,
        "consentDate": "2026-02-10T14:00:00Z"
      },
      {
        "channel": "PHONE",
        "isConsented": true,
        "consentDate": "2026-02-18T10:00:00Z"
      }
    ],
    "marketingFrequency": "MONTHLY"
  }
}
```
Server updates `updatedAt`. Returns complete contract with updated preferences.

**Withdrawing Consent (PATCH /api/v2/consents/consent-555/withdraw):**
```json
{
  "consentStatus": "WITHDRAWN",
  "consentWithdrawnDate": "2026-06-15T10:00:00Z",
  "notes": "Client requested withdrawal of marketing consent via email"
}
```
Server updates status and withdrawal date. Returns complete contract.

**Validation Rules:**

1. **Required Fields on Create:** `client`, `consentPurpose`, `consentStatus`, `consentGivenDate`, `consentMethod`, `consentChannel`, `lawfulBasis`, `dataProcessing`, `privacyPolicy`, `dataSubjectRights`, `audit`
2. **Write-Once Fields:** Cannot be changed after creation: `client`, `factfind`, `consentPurpose`
3. **Status Validation:** If `consentStatus` is "GIVEN", `consentGivenDate` must be provided. If "WITHDRAWN", `consentWithdrawnDate` must be provided
4. **Date Logic:** `consentGivenDate` must not be in future, `consentWithdrawnDate` must be > `consentGivenDate`
5. **Lawful Basis:** For `lawfulBasis` = "CONSENT", consent must be freely given, specific, informed, and unambiguous
6. **Data Categories:** At least one data category must be specified in `dataProcessing.dataCategories`
7. **Retention Period:** `dataProcessing.dataRetentionPeriod` must be specified and justified
8. **Privacy Policy:** `privacyPolicy.privacyPolicyAcceptedDate` must be provided and not in future
9. **Marketing Consent:** If marketing consent is given, at least one marketing channel must have `isConsented` = true
10. **Reference Integrity:** `client.id`, `factfind.id` must reference existing entities

---

### 14.13 Collection Response Wrapper

All list/collection endpoints use a standard wrapper contract:

```json
{
  "data": [
    { /* Complete entity contract */ },
    { /* Complete entity contract */ }
  ],
  "pagination": {
    "page": 1,
    "pageSize": 20,
    "totalPages": 5,
    "totalCount": 95,
    "hasMore": true
  }/clients?page=1&pageSize=20" },
    "prev": null,
    "self": { "href": "/api/v2/factfinds/{factfindId}/clients?page=1&pageSize=20" },
    "next": { "href": "/api/v2/factfinds/{factfindId}/clients?page=2&pageSize=20" },
    "last": { "href": "/api/v2/factfinds/{factfindId}/clients?page=5&pageSize=20" }
  }
}
```

The `data` array contains complete entity contracts. Clients can use field selection (`?fields=id,name`) to reduce response size.

---

### 14.14 Contract Extension for Other Entities

All other entities in the FactFind system follow the same Single Contract Principle:

**Circumstances Entities:**
- `Employment` - Employment history within FactFind
- `Expenditure` - Expenditure items within FactFind
- `Asset` - Assets (property, savings, investments)
- `Liability` - Liabilities (mortgages, loans, credit cards)

**Estate Planning Entities:**
- `Gift` - Gifts made or intended
- `GiftTrust` - Trust arrangements for gifts
- `Beneficiary` - Beneficiaries of estates/trusts

**Relationship Entities:**
- `Relationship` - Client relationships (spouse, partner, ex-partner)
- `Dependant` - Dependent family members
- `ProfessionalContact` - Solicitors, accountants, other advisers

**Reference Data Entities:**
- `Provider` - Financial product providers
- `ProductCategory` - Product categorization
- `EnumValue` - Dynamic enumeration values

Each entity contract follows the same field annotation pattern:
- Fields marked as `required-on-create`, `optional`, `read-only`, `write-once`, or `updatable`
- Same contract used for POST, PUT, PATCH, and GET
- Collection responses wrapped in standard pagination envelope
- Field selection supported via `?fields` query parameter

### 14.15 Standard Value Types

Value types are embedded data structures with no independent identity. They are named with a "Value" suffix and never have an `id` field. Value types are always embedded within their parent entity and have no separate API endpoints.

#### 14.15.1 MoneyValue

Represents a monetary amount with currency.

**Contract:**
```json
{
  "amount": 75000.00,
  "currency": {
    "code": "GBP",
    "display": "British Pound",
    "symbol": "£"
  }
}
```

**Fields:**

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `amount` | decimal | Yes | - | Monetary amount (positive or negative) |
| `currency` | CurrencyValue | Yes | - | Currency details (code, display, symbol) |

**Validation Rules:**
- `amount`: Precision 19, scale 4 (e.g., 9999999999999999.9999)
- `currency.code`: Must be valid ISO 4217 code (GBP, USD, EUR, etc.)

**Usage Example:**
```json
{
  "financialProfile": {
    "grossAnnualIncome": {
      "amount": 75000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "netMonthlyIncome": {
    "amount": 4500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  }
}
```

#### 14.15.2 AddressValue

Represents a physical address.

**Contract:**
```json
{
  "line1": "123 Main Street",
  "line2": "Flat 4B",
  "line3": null,
  "line4": null,
  "city": "London",
  "county": "GLA",
  "postcode": "SW1A 1AA",
  "country": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  },
  "addressType": "RES"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `line1` | string | Yes | Address line 1 (max 100 chars) |
| `line2` | string | No | Address line 2 (max 100 chars) |
| `line3` | string | No | Address line 3 (max 100 chars) |
| `line4` | string | No | Address line 4 (max 100 chars) |
| `city` | string | Yes | City/town (max 50 chars) |
| `county` | CountyValue | No | County/state with code and display name |
| `postcode` | string | Yes | Postal/ZIP code (max 20 chars) |
| `country` | CountryValue | Yes | Country with ISO codes and display name |
| `addressType` | AddressTypeValue | No | Type of address (Residential, Correspondence, etc.) |

**Validation Rules:**
- `country.code`: Must be valid ISO 3166-1 alpha-2 code (GB, US, FR, etc.)
- `postcode`: Format validation based on country

**Usage Example:**
```json
{
  "primaryAddress": {
    "line1": "10 Downing Street",
    "city": "London",
    "county": "GLA",
    "postcode": "SW1A 2AA",
    "country": {
      "code": "GB",
      "display": "United Kingdom",
      "alpha3": "GBR"
    },
    "addressType": "RES"
  }
}
```

#### 14.15.3 DateRangeValue

Represents a date range with start and optional end date.

**Contract:**
```json
{
  "startDate": "2020-01-01",
  "endDate": "2025-12-31"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `startDate` | date | Yes | Start date (ISO 8601: YYYY-MM-DD) |
| `endDate` | date | No | End date (ISO 8601: YYYY-MM-DD), null = ongoing |

**Validation Rules:**
- `endDate` must be after `startDate` if provided
- Both dates must be valid calendar dates

**Usage Example:**
```json
{
  "employmentPeriod": {
    "startDate": "2015-06-01",
    "endDate": null
  }
}
```

#### 14.15.4 NameValue

Represents a person's name.

**Contract:**
```json
{
  "title": "MR",
  "firstName": "John",
  "middleName": "Michael",
  "lastName": "Smith",
  "preferredName": "Johnny"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `title` | TitleValue | No | Title/honorific with code and display |
| `firstName` | string | Yes | First name (max 50 chars) |
| `middleName` | string | No | Middle name(s) (max 50 chars) |
| `lastName` | string | Yes | Last name/surname (max 50 chars) |
| `preferredName` | string | No | Preferred name/nickname (max 50 chars) |

**Usage Example:**
```json
{
  "name": {
    "title": "DR",
    "firstName": "Jane",
    "lastName": "Doe",
    "preferredName": "Janey"
  }
}
```

#### 14.15.5 ContactValue

Represents contact information (email, phone).

**Contract:**
```json
{
  "type": "EMAIL",
  "value": "john.smith@example.com",
  "isPrimary": true
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `type` | ContactTypeValue | Yes | Contact type with code and display (EMAIL, MOBILE, HOME, WORK, FAX) |
| `value` | string | Yes | Contact value (email address or phone number) |
| `isPrimary` | boolean | No | Whether this is the primary contact method |

**Validation Rules:**
- `value`: Format validation based on `type.code` (email format, phone number format)

**Usage Example:**
```json
{
  "contacts": [
    {
      "type": "EMAIL",
      "value": "john@example.com",
      "isPrimary": true
    },
    {
      "type": "MOBILE",
      "value": "+44 7700 900123",
      "isPrimary": false
    }
  ]
}
```

#### 14.15.6 PercentageValue

Represents a percentage as a decimal value.

**Contract:**
```json
{
  "value": 0.25
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `value` | decimal | Yes | Percentage value (0.00 = 0%, 1.00 = 100%) |

**Validation Rules:**
- `value`: Must be between 0.00 and 1.00 (or other specified range)

**Usage Example:**
```json
{
  "contributionRate": {
    "value": 0.08
  },
  "taxRate": {
    "value": 0.20
  }
}
```

#### 14.15.7 RateValue

Represents an interest rate or other rate.

**Contract:**
```json
{
  "rate": 3.5,
  "type": "Fixed"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `rate` | decimal | Yes | Rate value (e.g., 3.5 for 3.5%) |
| `type` | enum | No | Rate type: Fixed, Variable, Tracker, Discount, Capped |

**Usage Example:**
```json
{
  "interestRate": {
    "rate": 2.75,
    "type": "Fixed"
  },
  "projectedGrowthRate": {
    "rate": 5.0,
    "type": "Variable"
  }
}
```

#### 14.15.8 TaxDetailsValue

Represents tax identification details.

**Contract:**
```json
{
  "niNumber": "AB123456C",
  "taxReference": "1234567890"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `niNumber` | string | No | UK National Insurance Number (9 chars) |
| `taxReference` | string | No | Tax reference number (10 chars) |

**Validation Rules:**
- `niNumber`: Format AA123456A (2 letters, 6 digits, 1 letter)
- `taxReference`: 10-digit UTR format

**Usage Example:**
```json
{
  "taxDetails": {
    "niNumber": "AB123456C",
    "taxReference": "1234567890"
  }
}
```

#### 14.15.9 AdverseCreditEvent

Represents a single adverse credit event in a client's credit history. This is a value type embedded within the CreditHistory entity's `adverseCreditEvents` array.

**Value Type:** No `id` field - embedded within CreditHistory entity

**Purpose:**
- Record individual adverse credit events (CCJ, Default, IVA, Bankruptcy, Arrears, Repossession)
- Track complete timeline from registration to satisfaction/discharge
- Monitor outstanding debt amounts
- Link credit events to specific liability records
- Support mortgage lending impact assessment

**Contract:**
```json
{
  "type": "Default",
  "registeredOn": "2020-06-15T00:00:00Z",
  "satisfiedOrClearedOn": "2023-12-20T00:00:00Z",
  "reposessedOn": null,
  "dischargedOn": null,
  "amountRegistered": {
    "amount": 5000.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "amountOutstanding": {
    "amount": 0.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "isDebtOutstanding": false,
  "numberOfPaymentsMissed": 2,
  "consecutivePaymentsMissed": 2,
  "numberOfPaymentsInArrears": 0,
  "isArrearsClearedUponCompletion": true,
  "yearsMaintained": 0,
  "lender": "High Street Bank",
  "liability": {
    "id": 1001,
    "href": "/api/v2/factfinds/679/liabilities/1001",
    "description": "Credit Card Debt"
  },
  "concurrencyId": 1,
  "createdAt": "2026-01-15T10:30:00Z",
  "lastUpdatedAt": "2026-01-15T10:30:00Z"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `type` | enum | Yes | Type of adverse event: "CCJ", "Default", "IVA", "Bankruptcy", "Arrears", "Repossession" |
| `registeredOn` | datetime | Yes | Date event was registered with Credit Reference Agencies (ISO 8601) |
| `satisfiedOrClearedOn` | datetime | No | Date the debt was satisfied or cleared (ISO 8601) |
| `reposessedOn` | datetime | No | Date of property repossession if applicable (ISO 8601) |
| `dischargedOn` | datetime | No | Date bankruptcy or IVA was discharged (ISO 8601) |
| `amountRegistered` | MoneyValue | Yes | Original amount registered when event occurred |
| `amountOutstanding` | MoneyValue | Yes | Current outstanding amount (can be 0.00 if satisfied) |
| `isDebtOutstanding` | boolean | Yes | Whether debt is still outstanding (true) or fully paid (false) |
| `numberOfPaymentsMissed` | integer | No | Total number of payments missed for this event |
| `consecutivePaymentsMissed` | integer | No | Number of consecutive payments missed (maximum consecutive period) |
| `numberOfPaymentsInArrears` | integer | No | Number of payments currently in arrears |
| `isArrearsClearedUponCompletion` | boolean | No | Whether arrears were cleared when arrangement completed |
| `yearsMaintained` | integer | No | Number of years successfully maintained (for IVA/payment plans, typically 0-6) |
| `lender` | string | No | Name of lender or creditor involved (max 200 characters) |
| `liability` | LiabilityRef | No | Reference to related liability record if applicable |
| `concurrencyId` | integer | read-only | Concurrency control identifier for optimistic locking |
| `createdAt` | datetime | read-only | ISO 8601 timestamp when this event was created |
| `lastUpdatedAt` | datetime | read-only | ISO 8601 timestamp when this event was last updated |

**Validation Rules:**
- `type` is required
- `registeredOn` is required and cannot be in the future
- If `satisfiedOrClearedOn` is provided, it must be after `registeredOn`
- If `dischargedOn` is provided, it must be after `registeredOn`
- If `reposessedOn` is provided, it must be after `registeredOn`
- `amountOutstanding` cannot exceed `amountRegistered`
- If `isDebtOutstanding` = false, `amountOutstanding.amount` should be 0.00
- `consecutivePaymentsMissed` must be <= `numberOfPaymentsMissed` if both provided
- `yearsMaintained` must be between 0 and 10 if provided
- All dates must be valid ISO 8601 datetime format with timezone
- Currency codes must be valid ISO 4217 codes

**Event Type Enumeration:**

| Code | Display | Description | Duration on File | Mortgage Impact |
|------|---------|-------------|-----------------|-----------------|
| CCJ | County Court Judgment | Court judgment for unpaid debt | 6 years | Significant - may require specialist lender |
| Default | Default | Payment default registered by creditor | 6 years | Moderate to significant |
| IVA | Individual Voluntary Arrangement | Formal debt repayment arrangement | 6 years | Severe during, moderate after 3+ years |
| Bankruptcy | Bankruptcy | Declared bankrupt | 6 years | Very severe - specialist lenders only |
| Arrears | Payment Arrears | Currently in arrears on payments | Ongoing until cleared | Severe if active |
| Repossession | Repossession | Property repossessed by lender | 6 years | Very severe |

**Business Context:**

**CCJ (County Court Judgment):**
- Court order requiring debt repayment
- Stays on credit file for 6 years from judgment date
- Can be marked as "satisfied" via `satisfiedOrClearedOn`
- CCJs over £500 within 3 years typically exclude standard mortgages
- Use `amountRegistered` for judgment amount, `amountOutstanding` for balance owed

**Default:**
- Creditor has written off debt (typically after 3-6 months of missed payments)
- Stays on credit file for 6 years from default date
- Even if satisfied, remains on file for full 6 years
- Track missed payments via `numberOfPaymentsMissed` and `consecutivePaymentsMissed`
- Impact reduces over time

**IVA (Individual Voluntary Arrangement):**
- Formal agreement to pay reduced debt over time (typically 5-6 year plan)
- Stays on credit file for 6 years from approval date
- Use `yearsMaintained` to track years in good standing (0-6 typical range)
- `dischargedOn` indicates successful completion
- Can apply for mortgages after 3 years with good payment record

**Bankruptcy:**
- Legal process to write off unaffordable debts
- Typically discharged after 12 months (record `dischargedOn` date)
- Stays on credit file for 6 years from bankruptcy date
- Severely restricts access to credit during and after
- Specialist lenders only, typically 3+ years after discharge

**Arrears:**
- Currently behind on payment schedule
- Track with `numberOfPaymentsInArrears`
- Active arrears seriously impact mortgage applications
- `isArrearsClearedUponCompletion` indicates if cleared with final payment
- Different from "missed payments" which are historical

**Repossession:**
- Property has been repossessed by lender
- Very serious adverse event
- `reposessedOn` date is when property was taken
- Stays on file for 6 years
- Makes obtaining new mortgage extremely difficult

**Usage Examples:**

**Example 1: Satisfied Default**
```json
{
  "type": "Default",
  "registeredOn": "2020-06-15T00:00:00Z",
  "satisfiedOrClearedOn": "2023-12-20T00:00:00Z",
  "amountRegistered": {
    "amount": 5000.00,
    "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
  },
  "amountOutstanding": {
    "amount": 0.00,
    "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
  },
  "isDebtOutstanding": false,
  "numberOfPaymentsMissed": 3,
  "consecutivePaymentsMissed": 2,
  "lender": "Credit Card Provider",
  "liability": { "id": 1001, "href": "/api/v2/factfinds/679/liabilities/1001" }
}
```

**Example 2: Active IVA**
```json
{
  "type": "IVA",
  "registeredOn": "2022-03-01T00:00:00Z",
  "amountRegistered": {
    "amount": 45000.00,
    "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
  },
  "amountOutstanding": {
    "amount": 15000.00,
    "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
  },
  "isDebtOutstanding": true,
  "yearsMaintained": 2,
  "lender": "Various Creditors"
}
```

**Example 3: Satisfied CCJ**
```json
{
  "type": "CCJ",
  "registeredOn": "2021-08-10T00:00:00Z",
  "satisfiedOrClearedOn": "2022-12-15T00:00:00Z",
  "amountRegistered": {
    "amount": 2500.00,
    "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
  },
  "amountOutstanding": {
    "amount": 0.00,
    "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
  },
  "isDebtOutstanding": false,
  "lender": "Council Tax Authority"
}
```

**Example 4: Discharged Bankruptcy**
```json
{
  "type": "Bankruptcy",
  "registeredOn": "2019-05-01T00:00:00Z",
  "dischargedOn": "2020-05-01T00:00:00Z",
  "amountRegistered": {
    "amount": 85000.00,
    "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
  },
  "amountOutstanding": {
    "amount": 0.00,
    "currency": { "code": "GBP", "display": "British Pound", "symbol": "£" }
  },
  "isDebtOutstanding": false
}
```

---

#### 14.15.10 Enumeration Value Types

Enumeration value types represent categorical data using a structured code/display pattern. Unlike simple string enumerations, enumeration value types are self-documenting, internationalization-ready, and can carry rich metadata.

**Standard Pattern:**
All enumeration value types follow a consistent structure:
```json
{
  "code": "MACHINE_READABLE_CODE",    // Required: Uppercase, short identifier
  "display": "Human Readable Label",  // Required: User-facing label
  // ... additional metadata as needed
}
```

**Benefits:**
- Self-documenting: No need to look up code meanings
- Internationalization-ready: Display text can be localized
- Rich metadata: Dates, categories, and other context
- Forward-compatible: Can add fields without breaking changes
- Type-safe: Strongly typed in contract definitions

---

##### GenderValue

Represents a person's gender as a simple string enum.

**Type:** `string`

**Standard Codes:**
- `M` - Male
- `F` - Female
- `O` - Other
- `U` - Unknown
- `N` - Prefer not to say

**Usage Example:**
```json
{
  "gender": "M"
}
```

---

##### MaritalStatusValue

Represents a person's marital status with optional effective date.

**Contract:**
```json
{
  "code": "MAR",
  "display": "Married",
  "effectiveFrom": "2015-06-20"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | Marital status code |
| `display` | string | Yes | Human-readable label |
| `effectiveFrom` | date | No | Date this status became effective (ISO 8601) |

**Standard Codes:**
- `SIN` - Single
- `MAR` - Married
- `CIV` - Civil Partnership
- `DIV` - Divorced
- `WID` - Widowed
- `SEP` - Separated
- `COH` - Cohabiting

**Usage Example:**
```json
{
  "maritalStatus": {
    "code": "MAR",
    "display": "Married",
    "effectiveFrom": "2015-06-20"
  }
}
```

---

##### EmploymentStatusValue

Represents a person's employment status as a simple string enum.

**Type:** `string`

**Standard Codes:**
- `EMP` - Employed
- `SELF` - Self-Employed
- `DIR` - Company Director
- `RET` - Retired
- `UNE` - Unemployed
- `NW` - Not Working
- `STU` - Student
- `HOME` - Homemaker

**Usage Example:**
```json
{
  "employmentStatus": "Employed"
}
```

---

##### AddressTypeValue

Represents the type of an address.

**Contract:**
```json
{
  "code": "RES",
  "display": "Residential"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | Address type code |
| `display` | string | Yes | Human-readable label |

**Standard Codes:**
- `RES` - Residential
- `CORR` - Correspondence
- `PREV` - Previous
- `WORK` - Work
- `OTHER` - Other

**Usage Example:**
```json
{
  "addressType": "RES"
}
```

---

##### ContactTypeValue

Represents the type of contact information.

**Contract:**
```json
{
  "code": "EMAIL",
  "display": "Email"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | Contact type code |
| `display` | string | Yes | Human-readable label |

**Standard Codes:**
- `EMAIL` - Email
- `MOBILE` - Mobile Phone
- `HOME` - Home Phone
- `WORK` - Work Phone
- `FAX` - Fax

**Usage Example:**
```json
{
  "type": "EMAIL"
}
```

---

##### TitleValue

Represents a person's title or honorific.

**Contract:**
```json
{
  "code": "MR",
  "display": "Mr"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | Title code |
| `display` | string | Yes | Human-readable label |

**Standard Codes:**
- `MR` - Mr
- `MRS` - Mrs
- `MS` - Ms
- `MISS` - Miss
- `DR` - Dr
- `PROF` - Professor
- `REV` - Reverend
- `SIR` - Sir
- `LADY` - Lady
- `LORD` - Lord

**Usage Example:**
```json
{
  "title": "MR"
}
```

---

##### ProductTypeValue

Represents a financial product type with optional category.

**Contract:**
```json
{
  "code": "SIPP",
  "display": "Self-Invested Personal Pension",
  "category": "Pension"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | Product type code |
| `display` | string | Yes | Human-readable label |
| `category` | string | No | Product category grouping |

**Standard Codes:**
- Pensions: `PP` (Personal Pension), `SIPP` (SIPP), `GPP` (Group Personal Pension), `SSAS` (SSAS), `DB` (Defined Benefit), `SP` (State Pension)
- Investments: `ISA` (ISA), `GIA` (General Investment Account), `JISA` (Junior ISA), `LISA` (Lifetime ISA), `OIC` (Offshore Investment)
- Protection: `LIFE` (Life Insurance), `CIC` (Critical Illness), `IP` (Income Protection), `PMI` (Private Medical Insurance)
- Mortgages: `RESMTG` (Residential Mortgage), `BTL` (Buy-to-Let), `EQUITY` (Equity Release)
- Other: `BOND` (Investment Bond), `TRUST` (Trust), `SAVINGS` (Savings Account)

**Usage Example:**
```json
{
  "productType": {
    "code": "SIPP",
    "display": "Self-Invested Personal Pension",
    "category": "Pension"
  }
}
```

---

##### CountryValue

Represents a country using ISO 3166-1 standard codes.

**Contract:**
```json
{
  "code": "GB",
  "display": "United Kingdom",
  "alpha3": "GBR"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | ISO 3166-1 alpha-2 country code (2 chars) |
| `display` | string | Yes | Full country name |
| `alpha3` | string | No | ISO 3166-1 alpha-3 country code (3 chars) |

**Usage Example:**
```json
{
  "country": {
    "code": "GB",
    "display": "United Kingdom",
    "alpha3": "GBR"
  }
}
```

---

##### CountyValue

Represents a county or administrative region.

**Contract:**
```json
{
  "code": "GLA",
  "display": "Greater London",
  "country": "GB"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | County/region code |
| `display` | string | Yes | Full county/region name |
| `country` | CountryValue | No | Associated country |

**Usage Example:**
```json
{
  "county": {
    "code": "GLA",
    "display": "Greater London",
    "country": "GB"
  }
}
```

---

##### CurrencyValue

Represents a currency using ISO 4217 standard codes.

**Contract:**
```json
{
  "code": "GBP",
  "display": "British Pound",
  "symbol": "£"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | ISO 4217 currency code (3 chars) |
| `display` | string | Yes | Full currency name |
| `symbol` | string | No | Currency symbol (£, $, €, etc.) |

**Standard Codes:**
- `GBP` - British Pound (£)
- `USD` - US Dollar ($)
- `EUR` - Euro (€)
- `CHF` - Swiss Franc (CHF)
- `JPY` - Japanese Yen (¥)
- `AUD` - Australian Dollar (A$)
- `CAD` - Canadian Dollar (C$)

**Usage Example:**
```json
{
  "currency": {
    "code": "GBP",
    "display": "British Pound",
    "symbol": "£"
  }
}
```

---

##### FrequencyValue

Represents payment or contribution frequency.

**Contract:**
```json
{
  "code": "M",
  "display": "Monthly",
  "periodsPerYear": 12
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | Frequency code |
| `display` | string | Yes | Human-readable label |
| `periodsPerYear` | integer | No | Number of periods per year (for calculations) |

**Standard Codes:**
- `M` - Monthly (12 periods/year)
- `Q` - Quarterly (4 periods/year)
- `S` - Semi-Annual (2 periods/year)
- `A` - Annual (1 period/year)
- `W` - Weekly (52 periods/year)
- `F` - Fortnightly (26 periods/year)
- `SINGLE` - Single Payment (0 periods/year)

**Usage Example:**
```json
{
  "frequency": {
    "code": "M",
    "display": "Monthly",
    "periodsPerYear": 12
  }
}
```

---

##### StatusValue

Represents a generic status with optional category.

**Contract:**
```json
{
  "code": "ACT",
  "display": "Active",
  "category": "Arrangement"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | Status code |
| `display` | string | Yes | Human-readable label |
| `category` | string | No | Status category grouping |

**Standard Codes:**
- `ACT` - Active
- `INA` - Inactive
- `PEN` - Pending
- `COM` - Completed
- `CAN` - Cancelled
- `SUB` - Submitted
- `APP` - Approved
- `REJ` - Rejected
- `DRAFT` - Draft
- `CLOSED` - Closed

**Usage Example:**
```json
{
  "status": {
    "code": "ACT",
    "display": "Active",
    "category": "Arrangement"
  }
}
```

---

##### MeetingTypeValue

Represents the type of a client meeting.

**Contract:**
```json
{
  "code": "INIT",
  "display": "Initial Meeting"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `code` | string | Yes | Meeting type code |
| `display` | string | Yes | Human-readable label |

**Standard Codes:**
- `INIT` - Initial Meeting
- `REVIEW` - Review Meeting
- `ANNUAL` - Annual Review
- `ADHOC` - Ad-hoc Meeting
- `PHONE` - Phone Call
- `VIDEO` - Video Conference

**Usage Example:**
```json
{
  "meetingType": "INIT"
}
```

---

##### ResidencyStatusValue

Represents tax residency status as a simple string enum.

**Type:** `string`

**Standard Codes:**
- `UK_RES` - UK Resident
- `UK_DOM` - UK Domiciled
- `NON_RES` - Non-Resident
- `NON_DOM` - Non-Domiciled
- `EXPAT` - Expatriate

**Usage Example:**
```json
{
  "residencyStatus": "UK_RES"
}
```

---

##### HealthStatusValue

Represents a person's health status for insurance purposes as a simple string enum.

**Type:** `string`

**Standard Codes:**
- `GOOD` - Good Health
- `FAIR` - Fair Health
- `POOR` - Poor Health
- `PREEX` - Pre-existing Conditions
- `UNKNOWN` - Unknown

**Usage Example:**
```json
{
  "healthStatus": "GOOD"
}
```

---

### 14.16 Standard Reference Types

Reference types represent entities with independent identity. They are referenced from other entities using an expanded reference object containing `id`, `href`, and display fields. Reference fields are named with a "Ref" suffix (e.g., `client`, `adviser`).

#### 14.16.1 ClientRef

Reference to a Client entity.

**Minimal Contract (Required for Create/Update):**
```json
{
  "id": 123
}
```

**Full Contract (Server Response):**
```json
{
  "id": 123,
  "href": "/api/v2/factfinds/{factfindId}/clients/123",
  "name": "John Michael Smith",
  "clientNumber": "C00001234",
  "type": "Person"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | uuid | Yes | Unique client identifier (numeric) |
| `href` | string | Yes (response) | URL to client resource |
| `name` | string | Yes (response) | Full client name |
| `clientNumber` | string | No | Business client number |
| `type` | enum | No | Client type: Person, Corporate, Trust |

**Usage Example:**
```json
{
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/{factfindId}/clients/123",
    "name": "John Smith",
    "clientNumber": "C00001234",
    "type": "Person"
  }
}
```

#### 14.16.2 AdviserRef

Reference to an Adviser entity.

**Full Contract:**
```json
{
  "id": 789,
  "href": "/api/v2/advisers/789",
  "name": "Sarah Johnson",
  "code": "ADV001"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | uuid | Yes | Unique adviser identifier (numeric) |
| `href` | string | Yes (response) | URL to adviser resource |
| `name` | string | Yes (response) | Adviser full name |
| `code` | string | No | Adviser business code |

**Usage Example:**
```json
{
  "adviser": {
    "id": 789,
    "href": "/api/v2/advisers/789",
    "name": "Sarah Johnson",
    "code": "ADV001"
  }
}
```

#### 14.16.3 ProviderRef

Reference to a financial product Provider entity.

**Full Contract:**
```json
{
  "id": 456,
  "href": "/api/v2/providers/456",
  "name": "Aviva Life & Pensions UK Limited",
  "frnNumber": "185896"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | uuid | Yes | Unique provider identifier (numeric) |
| `href` | string | Yes (response) | URL to provider resource |
| `name` | string | Yes (response) | Provider name |
| `frnNumber` | string | No | FCA Firm Reference Number |

**Usage Example:**
```json
{
  "provider": {
    "id": 456,
    "href": "/api/v2/providers/456",
    "name": "Aviva",
    "frnNumber": "185896"
  }
}
```

#### 14.16.4 ArrangementRef

Reference to an Arrangement entity (pension, investment, protection, mortgage).

**Full Contract:**
```json
{
  "id": 111,
  "href": "/api/v2/factfinds/{factfindId}/arrangements/111",
  "policyNumber": "POL123456",
  "productType": "Pension",
  "provider": "Aviva"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | uuid | Yes | Unique arrangement identifier (numeric) |
| `href` | string | Yes (response) | URL to arrangement resource |
| `policyNumber` | string | No | Policy/plan number |
| `productType` | string | Yes (response) | Product type (Pension, Investment, etc.) |
| `provider` | string | Yes (response) | Provider name |

**Usage Example:**
```json
{
  "arrangement": {
    "id": 111,
    "href": "/api/v2/factfinds/{factfindId}/arrangements/111",
    "policyNumber": "SIPP123456",
    "productType": "Pension",
    "provider": "Aviva"
  }
}
```

#### 14.16.5 EmploymentRef

Reference to an Employment entity.

**Full Contract:**
```json
{
  "id": 222,
  "href": "/api/v2/employments/222",
  "employerName": "Acme Corporation Ltd",
  "status": "Current"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | uuid | Yes | Unique employment identifier (numeric) |
| `href` | string | Yes (response) | URL to employment resource |
| `employerName` | string | Yes (response) | Employer name |
| `status` | enum | Yes (response) | Status: Current, Previous, Future |

**Usage Example:**
```json
{
  "employment": {
    "id": 222,
    "href": "/api/v2/employments/222",
    "employerName": "Acme Corp",
    "status": "Current"
  }
}
```

#### 14.16.6 GoalRef

Reference to a Goal entity.

**Full Contract:**
```json
{
  "id": 333,
  "href": "/api/v2/factfinds/{factfindId}/objectives/333",
  "goalName": "Retirement at 65",
  "priority": "High"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | uuid | Yes | Unique goal identifier (numeric) |
| `href` | string | Yes (response) | URL to goal resource |
| `goalName` | string | Yes (response) | Goal name/description |
| `priority` | enum | No | Priority: High, Medium, Low |

**Usage Example:**
```json
{
  "goal": {
    "id": 333,
    "href": "/api/v2/factfinds/{factfindId}/objectives/333",
    "goalName": "Retirement Planning",
    "priority": "High"
  }
}
```

#### 14.16.7 FactFindRef

Reference to a FactFind (ADVICE_CASE) entity.

**Full Contract:**
```json
{
  "id": 444,
  "href": "/api/v2/factfinds/444",
  "factFindNumber": "FF001234",
  "status": "InProgress"
}
```

**Fields:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | uuid | Yes | Unique fact find identifier (numeric) |
| `href` | string | Yes (response) | URL to fact find resource |
| `factFindNumber` | string | No | Business fact find number |
| `status` | enum | Yes (response) | Status: Draft, InProgress, Complete, Submitted |-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned asset identifier |
| `href` | string | read-only | Canonical URI for this asset |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `assetType.code` | enum | required-on-create | Asset type code (PROPERTY, OWN_BUSINESS, CASH, etc.) |
| `assetType.display` | string | read-only | Human-readable asset type label |
| `description` | string | required-on-create | Asset description (max 500 chars) |
| `ownership.ownershipType.code` | enum | required-on-create | SOLE_CLIENT1, SOLE_CLIENT2, JOINT |
| `ownership.ownershipType.display` | string | read-only | Human-readable ownership type |
| `ownership.owners[]` | array | required-on-create | Array of owners with shares |
| `ownership.owners[].client` | ClientRef | required-on-create | Reference to owning client |
| `ownership.owners[].ownershipShare` | decimal | required-on-create | Percentage ownership (0-100) |
| `dividends` | DividendsValue | optional | `dividends.owners[]` | array | optional | Array of dividend recipients |
| `dividends.owners[].client` | ClientRef | required | Dividend recipient client |
| `dividends.owners[].dividend` | MoneyValue | required | Dividend amount |
| `dividends.owners[].withdrawalType` | enum | required | Regular or Lumpsum |
| `dividends.owners[].frequency` | enum | required | Payment frequency (Monthly, Quarterly, etc.) |
| `currentValue` | MoneyValue | required-on-create | Current asset valuation |
| `valuedOn` | date | optional | Date of valuation |
| `valuationBasis` | string | optional | Valuation method used |
| `originalValue` | MoneyValue | optional | Original purchase value |
| `purchasedOn` | date | optional | Date asset was acquired |
| `rentalExpenses` | MoneyValue | optional | Monthly rental expenses |
| `isVisibleToClient` | boolean | optional | Visibility in client portal (default: true) |
| `isBusinessAssetDisposalRelief` | boolean | optional | BADR eligibility (default: false) |
| `isFreeFromInheritanceTax` | boolean | optional | IHT exemption (default: false) |
| `rnrbEligibility` | string | optional | Residence Nil Rate Band eligibility |
| `isBusinessReliefQualifying` | boolean | optional | Business Relief for IHT (default: false) |
| `isHolding` | boolean | optional | Asset is a holding (default: false) |
| `property` | PropertyRef | optional | Link to property details |
| `arrangement` | ArrangementRef | optional | Link to related arrangement (mortgage) |
| `income` | IncomeRef | optional | Link to income generated by asset |
| `notes` | string | optional | Additional notes (max 2000 chars) |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Asset Type Codes

| Code | Display Name |
|------|-------------|
| `BOAT` | Boat |
| `BUY_TO_LET_PROPERTY` | Buy to Let Property |
| `CASH` | Cash |
| `COLLECTIBLES_ART_OTHER_VALUABLES` | Collectibles/ Art/ Other Valuables |
| `COMMERCIAL_PROPERTY` | Commercial Property |
| `HOLIDAY_HOME` | Holiday Home |
| `HOME_CONTENTS` | Home Contents |
| `INVESTMENT_PROPERTY` | Investment Property |
| `INVESTMENTS` | Investments |
| `MAIN_RESIDENCE` | Main Residence |
| `MOTOR_VEHICLES` | Motor Vehicles |
| `NON_INCOME_PRODUCING_REAL_ESTATE` | Non-Income Producing Real Estate |
| `OTHER` | Other |
| `OVERSEAS_PROPERTY` | Overseas Property |
| `OWN_BUSINESS` | Own Business |
| `PROPERTY` | Property |
| `RENTAL_PROPERTY_OTHER_PROPERTY` | Rental Property / Other Property |-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned liability identifier |
| `href` | string | read-only | Canonical URI for this liability |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `owner.client` | ClientRef | required-on-create | Owner of the liability |
| `liabilityAccountNumber` | string | optional | Account/reference number (max 100 chars) |
| `liabilityCategory.code` | enum | required-on-create | Liability category code |
| `liabilityCategory.display` | string | read-only | Human-readable liability category |
| `description` | string | optional | Liability description (max 500 chars) |
| `originalLoanAmount` | MoneyValue | optional | Original loan/mortgage amount |
| `repaymentOrInterestOnly.code` | enum | optional | Repayment method (REPAYMENT or INTEREST_ONLY) |
| `repaymentOrInterestOnly.display` | string | read-only | Human-readable repayment method |
| `rateType.code` | enum | optional | Interest rate type code |
| `rateType.display` | string | read-only | Human-readable rate type |
| `amountOutstanding` | MoneyValue | optional | Current outstanding balance |
| `creditLimit` | MoneyValue | optional | Credit limit (for credit cards) |
| `interestRate` | decimal | optional | Annual interest rate percentage |
| `paymentAmount` | MoneyValue | optional | Monthly payment amount |
| `lender` | string | optional | Lender/creditor name (max 200 chars) |
| `loanTermYears` | decimal | optional | Loan term in years |
| `endDate` | date | optional | Loan end/maturity date |
| `protected.code` | enum | optional | Protection type code |
| `protected.display` | string | read-only | Human-readable protection type |
| `earlyRedemptionCharge` | MoneyValue | optional | Early redemption penalty amount |
| `consolidate` | boolean | optional | Mark for consolidation (default: false) |
| `isToBeRepaid` | boolean | optional | Planned for repayment (default: false) |
| `howWillLiabilityBeRepaid` | string | optional | Repayment plan details (max 2000 chars) |
| `isGuarantorMortgage` | boolean | optional | Has guarantor (default: false) |
| `linkedAssetRef` | AssetRef | optional | Link to secured asset (for mortgages) |
| `protectionArrangementRef` | ArrangementRef | optional | Link to protection policy arrangement |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Liability Category Codes

| Code | Display Name |
|------|-------------|
| `MAIN_RESIDENCE` | Main Residence |
| `CREDIT_STORE_CARDS` | Credit/Store Cards |
| `PERSONAL_LOANS` | Personal Loans |
| `MORTGAGE_REPAYMENT_VEHICLE` | Mortgage Repayment Vehicle |
| `STUDENT_LOANS` | Student Loans |
| `CAR_LOAN` | Car Loan |
| `HIRE_PURCHASE` | Hire Purchase |
| `MAINTENANCE_ALIMONY` | Maintenance/Alimony |
| `OTHER_SECURED_LOANS` | Other Secured Loans |
| `OTHER_MORTGAGES` | Other Mortgages |
| `OTHER` | Other |

#### Repayment or Interest Only Codes

| Code | Display Name |
|------|-------------|
| `REPAYMENT` | Repayment |
| `INTEREST_ONLY` | Interest Only |

#### Rate Type Codes

| Code | Display Name |
|------|-------------|
| `CAPPED` | Capped |
| `DISCOUNT` | Discount |
| `FIXED` | Fixed |
| `FLEXIBLE` | Flexible |
| `LIBOR` | LIBOR |
| `OFFSET_RATE` | Offset Rate |
| `STANDARD` | Standard |
| `TRACKER` | Tracker |
| `VARIABLE` | Variable |

#### Protection Type Codes

| Code | Display Name |
|------|-------------|
| `NO` | No |
| `LIFE_ONLY` | Life Only |
| `CIC_ONLY` | CIC Only |
| `ASU_ONLY` | ASU Only |
| `LIFE_AND_CIC` | Life and CIC |
| `LIFE_AND_ASU` | Life and ASU |
| `CIC_AND_ASU` | CIC and ASU |
| `LIFE_CIC_AND_ASU` | Life, CIC and ASU |

#### Validation Rules

1. **Owner Validation:**
   - `owner.client` is required - at least one owner must be specified
   - Owner must be a valid client within the fact find

2. **Category-Specific Fields:**
   - **Main Residence, Other Mortgages, Personal Loans, Car Loan, Hire Purchase, Other Secured Loans, Other:**
     - All fields available including `originalLoanAmount`, `amountOutstanding`, `creditLimit`, `interestRate`, `lender`, `loanTermYears`, `earlyRedemptionCharge`
   - **Maintenance/Alimony:**
     - Simplified field set - only `rateType`, `paymentAmount`, `endDate` available
     - No loan/credit fields
   - **Mortgage Repayment Vehicle:**
     - Simplified field set - only `rateType`, `interestRate`, `paymentAmount`, `endDate` available
     - No loan amount or lender fields
   - **Credit/Store Cards:**
     - Must have `creditLimit` specified
     - `amountOutstanding` should not exceed `creditLimit`

3. **Mortgage-Specific (Main Residence, Other Mortgages):**
   - Should have `linkedAssetRef` reference to property asset
   - Should have `protected` field set if protection is in place
   - If protected, optionally link to `protectionArrangementRef`

4. **Repayment Planning:**
   - If `isToBeRepaid` is true, `howWillLiabilityBeRepaid` should be provided
   - `consolidate` flag indicates liability is part of consolidation plan

5. **Guarantor Mortgage:**
   - `isGuarantorMortgage` field available for "Other" category only
   - Indicates if mortgage has a guarantor arrangement

#### Additional Liability Examples

**Example 2: Credit/Store Card Liability**

```json
{
  "id": 790,
  "href": "/api/v2/factfinds/679/clients/346/liabilities/790",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "owner": {
    "client": {
      "id": 123,
      "href": "/api/v2/factfinds/679/clients/123",
      "name": "Bob Byblik"
    }
  },
  "liabilityAccountNumber": "****4567",
  "liabilityCategory": "CREDIT_STORE_CARDS",
  "description": "Visa Credit Card",
  "originalLoanAmount": null,
  "repaymentOrInterestOnly": null,
  "rateType": "VARIABLE",
  "amountOutstanding": {
    "amount": 3500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "creditLimit": {
    "amount": 10000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "interestRate": 19.9,
  "paymentAmount": {
    "amount": 250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "lender": "HSBC",
  "loanTermYears": null,
  "endDate": null,
  "protected": "NO",
  "earlyRedemptionCharge": null,
  "consolidate": true,
  "isToBeRepaid": true,
  "howWillLiabilityBeRepaid": "To be consolidated with other debts and paid off via balance transfer to 0% card",
  "isGuarantorMortgage": false,
  "linkedAssetRef": null,
  "protectionArrangementRef": null,
  "createdAt": "2026-01-20T11:00:00Z",
  "updatedAt": "2026-02-10T14:00:00Z"
}
```

**Example 3: Maintenance/Alimony Liability**

```json
{
  "id": 791,
  "href": "/api/v2/factfinds/679/clients/346/liabilities/791",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "owner": {
    "client": {
      "id": 123,
      "href": "/api/v2/factfinds/679/clients/123",
      "name": "Bob Byblik"
    }
  },
  "liabilityAccountNumber": null,
  "liabilityCategory": "MAINTENANCE_ALIMONY",
  "description": "Child maintenance for two children",
  "originalLoanAmount": null,
  "repaymentOrInterestOnly": null,
  "rateType": null,
  "amountOutstanding": null,
  "creditLimit": null,
  "interestRate": null,
  "paymentAmount": {
    "amount": 800.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "lender": null,
  "loanTermYears": null,
  "endDate": "2034-08-20",
  "protected": "NO",
  "earlyRedemptionCharge": null,
  "consolidate": false,
  "isToBeRepaid": false,
  "howWillLiabilityBeRepaid": null,
  "isGuarantorMortgage": false,
  "linkedAssetRef": null,
  "protectionArrangementRef": null,
  "createdAt": "2026-01-22T10:30:00Z",
  "updatedAt": "2026-01-22T10:30:00Z"
}
```

**Example 4: Personal Loan Liability**

```json
{
  "id": 792,
  "href": "/api/v2/factfinds/679/clients/346/liabilities/792",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "owner": {
    "client": {
      "id": 124,
      "href": "/api/v2/factfinds/679/clients/124",
      "name": "Jane Byblik"
    }
  },
  "liabilityAccountNumber": "PL-789012",
  "liabilityCategory": "PERSONAL_LOANS",
  "description": "Home improvement loan",
  "originalLoanAmount": {
    "amount": 15000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "repaymentOrInterestOnly": "REPAYMENT",
  "rateType": "FIXED",
  "amountOutstanding": {
    "amount": 12500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "creditLimit": null,
  "interestRate": 5.9,
  "paymentAmount": {
    "amount": 300.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "lender": "Santander",
  "loanTermYears": 5,
  "endDate": "2028-06-15",
  "protected": "LIFE_ONLY",
  "earlyRedemptionCharge": {
    "amount": 500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "consolidate": false,
  "isToBeRepaid": false,
  "howWillLiabilityBeRepaid": null,
  "isGuarantorMortgage": false,
  "linkedAssetRef": null,
  "protectionArrangementRef": {
    "id": 556,
    "href": "/api/v2/factfinds/679/arrangements/556"
  },
  "createdAt": "2023-06-15T09:00:00Z",
  "updatedAt": "2026-02-05T10:15:00Z"
}
```

---

### 14.19 Employment Contract

The `Employment` contract represents a client's comprehensive employment record including employment history, status, self-employed income with 3 years of accounts, and all information required for UK mortgage applications and affordability assessments.

**Reference Type:** Employment is a reference type with identity (has `id` field).

**Purpose:**
- Track employment history for affordability and mortgage applications
- Capture self-employed income with 3 years of accounts
- Support UK mortgage lending requirements
- Enable income verification and affordability calculations
- Record employment timeline and continuous employment

**Key Features:**
- **Comprehensive Employment Tracking** - Full employment details including dates, status, and occupation
- **Self-Employed Income Support** - 3 years of accounts (gross/net profit, dividends, salary)
- **Business Type Classification** - Sole trader, limited company, partnership, LLP
- **Mortgage Application Ready** - All fields required for UK mortgage lending
- **Affordability Integration** - Direct link to affordability calculations
- **Income Linking** - HATEOAS links to related income records
- **Probation Tracking** - Track probation periods affecting lending decisions
- **Tax Rate Capture** - Marginal tax rate for net income calculations
- **Continuous Employment** - Calculated duration for lending assessments

#### Complete Employment Contract (Employed Example)

```json
{
  "id": 567,
  "href": "/api/v2/factfinds/679/clients/346/employments/567",

  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 346,
    "href": "/api/v2/factfinds/679/clients/346"
  },

  "employmentStatus": "Employed",
  "employmentBusinessType": null,
  "employmentStatusDescription": "Full-time permanent employee",
  "occupation": "Senior Software Engineer",
  "employer": "Acme Corporation Ltd",
  "intendedRetirementAge": 67,
  "startsOn": "2015-03-01",
  "endsOn": null,
  "inProbation": false,
  "probationPeriodInMonths": null,
  "industryType": "Information Technology",
  "continuousEmploymentMonths": 132,
  "isCurrentEmployment": true,
  "highestTaxRate": "40",

  "address": {
    "line1": "Tech Park Building 5",
    "line2": "Silicon Way",
    "line3": null,
    "line4": null,
    "locality": "London",
    "postalCode": "EC1A 1BB",
    "county": {
      "code": "GB-LND",
      "name": "Greater London"
    },
    "country": {
      "isoCode": "GB",
      "name": "United Kingdom"
    }
  },

  "selfEmployedIncome": null,

  "incomesHref": "/api/v2/factfinds/679/clients/346/incomes?filter=employment.id eq 567",

  "createdAt": "2026-01-10T09:00:00Z",
  "updatedAt": "2026-02-10T11:15:00Z"
}
```

#### Complete Employment Contract (Self-Employed Example)

```json
{
  "id": 568,
  "href": "/api/v2/factfinds/679/clients/347/employments/568",

  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 347,
    "href": "/api/v2/factfinds/679/clients/347"
  },

  "employmentStatus": "SelfEmployed",
  "employmentBusinessType": "PrivateLimitedCompany",
  "employmentStatusDescription": "Director and majority shareholder of limited company",
  "occupation": "IT Consultant",
  "employer": "TechSolutions Ltd",
  "intendedRetirementAge": 65,
  "startsOn": "2018-04-01",
  "endsOn": null,
  "inProbation": false,
  "probationPeriodInMonths": null,
  "industryType": "Professional Services - IT Consulting",
  "continuousEmploymentMonths": 94,
  "isCurrentEmployment": true,
  "highestTaxRate": "45",

  "address": {
    "line1": "Business Centre",
    "line2": "123 High Street",
    "line3": null,
    "line4": null,
    "locality": "Manchester",
    "postalCode": "M1 1AA",
    "county": {
      "code": "GB-MAN",
      "name": "Greater Manchester"
    },
    "country": {
      "isoCode": "GB",
      "name": "United Kingdom"
    }
  },
  "selfEmployedIncome": {
    "mostRecentAnnualAccounts": {
      "grossProfit": {
        "amount": 180000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netProfit": {
        "amount": 150000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "shareOfCompanyProfit": {
        "amount": 180000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "grossDividend": {
        "amount": 60000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netDividend": {
        "amount": 54000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "grossSalary": {
        "amount": 25000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netSalary": {
        "amount": 20000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "yearEnd": "2024-03-31",
      "includeInAffordability": true
    },
    "yearTwoAnnualAccounts": {
      "grossProfit": {
        "amount": 165000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netProfit": {
        "amount": 135000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "shareOfCompanyProfit": {
        "amount": 165000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "grossDividend": {
        "amount": 55000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netDividend": {
        "amount": 49500.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "grossSalary": {
        "amount": 24000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netSalary": {
        "amount": 19200.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "yearEnd": "2023-03-31",
      "includeInAffordability": false
    },
    "yearThreeAnnualAccounts": {
      "grossProfit": {
        "amount": 150000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netProfit": {
        "amount": 120000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "shareOfCompanyProfit": {
        "amount": 150000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "grossDividend": {
        "amount": 50000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netDividend": {
        "amount": 45000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "grossSalary": {
        "amount": 22000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netSalary": {
        "amount": 17600.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "yearEnd": "2022-03-31",
      "includeInAffordability": false
    },
    "recentGrossPreTaxProfit": {
      "amount": 180000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "incomesHref": "/api/v2/factfinds/679/clients/347/incomes?filter=employment.id eq 568",

  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

#### Field Definitions

**Identification:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned employment identifier |
| `href` | string | read-only | Canonical URI for this employment record |
| `factfind.id` | integer | read-only | Reference to parent fact find |
| `factfind.href` | string | read-only | URI to parent fact find |
| `client.id` | integer | read-only | Reference to client |
| `client.href` | string | read-only | URI to client |

**Employment Details:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `employmentStatus` | enum string | required-on-create | Employment status (see Section 7.4 for complete list) |
| `employmentBusinessType` | enum string | conditional | Business type for self-employed (null for employed, see Section 7.5) |
| `employmentStatusDescription` | string | optional | Additional employment status details (max 1000 chars) |
| `occupation` | string | optional | Job title or occupation (max 512 chars) |
| `employer` | string | optional | Employer or business name (max 512 chars) |
| `industryType` | string | optional | Industry or sector (max 100 chars) |
| `highestTaxRate` | string | optional | Highest marginal tax rate (e.g., "20", "40", "45") |

**Employment Period:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `startsOn` | date | required-on-create | Employment start date (YYYY-MM-DD) |
| `endsOn` | date | optional | Employment end date (YYYY-MM-DD), null if current |
| `isCurrentEmployment` | boolean | read-only | Computed: true if endsOn is null |
| `continuousEmploymentMonths` | integer | read-only | Calculated months from startsOn to endsOn or today |
| `inProbation` | boolean | optional | Currently in probation period |
| `probationPeriodInMonths` | integer | optional | Length of probation period (1-99 months) |
| `intendedRetirementAge` | integer | optional | Planned retirement age (0-99 years) |

**Employment Location:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `address.line1` | string | optional | Address line 1 (max 100 chars) |
| `address.line2` | string | optional | Address line 2 (max 100 chars) |
| `address.line3` | string | optional | Address line 3 (max 100 chars) |
| `address.line4` | string | optional | Address line 4 (max 100 chars) |
| `address.locality` | string | optional | City/town (max 100 chars) |
| `address.postalCode` | string | optional | Postal/ZIP code (max 20 chars) |
| `address.county.code` | string | optional | County code (ISO-3166-2, max 6 chars) |
| `address.county.name` | string | read-only | County name (derived from code) |
| `address.country.isoCode` | string | required | Country ISO code (ISO-3166-1 alpha-2) |
| `address.country.name` | string | read-only | Country name (derived from ISO code) |

**Self-Employed Income (3 Years of Accounts):**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `selfEmployedIncome` | object | conditional | Self-employed accounts (null if not self-employed) |
| `selfEmployedIncome.mostRecentAnnualAccounts` | object | required-if-se | Most recent year accounts |
| `selfEmployedIncome.yearTwoAnnualAccounts` | object | optional | Previous year accounts |
| `selfEmployedIncome.yearThreeAnnualAccounts` | object | optional | Third year accounts |
| `selfEmployedIncome.recentGrossPreTaxProfit` | MoneyValue | read-only | Most recent gross profit (computed) |

**Related Resources:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `incomesHref` | string | read-only | HATEOAS link to related income records filtered by this employment |

**Audit Trail:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Annual Accounts Fields (for Self-Employed Income)

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `grossProfit` | MoneyValue | optional | Gross profit for the year |
| `netProfit` | MoneyValue | optional | Net profit for the year |
| `shareOfCompanyProfit` | MoneyValue | optional | Share of company profit |
| `grossDividend` | MoneyValue | optional | Gross dividend received |
| `netDividend` | MoneyValue | optional | Net dividend after tax |
| `grossSalary` | MoneyValue | optional | Gross salary drawn |
| `netSalary` | MoneyValue | optional | Net salary after tax |
| `yearEnd` | date | required | Year end date (YYYY-MM-DD) |
| `includeInAffordability` | boolean | required | Include in affordability calculations |

#### Employment Status Codes

| Code | Description |
|------|-------------|
| `Employed` | Employed |
| `SelfEmployed` | Self-Employed |
| `CompanyDirector` | Company Director |
| `Retired` | Retired |
| `Unemployed` | Unemployed |
| `Houseperson` | Houseperson |
| `Student` | Student |
| `MaternityLeave` | Maternity Leave |
| `LongTermIllness` | Long Term Illness |
| `ContractWorker` | Contract Worker |
| `CarerOfaChildUnder16` | Carer of a Child Under 16 |
| `CarerOfaPersonOver16` | Carer of a Person Over 16 |
| `Other` | Other |
| `Unknown` | Unknown |

#### Employment Business Type Codes (for Self-Employed)

| Code | Description | Tax Structure |
|------|-------------|---------------|
| `SoleTrader` | Sole Trader | Self-assessment, personal tax |
| `PrivateLimitedCompany` | Private Limited Company | Corporation tax, dividends, salary |
| `Partnership` | Partnership | Self-assessment, shared profits |
| `LimitedLiabilityPartnership` | Limited Liability Partnership | Self-assessment, LLP tax rules |

**Notes:**
- employmentBusinessType is NULL for all non-self-employed statuses
- Required when employmentStatus = "SelfEmployed"
- Determines income assessment method for mortgage applications
- Affects affordability calculations and evidence requirements

#### Validation Rules

**Required Fields:**
- `employmentStatus` - Must be one of the valid enum values
- `startsOn` - Must be a valid date, cannot be in future
- `address.country.isoCode` - Must be valid ISO 3166-1 alpha-2 code (if address provided)

**Conditional Requirements:**
- If `employmentStatus` = "SelfEmployed":
  - `employmentBusinessType` is required
  - `selfEmployedIncome` must be provided
  - `selfEmployedIncome.mostRecentAnnualAccounts` must be complete
- If `inProbation` = true:
  - `probationPeriodInMonths` should be provided

**Date Validations:**
- `endsOn` must be after `startsOn` if provided
- `yearEnd` dates must be in chronological order (most recent first)
- All dates cannot be in the future
- `startsOn` must be a reasonable date (not more than 60 years in past)

**Self-Employed Income Validations:**
- Must have at least `mostRecentAnnualAccounts`
- `yearEnd` must be in the past
- At least one financial field must be populated per year
- `includeInAffordability` = true only for most recent year (typically)
- Year end dates must be unique (no duplicate years)

**Numeric Validations:**
- `intendedRetirementAge` - Must be between 50 and 99
- `probationPeriodInMonths` - Must be between 1 and 99
- `continuousEmploymentMonths` - Auto-calculated, must be >= 0
- All money amounts must be >= 0

**Business Logic:**
- `continuousEmploymentMonths` automatically calculated from dates
- `isCurrentEmployment` automatically computed (endsOn == null)
- `recentGrossPreTaxProfit` derived from mostRecentAnnualAccounts.grossProfit

#### Business Rules

**Self-Employed Income Assessment for Mortgage Applications:**

**UK Mortgage Lenders Typically:**
- Require 2-3 years of accounts for self-employed applicants
- Use average of 2 years net profit for affordability calculations
- May stress-test using lower of 2 years if declining income
- Some lenders accept 1 year accounts for established businesses (3+ years trading)
- Directors of limited companies: salary + dividends + retained profits considered
- Partnership income: share of partnership profits used

**Income Averaging Formula:**
```
Standard Employed:
  Annual Income = Gross Salary + Regular Bonuses

Self-Employed (Sole Trader):
  Average Annual Income = (Year 1 Net Profit + Year 2 Net Profit) / 2

Limited Company Director:
  Total Income = Net Salary + Net Dividends + (Share of Retained Profits × percentage)
  Average = (Year 1 Total + Year 2 Total) / 2

Partnership:
  Average Income = (Year 1 Share of Profit + Year 2 Share of Profit) / 2
```

**Accountant Certification Requirements:**
- Certified accounts required for self-employed mortgage applications
- SA302 forms (HMRC Self-Assessment tax calculation) required as evidence
- Tax year overview from HMRC (matching SA302)
- Some lenders accept management accounts for most recent year
- Accounts must be prepared by qualified accountant (ACCA, ACA, FCCA, FCA)

**Probation Period Impact on Lending:**
- Most UK lenders require probation period to be completed before mortgage offer
- Some specialist lenders accept "passed probation" confirmation letters
- Contract of employment must be permanent (not fixed-term)
- Probation period typically 3-6 months for standard roles
- Senior/professional roles may have 6-12 month probation
- During probation: Higher deposit may be required or application declined

**Continuous Employment Calculations:**
- Calculated from `startsOn` to `endsOn` or current date
- Used for mortgage affordability (longer employment = lower risk)
- Gaps in employment history may require written explanation
- Typical mortgage requirement: 12+ months continuous employment
- Some lenders require 3+ years employment history
- Career changes may require explanation and impact assessment

**Retirement Age Considerations:**
- Most lenders require mortgage term to end before retirement age
- State pension age currently 66-67 in UK (may increase)
- Private pension access from age 55 (increasing to 57 in 2028)
- Intended retirement age affects maximum mortgage term calculation
- Some lenders use state pension age if intended retirement age not provided
- Early retirement plans may reduce maximum borrowing

**Tax Rate Capture:**
- Used for net income calculations in affordability assessments
- UK tax rates 2024/25: 20% (basic), 40% (higher), 45% (additional)
- Scottish tax rates differ: 19%, 20%, 21%, 42%, 47%
- Affects net disposable income calculations
- Higher rate taxpayers may have better affordability due to higher gross income
- Used to verify net income figures

**Industry Type Classification:**
- Some industries considered higher risk by mortgage lenders
- Construction, hospitality, arts may require larger deposits
- Professional occupations (IT, finance, healthcare, legal) typically preferred
- Key workers (NHS, teachers, emergency services) may get preferential rates
- Industry affects insurance underwriting and occupation classification
- Contractor/agency workers may face additional scrutiny

**Employment Status Impact on Mortgage Applications:**

| Employment Status | Mortgage Impact | Typical Requirements |
|-------------------|-----------------|---------------------|
| Employed (Permanent) | Standard assessment | 3 months payslips, employment letter |
| Self-Employed | More scrutiny | 2-3 years accounts, SA302s, tax overview |
| Company Director | Complex assessment | Accounts, dividend vouchers, shareholding proof |
| Contract Worker | Specialist lenders | Contract history, day rate evidence |
| Retired | Age-restricted | Pension income evidence, guaranteed for life |
| Unemployed | Generally declined | Must show alternative income |
| Maternity Leave | Depends on return date | Employment contract showing return date |

---

### 14.20 Budget Contract

The `Budget` contract represents a client's budgeted/planned monthly expenditure by category.

**Reference Type:** Budget is a reference type with identity (has `id` field).

**Key Features:**
- Monthly budget amounts by category
- Category-level planning
- Comparison with actual expenditure
- Affordability assessment support

#### Complete Budget Contract

```json
{
  "id": 445,
  "href": "/api/v2/factfinds/679/clients/346/budget/445",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "category": "Housing",
  "amount": {
    "amount": 1500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "notes": "Monthly mortgage payment and council tax",
  "createdAt": "2026-01-10T09:00:00Z",
  "updatedAt": "2026-02-05T10:15:00Z"
}
```

#### Field Definitions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned budget identifier |
| `href` | string | read-only | Canonical URI for this budget item |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `client` | ClientRef | read-only | Reference to client |
| `category` | string | required-on-create | Budget category name (max 100 chars) |
| `amount` | MoneyValue | required-on-create | Budgeted monthly amount |
| `notes` | string | optional | Budget notes and assumptions (max 2000 chars) |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

---

### 14.21 Expenditure Contract

The `Expenditure` contract represents a single expenditure item (outgoing payment) for a client, used for budget planning and affordability assessments. Each expenditure represents a specific payment such as mortgage, rent, utilities, food shopping, or other regular expenses.

**Reference Type:** Expenditure is a reference type with identity (has `id` field).

**Key Features:**
- Tracks individual expenditure items by type and frequency
- Links to liabilities being repaid (e.g., mortgage, credit card payments)
- Supports debt consolidation scenarios with `isConsolidated` flag
- Categorizes expenditure for affordability assessment (Essential vs Non-Essential)
- Period tracking with start and end dates

**Key Structure Changes (v2.2):**
- **RESTORED:** `factfind` field for consistent navigation patterns
- **REMOVED:** `grossAmount` field (now only `netAmount`)
- **CHANGED:** `netAmount` structure upgraded to full MoneyValue with currency object including code, display, and symbol
- **ADDED:** `isConsolidated` flag for debt consolidation scenarios
- **ADDED:** `isLiabilityToBeRepaid` flag to indicate debt repayment
- **ADDED:** `liability` reference to link to the liability being repaid

#### Complete Expenditure Contract Examples

**Example 1: Mortgage Payment (with liability link)**

```json
{
  "id": 1001,
  "href": "/api/v2/factfinds/234/clients/456/expenditures/1001",

  "factfind": {
    "id": 234,
    "href": "/api/v2/factfinds/234"
  },

  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/234/clients/456"
  },

  "description": "Monthly mortgage payment - main residence",
  "expenditureType": "Mortgage",
  "netAmount": {
    "amount": 1500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": "Monthly",
  "startsOn": "2020-06-01",
  "endsOn": null,

  "isConsolidated": false,
  "isLiabilityToBeRepaid": true,
  "liability": {
    "id": 5001,
    "href": "/api/v2/factfinds/234/liabilities/5001",
    "description": "Residential Mortgage - Main Home"
  },

  "notes": "Fixed rate until 2027",

  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

**Example 2: Council Tax (essential expense, no liability)**

```json
{
  "id": 1002,
  "href": "/api/v2/factfinds/234/clients/456/expenditures/1002",

  "factfind": {
    "id": 234,
    "href": "/api/v2/factfinds/234"
  },

  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/234/clients/456"
  },

  "description": "Council tax - Band D property",
  "expenditureType": "Council Tax",
  "netAmount": {
    "amount": 185.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": "Monthly",
  "startsOn": "2025-04-01",
  "endsOn": null,

  "isConsolidated": false,
  "isLiabilityToBeRepaid": false,
  "liability": null,

  "notes": "10 monthly payments (April-January)",

  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

**Example 3: Credit Card Payment (consolidated debt)**

```json
{
  "id": 1003,
  "href": "/api/v2/factfinds/234/clients/456/expenditures/1003",

  "factfind": {
    "id": 234,
    "href": "/api/v2/factfinds/234"
  },

  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/234/clients/456"
  },

  "description": "Credit card minimum payment",
  "expenditureType": "Credit Card",
  "netAmount": {
    "amount": 150.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": "Monthly",
  "startsOn": "2024-01-01",
  "endsOn": null,

  "isConsolidated": true,
  "isLiabilityToBeRepaid": true,
  "liability": {
    "id": 6001,
    "href": "/api/v2/factfinds/234/liabilities/6001",
    "description": "Barclaycard - Balance £4,500"
  },

  "notes": "To be consolidated into remortgage",

  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

**Example 4: Food & Personal Care (essential, no liability)**

```json
{
  "id": 1004,
  "href": "/api/v2/factfinds/234/clients/456/expenditures/1004",

  "factfind": {
    "id": 234,
    "href": "/api/v2/factfinds/234"
  },

  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/234/clients/456"
  },

  "description": "Weekly food shopping and personal care items",
  "expenditureType": "Food & Personal Care",
  "netAmount": {
    "amount": 520.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },
  "frequency": "Monthly",
  "startsOn": "2025-01-01",
  "endsOn": null,

  "isConsolidated": false,
  "isLiabilityToBeRepaid": false,
  "liability": null,

  "notes": "Family of 4 - approximately £120/week",

  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

#### Field Definitions

**Identification**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned expenditure identifier |
| `href` | string | read-only | Canonical URI for this expenditure |
| `factfind` | FactFindReference | required-on-create, write-once | Reference to the owning FactFind |
| `client` | ClientReference | required-on-create | Reference to the client who has this expenditure |

**Expenditure Details**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `description` | string | optional | Description of the expenditure (max 500 chars) |
| `expenditureType` | enum | required-on-create | Type/category of expenditure (see Expenditure Types below) |
| `netAmount` | MoneyValue | required-on-create | Amount paid after tax (if applicable) - full MoneyValue structure with `amount` and nested `currency` object containing `code`, `display`, and `symbol` |
| `frequency` | enum | required-on-create | Payment frequency: Daily, Weekly, Fortnightly, Monthly, Quarterly, Annually |

**Period**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `startsOn` | date | optional | When the expenditure started (ISO 8601 date format: YYYY-MM-DD) |
| `endsOn` | date | optional | When the expenditure ends (null if ongoing) |

**Debt Management**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `isConsolidated` | boolean | optional | Is this part of a debt consolidation scenario? (default: false) |
| `isLiabilityToBeRepaid` | boolean | optional | Is this paying off a specific debt/liability? (default: false) |
| `liability` | LiabilityReference | optional | Reference to the debt/liability being repaid (should be populated when `isLiabilityToBeRepaid` is true) |

**Additional Information**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `notes` | string | optional | Additional notes about this expenditure (max 2000 chars) |

**Audit Trail**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Expenditure Types

Expenditure types are organized into three categories based on their importance for affordability assessments:

| Category | Expenditure Type | Description |
|----------|-----------------|-------------|
| **Basic Essential Expenditure** | | |
| | Rent | Monthly or periodic rent payments |
| | Mortgage | Mortgage payment (principal + interest) |
| | Council Tax | Local authority council tax |
| | Gas | Gas utilities |
| | Electricity | Electricity utilities |
| | Water | Water and sewerage charges |
| | Telephone/Mobile | Phone and mobile services |
| | Food & Personal Care | Groceries, toiletries, personal care |
| | Car/Travelling Expenses | Vehicle running costs, fuel, public transport |
| | Housekeeping | General household running costs |
| | Ground Rent/Service charge | Service charges for leasehold properties |
| **Basic Quality of Living** | | |
| | Clothing | Clothing and footwear |
| | Furniture/Appliances/Repairs | Household goods and repairs |
| | TV/Satellite/Internet/Basic Recreation | Media subscriptions and basic entertainment |
| | Pension | Personal pension contributions |
| | School Fee/Childcare | Education and childcare costs |
| **Non-Essential Outgoings** | | |
| | Sports and Recreation | Sports memberships, hobbies |
| | Holidays | Annual holidays and travel |
| | Entertainment | Dining out, cinema, events |
| | Life/General Assurance Premium | Insurance premiums |
| | Investments | Investment contributions |
| | Credit Card | Credit card payment (minimum or regular) |

#### Validation Rules

- `id` is read-only, auto-generated by the system
- `factfind` is required on create and write-once (cannot be changed after creation)
- `client` is required on create
- `expenditureType` is required, must be one of the enum values from the table above
- `netAmount` is required, must be positive (> 0)
- `netAmount.amount` must be positive (> 0)
- `netAmount.currency.code` must be valid ISO 4217 currency code (e.g., GBP, EUR, USD)
- `netAmount.currency.display` must be provided (full currency name)
- `netAmount.currency.symbol` must be provided (currency symbol)
- `frequency` is required, must be one of: Daily, Weekly, Fortnightly, Monthly, Quarterly, Annually
- `endsOn` must be after `startsOn` if both provided
- If `startsOn` is provided, it cannot be in the future (cannot start payments that haven't begun)
- `liability` should only be populated when `isLiabilityToBeRepaid` is true
- If `isLiabilityToBeRepaid` is true, `liability` reference should be provided
- `description` max length 500 characters
- `notes` max length 2000 characters

#### Business Rules

**Liability Linking:**
- Expenditures linked to liabilities (via `liability` field) enable debt repayment tracking
- When a liability is repaid or settled, the associated expenditure should be ended (`endsOn` set)
- Mortgage expenditures should link to the corresponding mortgage liability for accurate tracking

**Debt Consolidation:**
- `isConsolidated` flag indicates expenditure is part of debt consolidation scenario
- Consolidated expenditures are typically credit card payments, personal loans, or other debts being rolled into a new arrangement
- When debts are consolidated, the old expenditures should be ended and new expenditure created for the consolidated payment

**Affordability Assessment Categories:**
- **Basic Essential Expenditure:** Always included in minimum expenditure calculations for affordability
  - Housing (Mortgage, Rent, Council Tax, Ground Rent/Service charge)
  - Utilities (Gas, Electricity, Water, Telephone/Mobile)
  - Living costs (Food & Personal Care, Housekeeping)
  - Transport (Car/Travelling Expenses)
- **Basic Quality of Living:** Typically included in standard affordability models
  - Clothing, Furniture/Appliances/Repairs
  - TV/Satellite/Internet/Basic Recreation
  - Pension, School Fee/Childcare
- **Non-Essential Outgoings:** May be excluded or reduced in affordability stress tests
  - Sports and Recreation, Holidays, Entertainment
  - Life/General Assurance Premium (may be excluded if being replaced)
  - Investments (discretionary)

**Mortgage Application Context:**
- For mortgage applications, lenders focus on Basic Essential and Basic Quality of Living expenses
- Non-Essential Outgoings may be excluded from minimum expenditure calculations
- Lenders stress-test affordability by excluding discretionary spending
- Credit card payments marked as `isConsolidated=true` indicate debt consolidation scenarios
- Consolidated debt expenditures will cease when the new mortgage completes (set `endsOn` date)

**Payment Frequency:**
- All expenditure amounts should be captured at their actual payment frequency
- Systems should calculate monthly equivalents for affordability calculations:
  - Daily: amount × 365 ÷ 12
  - Weekly: amount × 52 ÷ 12
  - Fortnightly: amount × 26 ÷ 12
  - Monthly: amount × 1
  - Quarterly: amount × 4 ÷ 12
  - Annually: amount × 1 ÷ 12

#### Affordability Context

**How Expenditure Categories Affect Affordability Assessments:**

1. **Basic Essential Expenditure:**
   - Always included in minimum expenditure calculations
   - Cannot be reduced or excluded in stress testing
   - Forms the baseline for sustainable living costs
   - Lenders will verify these against industry benchmarks (e.g., Office for National Statistics data)

2. **Basic Quality of Living:**
   - Typically included in standard affordability models
   - Represents normal standard of living for the client's circumstances
   - May be adjusted based on household size and composition
   - Pension contributions often required to maintain quality of life in retirement

3. **Non-Essential Outgoings:**
   - May be excluded or significantly reduced in affordability stress tests
   - Demonstrates available capacity to absorb payment increases
   - Lenders may exclude these when calculating minimum sustainable income
   - Can be forgone temporarily in financial difficulty scenarios

**Regulatory Context:**
- FCA MCOB (Mortgage Conduct of Business) requires thorough expenditure assessment
- Lenders must ensure borrowers can afford payments under stressed interest rate scenarios
- Consumer Duty requires fair treatment and consideration of actual living costs
- Expenditure verification may require bank statements or other evidence

---

### 14.22 Credit History Contract

The `CreditHistory` contract represents a comprehensive record of a client's credit history, including adverse credit events, payment history, and aggregate summary statistics. This contract is essential for affordability assessments and mortgage lending decisions, ensuring compliance with FCA regulations and responsible lending requirements.

**Reference Type:** CreditHistory is a reference type with identity (has `id` field).

**Purpose:**
- Track client credit history for affordability and lending decisions
- Document adverse credit events (CCJ, Default, IVA, Bankruptcy, Arrears, Repossession)
- Provide calculated summary of credit status and outstanding debt
- Support mortgage suitability assessments
- Ensure regulatory compliance for mortgage affordability assessments

**Key Features:**
- Aggregate summary dashboard with calculated statistics
- Detailed adverse credit event tracking with full lifecycle
- Payment history analysis (12-month and 6-year views)
- Outstanding debt aggregation
- Timeline management for each credit event
- Liability linking for debt tracking
- Regulatory compliance support for FCA mortgage lending rules

**Key Structure Changes (v2.2):**
- **REMOVED:** `creditScore` object (moved to external CRA integration)
- **REMOVED:** `mortgageSuitability` object (calculated at application time)
- **ADDED:** `summary` object with aggregate statistics and calculated fields
- **UPDATED:** All summary boolean flags moved into `summary` object
- **UPDATED:** `totalDebtOutstanding` calculated from adverseCreditEvents array
- **UPDATED:** `missedPayments` summary moved into `summary` object

**Regulatory Context:**
- FCA Mortgage Conduct of Business (MCOB) rules require thorough credit assessment
- Affordability assessments must consider credit history and repayment capacity
- Adverse credit events impact lending decisions and interest rates
- Credit Reference Agency data forms basis of responsible lending decisions
- Consumer Duty requires fair treatment in lending decisions

#### Complete Credit History Contract

```json
{
  "id": 334,
  "href": "/api/v2/factfinds/679/clients/346/credit-history/334",

  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },

  "client": {
    "id": 346,
    "href": "/api/v2/factfinds/679/clients/346",
    "fullName": "John Smith"
  },

  "summary": {
    "totalRecords": 1,
    "hasAdverseCredit": true,
    "hasCCJ": false,
    "hasBeenRefusedCredit": false,
    "ivaHistory": false,
    "hasDefault": true,
    "hasBankruptcyHistory": false,
    "hasArrears": false,

    "totalDebtOutstanding": {
      "amount": 3500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },

    "missedPayments": {
      "last12Months": 0,
      "last6Years": 2
    }
  },

  "adverseCreditEvents": [{
    "type": "Default",
    "registeredOn": "2020-06-15T00:00:00Z",
    "satisfiedOrClearedOn": null,
    "reposessedOn": null,
    "dischargedOn": null,
    "amountRegistered": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "amountOutstanding": {
      "amount": 3500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "isDebtOutstanding": true,
    "numberOfPaymentsMissed": 2,
    "consecutivePaymentsMissed": 2,
    "numberOfPaymentsInArrears": 1,
    "isArrearsClearedUponCompletion": false,
    "yearsMaintained": 0,
    "lender": "High Street Bank",
    "liability": {
      "id": 1001,
      "href": "/api/v2/factfinds/679/liabilities/1001",
      "description": "Credit Card Debt"
    },
    "concurrencyId": 1,
    "createdAt": "2026-01-15T10:30:00Z",
    "lastUpdatedAt": "2026-01-15T10:30:00Z"
  }],

  "notes": "Client has one outstanding default from 2020. Currently making regular payments to clear the debt.",

  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-01-15T10:00:00Z"
}
```

#### Field Definitions

**Identification Fields**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned credit history record identifier |
| `href` | string | read-only | Canonical URI for this credit history record |
| `factfind` | FactfindRef | read-only | Reference to parent factfind |
| `client` | ClientRef | read-only | Reference to the client this credit history belongs to |

**Summary Object (Aggregate Calculated Fields)**

The `summary` object provides a calculated overview of the client's entire credit history. All fields in this object are calculated from the `adverseCreditEvents` array and should be treated as read-only derived data.

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `summary` | object | read-only | Calculated summary of credit history status (derived from adverseCreditEvents) |
| `summary.totalRecords` | integer | read-only | Count of items in the adverseCreditEvents array |
| `summary.hasAdverseCredit` | boolean | read-only | True if adverseCreditEvents array is not empty |
| `summary.hasCCJ` | boolean | required | Indicates if client has County Court Judgment(s) - set based on events in array |
| `summary.hasBeenRefusedCredit` | boolean | required | Indicates if client has been refused credit in the past |
| `summary.ivaHistory` | boolean | required | Indicates if client has Individual Voluntary Arrangement (IVA) history |
| `summary.hasDefault` | boolean | required | Indicates if client has default(s) registered on credit file |
| `summary.hasBankruptcyHistory` | boolean | required | Indicates if client has bankruptcy history on record |
| `summary.hasArrears` | boolean | required | Indicates if client currently has or had payment arrears |
| `summary.totalDebtOutstanding` | MoneyValue | read-only | Sum of all adverseCreditEvents[].amountOutstanding where isDebtOutstanding = true |
| `summary.missedPayments` | object | read-only | Summary of missed payment history aggregated from all events |
| `summary.missedPayments.last12Months` | integer | read-only | Count of missed payments in last 12 months (aggregated from events within that period) |
| `summary.missedPayments.last6Years` | integer | read-only | Count of missed payments in last 6 years (aggregated from all events) |

**Adverse Credit Events Array**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `adverseCreditEvents[]` | AdverseCreditEvent[] | optional | Array of adverse credit events (see AdverseCreditEvent value type below) |

Each item in the `adverseCreditEvents` array is an **AdverseCreditEvent** value type (no `id` field) with the following structure:

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `type` | enum | required | Type of adverse event: "CCJ", "Default", "IVA", "Bankruptcy", "Arrears", "Repossession" |
| `registeredOn` | datetime | required | Date event was registered with Credit Reference Agencies (ISO 8601 format) |
| `satisfiedOrClearedOn` | datetime | optional | Date the debt was satisfied or cleared (ISO 8601 format) |
| `reposessedOn` | datetime | optional | Date of property repossession if applicable (ISO 8601 format) |
| `dischargedOn` | datetime | optional | Date bankruptcy or IVA was discharged (ISO 8601 format) |
| `amountRegistered` | MoneyValue | required | Original amount registered when event occurred |
| `amountOutstanding` | MoneyValue | required | Current outstanding amount (can be 0.00 if satisfied) |
| `isDebtOutstanding` | boolean | required | Whether debt is still outstanding (true) or fully paid (false) |
| `numberOfPaymentsMissed` | integer | optional | Total number of payments missed for this event |
| `consecutivePaymentsMissed` | integer | optional | Number of consecutive payments missed (maximum consecutive period) |
| `numberOfPaymentsInArrears` | integer | optional | Number of payments currently in arrears |
| `isArrearsClearedUponCompletion` | boolean | optional | Whether arrears were cleared when arrangement completed |
| `yearsMaintained` | integer | optional | Number of years successfully maintained after event (for IVA/payment plans, typically 0-6) |
| `lender` | string | optional | Name of lender or creditor involved in the adverse event (max 200 characters) |
| `liability` | LiabilityRef | optional | Reference to related liability record if applicable |
| `concurrencyId` | integer | read-only | Concurrency control identifier for optimistic locking of this specific event |
| `createdAt` | datetime | read-only | ISO 8601 timestamp when this event record was created |
| `lastUpdatedAt` | datetime | read-only | ISO 8601 timestamp when this event record was last updated |

**Additional Information**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `notes` | string | optional | Free-text notes about credit history, mitigating circumstances, or additional context (max 2000 characters) |

**Audit Trail**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `createdAt` | datetime | read-only | ISO 8601 timestamp when the credit history record was created |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp when the credit history record was last updated |

#### Validation Rules

**Summary Object Validation:**
- `summary.totalRecords` must equal the count of items in `adverseCreditEvents` array
- `summary.hasAdverseCredit` must be true if `adverseCreditEvents` array is not empty
- `summary.totalDebtOutstanding.amount` must equal the sum of all `adverseCreditEvents[].amountOutstanding.amount` where `isDebtOutstanding` = true
- Summary boolean flags must align with events in array:
  - If `summary.hasCCJ` = true, there must be at least one event with `type` = "CCJ"
  - If `summary.hasDefault` = true, there must be at least one event with `type` = "Default"
  - If `summary.ivaHistory` = true, there must be at least one event with `type` = "IVA"
  - If `summary.hasBankruptcyHistory` = true, there must be at least one event with `type` = "Bankruptcy"
  - If `summary.hasArrears` = true, there must be at least one event with `type` = "Arrears"
- `summary.missedPayments.last12Months` must equal sum of `numberOfPaymentsMissed` for events within last 12 months
- `summary.missedPayments.last6Years` must equal sum of `numberOfPaymentsMissed` for events within last 6 years

**Adverse Credit Event Validations:**
- `type` is required when event is present
- `type` must be one of: "CCJ", "Default", "IVA", "Bankruptcy", "Arrears", "Repossession"
- `registeredOn` is required and cannot be in the future
- If `satisfiedOrClearedOn` is provided, it must be after `registeredOn`
- If `dischargedOn` is provided, it must be after `registeredOn`
- If `reposessedOn` is provided, it must be after `registeredOn`
- Timeline must be logical: `registeredOn` < `satisfiedOrClearedOn` < `dischargedOn`
- `amountRegistered` is required and must be > 0
- `amountOutstanding` is required and cannot exceed `amountRegistered`
- If `isDebtOutstanding` = false, `amountOutstanding.amount` should be 0.00
- `isDebtOutstanding` is required
- `numberOfPaymentsMissed` must be >= 0 if provided
- `consecutivePaymentsMissed` must be <= `numberOfPaymentsMissed` if provided
- `numberOfPaymentsInArrears` must be >= 0 if provided
- `yearsMaintained` must be >= 0 and <= 10 if provided
- `lender` max length 200 characters
- Currency codes must be valid ISO 4217 codes

**Date Format Validations:**
- All dates must be valid ISO 8601 datetime format with timezone: YYYY-MM-DDTHH:mm:ssZ
- Event dates (`registeredOn`, `satisfiedOrClearedOn`, `reposessedOn`, `dischargedOn`) cannot be in the future
- Dates must be internally consistent within each event

**Business Rule Validations:**
- If event `type` = "IVA", `yearsMaintained` should typically be 0-6 (standard IVA term is 5-6 years)
- If event `type` = "Repossession", `reposessedOn` date should be provided
- If event `type` = "Bankruptcy", `dischargedOn` date should be provided when bankruptcy is discharged
- If `isDebtOutstanding` = true, `amountOutstanding` must be > 0

#### Business Rules and Context

**Credit Reference Agencies (CRAs):**
The UK has three main Credit Reference Agencies that financial advisers and lenders use:

1. **Experian** - Most widely used, score range 0-999
   - Excellent: 961-999
   - Good: 881-960
   - Fair: 721-880
   - Poor: 561-720
   - Very Poor: 0-560

2. **Equifax** - Score range 0-700
   - Excellent: 466-700
   - Good: 420-465
   - Fair: 380-419
   - Poor: 280-379
   - Very Poor: 0-279

3. **TransUnion (formerly Callcredit)** - Score range 0-710
   - Excellent: 628-710
   - Good: 604-627
   - Fair: 566-603
   - Poor: 551-565
   - Very Poor: 0-550

**Adverse Credit Event Types:**

1. **CCJ (County Court Judgment)** - Court order requiring debt repayment
   - Stays on credit file for 6 years
   - Can be marked as "satisfied" when paid
   - Significant impact on mortgage applications
   - CCJs over £500 within 3 years typically exclude standard mortgages

2. **Default** - Creditor has written off debt (typically 3-6 months of missed payments)
   - Stays on credit file for 6 years from default date
   - Even if paid, remains on file
   - Impact reduces over time
   - Multiple defaults severely impact lending options

3. **IVA (Individual Voluntary Arrangement)** - Formal agreement to pay reduced debt over time
   - Typically 5-6 year payment plan
   - Stays on credit file for 6 years from approval date
   - Can apply for mortgages after 3 years with good payment record
   - Must disclose to lenders

4. **Bankruptcy** - Legal process to write off unaffordable debts
   - Typically discharged after 12 months
   - Stays on credit file for 6 years
   - Severe impact on mortgage applications
   - May need specialist lender

5. **Arrears** - Behind on contractual payments
   - Current arrears severely impact lending decisions
   - Historical arrears (cleared) have reducing impact
   - 2+ months arrears trigger lender concerns
   - Pattern of arrears more serious than one-off issues

6. **Repossession** - Property taken back by lender
   - Extremely serious adverse event
   - Stays on file for 6 years
   - Very difficult to obtain new mortgage
   - Specialist lenders only, high interest rates

**Mortgage Lending Impact:**

The credit history directly affects:
- **Loan-to-Value (LTV)** - Clean credit may access 95% LTV; adverse credit often limited to 75-85% LTV
- **Interest Rates** - Adverse credit attracts higher rates (typically 1-3% higher)
- **Lender Options** - Mainstream vs. specialist adverse credit lenders
- **Affordability Assessment** - Pattern of missed payments suggests future risk

**FCA Regulatory Requirements:**

Under FCA MCOB (Mortgage Conduct of Business) rules:
- Lenders must assess creditworthiness comprehensively
- Credit Reference Agency searches are mandatory
- Adverse credit must be factored into affordability assessments
- Advisers must explain impact of credit history on mortgage options
- Consumers must be made aware of their credit profile

**Best Practices:**
- Check credit score 3-6 months before mortgage application
- Address errors on credit files immediately
- Allow time for adverse events to age (3+ years is better)
- Build positive credit history after adverse events
- Consider specialist lenders for recent adverse credit
- Document mitigating circumstances for adverse events

---

### 14.24 Property Detail Contract

The `PropertyDetail` contract represents detailed property information including physical characteristics, construction details, and tenure information.

**Reference Type:** PropertyDetail is a reference type with identity (has `id` field).

**Key Features:**
- Property type and status classification
- Construction and roof type details
- Tenure tracking (Freehold, Leasehold, Commonhold)
- Building characteristics (age, bedrooms, outbuildings)
- Certificate and warranty tracking (NHBC, Listed Building)
- Ex-local authority property identification

#### Complete Property Detail Contract

```json
{
  "id": 1,
  "href": "/api/v2/factfinds/679/property-details/1",
  "propertyType": "DETACHED",
  "tenureType": "Freehold",
  "leaseholdEndsOn": null,
  "propertyStatus": "RESIDENTIAL",
  "constructionType": "BRICK_AND_TILE",
  "constructionNotes": "Victorian cottage with modern renovation",
  "roofConstructionType": "PITCHED_SLATE_TILES",
  "numberOfBedrooms": 4,
  "yearBuilt": 1890,
  "isNewBuild": false,
  "isNHBCCertificateCovered": false,
  "isOtherCertificateCovered": true,
  "otherCertificateNotes": "Grade II Listed Building - Conservation Area",
  "builderName": null,
  "isExLocalAuthority": false,
  "numberOfOutbuildings": 1,
  "address": {
    "line1": "Rose Cottage",
    "line2": "Church Lane",
    "line3": null,
    "line4": null,
    "locality": "Cotswolds Village",
    "postalCode": "GL54 2AB",
    "county": {
      "code": "GB-GLS",
      "name": "Gloucestershire"
    },
    "country": {
      "isoCode": "GB",
      "name": "United Kingdom"
    }
  },
  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-02-10T14:20:00Z"
}
```

#### Field Definitions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned property detail identifier |
| `href` | string | read-only | Canonical URI for this property detail |
| `propertyType.code` | enum | required-on-create | Property type code (see codes below) |
| `propertyType.display` | string | read-only | Human-readable property type |
| `tenureType` | enum string | required-on-create | Tenure type (Freehold, Leasehold, Commonhold) |
| `leaseholdEndsOn` | date | optional | Lease end date (required if tenureType=Leasehold) |
| `propertyStatus.code` | enum | required-on-create | Property status code |
| `propertyStatus.display` | string | read-only | Human-readable property status |
| `constructionType.code` | enum | optional | Construction type code |
| `constructionType.display` | string | read-only | Construction type display |
| `constructionNotes` | string | optional | Additional construction details (max 500 chars) |
| `roofConstructionType.code` | enum | optional | Roof construction code |
| `roofConstructionType.display` | string | read-only | Roof construction display |
| `numberOfBedrooms` | integer | optional | Number of bedrooms (0 for studios/commercial) |
| `yearBuilt` | integer | optional | Year property was built (1800 to current year) |
| `isNewBuild` | boolean | optional | Property is new build (default: false) |
| `isNHBCCertificateCovered` | boolean | optional | Covered by NHBC certificate (default: false) |
| `isOtherCertificateCovered` | boolean | optional | Covered by other certificate/warranty (default: false) |
| `otherCertificateNotes` | string | optional | Other certificate details (max 500 chars) |
| `builderName` | string | optional | Builder name (for new builds, max 200 chars) |
| `isExLocalAuthority` | boolean | optional | Ex-local authority property (default: false) |
| `numberOfOutbuildings` | integer | optional | Number of outbuildings (default: 0) |
| `address` | AddressValue | required-on-create | Property address |
| `address.line1` | string | required | Address line 1 |
| `address.line2` | string | optional | Address line 2 |
| `address.line3` | string | optional | Address line 3 |
| `address.line4` | string | optional | Address line 4 |
| `address.locality` | string | required | City/town |
| `address.postalCode` | string | required | Postal/ZIP code |
| `address.county.code` | string | optional | County code (ISO-3166-2, max 6 chars) |
| `address.county.name` | string | read-only | County name |
| `address.country.isoCode` | string | required | Country ISO code (ISO-3166-1 alpha-2) |
| `address.country.name` | string | read-only | Country name |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Property Type Codes

| Code | Display Name |
|------|-------------|
| `DETACHED` | Detached House |
| `SEMI_DETACHED` | Semi-Detached House |
| `TERRACE` | Terraced House |
| `END_TERRACE` | End of Terrace House |
| `FLAT` | Flat/Apartment |
| `MAISONETTE` | Maisonette |
| `BUNGALOW` | Bungalow |
| `COTTAGE` | Cottage |
| `STUDIO` | Studio |
| `PENTHOUSE` | Penthouse |
| `LAND` | Land/Plot |
| `COMMERCIAL` | Commercial Property |
| `MIXED_USE` | Mixed Use |
| `OTHER` | Other |

#### Tenure Type Codes

| Code | Display Name |
|------|-------------|
| `Freehold` | Freehold |
| `Leasehold` | Leasehold |
| `Commonhold` | Commonhold |
| `SharedOwnership` | Shared Ownership |
| `ShareOfFreehold` | Share of Freehold |

#### Property Status Codes

| Code | Display Name |
|------|-------------|
| `RESIDENTIAL` | Residential |
| `BUY_TO_LET` | Buy to Let |
| `HOLIDAY_HOME` | Holiday Home |
| `INVESTMENT` | Investment Property |
| `COMMERCIAL` | Commercial |
| `MIXED_USE` | Mixed Use |
| `DEVELOPMENT` | Development/Project |
| `VACANT` | Vacant |

#### Construction Type Codes

| Code | Display Name |
|------|-------------|
| `BRICK_AND_TILE` | Brick and Tile |
| `BRICK_AND_BLOCK` | Brick and Block |
| `STONE` | Stone |
| `TIMBER_FRAME` | Timber Frame |
| `CONCRETE` | Concrete |
| `STEEL_FRAME` | Steel Frame |
| `PREFABRICATED` | Prefabricated/Modular |
| `LISTED_BUILDING` | Listed Building |
| `TRADITIONAL` | Traditional Construction |
| `NON_STANDARD` | Non-Standard Construction |
| `OTHER` | Other |

#### Roof Construction Type Codes

| Code | Display Name |
|------|-------------|
| `PITCHED_SLATE_TILES` | Pitched Slate Tiles |
| `PITCHED_CLAY_TILES` | Pitched Clay Tiles |
| `PITCHED_CONCRETE_TILES` | Pitched Concrete Tiles |
| `FLAT_FELT` | Flat Felt |
| `FLAT_RUBBER` | Flat Rubber Membrane |
| `THATCHED` | Thatched |
| `METAL` | Metal Roof |
| `GREEN_ROOF` | Green/Living Roof |
| `MIXED` | Mixed Roof Types |
| `OTHER` | Other |

#### Validation Rules

**Property Type:**
- Must be valid enum from Property Type Codes

**Tenure Type:**
- Must be valid enum from Tenure Type Codes
- If `tenureType = Leasehold`:
  - `leaseholdEndsOn` is required
  - `leaseholdEndsOn` must be > today
  - `leaseholdEndsOn` should be >= today + 50 years (business rule for mortgage suitability)

**Number of Bedrooms:**
- Must be >= 0
- 0 is valid for studios or commercial properties

**Number of Outbuildings:**
- Must be >= 0

**Year Built:**
- Must be valid year between 1800 and current year
- Must be logically consistent with `isNewBuild`
- If `isNewBuild = true`, `yearBuilt` should be within last 2 years

**Construction Type:**
- Must be valid enum from Construction Type Codes
- Should be consistent with `propertyType`
- Non-standard construction may require additional notes in `constructionNotes`

**Roof Construction Type:**
- Must be valid enum from Roof Construction Type Codes if provided
- Should be consistent with `constructionType`

**NHBC Certificate:**
- If `isNHBCCertificateCovered = true`, `otherCertificateNotes` should mention NHBC
- NHBC certificates are typically for properties less than 10 years old

**Leasehold:**
- If `tenureType = Leasehold`, `leaseholdEndsOn` is required
- Lease term remaining (years) = `leaseholdEndsOn` - today
- Properties with less than 80 years remaining may have financing challenges

**Address:**
- `line1`, `locality`, `postalCode`, and `country.isoCode` are required
- Postal code format must match country standards

#### Business Rules

**New Build Consistency:**
- If `isNewBuild = true`:
  - `yearBuilt` should be current year or current year - 1
  - Consider setting `isNHBCCertificateCovered = true` if applicable
  - `builderName` should be provided if known

**Ex-Local Authority:**
- If `isExLocalAuthority = true`:
  - May impact mortgage availability
  - Should be disclosed in property details

**Listed Buildings:**
- If property is Listed Building (Grade I, II*, II):
  - Set `constructionType = LISTED_BUILDING`
  - Document listing grade in `otherCertificateNotes`
  - Set `isOtherCertificateCovered = true`

**Conservation Areas:**
- If property is in Conservation Area:
  - Document in `otherCertificateNotes`

**Leasehold Suitability:**
- Lease term >= 125 years: Generally suitable for all mortgages
- Lease term 80-125 years: May require lease extension discussion
- Lease term < 80 years: Lease extension typically required

#### API Operations

**Create Property Detail:**
```
POST /api/v2/factfinds/{factfindId}/property-details
```
Returns: `201 Created` with Location header

**Update Property Detail:**
```
PATCH /api/v2/factfinds/{factfindId}/property-details/{id}
```
Returns: `200 OK`
- All fields optional (partial updates allowed)
- `id` is immutable (cannot be changed)

**Get Property Detail:**
```
GET /api/v2/factfinds/{factfindId}/property-details/{id}
```
Returns: `200 OK`

**Delete Property Detail:**
```
DELETE /api/v2/factfinds/{factfindId}/property-details/{id}
```
Returns: `204 No Content`

---

### 14.26 Notes Contract

The `Notes` contract represents a note attached to a fact find entity using a unified discriminator pattern.

**Reference Type:** Notes is a reference type with identity (has `id` field).

**Key Features:**
- Unified discriminator pattern for all note types
- Supports 10+ note discriminators
- Rich text content support
- Attachment linking
- Visibility control

#### Complete Notes Contract

```json
{
  "id": 888,
  "href": "/api/v2/factfinds/679/notes/888",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "noteDiscriminator": "ASSET_NOTES",
  "entity": {
    "type": "Asset",
    "id": 1234,
    "href": "/api/v2/factfinds/679/clients/346/assets/1234"
  },
  "subject": "Property Valuation Discussion",
  "content": "Discussed recent property valuation with client. Market conditions favorable for sale in 2027.",
  "contentType": "text/plain",
  "isVisibleToClient": false,
  "isSystemGenerated": false,
  "createdBy": {
    "id": 789,
    "name": "Sarah Johnson"
  },
  "attachments": [
    {
      "id": 111,
      "filename": "valuation_report.pdf",
      "mimeType": "application/pdf",
      "sizeBytes": 524288,
      "href": "/api/v2/factfinds/679/notes/888/attachments/att-111"
    }
  ],
  "createdAt": "2026-02-10T14:00:00Z",
  "updatedAt": "2026-02-10T14:00:00Z"
}
```

#### Field Definitions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned note identifier |
| `href` | string | read-only | Canonical URI for this note |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `noteDiscriminator.code` | enum | required-on-create | Note type discriminator code |
| `noteDiscriminator.display` | string | read-only | Note type display |
| `entityRef` | EntityRef | optional | Reference to related entity |
| `subject` | string | required-on-create | Note subject/title (max 200 chars) |
| `content` | string | required-on-create | Note content (max 10000 chars) |
| `contentType` | string | optional | Content MIME type (default: text/plain) |
| `isVisibleToClient` | boolean | optional | Visible in client portal (default: false) |
| `isSystemGenerated` | boolean | read-only | Generated by system (default: false) |
| `createdBy` | UserRef | read-only | User who created the note |
| `attachments[]` | array | read-only | Attached files |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Note Discriminator Codes

| Code | Display Name | Description |
|------|-------------|-------------|
| `ASSET_NOTES` | Asset Notes | Notes about assets |
| `LIABILITY_NOTES` | Liability Notes | Notes about liabilities |
| `INCOME_NOTES` | Income Notes | Notes about income |
| `EXPENDITURE_NOTES` | Expenditure Notes | Notes about expenditure |
| `EMPLOYMENT_NOTES` | Employment Notes | Notes about employment |
| `ARRANGEMENT_NOTES` | Arrangement Notes | Notes about arrangements |
| `GOAL_NOTES` | Goal Notes | Notes about goals |
| `RISK_NOTES` | Risk Assessment Notes | Notes about risk assessment |
| `GENERAL_NOTES` | General Notes | General fact find notes |
| `MEETING_NOTES` | Meeting Notes | Meeting minutes/notes |

---

### 14.27 Dependant Contract

The `Dependant` contract represents a dependent family member of one or more clients.

**Reference Type:** Dependant is a reference type with identity (has `id` field).

**Key Features:**
- Dependent demographics
- Multiple client relationships (e.g., child of both parents)
- Financial dependency tracking
- Education and care needs
- Relationship to clients
- Age and duration calculations

#### Complete Dependant Contract

```json
{
  "id": 999,
  "href": "/api/v2/factfinds/679/dependants/999",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "clients": [
    {
      "id": 123,
      "href": "/api/v2/factfinds/679/clients/123"
    },
    {
      "id": 124,
      "href": "/api/v2/factfinds/679/clients/124"
    }
  ],
  "firstName": "Emily",
  "middleNames": "Rose",
  "lastName": "Smith",
  "fullName": "Emily Rose Smith",
  "dateOfBirth": "2015-08-20",
  "age": 10,
  "gender": "F",
  "relationship": "CHILD",
  "isFinanciallyDependent": true,
  "dependencyDetails": {
    "estimatedDependencyEndAge": 21,
    "estimatedDependencyEndDate": "2036-08-20",
    "monthlyCost": {
      "amount": 800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "annualCost": {
      "amount": 9600.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "educationDetails": {
    "currentEducationLevel": "Primary School",
    "isInPrivateEducation": false,
    "plannedHigherEducation": true,
    "estimatedEducationCosts": {
      "amount": 50000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "healthDetails": {
    "hasSpecialNeeds": false,
    "requiresOngoingCare": false,
    "healthNotes": null
  },
  "livingArrangements": {
    "livesWithClient": true,
    "custodyArrangement": "Full Custody"
  },
  "notes": "Plans to attend university - considering STEM subjects. Child of both John and Sarah Smith.",
  "createdAt": "2026-01-05T10:00:00Z",
  "updatedAt": "2026-02-01T09:30:00Z"
}
```

#### Field Definitions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned dependant identifier |
| `href` | string | read-only | Canonical URI for this dependant |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `clients[]` | array | required-on-create | Array of client references (min 1, supports multiple parents) |
| `clients[].id` | integer | required | Client identifier |
| `clients[].href` | string | read-only | Client URI |
| `firstName` | string | required-on-create | First name (max 100 chars) |
| `middleNames` | string | optional | Middle names (max 200 chars) |
| `lastName` | string | required-on-create | Last name (max 100 chars) |
| `fullName` | string | read-only | Calculated full name |
| `dateOfBirth` | date | required-on-create | Date of birth |
| `age` | integer | read-only | Calculated age |
| `gender.code` | enum | optional | Gender code (M, F, O, X) |
| `gender.display` | string | read-only | Gender display |
| `relationship.code` | enum | required-on-create | Relationship type code |
| `relationship.display` | string | read-only | Relationship type display |
| `isFinanciallyDependent` | boolean | optional | Financially dependent (default: true) |
| `dependencyDetails` | DependencyValue | optional | Financial dependency details |
| `educationDetails` | EducationValue | optional | Education information |
| `healthDetails` | HealthValue | optional | Health and care needs |
| `livingArrangements` | LivingArrangementsValue | optional | Living situation |
| `notes` | string | optional | Additional notes (max 2000 chars) |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Relationship Type Codes

| Code | Display Name |
|------|-------------|
| `CHILD` | Child |
| `STEP_CHILD` | Step Child |
| `ADOPTED_CHILD` | Adopted Child |
| `FOSTER_CHILD` | Foster Child |
| `GRANDCHILD` | Grandchild |
| `PARENT` | Parent |
| `SIBLING` | Sibling |
| `OTHER_RELATIVE` | Other Relative |
| `NON_RELATIVE` | Non-Relative |

---

### 14.28 Income Changes Contract

The `IncomeChanges` contract represents anticipated changes to a client's income, used for affordability and cash flow planning.

**Reference Type:** IncomeChanges is a reference type with identity (has `id` field).

**Key Features:**
- Future income change tracking
- Effective date planning
- Income increase/decrease modeling
- Links to income sources
- Affordability impact assessment

#### Complete Income Changes Contract

```json
{
  "id": 345,
  "href": "/api/v2/factfinds/679/clients/346/income-changes/345",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "income": {
    "id": 890,
    "href": "/api/v2/factfinds/679/clients/346/income/890"
  },
  "changeType": "INCREASE",
  "description": "Salary increase following promotion to Senior Engineer",
  "currentAmount": {
    "amount": 75000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "newAmount": {
    "amount": 85000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "changeAmount": {
    "amount": 10000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "changePercentage": 13.33,
  "effectiveDate": "2026-04-01",
  "isConfirmed": true,
  "confidenceLevel": "HIGH",
  "impactOnAffordability": {
    "monthlyImpact": {
      "amount": 625.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "improvedAffordability": true
  },
  "notes": "Promotion confirmed by employer - effective from April",
  "createdAt": "2026-02-15T10:00:00Z",
  "updatedAt": "2026-02-15T10:00:00Z"
}
```

#### Field Definitions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned income change identifier |
| `href` | string | read-only | Canonical URI for this income change |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `client` | ClientRef | read-only | Reference to client |
| `income` | IncomeRef | optional | Reference to existing income source |
| `changeType.code` | enum | required-on-create | Change type code (INCREASE, DECREASE, NEW, CEASE) |
| `changeType.display` | string | read-only | Human-readable change type |
| `description` | string | required-on-create | Description of income change (max 500 chars) |
| `currentAmount` | MoneyValue | optional | Current income amount |
| `newAmount` | MoneyValue | required-on-create | New/expected income amount |
| `changeAmount` | MoneyValue | read-only | Calculated change amount |
| `changePercentage` | decimal | read-only | Calculated percentage change |
| `effectiveDate` | date | required-on-create | Date change takes effect |
| `isConfirmed` | boolean | optional | Change is confirmed (default: false) |
| `confidenceLevel.code` | enum | optional | Confidence in change occurring |
| `confidenceLevel.display` | string | read-only | Human-readable confidence level |
| `impactOnAffordability` | AffordabilityImpactValue | read-only | Calculated affordability impact |
| `notes` | string | optional | Additional notes (max 2000 chars) |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Change Type Codes

| Code | Display Name |
|------|-------------|
| `INCREASE` | Income Increase |
| `DECREASE` | Income Decrease |
| `NEW` | New Income Source |
| `CEASE` | Income Will Cease |

#### Confidence Level Codes

| Code | Display Name |
|------|-------------|
| `HIGH` | High Confidence |
| `MEDIUM` | Medium Confidence |
| `LOW` | Low Confidence |
| `SPECULATIVE` | Speculative |

---

### 14.29 Expenditure Changes Contract

The `ExpenditureChanges` contract represents anticipated changes to a client's expenditure, used for affordability and cash flow planning.

**Reference Type:** ExpenditureChanges is a reference type with identity (has `id` field).

**Key Features:**
- Future expenditure change tracking
- Effective date planning
- Increase/decrease modeling
- Links to expense sources
- Affordability impact assessment

#### Complete Expenditure Changes Contract

```json
{
  "id": 456,
  "href": "/api/v2/factfinds/679/clients/346/expenditure-changes/456",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "expenseRef": {
    "id": 1001,
    "href": "/api/v2/factfinds/679/clients/346/expenditure/667/expenses/1001"
  },
  "changeType": "CEASE",
  "description": "Mortgage will be paid off",
  "currentAmount": {
    "amount": 1200.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "newAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "changeAmount": {
    "amount": -1200.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "changePercentage": -100.0,
  "effectiveDate": "2027-06-01",
  "isConfirmed": true,
  "confidenceLevel": "HIGH",
  "impactOnAffordability": {
    "monthlyImpact": {
      "amount": 1200.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "improvedAffordability": true
  },
  "notes": "Mortgage term ends June 2027 - confirmed with lender",
  "createdAt": "2026-02-18T11:00:00Z",
  "updatedAt": "2026-02-18T11:00:00Z"
}
```

#### Field Definitions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned expenditure change identifier |
| `href` | string | read-only | Canonical URI for this expenditure change |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `client` | ClientRef | read-only | Reference to client |
| `expenseRef` | ExpenseRef | optional | Reference to existing expense |
| `changeType.code` | enum | required-on-create | Change type code (INCREASE, DECREASE, NEW, CEASE) |
| `changeType.display` | string | read-only | Human-readable change type |
| `description` | string | required-on-create | Description of expenditure change (max 500 chars) |
| `currentAmount` | MoneyValue | optional | Current expenditure amount |
| `newAmount` | MoneyValue | required-on-create | New/expected expenditure amount |
| `changeAmount` | MoneyValue | read-only | Calculated change amount |
| `changePercentage` | decimal | read-only | Calculated percentage change |
| `effectiveDate` | date | required-on-create | Date change takes effect |
| `isConfirmed` | boolean | optional | Change is confirmed (default: false) |
| `confidenceLevel.code` | enum | optional | Confidence in change occurring |
| `confidenceLevel.display` | string | read-only | Human-readable confidence level |
| `impactOnAffordability` | AffordabilityImpactValue | read-only | Calculated affordability impact |
| `notes` | string | optional | Additional notes (max 2000 chars) |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

---

### 14.30 Affordability

The `AffordabilityAssessment` contract represents a mortgage affordability calculation with stress testing and regulatory compliance checks.

**Reference Type:** AffordabilityAssessment is a reference type with identity (has `id` field).

**Key Features:**
- Income and expenditure analysis
- Debt-to-income ratio calculations
- Stress testing at higher interest rates
- Regulatory compliance (FCA guidelines)
- Multiple scenario modeling
- Surplus income calculations

#### Complete Affordability Contract

```json
{
  "id": 1111,
  "href": "/api/v2/factfinds/679/affordability-assessments/1111",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "assessmentDate": "2026-02-19",
  "assessmentType": "MORTGAGE_AFFORDABILITY",
  "clients": [
    {
      "client": {
        "id": 123,
        "href": "/api/v2/factfinds/679/clients/123"
      }
    },
    {
      "client": {
        "id": 124,
        "href": "/api/v2/factfinds/679/clients/124"
      }
    }
  ],
  "incomeAnalysis": {
    "totalGrossIncome": {
      "amount": 95000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalNetIncome": {
      "amount": 68000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "monthlyGrossIncome": {
      "amount": 7916.67,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "monthlyNetIncome": {
      "amount": 5666.67,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "includedIncomeSources": [
      {
        "id": 890,
        "category": "Employment Income",
        "amount": {
          "amount": 75000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      },
      {
        "id": 891,
        "category": "Employment Income",
        "amount": {
          "amount": 20000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      }
    ]
  },
  "expenditureAnalysis": {
    "totalMonthlyExpenditure": {
      "amount": 3250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "essentialExpenditure": {
      "amount": 2800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "discretionaryExpenditure": {
      "amount": 450.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "existingCreditCommitments": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "proposedMortgage": {
    "loanAmount": {
      "amount": 350000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "interestRate": 4.5,
    "termYears": 25,
    "monthlyPayment": {
      "amount": 1945.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "repaymentType": "Capital and Interest"
  },
  "affordabilityCalculations": {
    "surplusIncome": {
      "amount": 1471.67,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "debtToIncomeRatio": 37.5,
    "loanToIncomeMultiple": 3.68,
    "affordabilityRatio": 24.56,
    "isAffordable": true
  },
  "stressTesting": {
    "stressTestRate": 7.0,
    "stressedMonthlyPayment": {
      "amount": 2475.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "stressedSurplusIncome": {
      "amount": 941.67,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "passesStressTest": true
  },
  "regulatoryCompliance": {
    "fcaAffordabilityChecks": true,
    "responsibleLendingCriteria": true,
    "vulnerableCustomerConsiderations": false
  },
  "recommendation": {
    "isAffordable": true,
    "maxAffordableLoan": {
      "amount": 375000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "notes": "Clients demonstrate strong affordability with comfortable surplus income even under stress testing"
  },
  "createdAt": "2026-02-19T14:30:00Z",
  "updatedAt": "2026-02-19T14:30:00Z"
}
```

#### Field Definitions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned assessment identifier |
| `href` | string | read-only | Canonical URI for this assessment |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `assessmentDate` | date | required-on-create | Date of assessment |
| `assessmentType.code` | enum | required-on-create | Assessment type code |
| `assessmentType.display` | string | read-only | Human-readable assessment type |
| `clients[]` | array | required-on-create | Clients included in assessment |
| `incomeAnalysis` | IncomeAnalysisValue | required-on-create | Income breakdown and totals |
| `expenditureAnalysis` | ExpenditureAnalysisValue | required-on-create | Expenditure breakdown |
| `proposedMortgage` | ProposedMortgageValue | required-on-create | Proposed mortgage details |
| `affordabilityCalculations` | AffordabilityCalcsValue | read-only | Calculated affordability metrics |
| `stressTesting` | StressTestValue | read-only | Stress test results |
| `regulatoryCompliance` | RegulatoryComplianceValue | read-only | Compliance checks |
| `recommendation` | RecommendationValue | optional | Assessment recommendation |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

---

### 14.31 Contact Contract

The `Contact` contract represents a contact method (email, phone, mobile, work phone, website) for a client.

**Reference Type:** Contact is a reference type with identity (has `id` field).

**Key Features:**
- Multiple contact types (Email, Phone, Mobile, Work, Website)
- Preferred contact designation
- Contact validation status
- Opt-in/opt-out preferences
- Marketing consent tracking

#### Complete Contact Contract

```json
{
  "id": 2222,
  "href": "/api/v2/factfinds/679/clients/123/contacts/2222",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "contactType": "EMAIL",
  "value": "john.smith@example.com",
  "isPrimary": true,
  "isPreferred": true,
  "isVerified": true,
  "verifiedDate": "2026-01-15",
  "isValidForMarketing": true,
  "marketingOptIn": true,
  "notes": "Primary email for all communications",
  "createdAt": "2026-01-05T10:00:00Z",
  "updatedAt": "2026-01-15T09:30:00Z"
}
```

#### Field Definitions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned contact identifier |
| `href` | string | read-only | Canonical URI for this contact |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `client` | ClientRef | read-only | Reference to client |
| `contactType.code` | enum | required-on-create | Contact type code |
| `contactType.display` | string | read-only | Human-readable contact type |
| `value` | string | required-on-create | Contact value (email, phone number, URL) |
| `isPrimary` | boolean | optional | Primary contact of this type (default: false) |
| `isPreferred` | boolean | optional | Preferred contact method (default: false) |
| `isVerified` | boolean | optional | Contact has been verified (default: false) |
| `verifiedDate` | date | optional | Date contact was verified |
| `isValidForMarketing` | boolean | optional | Valid for marketing use (default: false) |
| `marketingOptIn` | boolean | optional | Opted in to marketing (default: false) |
| `notes` | string | optional | Additional notes (max 1000 chars) |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Contact Type Codes

| Code | Display Name |
|------|-------------|
| `EMAIL` | Email |
| `PHONE` | Phone |
| `MOBILE` | Mobile |
| `WORK_PHONE` | Work Phone |
| `WEBSITE` | Website |
| `FAX` | Fax |

---

### 14.32 Attitude to Risk (ATR) Contract

The `AttitudeToRisk` contract represents a client's risk tolerance assessment, typically completed via questionnaire for investment and pension advice.

**Reference Type:** AttitudeToRisk is a reference type with identity (has `id` field).

**Key Features:**
- Standardized risk questionnaire responses
- Risk profile categorization (1-10 scale or Conservative/Balanced/Adventurous)
- Investment capacity for loss
- Time horizon consideration
- Knowledge and experience assessment
- Regulatory compliance (FCA suitability requirements)

#### Complete ATR Contract

```json
{
  "id": 3333,
  "href": "/api/v2/factfinds/679/clients/123/attitude-to-risk/3333",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "assessmentDate": "2026-02-10",
  "assessmentMethod": "QUESTIONNAIRE",
  "questionnaireUsed": "FinaMetrica Risk Profile",
  "riskScore": 65,
  "riskProfile": "BALANCED",
  "riskLevel": 6,
  "investmentObjective": "GROWTH",
  "timeHorizon": {
    "years": 15,
    "category": "Long Term"
  },
  "capacityForLoss": "MEDIUM",
  "knowledgeAndExperience": {
    "investmentKnowledge": "GOOD",
    "investmentExperience": "MODERATE",
    "productsHeld": [
      "Stocks and Shares ISA",
      "Workplace Pension",
      "Investment Bonds"
    ]
  },
  "volatilityTolerance": {
    "maxAcceptableLoss": 20,
    "reactionToLosses": "Would review strategy but remain invested",
    "comfortWithFluctuation": "Moderate"
  },
  "recommendedAssetAllocation": {
    "equities": 60,
    "bonds": 30,
    "cash": 5,
    "alternatives": 5
  },
  "isValid": true,
  "validUntil": "2027-02-10",
  "reviewRequired": false,
  "notes": "Client comfortable with balanced risk/return profile. Has good understanding of investment principles.",
  "createdAt": "2026-02-10T11:00:00Z",
  "updatedAt": "2026-02-10T11:00:00Z"
}
```

#### Field Definitions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | read-only | System-assigned ATR identifier |
| `href` | string | read-only | Canonical URI for this ATR |
| `factfind` | FactfindRef | read-only | Reference to parent fact find |
| `client` | ClientRef | read-only | Reference to client |
| `assessmentDate` | date | required-on-create | Date assessment was completed |
| `assessmentMethod.code` | enum | required-on-create | Assessment method code |
| `assessmentMethod.display` | string | read-only | Human-readable assessment method |
| `questionnaireUsed` | string | optional | Name of questionnaire tool (max 200 chars) |
| `riskScore` | integer | optional | Numerical risk score (0-100) |
| `riskProfile.code` | enum | required-on-create | Risk profile code |
| `riskProfile.display` | string | read-only | Human-readable risk profile |
| `riskLevel` | integer | optional | Risk level (1-10 scale) |
| `investmentObjective.code` | enum | optional | Investment objective code |
| `investmentObjective.display` | string | read-only | Human-readable objective |
| `timeHorizon` | TimeHorizonValue | optional | Investment time horizon |
| `capacityForLoss.code` | enum | required-on-create | Capacity for loss code |
| `capacityForLoss.display` | string | read-only | Human-readable capacity |
| `knowledgeAndExperience` | KnowledgeValue | optional | Knowledge and experience details |
| `volatilityTolerance` | VolatilityToleranceValue | optional | Tolerance for volatility |
| `recommendedAssetAllocation` | AssetAllocationValue | optional | Recommended asset mix percentages |
| `isValid` | boolean | optional | Assessment is currently valid (default: true) |
| `validUntil` | date | optional | Date assessment expires |
| `reviewRequired` | boolean | optional | Assessment needs review (default: false) |
| `notes` | string | optional | Additional notes (max 2000 chars) |
| `createdAt` | datetime | read-only | ISO 8601 timestamp of creation |
| `updatedAt` | datetime | read-only | ISO 8601 timestamp of last update |

#### Risk Profile Codes

| Code | Display Name | Risk Level |
|------|-------------|------------|
| `VERY_CAUTIOUS` | Very Cautious | 1-2 |
| `CAUTIOUS` | Cautious | 3-4 |
| `BALANCED` | Balanced | 5-6 |
| `ADVENTUROUS` | Adventurous | 7-8 |
| `VERY_ADVENTUROUS` | Very Adventurous | 9-10 |

#### Investment Objective Codes

| Code | Display Name |
|------|-------------|
| `CAPITAL_PRESERVATION` | Capital Preservation |
| `INCOME` | Income Generation |
| `INCOME_AND_GROWTH` | Income and Growth |
| `GROWTH` | Growth |
| `AGGRESSIVE_GROWTH` | Aggressive Growth |

---

### 14.33 Professional Contact Contract

The `ProfessionalContact` contract represents a client's professional adviser (solicitor, accountant, IFA, mortgage broker, etc.).

**Reference Type:** ProfessionalContact is a reference type with identity (has `id` field).

**Key Features:**
- Multiple professional types
- Contact information
- Firm/organization details
- Relationship tracking
- Referral source designation

#### Complete Professional Contact Contract

```json
{
  "id": 4444,
  "href": "/api/v2/factfinds/679/clients/123/professional-contacts/4444",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "professionalType": "SOLICITOR",
  "title": "Mr",
  "firstName": "David",
  "lastName": "Williams",
  "fullName": "Mr David Williams",
  "jobTitle": "Partner",
  "firmName": "Williams & Associates Solicitors",
  "email": "david.williams@wandassoc.co.uk",
  "phone": "020 7123 4567",
  "mobile": "07700 900123",
  "address": {
    "line1": "45 Legal Square",
    "line2": "Suite 300",
    "city": "London",
    "postcode": "EC4A 1BR",
    "country": "GB"
  },
  "website": "www.wandassoc.co.uk",
  "isReferralSource": false,
  "canContactDirectly": true,
  "relationshipNotes": "Client's solicitor for 10+ years - handles all legal matters including will and LPA",
  "createdAt": "2026-01-10T09:00:00Z",
  "updatedAt": "2026-01-10T09:00:00Z"
}
```

#### Professional Type Codes

| Code | Display Name |
|------|-------------|
| `SOLICITOR` | Solicitor |
| `ACCOUNTANT` | Accountant |
| `FINANCIAL_ADVISER` | Financial Adviser |
| `MORTGAGE_BROKER` | Mortgage Broker |
| `ESTATE_AGENT` | Estate Agent |
| `INVESTMENT_MANAGER` | Investment Manager |
| `TAX_ADVISER` | Tax Adviser |
| `PENSION_ADVISER` | Pension Adviser |
| `OTHER` | Other Professional |

---

### 14.34 Vulnerability Contract

The `Vulnerability` contract represents a client vulnerability indicator for Consumer Duty compliance.

**Reference Type:** Vulnerability is a reference type with identity (has `id` field).

**Key Features:**
- Multiple vulnerability categories (Health, Life Events, Resilience, Capability)
- FCA Consumer Duty compliance
- Specific vulnerability indicators
- Impact assessment
- Support needs identification
- Regular review tracking

#### Complete Vulnerability Contract

```json
{
  "id": 5555,
  "href": "/api/v2/factfinds/679/clients/123/vulnerabilities/5555",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "hasVulnerabilities": true,
  "identifiedDate": "2026-01-15",
  "vulnerabilityCategories": [
    {
      "category": "HEALTH",
      "indicators": [
        {
          "code": "PHYSICAL_DISABILITY",
          "display": "Physical Disability",
          "description": "Client has limited mobility - uses wheelchair"
        }
      ],
      "impactLevel": "MODERATE",
      "supportNeeds": [
        "Home visits preferred",
        "Accessible venue for meetings",
        "Additional time for discussions"
      ]
    },
    {
      "category": "CAPABILITY",
      "indicators": [
        {
          "code": "LOW_FINANCIAL_LITERACY",
          "display": "Low Financial Literacy",
          "description": "Client has limited understanding of financial products"
        }
      ],
      "impactLevel": "MODERATE",
      "supportNeeds": [
        "Use plain language",
        "Provide written summaries",
        "Allow extra time for explanations"
      ]
    }
  ],
  "reasonableAdjustments": [
    "Home visits arranged",
    "Extra time allowed for meetings",
    "Partner invited to attend meetings for support",
    "All documents provided in large print"
  ],
  "consumerDutyCompliance": {
    "needsIdentified": true,
    "adjustmentsMade": true,
    "communicationTailored": true,
    "ongoingMonitoring": true
  },
  "reviewDate": "2026-07-15",
  "isReviewRequired": false,
  "notes": "Client appreciates extra care taken. Partner very supportive and usually attends meetings.",
  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-01-15T10:00:00Z"
}
```

#### Vulnerability Category Codes

| Code | Display Name |
|------|-------------|
| `HEALTH` | Health (physical, mental health, illness, disability) |
| `LIFE_EVENTS` | Life Events (bereavement, relationship breakdown, caring responsibilities) |
| `RESILIENCE` | Resilience (low income, debt, unemployment) |
| `CAPABILITY` | Capability (low literacy, financial inexperience, learning difficulties) |

#### Health Vulnerability Indicators

| Code | Display Name |
|------|-------------|
| `PHYSICAL_DISABILITY` | Physical Disability |
| `MENTAL_HEALTH` | Mental Health Condition |
| `LEARNING_DISABILITY` | Learning Disability |
| `HEARING_IMPAIRMENT` | Hearing Impairment |
| `VISUAL_IMPAIRMENT` | Visual Impairment |
| `CHRONIC_ILLNESS` | Chronic Illness |
| `DEMENTIA` | Dementia/Cognitive Impairment |

---

### 14.35 Marketing Preferences Contract

The `MarketingPreferences` contract represents a client's marketing consent and communication preferences.

**Reference Type:** MarketingPreferences is a reference type with identity (has `id` field).

**Key Features:**
- GDPR-compliant consent tracking
- Channel-specific preferences (email, phone, post, SMS)
- Product/service interest categories
- Consent date and source tracking
- Opt-out management
- Third-party marketing consent

#### Complete Marketing Preferences Contract

```json
{
  "id": 6666,
  "href": "/api/v2/factfinds/679/clients/123/marketing-preferences/6666",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "lastUpdated": "2026-01-15",
  "overallConsent": true,
  "channelPreferences": {
    "email": {
      "optIn": true,
      "consentDate": "2026-01-15",
      "consentMethod": "Online Form"
    },
    "phone": {
      "optIn": false,
      "consentDate": null,
      "consentMethod": null
    },
    "post": {
      "optIn": true,
      "consentDate": "2026-01-15",
      "consentMethod": "Written Consent"
    },
    "sms": {
      "optIn": false,
      "consentDate": null,
      "consentMethod": null
    }
  },
  "productInterests": [
    {
      "category": "Pensions",
      "interestedIn": true
    },
    {
      "category": "Investments",
      "interestedIn": true
    },
    {
      "category": "Mortgages",
      "interestedIn": false
    },
    {
      "category": "Protection",
      "interestedIn": true
    }
  ],
  "thirdPartyMarketing": {
    "optIn": false,
    "consentDate": null
  },
  "suppressionList": false,
  "dataRetentionConsent": true,
  "privacyNoticeVersion": "2.1",
  "privacyNoticeAcceptedDate": "2026-01-15",
  "notes": "Client prefers email contact for newsletters and updates",
  "createdAt": "2026-01-15T10:00:00Z",
  "updatedAt": "2026-01-15T10:00:00Z"
}
```

---

### 14.36 Estate Planning - Will Contract

The `Will` contract represents a client's last will and testament details.

**Reference Type:** Will is a reference type with identity (has `id` field).

**Key Features:**
- Will existence and validity tracking
- Executor information
- Location of will documents
- Review dates and update requirements
- Mirror will designation for couples

#### Complete Will Contract

```json
{
  "id": 7777,
  "href": "/api/v2/factfinds/679/clients/123/estate-planning/wills/7777",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "hasWill": true,
  "willDate": "2023-06-15",
  "lastReviewedDate": "2025-12-10",
  "nextReviewDate": "2026-12-10",
  "willType": "MIRROR_WILL",
  "isMirrorWill": true,
  "mirrorWillClientRef": {
    "id": 124,
    "href": "/api/v2/factfinds/679/clients/124"
  },
  "executors": [
    {
      "name": "Sarah Smith",
      "relationship": "Spouse",
      "contactDetails": {
        "email": "sarah.smith@example.com",
        "phone": "07700 900456"
      },
      "isProfessionalExecutor": false
    },
    {
      "name": "Williams & Associates Solicitors",
      "relationship": "Professional Executor",
      "contactDetails": {
        "email": "executors@wandassoc.co.uk",
        "phone": "020 7123 4567"
      },
      "isProfessionalExecutor": true
    }
  ],
  "mainBeneficiaries": [
    "Spouse (Sarah Smith)",
    "Children (Emily and Thomas Smith)"
  ],
  "hasResidenceNilRateBand": true,
  "willLocation": {
    "heldBy": "Williams & Associates Solicitors",
    "address": "45 Legal Square, London, EC4A 1BR",
    "notes": "Original will held by solicitor - copy at home"
  },
  "needsUpdate": false,
  "updateReason": null,
  "notes": "Will reviewed in December 2025 - no changes required. Mirror will arrangement with spouse.",
  "createdAt": "2026-01-10T10:00:00Z",
  "updatedAt": "2026-02-10T09:00:00Z"
}
```

#### Will Type Codes

| Code | Display Name |
|------|-------------|
| `STANDARD_WILL` | Standard Will |
| `MIRROR_WILL` | Mirror Will |
| `PROPERTY_TRUST_WILL` | Property Trust Will |
| `DISCRETIONARY_TRUST_WILL` | Discretionary Trust Will |
| `LIFE_INTEREST_TRUST_WILL` | Life Interest Trust Will |

---

### 14.37 Estate Planning - Lasting Power of Attorney (LPA) Contract

The `LastingPowerOfAttorney` contract represents a client's LPA arrangements.

**Reference Type:** LastingPowerOfAttorney is a reference type with identity (has `id` field).

**Key Features:**
- Multiple LPA types (Property & Financial Affairs, Health & Welfare)
- Attorney details and restrictions
- Registration status tracking
- Location of LPA documents

#### Complete LPA Contract

```json
{
  "id": 8888,
  "href": "/api/v2/factfinds/679/clients/123/estate-planning/lpas/8888",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "hasLPA": true,
  "lpaType": "PROPERTY_FINANCIAL",
  "registrationDate": "2023-09-20",
  "isRegistered": true,
  "registrationNumber": "LPA-2023-987654",
  "attorneys": [
    {
      "name": "Sarah Smith",
      "relationship": "Spouse",
      "contactDetails": {
        "email": "sarah.smith@example.com",
        "phone": "07700 900456"
      },
      "appointmentType": "JOINTLY_AND_SEVERALLY",
      "isPrimary": true
    },
    {
      "name": "Emily Smith",
      "relationship": "Daughter",
      "contactDetails": {
        "email": "emily.smith@example.com",
        "phone": "07700 900789"
      },
      "appointmentType": "REPLACEMENT",
      "isPrimary": false
    }
  ],
  "restrictions": "Attorney must consult with family before selling primary residence",
  "guidance": "Preference to remain at home as long as possible",
  "certificateProvider": {
    "name": "Dr. Michael Brown",
    "relationship": "GP",
    "contactDetails": {
      "phone": "020 7456 7890"
    }
  },
  "lpaLocation": {
    "heldBy": "Home Safe",
    "notes": "Original registered LPA stored in home safe. Copy with solicitor."
  },
  "needsUpdate": false,
  "notes": "Property and Financial Affairs LPA registered with Office of Public Guardian. Health and Welfare LPA also in place (separate record).",
  "createdAt": "2023-09-25T10:00:00Z",
  "updatedAt": "2026-01-15T09:00:00Z"
}
```

#### LPA Type Codes

| Code | Display Name |
|------|-------------|
| `PROPERTY_FINANCIAL` | Property and Financial Affairs |
| `HEALTH_WELFARE` | Health and Welfare |

#### Attorney Appointment Type Codes

| Code | Display Name |
|------|-------------|
| `JOINTLY` | Jointly |
| `JOINTLY_AND_SEVERALLY` | Jointly and Severally |
| `JOINTLY_FOR_SOME_SEVERALLY_FOR_OTHERS` | Jointly for Some, Severally for Others |
| `REPLACEMENT` | Replacement Attorney |

---

### 14.38 Estate Planning - Gift Contract

The `Gift` contract represents gifts made or planned by the client for inheritance tax planning.

**Reference Type:** Gift is a reference type with identity (has `id` field).

**Key Features:**
- Gift tracking for IHT purposes
- 7-year taper relief consideration
- Potentially Exempt Transfer (PET) status
- Regular gifts out of income exemption
- Gift valuation and recipient tracking

#### Complete Gift Contract

```json
{
  "id": 9999,
  "href": "/api/v2/factfinds/679/clients/123/estate-planning/gifts/9999",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "giftDate": "2024-12-25",
  "giftType": "POTENTIALLY_EXEMPT_TRANSFER",
  "recipient": {
    "name": "Emily Smith",
    "relationship": "Daughter",
    "dateOfBirth": "1995-03-15"
  },
  "giftValue": {
    "amount": 25000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "giftDescription": "Cash gift to help with house deposit",
  "isRegularGift": false,
  "isOutOfIncome": false,
  "exemptionsClaimed": [
    {
      "exemptionType": "ANNUAL_EXEMPTION",
      "exemptionAmount": {
        "amount": 3000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "taxYear": "2024/25"
    }
  ],
  "potentiallyExemptTransfer": {
    "isPET": true,
    "sevenYearAnniversary": "2031-12-25",
    "yearsRemaining": 5.85,
    "taperRelief": {
      "applicableRate": 100,
      "reliefAmount": 0
    }
  },
  "ihtImplications": {
    "includedInEstate": true,
    "currentTaxableAmount": {
      "amount": 22000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "notes": "Gift to daughter for house purchase. Annual exemption of £3,000 applied. Balance of £22,000 is PET.",
  "createdAt": "2024-12-26T10:00:00Z",
  "updatedAt": "2026-02-15T09:00:00Z"
}
```

#### Gift Type Codes

| Code | Display Name |
|------|-------------|
| `POTENTIALLY_EXEMPT_TRANSFER` | Potentially Exempt Transfer (PET) |
| `CHARGEABLE_LIFETIME_TRANSFER` | Chargeable Lifetime Transfer (CLT) |
| `EXEMPT_TRANSFER` | Exempt Transfer |
| `REGULAR_GIFTS_OUT_OF_INCOME` | Regular Gifts Out of Income |
| `SMALL_GIFTS` | Small Gifts (£250 exemption) |

#### Exemption Type Codes

| Code | Display Name | Amount Limit |
|------|-------------|--------------|
| `ANNUAL_EXEMPTION` | Annual Exemption | £3,000 per year |
| `SMALL_GIFTS` | Small Gifts Exemption | £250 per recipient |
| `WEDDING_GIFTS` | Wedding Gifts | Varies by relationship |
| `NORMAL_EXPENDITURE_OUT_OF_INCOME` | Normal Expenditure Out of Income | No limit |
| `SPOUSE_EXEMPTION` | Spouse/Civil Partner Exemption | Unlimited |
| `CHARITY_EXEMPTION` | Charity Exemption | Unlimited |

---

### 14.39 Estate Planning - Trust Contract

The `Trust` contract represents trusts established by or benefiting the client.

**Reference Type:** Trust is a reference type with identity (has `id` field).

**Key Features:**
- Trust type classification
- Trustee and beneficiary tracking
- Asset valuation
- Tax treatment
- Trust deed location

#### Complete Trust Contract

```json
{
  "id": 10001,
  "href": "/api/v2/factfinds/679/clients/123/estate-planning/trusts/10001",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "trustName": "The Smith Family Discretionary Trust",
  "trustType": "DISCRETIONARY_TRUST",
  "establishedDate": "2020-03-15",
  "clientRole": "SETTLOR",
  "trustees": [
    {
      "name": "Sarah Smith",
      "relationship": "Spouse",
      "appointedDate": "2020-03-15",
      "isProfessionalTrustee": false
    },
    {
      "name": "David Williams",
      "relationship": "Solicitor",
      "appointedDate": "2020-03-15",
      "isProfessionalTrustee": true,
      "firm": "Williams & Associates Solicitors"
    }
  ],
  "beneficiaries": [
    {
      "name": "Emily Smith",
      "relationship": "Daughter",
      "beneficiaryClass": "Primary Beneficiary",
      "hasReceivedDistributions": true
    },
    {
      "name": "Thomas Smith",
      "relationship": "Son",
      "beneficiaryClass": "Primary Beneficiary",
      "hasReceivedDistributions": false
    }
  ],
  "trustAssets": {
    "currentValue": {
      "amount": 150000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "assetTypes": [
      "Cash",
      "Investment Portfolio"
    ],
    "lastValuationDate": "2026-01-31"
  },
  "taxTreatment": {
    "taxYear": "2025/26",
    "trustTaxRate": 45,
    "dividendTaxRate": 39.35,
    "lastTaxReturn": "2025-10-31",
    "nextTaxReturnDue": "2026-10-31"
  },
  "trustDeedLocation": {
    "heldBy": "Williams & Associates Solicitors",
    "address": "45 Legal Square, London, EC4A 1BR"
  },
  "lastReviewDate": "2025-06-15",
  "nextReviewDate": "2026-06-15",
  "notes": "Discretionary trust established for children's benefit. Funds from inheritance. Professional trustee manages investments.",
  "createdAt": "2020-03-20T10:00:00Z",
  "updatedAt": "2026-02-01T09:00:00Z"
}
```

#### Trust Type Codes

| Code | Display Name |
|------|-------------|
| `DISCRETIONARY_TRUST` | Discretionary Trust |
| `BARE_TRUST` | Bare Trust |
| `INTEREST_IN_POSSESSION_TRUST` | Interest in Possession Trust |
| `ACCUMULATION_AND_MAINTENANCE_TRUST` | Accumulation and Maintenance Trust |
| `DISABLED_PERSONS_TRUST` | Disabled Person's Trust |
| `BEREAVED_MINORS_TRUST` | Bereaved Minor's Trust |
| `ASSET_PROTECTION_TRUST` | Asset Protection Trust |

#### Client Role in Trust Codes

| Code | Display Name |
|------|-------------|
| `SETTLOR` | Settlor |
| `TRUSTEE` | Trustee |
| `BENEFICIARY` | Beneficiary |
| `SETTLOR_AND_TRUSTEE` | Settlor and Trustee |
| `SETTLOR_AND_BENEFICIARY` | Settlor and Beneficiary |

---

### 14.40 Identity Verification & Data Protection Consent Contract

The `IdentityVerification` contract represents identity verification checks and data protection consents.

**Reference Type:** IdentityVerification is a reference type with identity (has `id` field).

**Key Features:**
- KYC (Know Your Customer) compliance
- AML (Anti-Money Laundering) checks
- Identity document verification
- GDPR consent tracking
- Data processing agreements

#### Complete Identity Verification Contract

```json
{
  "id": 11111,
  "href": "/api/v2/factfinds/679/clients/123/identity-verification/11111",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "verificationDate": "2026-01-05",
  "verificationMethod": "ELECTRONIC_VERIFICATION",
  "verificationProvider": "Experian Identity Check",
  "verificationReference": "EXP-2026-123456",
  "verificationStatus": "VERIFIED",
  "identityDocuments": [
    {
      "documentType": "PASSPORT",
      "documentNumber": "123456789",
      "issuingCountry": "GB",
      "issueDate": "2021-06-15",
      "expiryDate": "2031-06-15",
      "isVerified": true,
      "verifiedDate": "2026-01-05"
    },
    {
      "documentType": "UTILITY_BILL",
      "documentDescription": "Council Tax Bill",
      "documentDate": "2025-12-15",
      "isVerified": true,
      "verifiedDate": "2026-01-05"
    }
  ],
  "amlChecks": {
    "sanctionsCheck": {
      "performed": true,
      "checkDate": "2026-01-05",
      "result": "Clear",
      "provider": "World-Check"
    },
    "pepCheck": {
      "performed": true,
      "checkDate": "2026-01-05",
      "isPoliticallyExposed": false,
      "result": "Clear"
    },
    "adverseMediaCheck": {
      "performed": true,
      "checkDate": "2026-01-05",
      "result": "Clear"
    }
  },
  "sourceOfWealth": {
    "primarySource": "EMPLOYMENT",
    "description": "Senior Software Engineer - employed for 15 years",
    "isVerified": true
  },
  "dataProtectionConsent": {
    "consentGiven": true,
    "consentDate": "2026-01-05",
    "consentMethod": "Electronic Signature",
    "privacyNoticeVersion": "2.1",
    "privacyNoticeProvided": true,
    "dataProcessingPurposes": [
      "Providing financial advice",
      "Regulatory compliance",
      "Customer service",
      "Marketing (opted in)"
    ],
    "rightToWithdrawConsent": true,
    "dataRetentionPeriod": "7 years from last contact",
    "thirdPartyDisclosure": {
      "consentGiven": true,
      "disclosureReasons": [
        "Product providers",
        "Regulatory bodies",
        "Professional indemnity insurers"
      ]
    }
  },
  "gdprRights": {
    "rightToAccess": true,
    "rightToRectification": true,
    "rightToErasure": true,
    "rightToRestriction": true,
    "rightToDataPortability": true,
    "rightToObject": true
  },
  "nextReviewDate": "2027-01-05",
  "notes": "Full identity verification completed via Experian. All AML checks clear. GDPR consents obtained.",
  "createdAt": "2026-01-05T10:00:00Z",
  "updatedAt": "2026-01-05T10:00:00Z"
}
```

#### Verification Method Codes

| Code | Display Name |
|------|-------------|
| `ELECTRONIC_VERIFICATION` | Electronic Verification |
| `FACE_TO_FACE` | Face-to-Face with Documents |
| `CERTIFIED_DOCUMENTS` | Certified Documents |
| `VIDEO_VERIFICATION` | Video Verification |

#### Document Type Codes

| Code | Display Name |
|------|-------------|
| `PASSPORT` | Passport |
| `DRIVING_LICENCE` | Driving Licence |
| `NATIONAL_ID_CARD` | National ID Card |
| `UTILITY_BILL` | Utility Bill |
| `BANK_STATEMENT` | Bank Statement |
| `COUNCIL_TAX_BILL` | Council Tax Bill |

#### Source of Wealth Codes

| Code | Display Name |
|------|-------------|
| `EMPLOYMENT` | Employment Income |
| `BUSINESS_INCOME` | Business Income |
| `INVESTMENTS` | Investments |
| `INHERITANCE` | Inheritance |
| `PROPERTY_SALE` | Property Sale |
| `PENSION` | Pension Income |
| `GIFT` | Gift |

---

### 14.41 Arrangement - Mortgage Contract

The `MortgageArrangement` contract represents mortgage and equity release secured lending products including traditional mortgages, lifetime mortgages, and home reversion plans. This unified contract uses a product type discriminator to handle both mortgage and equity release scenarios with industry-standard field grouping.

**Reference Type:** MortgageArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Unified contract for traditional mortgages and equity release products
- Product type discriminator (FixedRateMortgage, LifetimeMortgage, HomeReversionPlan, etc.)
- Industry-standard 14 field group structure
- Owner array supporting multiple ownership percentages
- Comprehensive interest rate and repayment structures
- Support for shared ownership and offset features

#### Complete Mortgage Arrangement Contract

```json
{
  "id": 5001,
  "href": "/api/v2/factfinds/679/arrangements/mortgages/5001",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "MORTGAGE",

  "accountNumber": "MTG-001234",
  "policyNumber": "POL-98765",
  "illustrationReference": "IOB-REF-123456",

  "owners": [
    {
      "id": 456,
      "href": "/api/v2/factfinds/679/clients/456",
      "ownershipPercentage": 100.00
    }
  ],
  "sellingAdviser": {
    "id": 123,
    "href": "/api/v2/advisers/123",
    "name": "John Adviser",
    "firmName": "ABC Mortgage Services"
  },
  "agencyStatus": "NotUnderAgency",
  "agencyStatusDate": "2023-02-06",

  "productType": "FixedRateMortgage",
  "lenderName": "National Bank plc",
  "productName": "Fixed Rate Mortgage Premium",
  "description": "Main residence mortgage - 25 year fixed",

  "loanAmounts": {
    "originalLoanAmount": {
      "amount": 250000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentBalance": {
      "amount": 235000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "depositAmount": {
      "amount": 132000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "equityReleased": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "originalPropertyValuation": {
      "amount": 382000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentPropertyValuation": {
      "amount": 385000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "loanToValueRatio": 65.50
  },

  "interestTerms": {
    "interestRate": 3.50,
    "annualPercentageRate": 3.75,
    "rateType": "Fixed",
    "baseRateIndex": "SONIA",
    "reversionRate": 4.25,
    "hasCollarRate": false,
    "collarRate": null,
    "initialRatePeriodEndsOn": "2028-02-06",
    "initialTermYears": 5,
    "initialTermMonths": 0,
    "remainingTermYears": 23,
    "remainingTermMonths": 6
  },

  "repaymentStructure": {
    "repaymentMethod": "CapitalAndInterest",
    "capitalRepaymentAmount": {
      "amount": 200000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "capitalTermYears": 25,
    "capitalTermMonths": 0,
    "interestOnlyAmount": {
      "amount": 50000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "interestOnlyTermYears": 10,
    "interestOnlyTermMonths": 0,
    "interestOnlyRepaymentVehicle": "ISA",
    "lumpSumAdvance": null,
    "monthlyIncomeDrawdown": null,
    "regularAnnualOverpayment": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentRepaymentVehicles": ["ISA", "Pension"]
  },

  "feesAndCharges": {
    "lenderFees": {
      "amount": 995.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "ongoingContributions": null
  },

  "keyDates": {
    "startDate": "2023-02-06",
    "endDate": "2048-02-06",
    "completionDate": "2023-02-06",
    "exchangeDate": "2023-01-27",
    "nextPaymentDueDate": "2026-03-06",
    "nextReviewDate": "2028-02-01",
    "balanceAsOfDate": "2026-02-10",
    "applicationSubmittedDate": "2023-01-20",
    "valuationInstructedDate": "2023-01-15",
    "valuationDate": "2023-01-22",
    "valuationReceivedDate": "2023-01-28",
    "offerIssuedDate": "2023-01-30",
    "targetCompletionDate": "2023-02-06",
    "schemeEndDate": null
  },

  "redemptionTerms": {
    "hasEarlyRepaymentCharge": true,
    "earlyRepaymentTerms": "No repayment for first 2 years, 3% penalty for years 2-5",
    "earlyRepaymentChargeEndsOn": "2028-02-06",
    "earlyRepaymentCharge": {
      "amount": 7500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "earlyRepaymentChargeSecondCharge": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netProceedsOnRedemption": {
      "amount": 227500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "specialFeatures": {
    "isFirstTimeBuyer": false,
    "isCurrentResidence": true,
    "hasGuarantor": false,
    "isPortable": true,
    "isPropertySold": false,
    "isRedeemed": false,
    "hasDischargeOnCompletion": true,
    "hasConsentToLet": false,
    "consentToLetExpiresOn": null,
    "hasDebtConsolidation": false,
    "incomeVerificationStatus": "Employed",
    "isIncomeEvidenced": true
  },

  "sharedOwnershipDetails": {
    "sharedEquitySchemeType": null,
    "sharedEquitySchemeProvider": null,
    "sharedEquityRepaymentStartsOn": null,
    "sharedEquityLoanPercentage": null,
    "sharedEquityLoanAmount": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "sharedOwnershipPercentageOwned": null,
    "sharedOwnershipHousingAssociation": null,
    "sharedOwnershipMonthlyRent": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "offsetFeatures": {
    "offsetLinkedAccountNumber": "OFFSET-123456",
    "offsetOptions": [
      "AccountOffset",
      "SavingsOffset",
      "CurrentAccountOffset"
    ]
  },

  "asset": {
    "id": 67890,
    "href": "/api/v2/factfinds/679/assets/67890"
  },
  "property": {
    "id": 12345,
    "href": "/api/v2/factfinds/679/properties/12345"
  },
  "propertyDetail": {
    "id": 5,
    "href": "/api/v2/factfinds/679/property-details/5"
  },
  "linkedArrangements": [
    {
      "id": 99999,
      "href": "/api/v2/factfinds/679/arrangements/99999",
      "arrangementType": "Endowment"
    }
  ],

  "notes": "Main residence mortgage. Fixed rate ends February 2028. Review options 6 months before end of fixed period.",
  "createdAt": "2023-01-15T10:00:00Z",
  "updatedAt": "2026-02-10T14:30:00Z"
}
```

#### Field Definitions

The Mortgage contract is organized into 14 logical field groups for clarity and industry-standard alignment.

##### 1. Core Identification

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `id` | integer | Required | Unique identifier for the mortgage arrangement |
| `href` | string (URI) | Required | Self-referencing URI for this resource |
| `accountNumber` | string | Optional | Lender's account reference number |
| `policyNumber` | string | Optional | Policy or plan number |
| `illustrationReference` | string | Optional | Illustration of Benefits (IOB) reference number |

##### 2. Ownership & Advice

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `owners[]` | array of objects | Required | Array of client owners with ownership percentages |
| `owners[].id` | integer | Required | Client identifier |
| `owners[].href` | string (URI) | Required | URI to client resource |
| `owners[].ownershipPercentage` | decimal | Required | Percentage ownership (0-100, defaults to 100 for single owner) |
| `sellingAdviser` | object | Optional | Adviser who arranged this product |
| `sellingAdviser.id` | integer | Required | Adviser identifier |
| `sellingAdviser.href` | string (URI) | Required | URI to adviser resource |
| `sellingAdviser.name` | string | Optional | Adviser name |
| `sellingAdviser.firmName` | string | Optional | Adviser firm name |
| `agencyStatus` | string | Optional | Agency status (NotUnderAgency, UnderAgency, etc.) |
| `agencyStatusDate` | string (date) | Optional | Date agency status was set |

##### 3. Product Classification

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `productType` | string (enum) | Required | **Product type discriminator** - determines required fields (see Product Type Codes) |
| `lenderName` | string | Required | Name of the lending institution |
| `productName` | string | Required | Specific product name from lender |
| `description` | string | Optional | Additional product description or notes |

##### 4. Loan Amounts

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `loanAmounts` | object | Required | Container for all loan amount fields |
| `loanAmounts.originalLoanAmount` | MoneyValue | Required | Initial loan amount at origination |
| `loanAmounts.currentBalance` | MoneyValue | Required | Current outstanding balance |
| `loanAmounts.depositAmount` | MoneyValue | Conditional | Deposit amount (required for traditional mortgages, N/A for equity release) |
| `loanAmounts.equityReleased` | MoneyValue | Conditional | Amount of equity released (N/A for traditional mortgages, required for equity release) |
| `loanAmounts.originalPropertyValuation` | MoneyValue | Required | Property valuation at origination |
| `loanAmounts.currentPropertyValuation` | MoneyValue | Optional | Current property valuation |
| `loanAmounts.loanToValueRatio` | decimal | Required | LTV percentage (calculated: currentBalance / currentPropertyValuation * 100) |

##### 5. Interest Terms

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `interestTerms` | object | Required | Container for all interest-related fields |
| `interestTerms.interestRate` | decimal | Required | Current interest rate percentage |
| `interestTerms.annualPercentageRate` | decimal | Optional | APR including all costs (regulatory disclosure) |
| `interestTerms.rateType` | string (enum) | Required | Fixed, Variable, Tracker, Discount, Capped, Offset |
| `interestTerms.baseRateIndex` | string | Conditional | Base rate index (e.g., "SONIA") - required for Tracker products |
| `interestTerms.reversionRate` | decimal | Conditional | Rate after initial period ends (required for traditional mortgages with initial deal) |
| `interestTerms.hasCollarRate` | boolean | Optional | Whether a collar (minimum) rate applies |
| `interestTerms.collarRate` | decimal | Optional | Minimum interest rate (if hasCollarRate = true) |
| `interestTerms.initialRatePeriodEndsOn` | string (date) | Conditional | Date initial rate period ends (required for Fixed, Discount products) |
| `interestTerms.initialTermYears` | integer | Optional | Years in initial rate period |
| `interestTerms.initialTermMonths` | integer | Optional | Additional months in initial rate period |
| `interestTerms.remainingTermYears` | integer | Conditional | Years remaining on mortgage (required for traditional mortgages) |
| `interestTerms.remainingTermMonths` | integer | Conditional | Additional months remaining (required for traditional mortgages) |

##### 6. Repayment Structure

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `repaymentStructure` | object | Required | Container for repayment-related fields |
| `repaymentStructure.repaymentMethod` | string (enum) | Required | Method of repayment (see Repayment Method Codes) |
| `repaymentStructure.capitalRepaymentAmount` | MoneyValue | Conditional | Amount on capital repayment (required if CapitalAndInterest or PartAndPart) |
| `repaymentStructure.capitalTermYears` | integer | Conditional | Years for capital repayment portion |
| `repaymentStructure.capitalTermMonths` | integer | Conditional | Additional months for capital repayment |
| `repaymentStructure.interestOnlyAmount` | MoneyValue | Conditional | Amount on interest-only (required if InterestOnly or PartAndPart) |
| `repaymentStructure.interestOnlyTermYears` | integer | Conditional | Years for interest-only portion |
| `repaymentStructure.interestOnlyTermMonths` | integer | Conditional | Additional months for interest-only |
| `repaymentStructure.interestOnlyRepaymentVehicle` | string | Conditional | Planned repayment vehicle (e.g., "ISA", "Pension") - required if InterestOnly |
| `repaymentStructure.lumpSumAdvance` | MoneyValue | Conditional | Initial lump sum drawdown (equity release products) |
| `repaymentStructure.monthlyIncomeDrawdown` | MoneyValue | Conditional | Regular monthly drawdown amount (equity release products) |
| `repaymentStructure.regularAnnualOverpayment` | MoneyValue | Optional | Regular annual overpayment amount |
| `repaymentStructure.currentRepaymentVehicles` | array of strings | Optional | Current repayment vehicles in place (e.g., ["ISA", "Pension"]) |

##### 7. Fees & Contributions

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `feesAndCharges` | object | Optional | Container for fee-related fields |
| `feesAndCharges.lenderFees` | MoneyValue | Optional | Arrangement/booking fees charged by lender |
| `feesAndCharges.ongoingContributions` | object | Optional | Ongoing contributions structure (primarily for equity release) |
| `feesAndCharges.ongoingContributions.type` | string | Conditional | Type of contribution (Regular, Adhoc) |
| `feesAndCharges.ongoingContributions.amount` | MoneyValue | Conditional | Contribution amount |
| `feesAndCharges.ongoingContributions.frequency` | string | Conditional | Frequency (Monthly, Quarterly, Annually) |
| `feesAndCharges.ongoingContributions.contributorType` | string | Conditional | Who makes contribution (Client, ThirdParty) |
| `feesAndCharges.ongoingContributions.startsOn` | string (date) | Conditional | Contribution start date |
| `feesAndCharges.ongoingContributions.stopsOn` | string (date) | Optional | Contribution end date |
| `feesAndCharges.ongoingContributions.isInitialFee` | boolean | Optional | Whether this is an initial fee |
| `feesAndCharges.ongoingContributions.isOngoingFee` | boolean | Optional | Whether this is an ongoing fee |
| `feesAndCharges.ongoingContributions.notes` | string | Optional | Additional notes |

##### 8. Key Dates

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `keyDates` | object | Required | Container for all date fields |
| `keyDates.startDate` | string (date) | Required | Start date of the arrangement |
| `keyDates.endDate` | string (date) | Conditional | End/maturity date (required for traditional mortgages, null for equity release) |
| `keyDates.completionDate` | string (date) | Optional | Date the property purchase/remortgage completed |
| `keyDates.exchangeDate` | string (date) | Optional | Date contracts were exchanged |
| `keyDates.nextPaymentDueDate` | string (date) | Optional | Next scheduled payment date |
| `keyDates.nextReviewDate` | string (date) | Optional | Scheduled review date |
| `keyDates.balanceAsOfDate` | string (date) | Optional | Date of the current balance statement |
| `keyDates.applicationSubmittedDate` | string (date) | Optional | Date application was submitted to lender |
| `keyDates.valuationInstructedDate` | string (date) | Optional | Date valuation was instructed |
| `keyDates.valuationDate` | string (date) | Optional | Date property was valued |
| `keyDates.valuationReceivedDate` | string (date) | Optional | Date valuation report was received |
| `keyDates.offerIssuedDate` | string (date) | Optional | Date lender issued formal offer |
| `keyDates.targetCompletionDate` | string (date) | Optional | Target/planned completion date |
| `keyDates.schemeEndDate` | string (date) | Optional | Scheme end date (primarily for equity release products) |

##### 9. Redemption Terms

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `redemptionTerms` | object | Optional | Container for early repayment/redemption fields |
| `redemptionTerms.hasEarlyRepaymentCharge` | boolean | Required | Whether early repayment charges apply |
| `redemptionTerms.earlyRepaymentTerms` | string | Optional | Description of early repayment charge terms |
| `redemptionTerms.earlyRepaymentChargeEndsOn` | string (date) | Conditional | Date when early repayment charges end |
| `redemptionTerms.earlyRepaymentCharge` | MoneyValue | Optional | Calculated early repayment charge amount |
| `redemptionTerms.earlyRepaymentChargeSecondCharge` | MoneyValue | Optional | ERC amount for second charge (if applicable) |
| `redemptionTerms.netProceedsOnRedemption` | MoneyValue | Optional | Net proceeds after redemption costs |

##### 10. Special Features

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `specialFeatures` | object | Optional | Container for special feature flags |
| `specialFeatures.isFirstTimeBuyer` | boolean | Optional | Whether borrower is first-time buyer |
| `specialFeatures.isCurrentResidence` | boolean | Optional | Whether property is current main residence |
| `specialFeatures.hasGuarantor` | boolean | Optional | Whether arrangement has a guarantor |
| `specialFeatures.isPortable` | boolean | Optional | Whether mortgage is portable to new property |
| `specialFeatures.isPropertySold` | boolean | Optional | Whether the secured property has been sold |
| `specialFeatures.isRedeemed` | boolean | Optional | Whether the loan has been fully redeemed |
| `specialFeatures.hasDischargeOnCompletion` | boolean | Optional | Whether arrangement will discharge on completion (remortgage scenario) |
| `specialFeatures.hasConsentToLet` | boolean | Optional | Whether consent to let has been granted |
| `specialFeatures.consentToLetExpiresOn` | string (date) | Optional | Expiry date of consent to let |
| `specialFeatures.hasDebtConsolidation` | boolean | Optional | Whether loan includes debt consolidation |
| `specialFeatures.incomeVerificationStatus` | string (enum) | Optional | Income verification status (see Income Verification Status Codes) |
| `specialFeatures.isIncomeEvidenced` | boolean | Optional | Whether income has been documented/evidenced |

##### 11. Shared Ownership Details

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `sharedOwnershipDetails` | object | Optional | Container for shared ownership/equity fields (null if not applicable) |
| `sharedOwnershipDetails.sharedEquitySchemeType` | string (enum) | Conditional | Type of shared equity scheme (see Shared Equity Scheme Type Codes) |
| `sharedOwnershipDetails.sharedEquitySchemeProvider` | string | Conditional | Provider of shared equity scheme (e.g., government, housing association) |
| `sharedOwnershipDetails.sharedEquityRepaymentStartsOn` | string (date) | Optional | Date when shared equity loan repayment begins |
| `sharedOwnershipDetails.sharedEquityLoanPercentage` | decimal | Optional | Percentage of property value held as shared equity |
| `sharedOwnershipDetails.sharedEquityLoanAmount` | MoneyValue | Optional | Monetary amount of shared equity loan |
| `sharedOwnershipDetails.sharedOwnershipPercentageOwned` | decimal | Optional | Percentage of property owned (for shared ownership, typically 25-75%) |
| `sharedOwnershipDetails.sharedOwnershipHousingAssociation` | string | Conditional | Name of housing association (required if sharedOwnershipPercentageOwned is set) |
| `sharedOwnershipDetails.sharedOwnershipMonthlyRent` | MoneyValue | Conditional | Monthly rent on unowned portion (required if sharedOwnershipPercentageOwned is set) |

##### 13. Offset Features

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `offsetFeatures` | object | Optional | Container for offset mortgage features (null if not applicable) |
| `offsetFeatures.offsetLinkedAccountNumber` | string | Optional | Account number of linked offset account |
| `offsetFeatures.offsetOptions` | array of strings | Optional | Available offset options (e.g., ["AccountOffset", "SavingsOffset"]) |

##### 13. Related Entities

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `asset` | object | Optional | HATEOAS link to related asset record |
| `asset.id` | integer | Required | Asset identifier |
| `asset.href` | string (URI) | Required | URI to asset resource |
| `property` | object | Optional | HATEOAS link to related property record |
| `property.id` | integer | Required | Property identifier |
| `property.href` | string (URI) | Required | URI to property resource |
| `propertyDetail` | object | Optional | HATEOAS link to property details record |
| `propertyDetail.id` | integer | Required | Property detail identifier |
| `propertyDetail.href` | string (URI) | Required | URI to property detail resource |
| `linkedArrangements[]` | array of objects | Optional | Linked arrangements (e.g., endowments, protection products) |
| `linkedArrangements[].id` | integer | Required | Arrangement identifier |
| `linkedArrangements[].href` | string (URI) | Required | URI to arrangement resource |
| `linkedArrangements[].arrangementType` | string | Optional | Type of linked arrangement |

##### 14. Audit Trail

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `notes` | string | Optional | Free-text notes about the arrangement |
| `createdAt` | string (ISO 8601) | Required | Timestamp when record was created |
| `updatedAt` | string (ISO 8601) | Required | Timestamp when record was last updated |

#### Product Type Codes

Traditional Mortgages:
- `FixedRateMortgage` - Fixed interest rate for set period
- `VariableRateMortgage` - Rate varies with lender's standard variable rate
- `TrackerMortgage` - Tracks base rate (e.g., SONIA + margin)
- `DiscountedMortgage` - Discount off lender's SVR
- `CappedRateMortgage` - Rate capped at maximum level
- `OffsetMortgage` - Linked to savings/current account

Equity Release Products:
- `LifetimeMortgage` - Loan secured on property, repaid on death/care
- `HomeReversionPlan` - Sell percentage of property for lump sum/income
- `RetirementInterestOnlyMortgage` - Interest-only for over 55s

Specialized Products:
- `BuyToLetMortgage` - For rental properties
- `CommercialMortgage` - For business premises
- `BridgingLoan` - Short-term finance between purchases
- `SharedOwnershipMortgage` - Part buy, part rent
- `SharedEquityMortgage` - Government/housing association co-owns

#### Repayment Method Codes

Traditional Mortgage Methods:
- `CapitalAndInterest` - Repayment mortgage (capital + interest paid monthly)
- `InterestOnly` - Only interest paid, capital owed at end of term
- `PartAndPart` - Split between capital repayment and interest-only portions

Equity Release Methods:
- `NoRequiredPayment` - Interest rolls up (standard lifetime mortgage)
- `VoluntaryInterestPayment` - Client can choose to pay interest
- `LumpSumAdvance` - Single drawdown at outset
- `MonthlyIncomeDrawdown` - Regular monthly payments to client
- `ReservedDrawdownFacility` - Facility to draw additional funds over time

#### Rate Type Codes

| Code | Description |
|------|-------------|
| `Fixed` | Fixed interest rate for specified period |
| `Variable` | Variable rate at lender's discretion |
| `Tracker` | Tracks a base rate (e.g., SONIA) plus fixed margin |
| `Discount` | Discount off lender's standard variable rate |
| `Capped` | Variable rate with maximum cap |
| `Offset` | Interest offset by linked savings/current account balances |

#### Income Verification Status Codes

| Code | Description |
|------|-------------|
| `Employed` | Income verified via employment |
| `SelfEmployed` | Income verified via self-employment records |
| `Retired` | Income verified via pension/retirement income |
| `NotVerified` | Income not verified (e.g., self-certification) |
| `Exempt` | Income verification not required |

#### Shared Equity Scheme Type Codes

| Code | Description |
|------|-------------|
| `HelpToBuy` | Government Help to Buy equity loan scheme |
| `SharedOwnership` | Shared ownership with housing association |
| `RightToBuy` | Right to Buy scheme |
| `RightToAcquire` | Right to Acquire scheme |
| `Other` | Other shared equity scheme |

#### Validation Rules

##### Product-Specific Required Fields

**Traditional Mortgages** (FixedRateMortgage, VariableRateMortgage, TrackerMortgage, etc.):
- `loanAmounts.depositAmount` - REQUIRED
- `keyDates.endDate` - REQUIRED (maturity date)
- `interestTerms.remainingTermYears` - REQUIRED
- `interestTerms.reversionRate` - REQUIRED if initial rate period applies
- `loanAmounts.equityReleased` - N/A (should be null or zero)

**Equity Release Products** (LifetimeMortgage, HomeReversionPlan, RetirementInterestOnlyMortgage):
- `loanAmounts.equityReleased` - REQUIRED
- `keyDates.endDate` - N/A (should be null, repaid on death/care)
- `loanAmounts.depositAmount` - N/A (should be null or zero)
- `interestTerms.remainingTermYears` - N/A (should be null)

##### Repayment Structure Validation

**If repaymentMethod = "PartAndPart":**
- `repaymentStructure.capitalRepaymentAmount` - REQUIRED (must be > 0)
- `repaymentStructure.interestOnlyAmount` - REQUIRED (must be > 0)
- SUM(capitalRepaymentAmount + interestOnlyAmount) SHOULD EQUAL originalLoanAmount

**If repaymentMethod = "InterestOnly":**
- `repaymentStructure.interestOnlyAmount` - REQUIRED
- `repaymentStructure.interestOnlyRepaymentVehicle` - REQUIRED
- `repaymentStructure.currentRepaymentVehicles` - REQUIRED (min 1 vehicle)

**If repaymentMethod = "CapitalAndInterest":**
- `repaymentStructure.capitalRepaymentAmount` - REQUIRED
- `repaymentStructure.capitalRepaymentAmount` SHOULD EQUAL originalLoanAmount

##### LTV Calculation Rules

```
loanToValueRatio = (currentBalance / currentPropertyValuation) × 100
```

**Regulatory Guidelines:**
- Lifetime Mortgages: loanToValueRatio typically ≤ 60% (Equity Release Council guidelines)
- First-Time Buyer Mortgages: depositAmount ≥ (originalPropertyValuation × 0.05) [minimum 5% deposit]
- Standard Mortgages: loanToValueRatio typically ≤ 95%

##### Shared Ownership Validation

**If sharedOwnershipDetails.sharedOwnershipPercentageOwned is not null:**
- `sharedOwnershipDetails.sharedOwnershipHousingAssociation` - REQUIRED
- `sharedOwnershipDetails.sharedOwnershipMonthlyRent` - REQUIRED
- `sharedOwnershipPercentageOwned` MUST BE BETWEEN 25 AND 75 (typical shared ownership range)

##### Date Sequence Validation

**Application Process Dates:**
```
valuationInstructedDate ≤ valuationDate ≤ valuationReceivedDate
applicationSubmittedDate ≤ offerIssuedDate ≤ exchangeDate ≤ completionDate
```

**Operational Dates:**
```
startDate ≤ balanceAsOfDate ≤ currentDate
startDate < endDate (if endDate is not null)
initialRatePeriodEndsOn ≤ earlyRepaymentChargeEndsOn
```

---

### 14.42 Arrangement - Investment Contract (General Investment Account)

The `InvestmentArrangement` contract represents investment products including GIAs, ISAs, Investment Bonds, Platform Accounts, and Cash Accounts (savings, current accounts, cash deposits).

**Reference Type:** InvestmentArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Investment type classification
- Provider and platform details
- Asset allocation and fund holdings
- Valuation tracking
- Links to attitude to risk
- Contribution and withdrawal tracking

#### Complete Investment Arrangement Contract (GIA Example)

```json
{
  "id": 13001,
  "href": "/api/v2/factfinds/679/arrangements/investments/13001",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "INVESTMENT",
  "investmentType": "GENERAL_INVESTMENT_ACCOUNT",
  "productName": "Vanguard Investment Account",
  "providerName": "Vanguard",
  "provider": {
    "id": 456,
    "href": "/api/v2/providers/456"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "accountNumber": "GIA-987654321",
  "startDate": "2020-03-15",
  "currentValue": {
    "amount": 75000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "totalContributions": {
    "amount": 60000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "gainLoss": {
    "amount": 15000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 25.0
  },
  "assetAllocation": {
    "equities": 65.0,
    "bonds": 25.0,
    "cash": 5.0,
    "alternatives": 5.0
  },
  "fundHoldings": [
    {
      "fundName": "Vanguard LifeStrategy 80% Equity Fund",
      "fundCode": "GB00B4PQW151",
      "units": 5234.567,
      "currentValue": {
        "amount": 45000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 60.0
    },
    {
      "fundName": "Vanguard FTSE Global All Cap Index Fund",
      "fundCode": "GB00BD3RZ582",
      "units": 1876.234,
      "currentValue": {
        "amount": 25000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 33.3
    },
    {
      "fundName": "Vanguard UK Government Bond Index Fund",
      "fundCode": "GB00B1S74Q32",
      "units": 567.890,
      "currentValue": {
        "amount": 5000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 6.7
    }
  ],
  "regularContributions": {
    "amount": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2020-03-15",
    "isActive": true
  },
  "withdrawals": {
    "hasRegularWithdrawals": false
  },
  "charges": {
    "platformFee": 0.25,
    "fundCharges": 0.22,
    "totalAnnualCharge": 0.47
  },
  "riskProfile": {
    "targetRiskLevel": 6,
    "atrRef": {
      "id": 3333,
      "href": "/api/v2/factfinds/679/clients/123/attitude-to-risk/3333"
    }
  },
  "taxWrapper": "TAXABLE",
  "investmentObjective": "Long-term capital growth for retirement planning",
  "adviserDetails": {
    "adviserName": "Jane Financial Adviser",
    "firmName": "XYZ Wealth Management",
    "adviceDate": "2020-02-28",
    "lastReviewDate": "2025-11-15"
  },
  "notes": "General Investment Account with monthly contributions. Balanced risk profile aligned with ATR.",
  "createdAt": "2020-03-20T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Investment Type Codes

| Code | Display Name |
|------|-------------|
| `GENERAL_INVESTMENT_ACCOUNT` | General Investment Account (GIA) |
| `STOCKS_SHARES_ISA` | Stocks & Shares ISA |
| `CASH_ISA` | Cash ISA |
| `LIFETIME_ISA` | Lifetime ISA |
| `JUNIOR_ISA` | Junior ISA |
| `INVESTMENT_BOND` | Investment Bond |
| `OFFSHORE_BOND` | Offshore Bond |
| `UNIT_TRUSTS` | Unit Trusts |
| `OEICS` | OEICs (Open-Ended Investment Companies) |
| `INVESTMENT_TRUSTS` | Investment Trusts |
| `ETFS` | ETFs (Exchange-Traded Funds) |
| `DIRECT_EQUITIES` | Direct Equities |
| `PLATFORM_ACCOUNT` | Platform Account |
| `CASH_ACCOUNT` | Cash Account |
| `CASH_DEPOSIT` | Cash Deposit |
| `CURRENT_ACCOUNT` | Current Account |
| `SAVINGS_ACCOUNT` | Savings Account |

---

### 14.43 Arrangement - Protection Contract (Life Assurance)

The `ProtectionArrangement` contract represents protection products including Life Assurance, Critical Illness Cover, and Income Protection.

**Reference Type:** ProtectionArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Protection type classification
- Sum assured and premium details
- Beneficiary information
- Policy term and expiry
- Trust arrangement status
- Claims tracking

#### Complete Protection Arrangement Contract (Life Assurance Example)

```json
{
  "id": 20001,
  "href": "/api/v2/factfinds/679/arrangements/protection/20001",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "PROTECTION",
  "protectionType": "LIFE_ASSURANCE",
  "policyType": "DECREASING_TERM",
  "productName": "Mortgage Protection Plan",
  "providerName": "Aviva",
  "provider": {
    "id": 789,
    "href": "/api/v2/providers/789"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "policyNumber": "LA-12345678",
  "startDate": "2023-01-15",
  "endDate": "2048-01-15",
  "termRemaining": {
    "years": 21,
    "months": 11
  },
  "sumAssured": {
    "amount": 350000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "currentSumAssured": {
    "amount": 325000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "note": "Decreasing with mortgage balance"
  },
  "premium": {
    "amount": 45.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "premiumFrequency": "MONTHLY",
  "premiumType": "GUARANTEED",
  "isInTrust": true,
  "trustDetails": {
    "trustType": "Bare Trust",
    "trustees": [
      "Sarah Smith"
    ],
    "beneficiaries": [
      "Emily Smith",
      "Thomas Smith"
    ]
  },
  "beneficiaries": [
    {
      "name": "Sarah Smith",
      "relationship": "Spouse",
      "percentage": 100
    }
  ],
  "linkedTo": {
    "mortgage": {
      "id": 12001,
      "href": "/api/v2/factfinds/679/arrangements/mortgages/12001"
    },
    "liability": {
      "id": 5678,
      "href": "/api/v2/factfinds/679/clients/346/liabilities/5678"
    }
  },
  "underwriting": {
    "underwritingType": "Full Medical Underwriting",
    "completedDate": "2023-01-10",
    "exclusions": []
  },
  "indexation": {
    "isIndexLinked": false
  },
  "adviserDetails": {
    "adviserName": "John Adviser",
    "firmName": "ABC Protection Services",
    "adviceDate": "2022-12-10"
  },
  "reviewDate": "2027-01-15",
  "notes": "Decreasing term assurance to protect mortgage. Written in trust for estate planning. Policy decreases in line with mortgage balance.",
  "createdAt": "2023-01-20T10:00:00Z",
  "updatedAt": "2026-02-15T09:00:00Z"
}
```

#### Protection Type Codes

| Code | Display Name |
|------|-------------|
| `LIFE_ASSURANCE` | Life Assurance |
| `CRITICAL_ILLNESS_COVER` | Critical Illness Cover |
| `INCOME_PROTECTION` | Income Protection |
| `LIFE_AND_CRITICAL_ILLNESS` | Life and Critical Illness |
| `FAMILY_INCOME_BENEFIT` | Family Income Benefit |
| `ACCIDENT_SICKNESS_UNEMPLOYMENT` | Accident, Sickness and Unemployment (ASU) |

#### Policy Type Codes (Life Assurance)

| Code | Display Name |
|------|-------------|
| `LEVEL_TERM` | Level Term Assurance |
| `DECREASING_TERM` | Decreasing Term Assurance |
| `INCREASING_TERM` | Increasing Term Assurance |
| `WHOLE_OF_LIFE` | Whole of Life Assurance |
| `FAMILY_INCOME_BENEFIT` | Family Income Benefit |
| `CONVERTIBLE_TERM` | Convertible Term Assurance |

---

### 14.44 Arrangement - Pension Contract (Personal Pension)

The `PensionArrangement` contract represents pension products including Personal Pensions, SIPPs, Workplace Pensions, Final Salary schemes, and Annuities.

**Reference Type:** PensionArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Pension type classification
- Fund value and contribution tracking
- Retirement age and projection
- Death benefits
- Investment allocation
- Tax relief tracking

#### Complete Pension Arrangement Contract (Personal Pension Example)

```json
{
  "id": 30001,
  "href": "/api/v2/factfinds/679/arrangements/pensions/30001",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "PENSION",
  "pensionType": "PERSONAL_PENSION",
  "productName": "Vanguard Personal Pension",
  "providerName": "Vanguard",
  "provider": {
    "id": 456,
    "href": "/api/v2/providers/456"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "policyNumber": "PP-123456789",
  "startDate": "2010-04-06",
  "currentValue": {
    "amount": 185000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "totalContributions": {
    "amount": 120000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "growthToDate": {
    "amount": 65000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 54.2
  },
  "regularContributions": {
    "grossAmount": {
      "amount": 800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netAmount": {
      "amount": 640.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxRelief": {
      "amount": 160.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2010-04-06",
    "isActive": true
  },
  "retirementAge": 67,
  "selectedRetirementAge": 65,
  "stateRetirementAge": 67,
  "crystallisedAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedAmount": {
    "amount": 185000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxFreeCashAvailable": {
    "amount": 46250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 25
  },
  "lifetimeAllowanceUsed": {
    "amount": 185000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 16.4,
    "note": "Lifetime Allowance abolished from April 2024"
  },
  "assetAllocation": {
    "equities": 80.0,
    "bonds": 15.0,
    "cash": 3.0,
    "alternatives": 2.0
  },
  "fundHoldings": [
    {
      "fundName": "Vanguard LifeStrategy 100% Equity Fund",
      "fundCode": "GB00B41XG308",
      "units": 8234.567,
      "currentValue": {
        "amount": 148000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 80.0
    },
    {
      "fundName": "Vanguard UK Government Bond Index Fund",
      "fundCode": "GB00B1S74Q32",
      "units": 3456.789,
      "currentValue": {
        "amount": 27750.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 15.0
    },
    {
      "fundName": "Cash Fund",
      "fundCode": "CASH001",
      "currentValue": {
        "amount": 9250.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 5.0
    }
  ],
  "projectedValueAtRetirement": {
    "lowGrowth": {
      "amount": 285000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "mediumGrowth": {
      "amount": 340000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "highGrowth": {
      "amount": 410000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "assumedRetirementAge": 65
  },
  "deathBenefits": {
    "beforeRetirement": {
      "type": "Full fund value",
      "amount": {
        "amount": 185000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "isInTrust": true,
    "nominatedBeneficiaries": [
      {
        "name": "Sarah Smith",
        "relationship": "Spouse",
        "percentage": 100
      }
    ]
  },
  "charges": {
    "platformFee": 0.15,
    "fundCharges": 0.22,
    "totalAnnualCharge": 0.37
  },
  "adviserDetails": {
    "adviserName": "Jane Financial Adviser",
    "firmName": "XYZ Wealth Management",
    "adviceDate": "2010-03-15",
    "lastReviewDate": "2025-09-20"
  },
  "notes": "Personal pension with regular monthly contributions. Good growth to date. Review allocation as retirement approaches.",
  "createdAt": "2010-04-10T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Pension Type Codes

| Code | Display Name |
|------|-------------|
| `PERSONAL_PENSION` | Personal Pension |
| `SIPP` | Self-Invested Personal Pension (SIPP) |
| `WORKPLACE_PENSION` | Workplace Pension |
| `GROUP_PERSONAL_PENSION` | Group Personal Pension |
| `STAKEHOLDER_PENSION` | Stakeholder Pension |
| `MONEY_PURCHASE` | Money Purchase |
| `FINAL_SALARY` | Final Salary / Defined Benefit |
| `STATE_PENSION` | State Pension |
| `DRAWDOWN` | Pension Drawdown |
| `ANNUITY` | Annuity |
| `UNFUNDED_PUBLIC_SECTOR` | Unfunded Public Sector Scheme |

---

### 14.45 Arrangement - Pension Contract (SIPP - Self-Invested Personal Pension)

The `SIPPArrangement` contract represents Self-Invested Personal Pensions, which offer greater investment flexibility and control compared to standard personal pensions.

**Reference Type:** SIPPArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Wider investment universe including direct equities, commercial property
- Individual fund selection and asset allocation control
- SIPP-specific charges (setup, annual administration, transaction fees)
- May include commercial property holdings
- Flexible contribution and withdrawal options
- Death benefit nomination and trust arrangements

#### Complete SIPP Arrangement Contract

```json
{
  "id": 30002,
  "href": "/api/v2/factfinds/679/arrangements/pensions/30002",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "PENSION",
  "pensionType": "SIPP",
  "productName": "Self-Invested Personal Pension",
  "providerName": "Hargreaves Lansdown",
  "provider": {
    "id": 789,
    "href": "/api/v2/providers/789"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "policyNumber": "SIPP-987654321",
  "startDate": "2015-06-01",
  "currentValue": {
    "amount": 425000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "totalContributions": {
    "amount": 280000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "growthToDate": {
    "amount": 145000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 51.8
  },
  "regularContributions": {
    "grossAmount": {
      "amount": 1250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netAmount": {
      "amount": 1000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxRelief": {
      "amount": 250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2015-06-01",
    "isActive": true
  },
  "retirementAge": 67,
  "selectedRetirementAge": 60,
  "stateRetirementAge": 67,
  "crystallisedAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedAmount": {
    "amount": 425000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxFreeCashAvailable": {
    "amount": 106250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 25
  },
  "assetAllocation": {
    "equities": 55.0,
    "bonds": 15.0,
    "cash": 5.0,
    "property": 20.0,
    "alternatives": 5.0
  },
  "fundHoldings": [
    {
      "fundName": "Vanguard FTSE All-World UCITS ETF",
      "fundCode": "VWRL",
      "units": 2500.00,
      "currentValue": {
        "amount": 195000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 45.9
    },
    {
      "fundName": "iShares Core UK Gilts UCITS ETF",
      "fundCode": "IGLT",
      "units": 5000.00,
      "currentValue": {
        "amount": 63750.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 15.0
    },
    {
      "fundName": "Commercial Property - 123 High Street",
      "fundCode": "PROPERTY-001",
      "currentValue": {
        "amount": 145000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 34.1,
      "assetType": "CommercialProperty",
      "propertyDetails": {
        "address": "123 High Street, Manchester M1 1AA",
        "purchaseDate": "2018-03-15",
        "purchasePrice": {
          "amount": 120000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        },
        "currentValuation": {
          "amount": 145000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        },
        "rentalIncome": {
          "amount": 850.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
          "frequency": "MONTHLY"
        }
      }
    },
    {
      "fundName": "Cash Reserve",
      "fundCode": "CASH",
      "currentValue": {
        "amount": 21250.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 5.0
    }
  ],
  "sippSpecificFeatures": {
    "allowsCommercialProperty": true,
    "allowsDirectEquities": true,
    "allowsOverseasInvestments": true,
    "hasPropertyHolding": true,
    "propertyHoldingsCount": 1,
    "hasDirectEquityHoldings": false,
    "directEquityHoldingsCount": 0
  },
  "projectedValueAtRetirement": {
    "lowGrowth": {
      "amount": 585000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "mediumGrowth": {
      "amount": 720000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "highGrowth": {
      "amount": 890000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "assumedRetirementAge": 60
  },
  "deathBenefits": {
    "beforeRetirement": {
      "type": "Full fund value",
      "amount": {
        "amount": 425000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "isInTrust": true,
    "nominatedBeneficiaries": [
      {
        "name": "Sarah Smith",
        "relationship": "Spouse",
        "percentage": 60
      },
      {
        "name": "Emily Smith",
        "relationship": "Child",
        "percentage": 20
      },
      {
        "name": "Thomas Smith",
        "relationship": "Child",
        "percentage": 20
      }
    ]
  },
  "charges": {
    "setupFee": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
      "waived": true
    },
    "annualAdministrationFee": {
      "amount": 400.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "percentageBasedFee": 0.45,
    "cappedAt": {
      "amount": 200.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
      "period": "QUARTERLY"
    },
    "transactionFees": {
      "equityDealingFee": {
        "amount": 11.95,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "fundDealingFee": {
        "amount": 0.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "propertyRelatedFees": {
      "annualPropertyFee": {
        "amount": 900.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "conveyancingFees": "Client pays separately",
      "valuationFees": "Client pays separately"
    },
    "totalAnnualCharge": 0.55
  },
  "adviserDetails": {
    "adviserName": "Jane Financial Adviser",
    "firmName": "XYZ Wealth Management",
    "adviceDate": "2015-05-10",
    "lastReviewDate": "2025-10-12"
  },
  "notes": "SIPP with commercial property investment and diversified portfolio. Regular contributions ongoing. Property generates rental income within SIPP wrapper. Consider rebalancing as retirement approaches.",
  "createdAt": "2015-06-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**SIPP-Specific Fields:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `sippSpecificFeatures` | object | Required | Container for SIPP-specific investment features |
| `sippSpecificFeatures.allowsCommercialProperty` | boolean | Required | Whether SIPP permits commercial property investment |
| `sippSpecificFeatures.allowsDirectEquities` | boolean | Required | Whether SIPP permits direct equity holdings |
| `sippSpecificFeatures.allowsOverseasInvestments` | boolean | Required | Whether SIPP permits overseas investments |
| `sippSpecificFeatures.hasPropertyHolding` | boolean | Required | Whether SIPP currently holds commercial property |
| `sippSpecificFeatures.propertyHoldingsCount` | integer | Optional | Number of commercial properties held |
| `sippSpecificFeatures.hasDirectEquityHoldings` | boolean | Required | Whether SIPP currently holds direct equities |
| `sippSpecificFeatures.directEquityHoldingsCount` | integer | Optional | Number of direct equity holdings |
| `charges.setupFee` | MoneyValue | Optional | One-time setup fee (may be waived) |
| `charges.annualAdministrationFee` | MoneyValue | Required | Fixed annual administration charge |
| `charges.percentageBasedFee` | decimal | Optional | Percentage-based annual charge on fund value |
| `charges.cappedAt` | object | Optional | Cap on percentage-based fees |
| `charges.transactionFees` | object | Optional | Per-transaction dealing charges |
| `charges.propertyRelatedFees` | object | Optional | Additional fees for holding property within SIPP |

**Fund Holdings - Property Extension:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `fundHoldings[].assetType` | string | Optional | Type of asset (Fund, DirectEquity, CommercialProperty, Cash) |
| `fundHoldings[].propertyDetails` | object | Conditional | Required if assetType = CommercialProperty |
| `fundHoldings[].propertyDetails.address` | string | Required | Property address |
| `fundHoldings[].propertyDetails.purchaseDate` | string (date) | Required | Date property purchased by SIPP |
| `fundHoldings[].propertyDetails.purchasePrice` | MoneyValue | Required | Original purchase price |
| `fundHoldings[].propertyDetails.currentValuation` | MoneyValue | Required | Current property valuation |
| `fundHoldings[].propertyDetails.rentalIncome` | MoneyValue | Optional | Monthly rental income generated |

#### Validation Rules

**SIPP Property Investment Rules:**
- If `hasPropertyHolding = true`, at least one fundHolding must have `assetType = "CommercialProperty"`
- Commercial property must not exceed 60% of total SIPP value (best practice)
- Property must be used for commercial purposes only (cannot be client's residence)
- Rental income must be paid directly into SIPP

**SIPP Contribution Limits:**
- Annual allowance: £60,000 (2024/25) or 100% of earnings, whichever is lower
- Carry forward rules apply for unused allowances from previous 3 tax years
- Tapered annual allowance applies for high earners (adjusted income > £260,000)

**SIPP Investment Restrictions:**
- Cannot invest in residential property
- Cannot invest in certain assets (e.g., fine wine, classic cars)
- Investment must be at arm's length (no connected party transactions)

---

### 14.46 Arrangement - Pension Contract (Final Salary / Defined Benefit Pension)

The `DefinedBenefitPensionArrangement` contract represents Final Salary and Defined Benefit pensions, which provide a guaranteed income in retirement based on salary and years of service.

**Reference Type:** DefinedBenefitPensionArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Guaranteed pension income calculation based on service and salary
- Accrual rate and scheme-specific rules
- Deferred vs active membership status
- Revaluation rates and indexation
- Transfer value (Cash Equivalent Transfer Value - CETV)
- Spouse and dependant benefits
- Early retirement reduction factors

#### Complete Defined Benefit Pension Arrangement Contract

```json
{
  "id": 30003,
  "href": "/api/v2/factfinds/679/arrangements/pensions/30003",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "PENSION",
  "pensionType": "FINAL_SALARY",
  "schemeType": "DEFINED_BENEFIT",
  "productName": "ABC Corporation Pension Scheme",
  "providerName": "ABC Corporation",
  "provider": {
    "id": 999,
    "href": "/api/v2/providers/999"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "policyNumber": "DB-1234567",
  "membershipNumber": "MEM-987654",
  "startDate": "2005-04-06",
  "membershipStatus": "DEFERRED",
  "dateLeftService": "2022-09-30",
  "yearsOfService": {
    "years": 17,
    "months": 5,
    "totalYears": 17.42
  },
  "normalRetirementAge": 65,
  "selectedRetirementAge": 65,
  "stateRetirementAge": 67,
  "pensionableSalary": {
    "finalSalary": {
      "amount": 58000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "salaryDate": "2022-09-30",
    "salaryType": "FINAL_SALARY",
    "averagingPeriod": "Best 3 consecutive years in last 10 years"
  },
  "accrualDetails": {
    "accrualRate": "1/60th",
    "accrualRateDecimal": 0.01667,
    "accrualType": "FINAL_SALARY",
    "yearsAccrued": 17.42,
    "additionalYears": 0.00,
    "totalPensionableService": 17.42
  },
  "projectedPensionAtNRA": {
    "annualAmount": {
      "amount": 16837.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "monthlyAmount": {
      "amount": 1403.08,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "calculation": "£58,000 × 17.42 ÷ 60 = £16,837 p.a.",
    "revaluationMethod": "CPI",
    "revaluedTo": "2026-04-06"
  },
  "currentDeferredPension": {
    "annualAmount": {
      "amount": 16100.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "monthlyAmount": {
      "amount": 1341.67,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "asAtDate": "2022-09-30"
  },
  "revaluation": {
    "revaluationMethod": "CPI_CAPPED",
    "cappedAt": 2.5,
    "revaluationRate": 2.5,
    "lastRevaluationDate": "2025-04-06"
  },
  "indexation": {
    "inPaymentIndexation": "CPI_CAPPED",
    "cappedAt": 3.0,
    "indexationAppliesTo": "Pension accrued from April 1997"
  },
  "earlyRetirementFactors": {
    "availableFrom": 55,
    "reductionFactors": [
      {
        "age": 55,
        "annualReduction": 6.0,
        "factor": 0.40
      },
      {
        "age": 60,
        "annualReduction": 4.0,
        "factor": 0.80
      },
      {
        "age": 62,
        "annualReduction": 3.0,
        "factor": 0.94
      }
    ],
    "earlyRetirementPenaltyApplies": true
  },
  "lateRetirementFactors": {
    "enhancementRate": 5.0,
    "enhancementAppliesPerYear": true
  },
  "lumpSumOptions": {
    "automaticLumpSum": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "commutationAvailable": true,
    "commutationRate": "£12 lump sum per £1 of pension",
    "maxCommutation": 25.0,
    "maxTaxFreeLumpSum": {
      "amount": 50509.25,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
      "calculation": "£16,837 × 3 = £50,511 (25% of CETV £202,037)"
    }
  },
  "transferValue": {
    "cashEquivalentTransferValue": {
      "amount": 415000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "cetvDate": "2026-01-15",
    "cetvGuaranteePeriod": "3 months",
    "cetvExpiryDate": "2026-04-15",
    "transferValueMultiplier": 24.6,
    "calculation": "£16,837 × 24.6 = £414,190",
    "isProtectedTransferValue": false
  },
  "deathBenefits": {
    "spousePension": {
      "percentage": 50.0,
      "annualAmount": {
        "amount": 8418.50,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "payableFor": "Spouse's lifetime"
    },
    "childrensPension": {
      "percentage": 25.0,
      "annualAmountPerChild": {
        "amount": 4209.25,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "payableUntil": "Age 18 (or 23 if in full-time education)"
    },
    "lumpSumOnDeathBeforeRetirement": {
      "amount": 174000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
      "calculation": "3 × Final Pensionable Salary"
    },
    "lumpSumOnDeathAfterRetirement": {
      "guaranteePeriod": 5,
      "guaranteePeriodUnit": "YEARS",
      "calculation": "5 years' pension guaranteed, then spouse's pension"
    }
  },
  "contributions": {
    "memberContributionsRequired": false,
    "employerContributionsRequired": false,
    "historicMemberContributions": {
      "amount": 18500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "averageContributionRate": 6.5
  },
  "schemeDetails": {
    "schemeAdministrator": "ABC Pension Trustees Ltd",
    "schemeFundingLevel": 105.2,
    "lastValuationDate": "2023-03-31",
    "schemeStatus": "ONGOING",
    "isPensionProtectionFund": false,
    "guaranteedMinimumPension": {
      "amount": 2450.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "adviceConsiderations": {
    "transferAdviceRequired": true,
    "transferAdviceThreshold": {
      "amount": 30000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "ftcaProtectionApplies": true,
    "pensionWiseGuidanceRecommended": true,
    "lastAdviceDate": "2025-11-20",
    "adviserRecommendation": "Retain in scheme - valuable guaranteed benefits"
  },
  "notes": "Valuable DB scheme with good indexation. CETV multiple of 24.6× is below typical transfer multiples. Strong employer funding position. Death benefits include 50% spouse's pension. Recommend retaining in scheme unless compelling circumstances.",
  "createdAt": "2022-10-01T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**Membership & Service:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `schemeType` | string (enum) | Required | DEFINED_BENEFIT, CAREER_AVERAGE, FINAL_SALARY |
| `membershipStatus` | string (enum) | Required | ACTIVE, DEFERRED, PENSIONER |
| `membershipNumber` | string | Optional | Scheme membership reference number |
| `dateLeftService` | string (date) | Conditional | Date left employment (required if DEFERRED) |
| `yearsOfService` | object | Required | Total pensionable service |
| `yearsOfService.years` | integer | Required | Full years of service |
| `yearsOfService.months` | integer | Required | Additional months of service |
| `yearsOfService.totalYears` | decimal | Required | Total years in decimal format |

**Pensionable Salary:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `pensionableSalary` | object | Required | Container for salary calculation details |
| `pensionableSalary.finalSalary` | MoneyValue | Required | Final pensionable salary used for calculation |
| `pensionableSalary.salaryDate` | string (date) | Required | Date salary was determined |
| `pensionableSalary.salaryType` | string (enum) | Required | FINAL_SALARY, CAREER_AVERAGE, BEST_3_YEARS |
| `pensionableSalary.averagingPeriod` | string | Optional | Description of averaging methodology |

**Accrual Details:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `accrualDetails` | object | Required | Container for benefit accrual calculation |
| `accrualDetails.accrualRate` | string | Required | Accrual rate (e.g., "1/60th", "1/80th") |
| `accrualDetails.accrualRateDecimal` | decimal | Required | Decimal representation of accrual rate |
| `accrualDetails.accrualType` | string (enum) | Required | FINAL_SALARY, CAREER_AVERAGE |
| `accrualDetails.yearsAccrued` | decimal | Required | Total years of pension accrual |
| `accrualDetails.additionalYears` | decimal | Optional | Additional years granted (e.g., redundancy enhancement) |
| `accrualDetails.totalPensionableService` | decimal | Required | Total pensionable service including enhancements |

**Projected & Current Pension:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `projectedPensionAtNRA` | object | Required | Projected pension at Normal Retirement Age |
| `projectedPensionAtNRA.annualAmount` | MoneyValue | Required | Annual pension amount |
| `projectedPensionAtNRA.monthlyAmount` | MoneyValue | Required | Monthly pension amount |
| `projectedPensionAtNRA.calculation` | string | Optional | Calculation methodology explanation |
| `projectedPensionAtNRA.revaluationMethod` | string (enum) | Required | CPI, RPI, FIXED, SALARY_INCREASE |
| `projectedPensionAtNRA.revaluedTo` | string (date) | Required | Date revaluation calculated to |
| `currentDeferredPension` | object | Conditional | Current deferred pension (required if DEFERRED status) |

**Transfer Value (CETV):**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `transferValue` | object | Required | Cash Equivalent Transfer Value details |
| `transferValue.cashEquivalentTransferValue` | MoneyValue | Required | Current CETV amount |
| `transferValue.cetvDate` | string (date) | Required | Date CETV was calculated |
| `transferValue.cetvGuaranteePeriod` | string | Required | How long CETV is guaranteed for |
| `transferValue.cetvExpiryDate` | string (date) | Required | Date CETV guarantee expires |
| `transferValue.transferValueMultiplier` | decimal | Required | CETV as multiple of annual pension (CETV ÷ annual pension) |
| `transferValue.isProtectedTransferValue` | boolean | Optional | Whether CETV has protection certificate |

**Death Benefits:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `deathBenefits.spousePension` | object | Required | Spouse's pension entitlement |
| `deathBenefits.spousePension.percentage` | decimal | Required | Percentage of member's pension payable to spouse |
| `deathBenefits.childrensPension` | object | Optional | Children's pension entitlement |
| `deathBenefits.lumpSumOnDeathBeforeRetirement` | MoneyValue | Optional | Lump sum death benefit before retirement |
| `deathBenefits.lumpSumOnDeathAfterRetirement` | object | Optional | Death benefit structure after retirement |

**Advice Considerations:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `adviceConsiderations` | object | Required | Regulatory and advice requirements |
| `adviceConsiderations.transferAdviceRequired` | boolean | Required | Whether FCA transfer advice is mandatory |
| `adviceConsiderations.transferAdviceThreshold` | MoneyValue | Required | CETV threshold requiring advice (£30,000) |
| `adviceConsiderations.ftcaProtectionApplies` | boolean | Required | Whether Financial Services Compensation Scheme applies |
| `adviceConsiderations.pensionWiseGuidanceRecommended` | boolean | Required | Whether Pension Wise guidance recommended |
| `adviceConsiderations.adviserRecommendation` | string | Optional | Summary of adviser's recommendation |

#### Validation Rules

**Transfer Advice Requirements (FCA Rules):**
- If CETV ≥ £30,000: `transferAdviceRequired = true` (mandatory regulated advice)
- Adviser must hold appropriate pension transfer qualifications
- Pension Wise guidance must be offered to client aged 50+
- Transfer must be in client's best interest (high bar to meet)

**CETV Calculations:**
- `transferValueMultiplier = CETV ÷ projectedPensionAtNRA.annualAmount`
- Typical multiples: 20-30× (varies by scheme funding, age, market conditions)
- Protected transfer values may have higher multiples

**Accrual Rate Standards:**
- Final Salary schemes: typically 1/60th or 1/80th
- Career Average schemes: typically 1/60th or 1/80th of CARE salary each year
- Public sector schemes: often 1/60th or better

**Death Benefits Validation:**
- Spouse's pension typically 50-66.67% of member's pension
- Children's pension typically 25-33% per child
- Lump sum death in service typically 2-4× final salary

---

### 14.47 Arrangement - Pension Contract (Money Purchase / Defined Contribution Pension)

The `MoneyPurchasePensionArrangement` contract represents Defined Contribution pensions including workplace Money Purchase schemes, typically employer-sponsored with matched contributions.

**Reference Type:** MoneyPurchasePensionArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Employer and employee contribution tracking
- Contribution matching rules and eligibility
- Auto-enrolment compliance details
- Fund value accumulation (no guaranteed income)
- Investment choice within scheme parameters
- Salary sacrifice arrangements
- Lifestyling and default fund management

#### Complete Money Purchase Pension Arrangement Contract

```json
{
  "id": 30004,
  "href": "/api/v2/factfinds/679/arrangements/pensions/30004",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "PENSION",
  "pensionType": "MONEY_PURCHASE",
  "productName": "XYZ Corporation Group Money Purchase Scheme",
  "providerName": "Scottish Widows",
  "provider": {
    "id": 555,
    "href": "/api/v2/providers/555"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "policyNumber": "DC-GRP-789456",
  "membershipNumber": "MEM-456789",
  "startDate": "2019-01-01",
  "employerDetails": {
    "employerName": "XYZ Corporation Ltd",
    "schemeJoinDate": "2019-01-01",
    "isActiveEmployee": true,
    "employment": {
      "id": 1001,
      "href": "/api/v2/factfinds/679/employment/1001"
    }
  },
  "currentValue": {
    "amount": 48500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "totalContributions": {
    "memberContributions": {
      "amount": 15800.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "employerContributions": {
      "amount": 23700.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalContributed": {
      "amount": 39500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "growthToDate": {
    "amount": 9000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 22.8
  },
  "contributionStructure": {
    "memberContribution": {
      "type": "SALARY_PERCENTAGE",
      "percentage": 5.0,
      "grossAmount": {
        "amount": 220.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netAmount": {
        "amount": 176.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "taxRelief": {
        "amount": 44.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
        "method": "NET_PAY"
      },
      "frequency": "MONTHLY",
      "isActive": true,
      "isSalarySacrifice": false
    },
    "employerContribution": {
      "type": "MATCHED_PERCENTAGE",
      "percentage": 7.5,
      "grossAmount": {
        "amount": 330.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "frequency": "MONTHLY",
      "matchingStructure": {
        "baseContribution": 3.0,
        "matchedContribution": 4.5,
        "matchingRatio": "1.5:1",
        "maxMatchedPercentage": 7.5,
        "matchingTier": "Member contributes 5%, Employer matches 1.5× up to 7.5%"
      },
      "includesNationalInsuranceSaving": true,
      "nationalInsuranceSaving": {
        "amount": 45.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "totalMonthlyContribution": {
      "amount": 550.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "autoEnrolmentDetails": {
    "isAutoEnrolmentScheme": true,
    "autoEnrolmentDate": "2019-01-01",
    "isQualifyingScheme": true,
    "minimumContributionsMet": true,
    "currentMinimumMember": 5.0,
    "currentMinimumEmployer": 3.0,
    "currentMinimumTotal": 8.0,
    "optOutDeadline": "2019-02-01",
    "hasOptedOut": false,
    "reEnrolmentDate": null
  },
  "salarySacrificeArrangement": {
    "isSalarySacrifice": false,
    "sacrificeAmount": null,
    "employerNISaving": null,
    "employeeNISaving": null,
    "totalNISaving": null
  },
  "retirementAge": 67,
  "selectedRetirementAge": 65,
  "stateRetirementAge": 67,
  "crystallisedAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedAmount": {
    "amount": 48500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxFreeCashAvailable": {
    "amount": 12125.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 25
  },
  "assetAllocation": {
    "equities": 70.0,
    "bonds": 20.0,
    "cash": 5.0,
    "alternatives": 5.0
  },
  "fundHoldings": [
    {
      "fundName": "Scottish Widows Pension Portfolio Three",
      "fundCode": "SWPP3",
      "units": 4850.00,
      "currentValue": {
        "amount": 48500.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 100.0,
      "isDefaultFund": true
    }
  ],
  "lifestyling": {
    "isLifestylingActive": true,
    "lifestylingStrategy": "Automatic switching to lower-risk funds from age 55",
    "lifestylingStartAge": 55,
    "currentLifestylePhase": "Growth Phase",
    "targetRetirementAge": 65,
    "switchingRules": "Gradual switch to bonds and cash over 10 years before retirement"
  },
  "projectedValueAtRetirement": {
    "lowGrowth": {
      "amount": 92000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "mediumGrowth": {
      "amount": 115000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "highGrowth": {
      "amount": 145000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "assumedRetirementAge": 65,
    "assumedContributionsIncrease": "In line with salary increases (assumed 2.5% p.a.)"
  },
  "deathBenefits": {
    "beforeRetirement": {
      "type": "Full fund value",
      "amount": {
        "amount": 48500.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "isInTrust": true,
    "nominatedBeneficiaries": [
      {
        "name": "Sarah Smith",
        "relationship": "Spouse",
        "percentage": 100
      }
    ]
  },
  "charges": {
    "annualManagementCharge": 0.75,
    "transactionCosts": 0.08,
    "totalAnnualCharge": 0.83,
    "chargesCappedAt": null
  },
  "adviserDetails": {
    "adviserName": "Corporate HR Team",
    "firmName": "XYZ Corporation",
    "adviceDate": "2018-12-15",
    "lastReviewDate": "2025-08-10"
  },
  "notes": "Workplace money purchase scheme with generous 1.5:1 employer matching. Good growth phase allocation. Lifestyling will reduce risk from age 55. Consider increasing contributions if affordable. Review investment strategy every 3 years.",
  "createdAt": "2019-01-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**Employer & Contribution Structure:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `employerDetails` | object | Required | Container for employer relationship details |
| `employerDetails.employerName` | string | Required | Name of sponsoring employer |
| `employerDetails.schemeJoinDate` | string (date) | Required | Date joined employer's scheme |
| `employerDetails.isActiveEmployee` | boolean | Required | Whether member is currently employed |
| `employerDetails.employmentRef` | object | Optional | Link to Employment record |
| `contributionStructure` | object | Required | Container for contribution details |
| `contributionStructure.memberContribution` | object | Required | Employee contribution structure |
| `contributionStructure.memberContribution.type` | string (enum) | Required | SALARY_PERCENTAGE, FIXED_AMOUNT |
| `contributionStructure.memberContribution.percentage` | decimal | Conditional | Contribution percentage (required if type = SALARY_PERCENTAGE) |
| `contributionStructure.memberContribution.taxRelief.method` | string (enum) | Required | NET_PAY, RELIEF_AT_SOURCE |
| `contributionStructure.memberContribution.isSalarySacrifice` | boolean | Required | Whether salary sacrifice arrangement applies |
| `contributionStructure.employerContribution` | object | Required | Employer contribution structure |
| `contributionStructure.employerContribution.type` | string (enum) | Required | MATCHED_PERCENTAGE, FIXED_PERCENTAGE, FIXED_AMOUNT |
| `contributionStructure.employerContribution.matchingStructure` | object | Conditional | Matching rules (required if type = MATCHED_PERCENTAGE) |

**Auto-Enrolment Compliance:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `autoEnrolmentDetails` | object | Required | Auto-enrolment compliance information |
| `autoEnrolmentDetails.isAutoEnrolmentScheme` | boolean | Required | Whether scheme qualifies for auto-enrolment |
| `autoEnrolmentDetails.autoEnrolmentDate` | string (date) | Conditional | Date auto-enrolled (required if applicable) |
| `autoEnrolmentDetails.isQualifyingScheme` | boolean | Required | Whether scheme meets qualifying criteria |
| `autoEnrolmentDetails.minimumContributionsMet` | boolean | Required | Whether minimum contribution levels met |
| `autoEnrolmentDetails.currentMinimumMember` | decimal | Required | Current minimum member contribution % |
| `autoEnrolmentDetails.currentMinimumEmployer` | decimal | Required | Current minimum employer contribution % |
| `autoEnrolmentDetails.currentMinimumTotal` | decimal | Required | Current minimum total contribution % (8% from April 2019) |

**Lifestyling:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `lifestyling` | object | Optional | Lifestyle investment strategy details |
| `lifestyling.isLifestylingActive` | boolean | Required | Whether lifestyling strategy is active |
| `lifestyling.lifestylingStrategy` | string | Optional | Description of lifestyling approach |
| `lifestyling.lifestylingStartAge` | integer | Conditional | Age lifestyling begins (typically 10-15 years before retirement) |
| `lifestyling.currentLifestylePhase` | string | Optional | Current phase (Growth, Consolidation, Protective) |
| `lifestyling.targetRetirementAge` | integer | Required | Target retirement age for lifestyling calculations |

#### Validation Rules

**Auto-Enrolment Minimum Contributions (UK):**
- Minimum member contribution: 5% of qualifying earnings
- Minimum employer contribution: 3% of qualifying earnings
- Minimum total contribution: 8% of qualifying earnings
- Qualifying earnings band: £6,240 - £50,270 (2024/25)

**Matching Structure Validation:**
- If `employerContribution.type = MATCHED_PERCENTAGE`, `matchingStructure` is REQUIRED
- `matchingStructure.baseContribution + matchingStructure.matchedContribution = employerContribution.percentage`
- Matching ratio typically ranges from 1:1 to 2:1

**Salary Sacrifice:**
- If `isSalarySacrifice = true`, member contribution reduces gross salary for tax and NI purposes
- Employer contribution typically includes NI saving passed to member
- Total contribution usually higher than non-salary sacrifice equivalent

**Net Pay vs Relief at Source:**
- **Net Pay:** Tax relief at source (reduces taxable income) - used by most employer schemes
- **Relief at Source:** Tax relief claimed back (20% automatically, higher rate via self-assessment)

---

### 14.48 Arrangement - Pension Contract (State Pension)

The `StatePensionArrangement` contract represents State Pension entitlement, including forecast amounts and National Insurance contribution history.

**Reference Type:** StatePensionArrangement is a reference type with identity (has `id` field).

**Key Features:**
- State Pension Age and entitlement tracking
- National Insurance contributions record
- New State Pension vs Basic State Pension
- Contracted-out deductions
- State Pension forecast amounts
- Deferral options and increases

#### Complete State Pension Arrangement Contract

```json
{
  "id": 30005,
  "href": "/api/v2/factfinds/679/arrangements/pensions/30005",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "PENSION",
  "pensionType": "STATE_PENSION",
  "productName": "UK State Pension",
  "providerName": "Department for Work and Pensions (DWP)",
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "nationalInsuranceNumber": "AB123456C",
  "statePensionType": "NEW_STATE_PENSION",
  "stateRetirementAge": 67,
  "statePensionDate": "2039-05-06",
  "currentAge": 45,
  "yearsToStatePension": 22,
  "nationalInsuranceRecord": {
    "qualifyingYears": 23,
    "yearsRequired": 35,
    "yearsToRequiredMinimum": 12,
    "minimumYearsRequired": 10,
    "hasMinimumYears": true,
    "gapsInRecord": 2,
    "yearsCredited": 1,
    "yearsContributed": 22
  },
  "statePensionForecast": {
    "currentWeeklyAmount": {
      "amount": 140.35,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "currentAnnualAmount": {
      "amount": 7298.20,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "forecastWeeklyAmount": {
      "amount": 203.85,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "forecastAnnualAmount": {
      "amount": 10600.20,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "maximumWeeklyAmount": {
      "amount": 221.20,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "maximumAnnualAmount": {
      "amount": 11502.40,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "forecastScenario": "Assuming you continue to contribute until State Pension Age",
    "forecastDate": "2026-02-15",
    "isMaximumPension": false
  },
  "contractedOut": {
    "wasContractedOut": true,
    "contractedOutPeriods": [
      {
        "startDate": "2005-04-06",
        "endDate": "2016-04-05",
        "yearsContractedOut": 11,
        "scheme": "Employer Final Salary Scheme"
      }
    ],
    "contractedOutDeduction": {
      "weeklyAmount": {
        "amount": 17.35,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "annualAmount": {
        "amount": 902.20,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "affectsStatePension": true,
    "explanation": "You were contracted out of the Additional State Pension (SERPS/S2P) from 2005-2016. Your State Pension is reduced but you have benefits in your employer's Final Salary scheme."
  },
  "voluntaryContributions": {
    "canMakeVoluntaryContributions": true,
    "gapsEligibleForFilling": 2,
    "costToFillOneYear": {
      "amount": 824.20,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "potentialIncrease": {
      "weeklyAmount": {
        "amount": 6.32,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "annualAmount": {
        "amount": 328.64,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "perYearFilled": true
    },
    "deadlineToFillGaps": "2030-04-05",
    "recommendation": "Consider filling gaps - payback period approximately 2.5 years"
  },
  "deferralOptions": {
    "canDefer": true,
    "deferralIncreaseRate": 5.8,
    "deferralIncreaseType": "PERCENTAGE_PER_YEAR",
    "deferredFor1Year": {
      "weeklyIncrease": {
        "amount": 12.83,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "newWeeklyAmount": {
        "amount": 234.03,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "deferredFor5Years": {
      "weeklyIncrease": {
        "amount": 64.15,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "newWeeklyAmount": {
        "amount": 285.35,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "lumpSumOption": false,
    "explanation": "New State Pension can be deferred to increase weekly amount by 1% for every 9 weeks deferred (approximately 5.8% per year). Lump sum option not available for New State Pension."
  },
  "indexation": {
    "indexationType": "TRIPLE_LOCK",
    "indexationRule": "Increases by highest of: earnings growth, CPI inflation, or 2.5%",
    "lastIncrease": {
      "date": "2025-04-06",
      "percentage": 8.5,
      "increasedBy": {
        "weeklyAmount": {
          "amount": 17.30,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      }
    }
  },
  "otherStateBenefits": {
    "additionalStatePension": null,
    "graduatedRetirementBenefit": {
      "weeklyAmount": {
        "amount": 2.45,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "statePensionCredit": {
      "eligible": false
    }
  },
  "notes": "State Pension forecast shows 23 qualifying years so far, with 2 gaps that could be filled. Contracted out for 11 years reduces entitlement but offset by Final Salary pension. On track for near-maximum State Pension if contributions continue. Consider filling gaps - good value. Deferral unlikely to be beneficial given other pension provisions.",
  "createdAt": "2025-01-10T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**State Pension Basics:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `nationalInsuranceNumber` | string | Required | Client's National Insurance number |
| `statePensionType` | string (enum) | Required | NEW_STATE_PENSION, BASIC_STATE_PENSION (pre-April 2016) |
| `stateRetirementAge` | integer | Required | Client's State Pension Age |
| `statePensionDate` | string (date) | Required | Date client reaches State Pension Age |
| `currentAge` | integer | Required | Client's current age |
| `yearsToStatePension` | integer | Required | Years until State Pension Age |

**National Insurance Record:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `nationalInsuranceRecord` | object | Required | NI contributions history |
| `nationalInsuranceRecord.qualifyingYears` | integer | Required | Total qualifying years accumulated |
| `nationalInsuranceRecord.yearsRequired` | integer | Required | Years required for maximum State Pension (35 for New State Pension) |
| `nationalInsuranceRecord.yearsToRequiredMinimum` | integer | Required | Additional years needed to reach minimum (10 years) |
| `nationalInsuranceRecord.minimumYearsRequired` | integer | Required | Minimum years for any State Pension (10 years) |
| `nationalInsuranceRecord.hasMinimumYears` | boolean | Required | Whether minimum qualifying years already achieved |
| `nationalInsuranceRecord.gapsInRecord` | integer | Required | Number of years with gaps |
| `nationalInsuranceRecord.yearsCredited` | integer | Optional | Years credited (e.g., caring responsibilities, unemployment) |
| `nationalInsuranceRecord.yearsContributed` | integer | Required | Years with actual NI contributions |

**State Pension Forecast:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `statePensionForecast` | object | Required | State Pension forecast amounts |
| `statePensionForecast.currentWeeklyAmount` | MoneyValue | Required | Current entitlement based on record to date |
| `statePensionForecast.currentAnnualAmount` | MoneyValue | Required | Current annual entitlement |
| `statePensionForecast.forecastWeeklyAmount` | MoneyValue | Required | Forecast amount at State Pension Age |
| `statePensionForecast.forecastAnnualAmount` | MoneyValue | Required | Forecast annual amount |
| `statePensionForecast.maximumWeeklyAmount` | MoneyValue | Required | Maximum possible State Pension (35 qualifying years) |
| `statePensionForecast.isMaximumPension` | boolean | Required | Whether forecast equals maximum |

**Contracted Out:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `contractedOut` | object | Optional | Contracted-out history (pre-April 2016) |
| `contractedOut.wasContractedOut` | boolean | Required | Whether ever contracted out of Additional State Pension |
| `contractedOut.contractedOutPeriods` | array | Conditional | Periods contracted out (required if wasContractedOut = true) |
| `contractedOut.contractedOutDeduction` | MoneyValue | Optional | Amount State Pension reduced by due to contracting out |
| `contractedOut.affectsStatePension` | boolean | Required | Whether contracting out reduces State Pension |

**Voluntary Contributions:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `voluntaryContributions` | object | Required | Voluntary NI contributions options |
| `voluntaryContributions.canMakeVoluntaryContributions` | boolean | Required | Whether eligible to make voluntary contributions |
| `voluntaryContributions.gapsEligibleForFilling` | integer | Required | Number of years with gaps that can be filled |
| `voluntaryContributions.costToFillOneYear` | MoneyValue | Conditional | Cost to fill one year of NI contributions |
| `voluntaryContributions.potentialIncrease` | MoneyValue | Conditional | State Pension increase per year filled |
| `voluntaryContributions.deadlineToFillGaps` | string (date) | Conditional | Deadline to fill historic gaps |

**Deferral Options:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `deferralOptions` | object | Required | State Pension deferral information |
| `deferralOptions.canDefer` | boolean | Required | Whether State Pension can be deferred |
| `deferralOptions.deferralIncreaseRate` | decimal | Required | Annual increase rate for deferral (5.8% for New State Pension) |
| `deferralOptions.lumpSumOption` | boolean | Required | Whether lump sum option available (false for New State Pension) |

#### Validation Rules

**New State Pension (from 6 April 2016):**
- Minimum qualifying years: 10 years
- Full State Pension: 35 qualifying years
- Current maximum (2024/25): £221.20 per week (£11,502.40 per year)
- Calculation: £221.20 ÷ 35 × qualifying years = weekly entitlement
- Triple lock: increases by highest of earnings growth, CPI, or 2.5%

**State Pension Age:**
- Currently: 66 (men and women)
- Increasing to 67 between 2026-2028
- Increasing to 68 between 2044-2046 (proposed)
- Check gov.uk calculator for individual State Pension Age

**Contracted Out Impact:**
- Applies to those contracted out before 6 April 2016
- Reduces State Pension but offset by contracted-out pension
- Foundation amount calculation considers contracted-out periods

**Voluntary Contributions:**
- Can usually fill gaps from last 6 tax years
- Extended deadline for pre-2016 gaps (until 5 April 2025 for many)
- Cost: Class 3 NI contributions (£17.45 per week for 2024/25 = £907.40 per year)
- Typical payback period: 2-3 years

---

### 14.49 Arrangement - Pension Contract (Stakeholder Pension)

The `StakeholderPensionArrangement` contract represents Stakeholder Pensions, which are low-cost, flexible personal pensions with capped charges and minimum contribution requirements.

**Reference Type:** StakeholderPensionArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Charge cap of 1.5% (first 10 years) then 1%
- Minimum contributions of £20
- Portable between employers
- Simple default investment fund
- No penalties for stopping/restarting contributions
- Used for employer auto-enrolment compliance

#### Complete Stakeholder Pension Arrangement Contract

```json
{
  "id": 30006,
  "href": "/api/v2/factfinds/679/arrangements/pensions/30006",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "PENSION",
  "pensionType": "STAKEHOLDER_PENSION",
  "productName": "Standard Life Stakeholder Pension",
  "providerName": "Standard Life",
  "provider": {
    "id": 333,
    "href": "/api/v2/providers/333"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "policyNumber": "SHP-456789123",
  "startDate": "2016-09-01",
  "isPaid up": false,
  "currentValue": {
    "amount": 23400.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "totalContributions": {
    "amount": 19800.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "growthToDate": {
    "amount": 3600.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 18.2
  },
  "regularContributions": {
    "grossAmount": {
      "amount": 200.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "netAmount": {
      "amount": 160.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taxRelief": {
      "amount": 40.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2016-09-01",
    "isActive": true,
    "paymentMethod": "DIRECT_DEBIT"
  },
  "stakeholderSpecificFeatures": {
    "isAutoEnrolmentCompliant": true,
    "meetsMinimumContribution": true,
    "minimumContribution": {
      "amount": 20.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "chargeCapCompliance": {
      "withinChargeCap": true,
      "chargeCap": 1.0,
      "chargeCap First10Years": 1.5,
      "currentYear": 10,
      "appliedChargeCap": 1.0
    },
    "flexibility": {
      "canStopContributions": true,
      "penaltyForStopping": false,
      "canRestartContributions": true,
      "canChangeContributionAmount": true,
      "minimumChangeAmount": {
        "amount": 20.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "isPortable": true,
    "acceptsTransferIn": true,
    "transferOutRestrictions": "None"
  },
  "retirementAge": 67,
  "selectedRetirementAge": 65,
  "stateRetirementAge": 67,
  "crystallisedAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedAmount": {
    "amount": 23400.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxFreeCashAvailable": {
    "amount": 5850.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 25
  },
  "assetAllocation": {
    "equities": 75.0,
    "bonds": 20.0,
    "cash": 5.0
  },
  "fundHoldings": [
    {
      "fundName": "Standard Life Stakeholder Default Fund",
      "fundCode": "SLSHDF",
      "units": 2340.00,
      "currentValue": {
        "amount": 23400.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 100.0,
      "isDefaultFund": true,
      "lifestylingSwitching": "Automatic rebalancing 10 years before retirement"
    }
  ],
  "projectedValueAtRetirement": {
    "lowGrowth": {
      "amount": 42000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "mediumGrowth": {
      "amount": 52000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "highGrowth": {
      "amount": 65000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "assumedRetirementAge": 65
  },
  "deathBenefits": {
    "beforeRetirement": {
      "type": "Full fund value",
      "amount": {
        "amount": 23400.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "isInTrust": true,
    "nominatedBeneficiaries": [
      {
        "name": "Sarah Smith",
        "relationship": "Spouse",
        "percentage": 100
      }
    ]
  },
  "charges": {
    "annualManagementCharge": 1.0,
    "additionalFundCharges": 0.0,
    "totalAnnualCharge": 1.0,
    "isWithinStakeholderCap": true,
    "noSetupFee": true,
    "noExitFee": true,
    "noTransferFee": true
  },
  "adviserDetails": {
    "adviserName": "Jane Financial Adviser",
    "firmName": "XYZ Wealth Management",
    "adviceDate": "2016-08-15",
    "lastReviewDate": "2025-07-22"
  },
  "notes": "Stakeholder pension with regular monthly contributions. Low charges at 1% annually. Default fund with lifestyling. No penalties for flexibility. Consider consolidating with other pensions for better management.",
  "createdAt": "2016-09-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**Stakeholder-Specific Features:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `stakeholderSpecificFeatures` | object | Required | Container for stakeholder pension specific features |
| `stakeholderSpecificFeatures.isAutoEnrolmentCompliant` | boolean | Required | Whether scheme qualifies for auto-enrolment |
| `stakeholderSpecificFeatures.meetsMinimumContribution` | boolean | Required | Whether £20 minimum contribution met |
| `stakeholderSpecificFeatures.minimumContribution` | MoneyValue | Required | Minimum contribution amount (£20) |
| `stakeholderSpecificFeatures.chargeCapCompliance` | object | Required | Charge cap compliance details |
| `stakeholderSpecificFeatures.chargeCapCompliance.withinChargeCap` | boolean | Required | Whether charges within stakeholder cap |
| `stakeholderSpecificFeatures.chargeCapCompliance.chargeCap` | decimal | Required | Current charge cap (1% after 10 years) |
| `stakeholderSpecificFeatures.chargeCapCompliance.chargeCapFirst10Years` | decimal | Required | Charge cap for first 10 years (1.5%) |
| `stakeholderSpecificFeatures.flexibility` | object | Required | Flexibility features |
| `stakeholderSpecificFeatures.flexibility.canStopContributions` | boolean | Required | Can stop without penalty |
| `stakeholderSpecificFeatures.flexibility.penaltyForStopping` | boolean | Required | Whether penalty applies (must be false for stakeholder) |
| `stakeholderSpecificFeatures.isPortable` | boolean | Required | Whether pension is portable between employers |

#### Validation Rules

**Stakeholder Pension Minimum Standards:**
- Minimum contribution: £20
- Maximum charge: 1.5% per year for first 10 years, then 1% per year
- No penalties for stopping, changing, or restarting contributions
- No minimum contribution period
- Must offer default investment fund
- Must accept transfers in
- Lifestyling approach available

**Charge Cap Enforcement:**
- First 10 years: `annualManagementCharge ≤ 1.5%`
- After 10 years: `annualManagementCharge ≤ 1.0%`
- No additional charges permitted (setup, exit, transfer fees all £0)

**Auto-Enrolment Compliance:**
- Stakeholder pensions automatically qualify as auto-enrolment schemes
- Must meet minimum contribution requirements (8% total from April 2019)
- Can be used by employers without contract negotiation

---

### 14.50 Arrangement - Pension Contract (Group Personal Pension)

The `GroupPersonalPensionArrangement` contract represents Group Personal Pensions (GPP), employer-sponsored arrangements where each member has individual personal pension with negotiated group terms.

**Reference Type:** GroupPersonalPensionArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Employer-sponsored but individually owned policies
- Group negotiated terms and charges
- Employer and employee contributions
- May include auto-enrolment features
- Flexible investment choices
- Portable when changing employment

#### Complete Group Personal Pension Arrangement Contract

```json
{
  "id": 30007,
  "href": "/api/v2/factfinds/679/arrangements/pensions/30007",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "PENSION",
  "pensionType": "GROUP_PERSONAL_PENSION",
  "productName": "Aviva Group Personal Pension",
  "providerName": "Aviva",
  "provider": {
    "id": 777,
    "href": "/api/v2/providers/777"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "policyNumber": "GPP-789456123",
  "membershipNumber": "MEM-654321",
  "startDate": "2020-10-01",
  "employerDetails": {
    "employerName": "ABC Manufacturing Ltd",
    "schemeJoinDate": "2020-10-01",
    "isActiveEmployee": true,
    "employment": {
      "id": 1002,
      "href": "/api/v2/factfinds/679/employment/1002"
    },
    "employerSchemeStartDate": "2018-04-06",
    "groupSchemeReference": "ABC-GPP-2018"
  },
  "groupSpecificFeatures": {
    "isGroupScheme": true,
    "individualPolicy": true,
    "groupNegotiatedTerms": true,
    "portableOnLeaving": true,
    "canContinueContributionsAfterLeaving": true,
    "groupDiscountApplied": true,
    "groupChargeReduction": 0.25
  },
  "currentValue": {
    "amount": 36800.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "totalContributions": {
    "memberContributions": {
      "amount": 12600.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "employerContributions": {
      "amount": 18900.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalContributed": {
      "amount": 31500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "growthToDate": {
    "amount": 5300.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 16.8
  },
  "contributionStructure": {
    "memberContribution": {
      "type": "SALARY_PERCENTAGE",
      "percentage": 5.0,
      "grossAmount": {
        "amount": 200.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netAmount": {
        "amount": 160.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "taxRelief": {
        "amount": 40.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
        "method": "RELIEF_AT_SOURCE"
      },
      "frequency": "MONTHLY",
      "isActive": true,
      "isSalarySacrifice": false
    },
    "employerContribution": {
      "type": "FIXED_PERCENTAGE",
      "percentage": 7.5,
      "grossAmount": {
        "amount": 300.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "frequency": "MONTHLY"
    },
    "totalMonthlyContribution": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "autoEnrolmentDetails": {
    "isAutoEnrolmentScheme": true,
    "autoEnrolmentDate": "2020-10-01",
    "isQualifyingScheme": true,
    "minimumContributionsMet": true,
    "currentMinimumMember": 5.0,
    "currentMinimumEmployer": 3.0,
    "currentMinimumTotal": 8.0
  },
  "retirementAge": 67,
  "selectedRetirementAge": 65,
  "stateRetirementAge": 67,
  "crystallisedAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedAmount": {
    "amount": 36800.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxFreeCashAvailable": {
    "amount": 9200.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 25
  },
  "investmentChoice": {
    "hasInvestmentChoice": true,
    "numberOfFundsAvailable": 45,
    "selectedStrategy": "SELF_SELECTED",
    "defaultFundAvailable": true,
    "lifestylingAvailable": true,
    "canSwitchFunds": true,
    "fundSwitchingFee": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "assetAllocation": {
    "equities": 80.0,
    "bonds": 15.0,
    "cash": 5.0
  },
  "fundHoldings": [
    {
      "fundName": "Aviva My Future Growth Fund",
      "fundCode": "AVMFG",
      "units": 3200.00,
      "currentValue": {
        "amount": 29440.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 80.0,
      "fundCharge": 0.18
    },
    {
      "fundName": "Aviva Corporate Bond Fund",
      "fundCode": "AVCB",
      "units": 550.00,
      "currentValue": {
        "amount": 5520.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 15.0,
      "fundCharge": 0.12
    },
    {
      "fundName": "Aviva Cash Fund",
      "fundCode": "AVCASH",
      "currentValue": {
        "amount": 1840.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 5.0,
      "fundCharge": 0.05
    }
  },
  "projectedValueAtRetirement": {
    "lowGrowth": {
      "amount": 78000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "mediumGrowth": {
      "amount": 98000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "highGrowth": {
      "amount": 124000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "assumedRetirementAge": 65
  },
  "deathBenefits": {
    "beforeRetirement": {
      "type": "Full fund value",
      "amount": {
        "amount": 36800.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "isInTrust": true,
    "nominatedBeneficiaries": [
      {
        "name": "Sarah Smith",
        "relationship": "Spouse",
        "percentage": 100
      }
    ]
  },
  "charges": {
    "annualManagementCharge": 0.50,
    "groupDiscount": 0.25,
    "effectiveAMC": 0.25,
    "averageFundCharge": 0.15,
    "totalAnnualCharge": 0.40,
    "noSetupFee": true,
    "noExitFee": true,
    "fundSwitchingFee": 0.00
  },
  "portability": {
    "isPortable": true,
    "canContinueIfLeavingEmployer": true,
    "contributionRestrictionsOnLeaving": "Can continue personal contributions; employer contributions cease",
    "chargesOnLeaving": "Group discount may be lost; charges may increase to 0.75%"
  },
  "adviserDetails": {
    "adviserName": "Corporate HR Team",
    "firmName": "ABC Manufacturing Ltd",
    "adviceDate": "2020-09-15",
    "lastReviewDate": "2025-09-10"
  },
  "notes": "Group Personal Pension with good employer contributions (7.5%). Benefiting from group discount (0.25% reduction). Individual policy ownership means portable on leaving. Investment choice allows self-selection. Review allocation every 2-3 years. Death benefits written in trust.",
  "createdAt": "2020-10-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**Group Scheme Features:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `groupSpecificFeatures` | object | Required | Container for GPP-specific features |
| `groupSpecificFeatures.isGroupScheme` | boolean | Required | Whether this is a group scheme |
| `groupSpecificFeatures.individualPolicy` | boolean | Required | Whether member owns individual policy (true for GPP) |
| `groupSpecificFeatures.groupNegotiatedTerms` | boolean | Required | Whether terms negotiated at group level |
| `groupSpecificFeatures.portableOnLeaving` | boolean | Required | Whether pension portable when leaving employer |
| `groupSpecificFeatures.canContinueContributionsAfterLeaving` | boolean | Required | Whether can continue personal contributions after leaving |
| `groupSpecificFeatures.groupDiscountApplied` | boolean | Required | Whether group discount on charges applies |
| `groupSpecificFeatures.groupChargeReduction` | decimal | Optional | Percentage reduction in charges due to group terms |

**Investment Choice:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `investmentChoice` | object | Required | Investment options and flexibility |
| `investmentChoice.hasInvestmentChoice` | boolean | Required | Whether member can choose investments |
| `investmentChoice.numberOfFundsAvailable` | integer | Optional | Number of funds available to choose from |
| `investmentChoice.selectedStrategy` | string (enum) | Required | DEFAULT_FUND, LIFESTYLING, SELF_SELECTED |
| `investmentChoice.defaultFundAvailable` | boolean | Required | Whether default fund option available |
| `investmentChoice.lifestylingAvailable` | boolean | Required | Whether lifestyling option available |
| `investmentChoice.canSwitchFunds` | boolean | Required | Whether can switch between funds |
| `investmentChoice.fundSwitchingFee` | MoneyValue | Optional | Fee for switching funds (typically £0) |

**Portability:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `portability` | object | Required | Portability details |
| `portability.isPortable` | boolean | Required | Whether pension can be retained on leaving |
| `portability.canContinueIfLeavingEmployer` | boolean | Required | Whether can keep pension active after leaving |
| `portability.contributionRestrictionsOnLeaving` | string | Optional | Restrictions on contributions after leaving |
| `portability.chargesOnLeaving` | string | Optional | How charges may change on leaving employment |

#### Validation Rules

**Group Personal Pension Characteristics:**
- Individual policy ownership: member owns policy, not employer
- Group negotiated terms: charges and terms negotiated at employer level
- Portability: pension portable when leaving employer
- Can continue contributions: member can continue personal contributions after leaving
- Relief at source: tax relief typically claimed via relief at source method
- Investment choice: typically offers wider investment choice than group schemes

**Employer Contribution Validation:**
- Employer contributions cease when leaving employment
- Member can continue personal contributions
- Group discount may be lost on leaving (charges may increase)

**Auto-Enrolment Compliance:**
- Can be used for auto-enrolment if meets qualifying scheme criteria
- Minimum contribution requirements: 8% total (5% employee, 3% employer minimum)

---

### 14.51 Arrangement - Pension Contract (Executive Pension Plan)

The `ExecutivePensionPlanArrangement` contract represents Executive Pension Plans (EPP), typically high-value arrangements for company directors and senior executives with enhanced benefits.

**Reference Type:** ExecutivePensionPlanArrangement is a reference type with identity (has `id` field).

**Key Features:**
- High contribution limits for directors/executives
- Company-funded or co-funded arrangements
- Enhanced death benefits (often 4× salary)
- Flexible investment options including DFM services
- May include Additional Voluntary Contributions (AVCs)
- Often includes income protection or critical illness cover
- Trustee structure or individual policy options

#### Complete Executive Pension Plan Arrangement Contract

```json
{
  "id": 30008,
  "href": "/api/v2/factfinds/679/arrangements/pensions/30008",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "PENSION",
  "pensionType": "EXECUTIVE_PENSION_PLAN",
  "productName": "Quilter Executive Pension Plan",
  "providerName": "Quilter",
  "provider": {
    "id": 888,
    "href": "/api/v2/providers/888"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "policyNumber": "EPP-987654321",
  "membershipNumber": "EXEC-123456",
  "startDate": "2012-04-06",
  "executiveDetails": {
    "employerCompany": "XYZ Technology Ltd",
    "memberRole": "Chief Financial Officer",
    "memberDirector": true,
    "schemeSetupDate": "2012-04-06",
    "isCompanyDirector": true,
    "employment": {
      "id": 1003,
      "href": "/api/v2/factfinds/679/employment/1003"
    }
  },
  "currentValue": {
    "amount": 685000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "totalContributions": {
    "memberContributions": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "employerContributions": {
      "amount": 480000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "additionalVoluntaryContributions": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalContributed": {
      "amount": 480000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "growthToDate": {
    "amount": 205000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 42.7
  },
  "contributionStructure": {
    "memberContribution": {
      "type": "NONE",
      "percentage": 0.0,
      "grossAmount": {
        "amount": 0.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "isActive": false
    },
    "employerContribution": {
      "type": "ANNUAL_LUMP_SUM",
      "annualAmount": {
        "amount": 40000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "frequency": "ANNUALLY",
      "contributionMonth": "APRIL",
      "isActive": true,
      "contributionStrategy": "Maximum annual allowance utilization",
      "carryForwardUsed": true
    },
    "additionalVoluntaryContributions": {
      "avcAvailable": true,
      "avcActive": false,
      "avcAmount": {
        "amount": 0.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    }
  },
  "taxStrategy": {
    "annualAllowanceUsed": {
      "amount": 40000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "annualAllowanceRemaining": {
      "amount": 20000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "carryForwardAvailable": {
      "amount": 0.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "taperedAnnualAllowance": {
      "applies": false,
      "adjustedIncome": {
        "amount": 0.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "reducedAllowance": {
        "amount": 60000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "moneyPurchaseAnnualAllowance": {
      "applies": false
    }
  },
  "retirementAge": 67,
  "selectedRetirementAge": 60,
  "stateRetirementAge": 67,
  "crystallisedAmount": {
    "amount": 0.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "uncrystallisedAmount": {
    "amount": 685000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "taxFreeCashAvailable": {
    "amount": 171250.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 25
  },
  "investmentManagement": {
    "investmentApproach": "DISCRETIONARY_FUND_MANAGEMENT",
    "discretionaryFundManager": {
      "name": "Quilter Cheviot",
      "mandateType": "BALANCED_GROWTH",
      "mandateStartDate": "2018-06-01",
      "reviewFrequency": "QUARTERLY"
    },
    "hasInvestmentChoice": true,
    "investmentRestrictions": "None - full discretion within mandate",
    "modelPortfolio": "Quilter Cheviot Balanced Growth"
  },
  "assetAllocation": {
    "equities": 55.0,
    "bonds": 25.0,
    "property": 10.0,
    "alternatives": 7.0,
    "cash": 3.0
  },
  "fundHoldings": [
    {
      "fundName": "Quilter Investors Equity Fund",
      "fundCode": "QIEF",
      "units": 38000.00,
      "currentValue": {
        "amount": 376750.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 55.0
    },
    {
      "fundName": "Quilter Investors Corporate Bond Fund",
      "fundCode": "QICB",
      "units": 17000.00,
      "currentValue": {
        "amount": 171250.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 25.0
    },
    {
      "fundName": "Quilter Investors Property Fund",
      "fundCode": "QIPF",
      "units": 6800.00,
      "currentValue": {
        "amount": 68500.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 10.0
    },
    {
      "fundName": "Quilter Investors Alternatives Fund",
      "fundCode": "QIAF",
      "units": 4800.00,
      "currentValue": {
        "amount": 47950.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 7.0
    },
    {
      "fundName": "Cash Reserve",
      "fundCode": "CASH",
      "currentValue": {
        "amount": 20550.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 3.0
    }
  ],
  "projectedValueAtRetirement": {
    "lowGrowth": {
      "amount": 985000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "mediumGrowth": {
      "amount": 1240000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "highGrowth": {
      "amount": 1580000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    },
    "assumedRetirementAge": 60
  },
  "deathBenefits": {
    "beforeRetirement": {
      "type": "Enhanced death benefit",
      "amount": {
        "amount": 685000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "lumpSumLifeCover": {
        "amount": 480000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
        "calculation": "4 × Executive Salary (£120,000)"
      },
      "totalDeathBenefit": {
        "amount": 1165000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
        "explanation": "Fund value (£685,000) + Life cover (£480,000)"
      }
    },
    "isInTrust": true,
    "trustType": "DISCRETIONARY_TRUST",
    "trustees": [
      "Sarah Smith",
      "Professional Trustee Ltd"
    ],
    "nominatedBeneficiaries": [
      {
        "name": "Sarah Smith",
        "relationship": "Spouse",
        "percentage": 60
      },
      {
        "name": "Emily Smith",
        "relationship": "Child",
        "percentage": 20
      },
      {
        "name": "Thomas Smith",
        "relationship": "Child",
        "percentage": 20
      }
    ]
  },
  "charges": {
    "annualManagementCharge": 0.35,
    "discretionaryFundManagementFee": 0.75,
    "platformFee": 0.25,
    "averageFundCharge": 0.15,
    "totalAnnualCharge": 1.50,
    "performanceFee": {
      "applies": false
    }
  },
  "additionalBenefits": {
    "incomeProtectionIncluded": true,
    "incomeProtectionDetails": {
      "coverAmount": {
        "amount": 6000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
        "period": "MONTHLY"
      },
      "deferredPeriod": 13,
      "deferredPeriodUnit": "WEEKS",
      "coverUntilAge": 65
    },
    "criticalIllnessCoverIncluded": false
  },
  "adviserDetails": {
    "adviserName": "Senior Wealth Adviser",
    "firmName": "Elite Financial Planning Ltd",
    "adviceDate": "2012-03-20",
    "lastReviewDate": "2025-11-05",
    "reviewFrequency": "ANNUALLY"
  },
  "notes": "High-value Executive Pension Plan for CFO. Company-funded with £40k annual contributions utilizing full annual allowance. Discretionary fund management via Quilter Cheviot with balanced growth mandate. Enhanced death benefits include 4× salary life cover (£480k) plus fund value. Income protection included (£6k/month after 13 weeks, to age 65). Death benefits written in discretionary trust. Quarterly investment reviews. Tax-efficient remuneration structure.",
  "createdAt": "2012-04-15T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**Executive Arrangement Features:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `executiveDetails` | object | Required | Container for executive arrangement details |
| `executiveDetails.employerCompany` | string | Required | Name of employer company |
| `executiveDetails.memberRole` | string | Required | Member's role/position in company |
| `executiveDetails.memberDirector` | boolean | Required | Whether member is company director |
| `executiveDetails.isCompanyDirector` | boolean | Required | Whether member is registered company director |
| `taxStrategy` | object | Required | Tax planning and annual allowance tracking |
| `taxStrategy.annualAllowanceUsed` | MoneyValue | Required | Annual allowance used in current tax year |
| `taxStrategy.annualAllowanceRemaining` | MoneyValue | Required | Annual allowance remaining |
| `taxStrategy.carryForwardAvailable` | MoneyValue | Required | Unused allowance available from previous 3 years |
| `taxStrategy.taperedAnnualAllowance` | object | Required | Tapered annual allowance details (high earners) |

**Investment Management:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `investmentManagement` | object | Required | Investment management approach |
| `investmentManagement.investmentApproach` | string (enum) | Required | SELF_DIRECTED, ADVISORY, DISCRETIONARY_FUND_MANAGEMENT |
| `investmentManagement.discretionaryFundManager` | object | Conditional | DFM details (required if approach = DISCRETIONARY_FUND_MANAGEMENT) |
| `investmentManagement.discretionaryFundManager.name` | string | Required | Name of discretionary fund manager |
| `investmentManagement.discretionaryFundManager.mandateType` | string | Required | Investment mandate (e.g., BALANCED_GROWTH, INCOME, CAPITAL_PRESERVATION) |
| `investmentManagement.discretionaryFundManager.reviewFrequency` | string (enum) | Required | MONTHLY, QUARTERLY, SEMI_ANNUALLY, ANNUALLY |

**Enhanced Death Benefits:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `deathBenefits.beforeRetirement.lumpSumLifeCover` | MoneyValue | Optional | Additional life cover beyond fund value |
| `deathBenefits.beforeRetirement.totalDeathBenefit` | MoneyValue | Required | Total death benefit (fund + life cover) |
| `deathBenefits.trustType` | string (enum) | Conditional | DISCRETIONARY_TRUST, BARE_TRUST, FLEXIBLE_TRUST |
| `deathBenefits.trustees` | array of strings | Conditional | Named trustees (required if trust established) |

**Additional Benefits:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `additionalBenefits` | object | Optional | Additional benefits included in EPP |
| `additionalBenefits.incomeProtectionIncluded` | boolean | Required | Whether income protection included |
| `additionalBenefits.incomeProtectionDetails` | object | Conditional | IP details (required if included) |
| `additionalBenefits.criticalIllnessCoverIncluded` | boolean | Required | Whether critical illness cover included |

#### Validation Rules

**Executive Pension Plan Characteristics:**
- Typically high contribution levels (£30,000 - £60,000+ annually)
- Company-funded or co-funded arrangements
- Enhanced death benefits common (2-4× salary life cover)
- Discretionary fund management often used
- May include additional benefits (income protection, critical illness)
- Death benefits typically in discretionary trust for IHT efficiency

**Tax Planning Requirements:**
- Annual allowance: £60,000 (2024/25) or 100% of earnings, whichever lower
- Tapered annual allowance for high earners (adjusted income > £260,000)
- Minimum tapered allowance: £10,000
- Carry forward: unused allowances from previous 3 tax years
- Money Purchase Annual Allowance (MPAA): £10,000 if flexibly accessed

**Contribution Validation:**
- If `taperedAnnualAllowance.applies = true`, validate contribution against reduced allowance
- If `moneyPurchaseAnnualAllowance.applies = true`, maximum contribution £10,000
- Total contributions across all pensions must not exceed annual allowance (+ carry forward)

**Enhanced Death Benefits:**
- Life cover typically 2-4× executive salary
- Total death benefit = fund value + life cover
- Life cover element typically written in trust
- Life cover premiums paid by employer (benefit-in-kind tax implications)

---

### 14.52 Arrangement - Investment Contract (Stocks & Shares ISA)

The `StocksSharesISAArrangement` contract represents Stocks & Shares ISAs, tax-efficient investment wrappers that shelter investment returns from income tax and capital gains tax.

**Reference Type:** StocksSharesISAArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Annual subscription limit (£20,000 for 2024/25)
- Tax-free growth and income
- Flexible withdrawals without loss of allowance (from April 2024)
- Wide investment choice (funds, ETFs, investment trusts, bonds, shares)
- ISA transfer rules and history
- No tax reporting required

#### Complete Stocks & Shares ISA Arrangement Contract

```json
{
  "id": 13002,
  "href": "/api/v2/factfinds/679/arrangements/investments/13002",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "INVESTMENT",
  "investmentType": "STOCKS_SHARES_ISA",
  "productName": "Vanguard Stocks & Shares ISA",
  "providerName": "Vanguard",
  "provider": {
    "id": 456,
    "href": "/api/v2/providers/456"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "accountNumber": "ISA-123456789",
  "startDate": "2015-04-06",
  "currentValue": {
    "amount": 142000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "totalContributions": {
    "amount": 98000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "gainLoss": {
    "amount": 44000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 44.9
  },
  "isaAllowanceTracking": {
    "currentTaxYear": "2025/26",
    "annualAllowance": {
      "amount": 20000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "usedThisYear": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "remainingThisYear": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "subscriptionHistory": [
      {
        "taxYear": "2025/26",
        "subscribed": {
          "amount": 15000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      },
      {
        "taxYear": "2024/25",
        "subscribed": {
          "amount": 20000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      },
      {
        "taxYear": "2023/24",
        "subscribed": {
          "amount": 20000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      }
    ],
    "totalHistoricSubscriptions": {
      "amount": 98000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "regularContributions": {
    "amount": {
      "amount": 1250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2015-04-06",
    "isActive": true,
    "paymentMethod": "DIRECT_DEBIT",
    "annualEquivalent": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "assetAllocation": {
    "equities": 80.0,
    "bonds": 15.0,
    "cash": 5.0
  },
  "fundHoldings": [
    {
      "fundName": "Vanguard LifeStrategy 80% Equity Fund",
      "fundCode": "GB00B4PQW151",
      "ISIN": "GB00B4PQW151",
      "units": 6200.00,
      "currentValue": {
        "amount": 113600.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 80.0,
      "fundCharge": 0.22
    },
    {
      "fundName": "Vanguard UK Government Bond Index Fund",
      "fundCode": "GB00B1S74Q32",
      "ISIN": "GB00B1S74Q32",
      "units": 2000.00,
      "currentValue": {
        "amount": 21300.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 15.0,
      "fundCharge": 0.15
    },
    {
      "fundName": "Cash Reserve",
      "fundCode": "CASH",
      "currentValue": {
        "amount": 7100.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 5.0
    }
  ],
  "withdrawals": {
    "hasRegularWithdrawals": false,
    "adhocWithdrawalsThisYear": [
      {
        "date": "2025-12-15",
        "amount": {
          "amount": 5000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        },
        "purpose": "Christmas expenses",
        "impactsAllowance": false
      }
    ],
    "totalWithdrawnThisYear": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "flexibleISA": {
    "isFlexibleISA": true,
    "canReplaceWithdrawals": true,
    "withdrawalsThisYear": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "replacementAllowanceAvailable": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "effectiveAllowanceRemaining": {
      "amount": 10000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
      "calculation": "Standard remaining (£5,000) + Withdrawal replacement (£5,000)"
    }
  },
  "transferHistory": {
    "transfersIn": [
      {
        "transferDate": "2018-06-15",
        "fromProvider": "Hargreaves Lansdown",
        "amount": {
          "amount": 15000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        },
        "taxYear": "2018/19"
      }
    ],
    "totalTransferredIn": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "charges": {
    "platformFee": 0.15,
    "fundCharges": 0.21,
    "totalAnnualCharge": 0.36
  },
  "incomeGenerated": {
    "dividendsReceivedThisYear": {
      "amount": 3200.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "interestReceivedThisYear": {
      "amount": 150.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalIncomeThisYear": {
      "amount": 3350.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "incomeReinvested": true,
    "taxTreatment": "TAX_FREE"
  },
  "riskProfile": {
    "targetRiskLevel": 6,
    "atrRef": {
      "id": 3333,
      "href": "/api/v2/factfinds/679/clients/123/attitude-to-risk/3333"
    }
  },
  "taxWrapper": "ISA",
  "investmentObjective": "Long-term capital growth, tax-efficiently. Build wealth for retirement and major life goals.",
  "adviserDetails": {
    "adviserName": "Jane Financial Adviser",
    "firmName": "XYZ Wealth Management",
    "adviceDate": "2015-03-20",
    "lastReviewDate": "2025-11-10"
  },
  "notes": "Stocks & Shares ISA with consistent monthly contributions (£1,250). Utilizing annual ISA allowance effectively. Good growth (44.9% total return). Flexible ISA allows replacement of withdrawals. Tax-free income and growth. Review allocation annually. Consider maxing out ISA allowance if cash flow permits.",
  "createdAt": "2015-04-10T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**ISA Allowance Tracking:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `isaAllowanceTracking` | object | Required | Container for ISA allowance tracking |
| `isaAllowanceTracking.currentTaxYear` | string | Required | Current tax year (format: "YYYY/YY") |
| `isaAllowanceTracking.annualAllowance` | MoneyValue | Required | Annual ISA allowance for current tax year (£20,000 for 2024/25) |
| `isaAllowanceTracking.usedThisYear` | MoneyValue | Required | Amount of allowance used in current tax year |
| `isaAllowanceTracking.remainingThisYear` | MoneyValue | Required | Remaining allowance for current tax year |
| `isaAllowanceTracking.subscriptionHistory` | array | Optional | Historic ISA subscriptions by tax year |
| `isaAllowanceTracking.totalHistoricSubscriptions` | MoneyValue | Required | Total subscriptions across all tax years |

**Flexible ISA Features:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `flexibleISA` | object | Required | Flexible ISA withdrawal replacement tracking |
| `flexibleISA.isFlexibleISA` | boolean | Required | Whether ISA is flexible (allows withdrawal replacement) |
| `flexibleISA.canReplaceWithdrawals` | boolean | Required | Whether withdrawals can be replaced same tax year |
| `flexibleISA.withdrawalsThisYear` | MoneyValue | Required | Total withdrawn in current tax year |
| `flexibleISA.replacementAllowanceAvailable` | MoneyValue | Required | Additional allowance available from withdrawals |
| `flexibleISA.effectiveAllowanceRemaining` | MoneyValue | Required | Total effective allowance (standard + replacement) |

**Transfer History:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `transferHistory` | object | Optional | ISA transfer history |
| `transferHistory.transfersIn` | array | Optional | List of ISA transfers received |
| `transferHistory.transfersIn[].transferDate` | string (date) | Required | Date transfer completed |
| `transferHistory.transfersIn[].fromProvider` | string | Required | Previous ISA provider |
| `transferHistory.transfersIn[].amount` | MoneyValue | Required | Amount transferred |
| `transferHistory.transfersIn[].taxYear` | string | Required | Tax year of transfer |

**Income Generated:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `incomeGenerated` | object | Required | Income tracking within ISA |
| `incomeGenerated.dividendsReceivedThisYear` | MoneyValue | Required | Dividends received in current tax year |
| `incomeGenerated.interestReceivedThisYear` | MoneyValue | Required | Interest received in current tax year |
| `incomeGenerated.totalIncomeThisYear` | MoneyValue | Required | Total income received |
| `incomeGenerated.incomeReinvested` | boolean | Required | Whether income automatically reinvested |
| `incomeGenerated.taxTreatment` | string | Required | Tax treatment of income (always "TAX_FREE" for ISA) |

#### Validation Rules

**ISA Allowance Rules (2024/25):**
- Annual ISA allowance: £20,000
- Can subscribe to one Stocks & Shares ISA per tax year
- Can transfer previous years' ISAs without affecting current year allowance
- Flexible ISA: withdrawals can be replaced in same tax year without using allowance

**ISA Transfer Rules:**
- Can transfer current year ISA subscriptions: must transfer all current year subscriptions
- Can transfer previous years' ISA: can transfer partial or full amount
- Transfers don't count towards annual allowance
- Current year subscriptions to new ISA stop during transfer period

**ISA Eligibility:**
- UK resident (or Crown employee/spouse serving overseas)
- Aged 18+ for Stocks & Shares ISA
- One Stocks & Shares ISA per tax year

**Flexible ISA Calculation:**
```
effectiveAllowanceRemaining = (annualAllowance - usedThisYear) + withdrawalsThisYear
```

---

### 14.53 Arrangement - Investment Contract (Cash ISA)

The `CashISAArrangement` contract represents Cash ISAs, tax-free savings accounts that shelter interest from income tax.

**Reference Type:** CashISAArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Tax-free interest
- Annual subscription limit (shares overall £20,000 ISA allowance)
- Instant access or fixed-term options
- Flexible ISA features
- ISA transfer capabilities
- No capital at risk

#### Complete Cash ISA Arrangement Contract

```json
{
  "id": 13003,
  "href": "/api/v2/factfinds/679/arrangements/investments/13003",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "INVESTMENT",
  "investmentType": "CASH_ISA",
  "productName": "Premium Cash ISA",
  "providerName": "Nationwide Building Society",
  "provider": {
    "id": 111,
    "href": "/api/v2/providers/111"
  },
  "client": {
    "id": 123,
    "href": "/api/v2/factfinds/679/clients/123"
  },
  "accountNumber": "CISA-987654321",
  "startDate": "2024-04-06",
  "cashISAType": "INSTANT_ACCESS",
  "currentValue": {
    "amount": 18500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "totalDeposits": {
    "amount": 18000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "totalInterestEarned": {
    "amount": 500.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "isaAllowanceTracking": {
    "currentTaxYear": "2025/26",
    "annualAllowance": {
      "amount": 20000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "usedThisYear": {
      "amount": 4000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "remainingThisYear": {
      "amount": 16000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "subscriptionHistory": [
      {
        "taxYear": "2025/26",
        "subscribed": {
          "amount": 4000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      },
      {
        "taxYear": "2024/25",
        "subscribed": {
          "amount": 14000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      }
    ],
    "totalHistoricSubscriptions": {
      "amount": 18000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "interestRate": {
    "grossAER": 4.25,
    "rateType": "VARIABLE",
    "lastRateChange": "2025-08-01",
    "bonusRate": 0.50,
    "bonusExpiry": "2026-04-05",
    "baseRate": 3.75,
    "rateGuaranteedUntil": null
  },
  "regularContributions": {
    "amount": {
      "amount": 500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2024-04-06",
    "isActive": true,
    "paymentMethod": "STANDING_ORDER"
  },
  "accessTerms": {
    "accessType": "INSTANT_ACCESS",
    "withdrawalLimit": null,
    "penaltyForWithdrawal": false,
    "noticePeriod": 0,
    "noticePeriodUnit": null
  },
  "flexibleISA": {
    "isFlexibleISA": true,
    "canReplaceWithdrawals": true,
    "withdrawalsThisYear": {
      "amount": 2000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "replacementAllowanceAvailable": {
      "amount": 2000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "interestPayment": {
    "interestEarnedThisYear": {
      "amount": 780.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "interestPaymentFrequency": "MONTHLY",
    "interestReinvested": true,
    "taxTreatment": "TAX_FREE"
  },
  "taxWrapper": "ISA",
  "investmentObjective": "Emergency fund and short-term savings with tax-free interest",
  "notes": "Cash ISA for emergency fund. Instant access provides liquidity. Variable rate currently 4.25% AER including 0.50% bonus until April 2026. Flexible ISA allows replacement of withdrawals. Tax-free interest. Monitor rate after bonus expiry.",
  "createdAt": "2024-04-10T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**Cash ISA Type:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `cashISAType` | string (enum) | Required | INSTANT_ACCESS, NOTICE_ACCOUNT, FIXED_TERM, REGULAR_SAVER |

**Interest Rate:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `interestRate` | object | Required | Interest rate details |
| `interestRate.grossAER` | decimal | Required | Gross Annual Equivalent Rate (%) |
| `interestRate.rateType` | string (enum) | Required | VARIABLE, FIXED |
| `interestRate.lastRateChange` | string (date) | Optional | Date rate last changed |
| `interestRate.bonusRate` | decimal | Optional | Bonus rate component (%) |
| `interestRate.bonusExpiry` | string (date) | Optional | Date bonus rate expires |
| `interestRate.baseRate` | decimal | Optional | Base rate excluding bonus (%) |
| `interestRate.rateGuaranteedUntil` | string (date) | Optional | Date rate guaranteed until (for fixed-term) |

**Access Terms:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `accessTerms` | object | Required | Access and withdrawal terms |
| `accessTerms.accessType` | string (enum) | Required | INSTANT_ACCESS, NOTICE_REQUIRED, FIXED_TERM |
| `accessTerms.withdrawalLimit` | integer | Optional | Number of withdrawals allowed per year |
| `accessTerms.penaltyForWithdrawal` | boolean | Required | Whether penalty applies for early withdrawal |
| `accessTerms.noticePeriod` | integer | Optional | Notice period required for withdrawal |
| `accessTerms.noticePeriodUnit` | string (enum) | Optional | DAYS, MONTHS |

**Interest Payment:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `interestPayment` | object | Required | Interest payment details |
| `interestPayment.interestEarnedThisYear` | MoneyValue | Required | Interest earned in current tax year |
| `interestPayment.interestPaymentFrequency` | string (enum) | Required | MONTHLY, QUARTERLY, ANNUALLY |
| `interestPayment.interestReinvested` | boolean | Required | Whether interest automatically reinvested |
| `interestPayment.taxTreatment` | string | Required | Tax treatment (always "TAX_FREE" for Cash ISA) |

#### Validation Rules

**Cash ISA Allowance:**
- Shares overall £20,000 ISA allowance with Stocks & Shares ISA
- Can subscribe to one Cash ISA per tax year
- Can split allowance between Cash ISA and Stocks & Shares ISA

**Cash ISA Types:**
- **Instant Access:** Withdraw anytime without penalty
- **Notice Account:** Requires notice period (typically 30-120 days)
- **Fixed-Term:** Fixed rate for set period; early withdrawal penalties apply
- **Regular Saver:** Monthly contributions required; often higher rate

**Interest Rate Rules:**
- AER (Annual Equivalent Rate) accounts for compounding
- Bonus rates typically expire after 12 months
- Variable rates can change at provider's discretion
- Fixed rates guaranteed for fixed term

---

### 14.54 Arrangement - Investment Contract (Lifetime ISA)

The `LifetimeISAArrangement` contract represents Lifetime ISAs (LISA), designed for first-time home buyers or retirement savings with 25% government bonus.

**Reference Type:** LifetimeISAArrangement is a reference type with identity (has `id` field).

**Key Features:**
- 25% government bonus on contributions (up to £1,000/year)
- Annual contribution limit £4,000
- Age eligibility: 18-39 to open, contribute until age 50
- Withdrawal purposes: first home purchase or age 60+
- Early withdrawal penalty: 25% (loses bonus + some capital)
- Cash or Stocks & Shares options

#### Complete Lifetime ISA Arrangement Contract

```json
{
  "id": 13004,
  "href": "/api/v2/factfinds/679/arrangements/investments/13004",
  "factfind": {
    "id": 679,
    "href": "/api/v2/factfinds/679"
  },
  "arrangementCategory": "INVESTMENT",
  "investmentType": "LIFETIME_ISA",
  "lisaType": "STOCKS_SHARES_LISA",
  "productName": "Moneybox Lifetime ISA",
  "providerName": "Moneybox",
  "provider": {
    "id": 222,
    "href": "/api/v2/providers/222"
  },
  "client": {
    "id": 456,
    "href": "/api/v2/factfinds/679/clients/456"
  },
  "accountNumber": "LISA-456789123",
  "startDate": "2022-04-06",
  "accountOpenedAge": 28,
  "currentValue": {
    "amount": 17200.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "valuationDate": "2026-02-18",
  "memberContributions": {
    "amount": 12000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "governmentBonus": {
    "amount": 3000.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
  },
  "investmentGrowth": {
    "amount": 2200.00,
    "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      },
    "percentage": 14.7
  },
  "lisaAllowanceTracking": {
    "currentTaxYear": "2025/26",
    "annualAllowance": {
      "amount": 4000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "usedThisYear": {
      "amount": 3000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "remainingThisYear": {
      "amount": 1000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "governmentBonusThisYear": {
      "amount": 750.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "subscriptionHistory": [
      {
        "taxYear": "2025/26",
        "memberContribution": {
          "amount": 3000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        },
        "governmentBonus": {
          "amount": 750.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      },
      {
        "taxYear": "2024/25",
        "memberContribution": {
          "amount": 4000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        },
        "governmentBonus": {
          "amount": 1000.00,
          "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
        }
      }
    ]
  },
  "regularContributions": {
    "amount": {
      "amount": 250.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "frequency": "MONTHLY",
    "startDate": "2022-04-06",
    "isActive": true,
    "annualEquivalent": {
      "amount": 3000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },
  "assetAllocation": {
    "equities": 90.0,
    "bonds": 5.0,
    "cash": 5.0
  },
  "fundHoldings": [
    {
      "fundName": "Vanguard FTSE Global All Cap Index Fund",
      "fundCode": "GB00BD3RZ582",
      "units": 1450.00,
      "currentValue": {
        "amount": 15480.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 90.0
    },
    {
      "fundName": "Cash Reserve",
      "fundCode": "CASH",
      "currentValue": {
        "amount": 1720.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "percentage": 10.0
    }
  ],
  "eligibilityAndWithdrawal": {
    "ageAtOpening": 28,
    "canContributeUntilAge": 50,
    "yearsUntilContributionCutoff": 22,
    "normalAccessAge": 60,
    "yearsUntilNormalAccess": 32,
    "qualifiedWithdrawalReasons": [
      "FIRST_HOME_PURCHASE",
      "AGE_60_OR_OVER",
      "TERMINAL_ILLNESS"
    ],
    "earlyWithdrawalPenalty": 25.0,
    "isFirstTimeBuyer": true,
    "firstHomeEligibility": {
      "maxPropertyPrice": {
        "amount": 450000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "mustBeUKProperty": true,
      "mustBeMainResidence": true,
      "mustUseMortgage": true,
      "minimumConveyancerHoldPeriod": "12 months"
    }
  },
  "penaltyCalculation": {
    "ifWithdrawnNow": {
      "currentValue": {
        "amount": 17200.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "penaltyPercentage": 25.0,
      "penaltyAmount": {
        "amount": 4300.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "netProceeds": {
        "amount": 12900.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "bonusLost": {
        "amount": 3000.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      },
      "growthLost": {
        "amount": 1300.00,
        "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
      }
    }
  },
  "charges": {
    "platformFee": 0.45,
    "fundCharges": 0.23,
    "totalAnnualCharge": 0.68
  },
  "purposeAndObjective": "Saving for first home purchase. Target property value: £350,000. Aiming to complete house purchase within 5-7 years.",
  "taxWrapper": "LIFETIME_ISA",
  "notes": "Lifetime ISA for first home purchase. Regular monthly contributions of £250. Government bonus of 25% received (£3,000 so far). Good investment growth (14.7%). Must use for first home purchase (under £450,000) or wait until age 60 to avoid 25% penalty. Monitor progress towards house deposit goal.",
  "createdAt": "2022-04-10T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Field Definitions

**LISA Type:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `lisaType` | string (enum) | Required | CASH_LISA, STOCKS_SHARES_LISA |

**Government Bonus Tracking:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `memberContributions` | MoneyValue | Required | Total member contributions (excludes bonus) |
| `governmentBonus` | MoneyValue | Required | Total government bonus received |
| `investmentGrowth` | MoneyValue | Required | Investment growth/interest earned |
| `lisaAllowanceTracking.governmentBonusThisYear` | MoneyValue | Required | Government bonus received in current tax year |
| `lisaAllowanceTracking.subscriptionHistory[].governmentBonus` | MoneyValue | Required | Government bonus for each tax year |

**Eligibility & Withdrawal:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `eligibilityAndWithdrawal` | object | Required | LISA eligibility and withdrawal rules |
| `eligibilityAndWithdrawal.ageAtOpening` | integer | Required | Age when LISA opened (must be 18-39) |
| `eligibilityAndWithdrawal.canContributeUntilAge` | integer | Required | Age contributions must stop (50) |
| `eligibilityAndWithdrawal.normalAccessAge` | integer | Required | Age for penalty-free withdrawal (60) |
| `eligibilityAndWithdrawal.qualifiedWithdrawalReasons` | array | Required | Reasons for penalty-free withdrawal |
| `eligibilityAndWithdrawal.earlyWithdrawalPenalty` | decimal | Required | Early withdrawal penalty percentage (25%) |
| `eligibilityAndWithdrawal.isFirstTimeBuyer` | boolean | Required | Whether member is first-time buyer |
| `eligibilityAndWithdrawal.firstHomeEligibility` | object | Conditional | First home purchase criteria |

**Penalty Calculation:**

| Field | Type | Behavior | Description |
|-------|------|----------|-------------|
| `penaltyCalculation` | object | Required | Early withdrawal penalty breakdown |
| `penaltyCalculation.ifWithdrawnNow.penaltyPercentage` | decimal | Required | Penalty rate (25%) |
| `penaltyCalculation.ifWithdrawnNow.penaltyAmount` | MoneyValue | Required | Calculated penalty amount |
| `penaltyCalculation.ifWithdrawnNow.netProceeds` | MoneyValue | Required | Amount received after penalty |
| `penaltyCalculation.ifWithdrawnNow.bonusLost` | MoneyValue | Required | Government bonus lost to penalty |

#### Validation Rules

**LISA Eligibility:**
- Age at opening: 18-39
- Can contribute from age 18 until day before 50th birthday
- Maximum contribution: £4,000 per tax year
- Government bonus: 25% on contributions (max £1,000/year)
- Counts towards overall £20,000 ISA allowance

**Qualified Withdrawals (No Penalty):**
1. **First Home Purchase:**
   - Property price ≤ £450,000
   - Must be first-time buyer
   - Property in UK
   - Must be main residence
   - Must use mortgage
   - LISA open for at least 12 months

2. **Age 60 or over:**
   - Can withdraw penalty-free from age 60

3. **Terminal Illness:**
   - With less than 12 months to live

**Early Withdrawal Penalty:**
- 25% penalty on entire fund value
- Loses all government bonus
- May lose some original capital
- Example: £10,000 fund → £2,500 penalty → £7,500 received

**Government Bonus Calculation:**
```
governmentBonus = memberContribution × 0.25
maxBonusPerYear = £1,000 (on £4,000 contributions)
```

---

### 14.55 Arrangement - Investment Contract (Investment Bond - Onshore)

The `OnshoreInvestmentBondArrangement` contract represents onshore investment bonds (life insurance wrappers) with tax-efficient growth and 5% annual withdrawal allowance.

**Reference Type:** OnshoreInvestmentBondArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Life insurance wrapper with single/regular premium options
- Tax-deferred growth (no CGT within bond, no income tax on gains)
- 5% annual withdrawal allowance (cumulative if unused)
- Top-slicing relief on chargeable gains
- Segments for partial encashment
- Succession planning benefits

#### Complete Onshore Investment Bond Contract (Abbreviated)

```json
{
  "id": 13005,
  "href": "/api/v2/factfinds/679/arrangements/investments/13005",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "INVESTMENT",
  "investmentType": "INVESTMENT_BOND_ONSHORE",
  "productName": "Prudential International Investment Bond",
  "providerName": "Prudential",
  "client": {"id": 123, "href": "/api/v2/factfinds/679/clients/123"},
  "policyNumber": "BOND-123456789",
  "startDate": "2018-03-15",
  "currentValue": {"amount": 285000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "valuationDate": "2026-02-18",
  "premiumStructure": {
    "premiumType": "SINGLE_PREMIUM",
    "initialPremium": {"amount": 200000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "additionalPremiums": {"amount": 50000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "totalInvested": {"amount": 250000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "bondStructure": {
    "numberOfSegments": 100,
    "segmentValue": {"amount": 2850.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "segmentsRemaining": 100,
    "segmentsSurrendered": 0
  },
  "withdrawalAllowance": {
    "annualAllowancePercentage": 5.0,
    "cumulativeAllowanceAvailable": {"amount": 100000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "withdrawalsTaken": {"amount": 0.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "allowanceRemaining": {"amount": 100000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "yearsElapsed": 8,
    "calculation": "£250,000 × 5% × 8 years = £100,000 cumulative allowance"
  },
  "taxPosition": {
    "bondType": "ONSHORE",
    "taxTreatment": "TAX_DEFERRED",
    "chargeableGain": {"amount": 35000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "topSlicingReliefAvailable": true,
    "yearsHeld": 8,
    "averageGainPerYear": {"amount": 4375.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "basicRateTaxCredit": 20.0
  },
  "assetAllocation": {"equities": 70.0, "bonds": 20.0, "property": 5.0, "cash": 5.0},
  "charges": {"annualManagementCharge": 0.75, "fundCharges": 0.25, "totalAnnualCharge": 1.00},
  "lifeAssured": [
    {"name": "John Smith", "dateOfBirth": "1972-03-15", "smokerStatus": "NON_SMOKER"}
  ],
  "notes": "Onshore investment bond with 100 segments. 5% annual withdrawal allowance available. Tax-deferred growth with top-slicing relief. Consider partial encashments if higher rate taxpayer status changes.",
  "createdAt": "2018-03-20T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Key Field Definitions

| Field | Type | Description |
|-------|------|-------------|
| `bondStructure.numberOfSegments` | integer | Total segments (typically 100 or 1000) for flexible partial encashment |
| `withdrawalAllowance.annualAllowancePercentage` | decimal | Annual 5% withdrawal allowance |
| `withdrawalAllowance.cumulativeAllowanceAvailable` | MoneyValue | Unused allowance accumulates over years |
| `taxPosition.topSlicingReliefAvailable` | boolean | Whether top-slicing relief available on gains |
| `taxPosition.basicRateTaxCredit` | decimal | 20% basic rate tax already paid within bond |

#### Validation Rules

**5% Withdrawal Allowance:**
```
cumulativeAllowance = totalInvested × 5% × yearsElapsed
maxTaxDeferredWithdrawal = cumulativeAllowance - withdrawalsTaken
```

**Top-Slicing Relief:**
- Gain divided by years held = average gain per year
- Add average gain to income to determine tax rate
- Can reduce higher rate tax liability

---

### 14.56 Arrangement - Investment Contract (Investment Bond - Offshore)

The `OffshoreInvestmentBondArrangement` contract represents offshore investment bonds with gross roll-up and wider investment choice.

**Reference Type:** OffshoreInvestmentBondArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Gross roll-up (no UK tax within bond)
- Wider investment choice including alternative assets
- 5% annual withdrawal allowance (same as onshore)
- Currency options (GBP, USD, EUR)
- Non-UK domiciled investor benefits
- Chargeable event gain on full/partial surrender

#### Complete Offshore Investment Bond Contract (Abbreviated)

```json
{
  "id": 13006,
  "href": "/api/v2/factfinds/679/arrangements/investments/13006",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "INVESTMENT",
  "investmentType": "INVESTMENT_BOND_OFFSHORE",
  "productName": "RL360 Quantum Reserve",
  "providerName": "RL360",
  "jurisdiction": "ISLE_OF_MAN",
  "client": {"id": 123, "href": "/api/v2/factfinds/679/clients/123"},
  "policyNumber": "OFF-BOND-987654",
  "startDate": "2015-06-01",
  "bondCurrency": "USD",
  "currentValue": {"amount": 420000.00, "currency": {
        "code": "USD",
        "display": "US Dollar",
        "symbol": "$"
      }},
  "currentValueGBP": {"amount": 315000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "valuationDate": "2026-02-18",
  "premiumStructure": {
    "premiumType": "SINGLE_PREMIUM",
    "initialPremium": {"amount": 300000.00, "currency": {
        "code": "USD",
        "display": "US Dollar",
        "symbol": "$"
      }},
    "totalInvested": {"amount": 300000.00, "currency": {
        "code": "USD",
        "display": "US Dollar",
        "symbol": "$"
      }}
  },
  "bondStructure": {
    "numberOfSegments": 1000,
    "segmentValue": {"amount": 420.00, "currency": {
        "code": "USD",
        "display": "US Dollar",
        "symbol": "$"
      }},
    "segmentsRemaining": 1000
  },
  "withdrawalAllowance": {
    "annualAllowancePercentage": 5.0,
    "cumulativeAllowanceAvailable": {"amount": 165000.00, "currency": {
        "code": "USD",
        "display": "US Dollar",
        "symbol": "$"
      }},
    "allowanceRemaining": {"amount": 165000.00, "currency": {
        "code": "USD",
        "display": "US Dollar",
        "symbol": "$"
      }},
    "yearsElapsed": 11
  },
  "taxPosition": {
    "bondType": "OFFSHORE",
    "taxTreatment": "GROSS_ROLLUP",
    "chargeableGainOnSurrender": {"amount": 120000.00, "currency": {
        "code": "USD",
        "display": "US Dollar",
        "symbol": "$"
      }},
    "topSlicingReliefAvailable": true,
    "noUKTaxWithinBond": true,
    "taxDeferredUntilEncashment": true
  },
  "assetAllocation": {"equities": 65.0, "bonds": 15.0, "property": 10.0, "alternatives": 5.0, "cash": 5.0},
  "charges": {"annualManagementCharge": 1.00, "fundCharges": 0.35, "totalAnnualCharge": 1.35},
  "notes": "Offshore investment bond in USD. Gross roll-up with no UK tax within bond. Wide investment choice. Consider currency risk and exchange rate timing on encashment.",
  "createdAt": "2015-06-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Key Features - Offshore vs Onshore

| Feature | Onshore Bond | Offshore Bond |
|---------|--------------|---------------|
| Tax within bond | 20% basic rate paid | Gross roll-up (0% UK tax) |
| Tax on encashment | Higher/additional rate only | Full marginal rate on gain |
| Investment choice | Standard funds | Wider choice (alternatives, property, etc.) |
| Currency options | GBP only | Multiple currencies |
| 5% allowance | Yes | Yes |
| Top-slicing relief | Yes | Yes |

---

### 14.57 Arrangement - Investment Contract (Savings Account / Cash Deposit)

The `SavingsAccountArrangement` contract represents savings accounts, fixed-term deposits, and instant access cash accounts.

**Reference Type:** SavingsAccountArrangement is a reference type with identity (has `id` field).

**Key Features:**
- FSCS protection (£85,000 per institution)
- Instant access, notice, or fixed-term options
- Interest rates (gross and net)
- Personal Savings Allowance tracking
- Regular saver products
- No capital risk

#### Complete Savings Account Contract (Abbreviated)

```json
{
  "id": 13007,
  "href": "/api/v2/factfinds/679/arrangements/investments/13007",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "INVESTMENT",
  "investmentType": "SAVINGS_ACCOUNT",
  "savingsAccountType": "FIXED_TERM_DEPOSIT",
  "productName": "2 Year Fixed Rate Bond",
  "providerName": "Coventry Building Society",
  "client": {"id": 123, "href": "/api/v2/factfinds/679/clients/123"},
  "accountNumber": "SAV-445566778",
  "startDate": "2024-06-01",
  "maturityDate": "2026-06-01",
  "currentValue": {"amount": 51200.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "valuationDate": "2026-02-18",
  "depositAmount": {"amount": 50000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "interestEarned": {"amount": 1200.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "interestRate": {
    "grossAER": 5.10,
    "netAER": 4.08,
    "rateType": "FIXED",
    "fixedUntil": "2026-06-01",
    "taxDeductedAtSource": false
  },
  "accessTerms": {
    "accessType": "FIXED_TERM",
    "earlyAccessPenalty": "Interest forfeited for full term",
    "withdrawalsAllowed": 0,
    "maturityOptions": ["WITHDRAW_IN_FULL", "ROLLOVER_TO_NEW_TERM", "TRANSFER_TO_INSTANT_ACCESS"]
  },
  "fscsProtection": {
    "protected": true,
    "protectionLimit": {"amount": 85000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "balanceOverLimit": false
  },
  "personalSavingsAllowance": {
    "applicableTaxYear": "2025/26",
    "clientTaxBand": "HIGHER_RATE",
    "allowance": {"amount": 500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "interestEarnedThisYear": {"amount": 2550.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "taxableInterest": {"amount": 2050.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "estimatedTaxDue": {"amount": 820.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "notes": "Fixed term deposit for 2 years at 5.10% gross. FSCS protected. Interest taxable above £500 Personal Savings Allowance for higher rate taxpayer. Maturity June 2026 - review rates at maturity.",
  "createdAt": "2024-06-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Personal Savings Allowance (PSA)

| Tax Band | PSA | Tax on Excess |
|----------|-----|---------------|
| Basic rate (20%) | £1,000 | 20% |
| Higher rate (40%) | £500 | 40% |
| Additional rate (45%) | £0 | 45% |

---

### 14.58 Arrangement - Protection Contract (Critical Illness Cover)

The `CriticalIllnessCoverArrangement` contract represents critical illness insurance providing lump sum on diagnosis of specified conditions.

**Reference Type:** CriticalIllnessCoverArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Defined list of covered conditions (typically 40-50 conditions)
- Full pay-out conditions vs partial pay-out conditions
- Severity-based pay-outs (e.g., cancer staging)
- Children's cover included
- Additional payment cover
- Total permanent disability (TPD) benefit

#### Complete Critical Illness Cover Contract (Abbreviated)

```json
{
  "id": 20002,
  "href": "/api/v2/factfinds/679/arrangements/protection/20002",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "PROTECTION",
  "protectionType": "CRITICAL_ILLNESS_COVER",
  "policyType": "STANDALONE_CRITICAL_ILLNESS",
  "productName": "Vitality Serious Illness Cover",
  "providerName": "Vitality",
  "client": {"id": 123, "href": "/api/v2/factfinds/679/clients/123"},
  "policyNumber": "CIC-789456123",
  "startDate": "2023-01-15",
  "endDate": "2048-01-15",
  "termRemaining": {"years": 21, "months": 11},
  "sumAssured": {"amount": 200000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "premium": {"amount": 95.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "premiumFrequency": "MONTHLY",
  "premiumType": "REVIEWABLE",
  "coverageDetails": {
    "numberOfConditionsCovered": 47,
    "fullPayOutConditions": 42,
    "partialPayOutConditions": 5,
    "childrensCoverIncluded": true,
    "childrensCoverAmount": {"amount": 25000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "additionalPaymentCover": true,
    "additionalPaymentAmount": {"amount": 50000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "totalPermanentDisabilityCover": true
  },
  "keyConditionsCovered": [
    {"condition": "Cancer", "payOutType": "FULL_OR_PARTIAL_BASED_ON_SEVERITY"},
    {"condition": "Heart Attack", "payOutType": "FULL"},
    {"condition": "Stroke", "payOutType": "FULL"},
    {"condition": "Multiple Sclerosis", "payOutType": "FULL"},
    {"condition": "Coronary Artery Bypass", "payOutType": "FULL"},
    {"condition": "Kidney Failure", "payOutType": "FULL"},
    {"condition": "Major Organ Transplant", "payOutType": "FULL"},
    {"condition": "Loss of Limbs", "payOutType": "FULL"},
    {"condition": "Blindness", "payOutType": "FULL"},
    {"condition": "Deafness", "payOutType": "FULL"}
  ],
  "underwriting": {
    "underwritingType": "FULL_MEDICAL_UNDERWRITING",
    "completedDate": "2023-01-10",
    "exclusions": [],
    "loadings": []
  },
  "indexation": {
    "isIndexLinked": true,
    "indexationType": "RPI",
    "annualIncreasePercentage": 3.2
  },
  "linkedTo": {
    "mortgage": {"id": 12001, "href": "/api/v2/factfinds/679/arrangements/mortgages/12001"}
  },
  "notes": "Standalone critical illness cover for mortgage protection. 47 conditions covered including partial pay-outs. Children's cover (£25k) and additional payment cover (£50k) included. Index-linked to maintain real value. Review annually.",
  "createdAt": "2023-01-20T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Critical Illness - Full vs Partial Pay-Out

**Full Pay-Out Conditions (100% of sum assured):**
- Cancer (excluding less advanced cases)
- Heart attack (of specified severity)
- Stroke (with permanent symptoms)
- Major organ transplant
- Kidney failure (requiring dialysis)

**Partial Pay-Out Conditions (typically 25% of sum assured):**
- Early stage cancer
- Less severe heart attack
- Angioplasty
- Loss of one limb
- Less severe stroke

---

### 14.59 Arrangement - Protection Contract (Income Protection Insurance)

The `IncomeProtectionArrangement` contract represents income protection insurance providing replacement income during illness or injury.

**Reference Type:** IncomeProtectionArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Deferred period (4, 13, 26, 52 weeks)
- Benefit percentage (typically 50-70% of income)
- Payment period (to retirement age or fixed term)
- Guaranteed vs reviewable premiums
- Own occupation vs any occupation definition
- Rehabilitation benefits

#### Complete Income Protection Contract (Abbreviated)

```json
{
  "id": 20003,
  "href": "/api/v2/factfinds/679/arrangements/protection/20003",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "PROTECTION",
  "protectionType": "INCOME_PROTECTION",
  "productName": "Income Protection Plus",
  "providerName": "Legal & General",
  "client": {"id": 123, "href": "/api/v2/factfinds/679/clients/123"},
  "policyNumber": "IP-456789123",
  "startDate": "2023-06-01",
  "policyEndAge": 65,
  "coverRemaining": {"years": 17, "months": 4},
  "monthlyBenefit": {"amount": 3500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "premium": {"amount": 87.50, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "premiumFrequency": "MONTHLY",
  "premiumType": "GUARANTEED",
  "deferredPeriod": {
    "weeks": 13,
    "description": "13 weeks from onset of incapacity before benefit starts"
  },
  "benefitDetails": {
    "monthlyBenefit": {"amount": 3500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "annualBenefit": {"amount": 42000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "benefitPercentageOfIncome": 60.0,
    "grossAnnualIncome": {"amount": 70000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "paymentPeriod": "TO_RETIREMENT_AGE",
    "retirementAge": 65,
    "maximumBenefitPeriod": "Until age 65"
  },
  "occupationDefinition": {
    "definitionType": "OWN_OCCUPATION",
    "occupation": "Software Engineer",
    "occupationClass": "1",
    "description": "Unable to perform own occupation due to illness or injury"
  },
  "additionalBenefits": {
    "proportionateBenefit": true,
    "rehabilitationBenefit": {"amount": 3500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "hospitalCashBenefit": {"amount": 100.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }, "perDay": true},
    "waiversOfPremium": true
  },
  "indexation": {
    "isIndexLinked": true,
    "indexationType": "RPI",
    "cappedAt": 5.0
  },
  "underwriting": {
    "underwritingType": "FULL_MEDICAL_UNDERWRITING",
    "exclusions": ["Pre-existing back condition - 2 year exclusion"],
    "loadings": []
  },
  "notes": "Income protection covering 60% of income (£3,500/month). 13 week deferred period. Own occupation definition. Guaranteed premiums. Index-linked with 5% cap. Rehabilitation support included. Critical for mortgage and family protection.",
  "createdAt": "2023-06-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Income Protection Key Concepts

**Deferred Period:** Time between onset of incapacity and benefit payment start
- Longer deferred period = lower premium
- Typical options: 4, 8, 13, 26, 52 weeks

**Occupation Definition:**
- **Own Occupation:** Can't perform your specific job
- **Suited Occupation:** Can't perform any job you're suited to by training/experience
- **Any Occupation:** Can't perform any paid work

**Benefit Percentage:** Typically 50-70% of gross income (insurance companies limit to prevent over-insurance)

---

### 14.60 Arrangement - Protection Contract (Buildings Insurance)

The `BuildingsInsuranceArrangement` contract represents buildings insurance for property structural protection.

**Reference Type:** BuildingsInsuranceArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Rebuild cost basis (not market value)
- Structural damage cover
- Subsidence and landslip protection
- Alternative accommodation
- Public liability
- Accidental damage extension

#### Complete Buildings Insurance Contract (Abbreviated)

```json
{
  "id": 20004,
  "href": "/api/v2/factfinds/679/arrangements/protection/20004",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "PROTECTION",
  "protectionType": "BUILDINGS_INSURANCE",
  "productName": "Premier Home Insurance - Buildings",
  "providerName": "Aviva",
  "client": {"id": 123, "href": "/api/v2/factfinds/679/clients/123"},
  "policyNumber": "BLDG-123456789",
  "startDate": "2023-04-01",
  "renewalDate": "2026-04-01",
  "sumInsured": {"amount": 450000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "valuationBasis": "REBUILD_COST",
  "annualPremium": {"amount": 385.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "excess": {"amount": 250.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "subsidenceExcess": {"amount": 1000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "coverageDetails": {
    "fireAndLightning": true,
    "explosionAndEarthquake": true,
    "floodAndWeather": true,
    "theftAndVandalism": true,
    "subsidenceAndHeave": true,
    "impactDamage": true,
    "accidentalDamage": true,
    "alternativeAccommodation": {"amount": 50000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "publicLiability": {"amount": 2000000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "tracingAndAccessCover": {"amount": 5000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "propertyDetails": {
    "propertyType": "DETACHED_HOUSE",
    "constructionType": "STANDARD_BRICK",
    "yearBuilt": 1995,
    "numberOfBedrooms": 4,
    "roofType": "TILED",
    "heatingType": "GAS_CENTRAL_HEATING"
  },
  "linkedProperty": {
    "id": 12345,
    "href": "/api/v2/factfinds/679/properties/12345"
  },
  "notes": "Buildings insurance based on rebuild cost (£450k). Accidental damage included. Subsidence cover with £1k excess. Alternative accommodation up to £50k. Review rebuild cost annually to ensure adequate cover.",
  "createdAt": "2023-04-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Buildings vs Contents Insurance

| Feature | Buildings Insurance | Contents Insurance |
|---------|-------------------|-------------------|
| Covers | Structure, fixtures, fittings | Possessions inside property |
| Basis | Rebuild cost | Replacement cost |
| Who needs it | Property owner (required if mortgage) | Owner or tenant |
| Includes | Roof, walls, floors, built-in kitchen | Furniture, electronics, clothes, valuables |
| Alternative accommodation | Usually included | May be included |

---

### 14.61 Arrangement - Protection Contract (Contents Insurance)

The `ContentsInsuranceArrangement` contract represents contents insurance for possessions within property.

**Reference Type:** ContentsInsuranceArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Replacement value basis
- Specified high-value items
- Accidental damage extension
- All-risks cover for items outside home
- New-for-old replacement
- Personal liability

#### Complete Contents Insurance Contract (Abbreviated)

```json
{
  "id": 20005,
  "href": "/api/v2/factfinds/679/arrangements/protection/20005",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "PROTECTION",
  "protectionType": "CONTENTS_INSURANCE",
  "productName": "Premier Home Insurance - Contents",
  "providerName": "Aviva",
  "client": {"id": 123, "href": "/api/v2/factfinds/679/clients/123"},
  "policyNumber": "CONT-987654321",
  "startDate": "2023-04-01",
  "renewalDate": "2026-04-01",
  "sumInsured": {"amount": 75000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "valuationBasis": "NEW_FOR_OLD",
  "annualPremium": {"amount": 185.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "excess": {"amount": 100.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "coverageDetails": {
    "theft": true,
    "fireAndSmoke": true,
    "waterDamage": true,
    "accidentalDamage": true,
    "personalPossessionsAwayFromHome": true,
    "allRisksCover": {"amount": 10000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "personalLiability": {"amount": 2000000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "legalExpenses": {"amount": 50000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "bicycleCover": {"amount": 2000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "specifiedItems": [
    {"itemDescription": "Rolex Watch", "value": {"amount": 8500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}},
    {"itemDescription": "Diamond Engagement Ring", "value": {"amount": 6000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}},
    {"itemDescription": "Artwork - Oil Painting", "value": {"amount": 4500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}}
  ],
  "totalSpecifiedItemsValue": {"amount": 19000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "singleItemLimit": {"amount": 2000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "notes": "Contents insurance covering £75k total. High-value items specified separately (£19k). Accidental damage included. All-risks cover for items outside home (£10k). Bicycle cover (£2k). Review annually and update valuations.",
  "createdAt": "2023-04-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

---

### 14.62 Arrangement - Protection Contract (Private Medical Insurance)

The `PrivateMedicalInsuranceArrangement` contract represents private medical insurance (PMI) for healthcare treatment.

**Reference Type:** PrivateMedicalInsuranceArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Hospital list (full or restricted)
- Excess options (annual excess reduces premium)
- Underwriting method (medical history disregarded or fully underwritten)
- Out-patient cover
- Mental health cover
- Corporate vs individual policies

#### Complete Private Medical Insurance Contract (Abbreviated)

```json
{
  "id": 20006,
  "href": "/api/v2/factfinds/679/arrangements/protection/20006",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "PROTECTION",
  "protectionType": "PRIVATE_MEDICAL_INSURANCE",
  "policyType": "CORPORATE_PMI",
  "productName": "Company Health Insurance",
  "providerName": "Bupa",
  "client": {"id": 123, "href": "/api/v2/factfinds/679/clients/123"},
  "policyNumber": "PMI-445566778",
  "startDate": "2023-01-01",
  "renewalDate": "2026-01-01",
  "annualPremium": {"amount": 0.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "paidByEmployer": true,
  "benefitInKindValue": {"amount": 1850.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "excess": {"amount": 0.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
  "hospitalList": "FULL_LIST",
  "underwritingMethod": "MEDICAL_HISTORY_DISREGARDED",
  "coverageDetails": {
    "inPatientTreatment": true,
    "outPatientTreatment": true,
    "dayPatientTreatment": true,
    "diagnosticTests": true,
    "cancerCover": true,
    "mentalHealthCover": {"amount": 5000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }, "perYear": true},
    "dentalAccidentCover": true,
    "therapies": true,
    "prescriptionDrugs": true
  },
  "limits": {
    "annualLimit": "UNLIMITED",
    "outPatientLimit": {"amount": 1500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "therapiesLimit": {"amount": 1000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "notes": "Corporate PMI provided by employer. Full hospital list access. Medical history disregarded underwriting. Unlimited in-patient cover. Out-patient limited to £1,500 p.a. Mental health cover £5k p.a. Benefit-in-kind £1,850.",
  "createdAt": "2023-01-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

---

### 14.63 Arrangement - Mortgage Contract (Lifetime Mortgage - Equity Release)

The `LifetimeMortgageArrangement` contract represents lifetime mortgages (equity release) for over-55s with no monthly repayments.

**Reference Type:** LifetimeMortgageArrangement is a reference type with identity (has `id` field).

**Key Features:**
- No monthly repayments (interest rolls up)
- No negative equity guarantee (Equity Release Council standard)
- Fixed or capped interest rate
- Voluntary interest payment option
- Drawdown facility or lump sum
- Inheritance protection

#### Complete Lifetime Mortgage Contract (Abbreviated)

```json
{
  "id": 5002,
  "href": "/api/v2/factfinds/679/arrangements/mortgages/5002",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "MORTGAGE",
  "productType": "LifetimeMortgage",
  "lenderName": "Aviva Equity Release",
  "productName": "Lifetime Mortgage - Lump Sum",
  "policyNumber": "LTM-123456",
  "startDate": "2024-06-01",
  "borrowerDetails": [
    {"name": "John Smith", "dateOfBirth": "1955-03-15", "ageAtAdvance": 69},
    {"name": "Mary Smith", "dateOfBirth": "1957-08-22", "ageAtAdvance": 66}
  ],
  "youngestBorrowerAge": 66,
  "loanDetails": {
    "initialAdvance": {"amount": 85000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "currentBalance": {"amount": 87650.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "propertyValue": {"amount": 380000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
    "maxLoanToValue": 30.0
  },
  "interestDetails": {
    "interestRate": 5.95,
    "rateType": "FIXED_FOR_LIFE",
    "rollUpMethod": "COMPOUND_INTEREST",
    "noPaymentRequired": true,
    "voluntaryPaymentOption": true,
    "voluntaryPaymentMaxPerYear": {"amount": 10000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "projectedBalance": {
    "after5Years": {"amount": 114500.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "after10Years": {"amount": 149700.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "after15Years": {"amount": 195700.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "after20Years": {"amount": 255800.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "equityReleaseCouncilStandards": {
    "memberOfERC": true,
    "noNegativeEquityGuarantee": true,
    "guaranteedRightToRemain": true,
    "portabilityOption": true,
    "fixedInterestRate": true,
    "regulatedByFCA": true
  },
  "inheritanceProtection": {
    "protectionAmount": {"amount": 76000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "protectionPercentage": 20.0,
    "description": "20% of property value protected for inheritance"
  },
  "drawdownFacility": {
    "hasDrawdownFacility": false
  },
  "notes": "Lifetime mortgage releasing £85k equity. Fixed 5.95% for life with interest rolling up. No monthly payments required. No negative equity guarantee. 20% inheritance protection (£76k). Projected balance after 20 years: £256k. Review annually to monitor equity position.",
  "createdAt": "2024-06-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Lifetime Mortgage Key Features

**No Negative Equity Guarantee:** Balance owed will never exceed property sale proceeds

**Interest Roll-Up Calculation:**
```
year1Balance = initialLoan × (1 + rate)
year2Balance = year1Balance × (1 + rate)
yearNBalance = initialLoan × (1 + rate)^N
```

Example: £85,000 at 5.95% for 20 years = £255,800

**Equity Release Council Standards:**
- Member lenders must offer no negative equity guarantee
- Clients have right to remain in property for life
- Fixed interest rates standard
- Portability to new property (subject to lender criteria)

---

### 14.64 Arrangement - Mortgage Contract (Buy-to-Let Mortgage)

The `BuyToLetMortgageArrangement` contract represents buy-to-let mortgages for investment properties with rental income assessment.

**Reference Type:** BuyToLetMortgageArrangement is a reference type with identity (has `id` field).

**Key Features:**
- Rental income assessment (125-145% ICR)
- Higher interest rates than residential mortgages
- Limited company vs personal ownership
- Portfolio landlord considerations
- Section 24 tax implications
- HMO or standard tenancy

#### Complete Buy-to-Let Mortgage Contract (Abbreviated)

```json
{
  "id": 5003,
  "href": "/api/v2/factfinds/679/arrangements/mortgages/5003",
  "factfind": {"id": 679, "href": "/api/v2/factfinds/679"},
  "arrangementCategory": "MORTGAGE",
  "productType": "BuyToLetMortgage",
  "lenderName": "Paragon Bank",
  "productName": "Buy-to-Let Fixed Rate Mortgage",
  "policyNumber": "BTL-789456",
  "startDate": "2023-09-01",
  "loanDetails": {
    "originalLoanAmount": {"amount": 180000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "currentBalance": {"amount": 175000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "propertyValue": {"amount": 300000.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "interestDetails": {
    "interestRate": 4.75,
    "rateType": "FIXED",
    "fixedUntil": "2028-09-01",
    "reversionRate": 5.99,
    "monthlyPayment": {"amount": 976.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "rentalIncome": {
    "monthlyRental": {"amount": 1450.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "annualRental": {"amount": 17400.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }},
    "voidPeriodsAssumed": 1.0,
    "netAnnualRental": {"amount": 16530.00, "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }}
  },
  "interestCoverageRatio": {
    "requiredICR": 125.0,
    "actualICR": 145.0,
    "calculation": "(£17,400 / £11,713 annual interest) × 100 = 148.5% (passes 125% requirement)",
    "assessmentRate": 5.5,
    "meetsRequirement": true
  },
  "ownershipStructure": {
    "ownershipType": "PERSONAL",
    "section24TaxApplies": true,
    "section24Impact": "Mortgage interest relief restricted to basic rate (20%) from 2020/21"
  },
  "landlordProfile": {
    "isPortfolioLandlord": false,
    "numberOfBTLProperties": 1,
    "experiencedLandlord": false,
    "yearsExperience": 2
  },
  "tenancyDetails": {
    "tenancyType": "ASSURED_SHORTHOLD_TENANCY",
    "isHMO": false,
    "currentlyLet": true,
    "tenancyStartDate": "2023-10-01"
  },
  "notes": "Buy-to-let mortgage on investment property. Rental income £1,450/month. ICR 145% (passes 125% requirement). Personal ownership subject to Section 24 tax restrictions. Fixed rate until Sept 2028. Monitor rental market and consider limited company structure for tax efficiency.",
  "createdAt": "2023-09-05T10:00:00Z",
  "updatedAt": "2026-02-18T14:00:00Z"
}
```

#### Buy-to-Let Key Concepts

**Interest Coverage Ratio (ICR):**
```
ICR = (Annual Rental Income / Annual Mortgage Interest) × 100
Required ICR typically: 125% (standard), 145% (higher rate taxpayers)
Assessment rate: Typically 5.5% (stress test rate)
```

**Section 24 Tax Changes:**
- Pre-2017: Full mortgage interest tax relief at marginal rate (20%/40%/45%)
- From 2020/21: Interest relief restricted to basic rate (20%) only
- Higher rate landlords significantly impacted
- Many landlords switching to limited company ownership for tax efficiency

**Portfolio Landlord:** Typically 4+ mortgaged BTL properties


---

## Appendices

### Appendix A: Complete Entity-to-Endpoint Mapping

**Client Onboarding & KYC Context:**
- CLIENT → `/api/v2/factfinds/{factfindId}/clients`
- ADDRESS → `/api/v2/factfinds/{factfindId}/clients/{id}/addresses`
- CONTACT_DETAIL → `/api/v2/factfinds/{factfindId}/clients/{id}/contacts`
- PROFESSIONAL_CONTACT → `/api/v2/factfinds/{factfindId}/clients/{id}/professional-contacts`
- CLIENT_RELATIONSHIP → `/api/v2/factfinds/{factfindId}/clients/{id}/relationships`
- DPA_CONSENT → `/api/v2/factfinds/{factfindId}/clients/{id}/dpa-consent`
- MARKETING_CONSENT → `/api/v2/factfinds/{factfindId}/clients/{id}/marketing-consent`
- VULNERABLE_CUSTOMER_FLAG → `/api/v2/factfinds/{factfindId}/clients/{id}/vulnerability`
- DEPENDANT → `/api/v2/factfinds/{factfindId}/clients/{id}/dependants`

**Circumstances Context:**
- ADVICE_CASE → `/api/v2/factfinds`
- EMPLOYMENT → `/api/v2/factfinds/{id}/employment`
- INCOME → `/api/v2/factfinds/{id}/income`
- INCOME_CHANGE → `/api/v2/factfinds/{id}/income-changes`
- EXPENDITURE → `/api/v2/factfinds/{id}/expenditure`
- EXPENDITURE_CHANGE → `/api/v2/factfinds/{id}/expenditure-changes`

**Assets & Liabilities Context:**
- ASSET → `/api/v2/factfinds/{factfindId}/assets`
- PROPERTY_DETAIL → `/api/v2/factfinds/{factfindId}/assets/{id}` (embedded in ASSET)
- CREDIT_HISTORY → `/api/v2/factfinds/{factfindId}/clients/{id}/credit-history`
- VALUATION → `/api/v2/factfinds/{factfindId}/arrangements/{id}/valuations`

**Arrangements Context:**
- ARRANGEMENT → `/api/v2/factfinds/{factfindId}/arrangements`
- CONTRIBUTION → `/api/v2/factfinds/{factfindId}/arrangements/{id}/contributions`
- WITHDRAWAL → `/api/v2/factfinds/{factfindId}/arrangements/{id}/withdrawals`
- BENEFICIARY → `/api/v2/factfinds/{factfindId}/arrangements/{id}/beneficiaries`
- CLIENT_PENSION → `/api/v2/factfinds/{factfindId}/clients/{id}/pension-summary`

**Goals Context:**
- GOAL → `/api/v2/factfinds/{factfindId}/objectives`
- OBJECTIVE → `/api/v2/factfinds/{factfindId}/goals/{id}/objectives`
- NEED → `/api/v2/factfinds/{factfindId}/goals/{id}/needs`

**Risk Profile Context:**
- RISK_PROFILE → `/api/v2/factfinds/{factfindId}/risk-profile`

**Estate Planning Context:**
- GIFT → `/api/v2/factfinds/{factfindId}/gifts`
- GIFT_TRUST → `/api/v2/gift-trusts`

### Appendix B: HTTP Status Code Reference

**2xx Success:**
- `200 OK` - GET, PUT, PATCH successful with body
- `201 Created` - POST successful, resource created
- `204 No Content` - PUT, PATCH, DELETE successful without body

**4xx Client Errors:**
- `400 Bad Request` - Invalid request syntax or validation error
- `401 Unauthorized` - Authentication required or failed
- `403 Forbidden` - Authenticated but not authorized
- `404 Not Found` - Resource does not exist
- `409 Conflict` - Concurrent modification or business rule violation
- `412 Precondition Failed` - If-Match header missing/invalid
- `422 Unprocessable Entity` - Semantic validation error
- `429 Too Many Requests` - Rate limit exceeded

**5xx Server Errors:**
- `500 Internal Server Error` - Unexpected error
- `503 Service Unavailable` - Service temporarily unavailable

### Appendix C: Data Type Formats

**Date/DateTime (ISO 8601):**
- Date: `yyyy-MM-dd` (e.g., `2026-02-16`)
- DateTime: `yyyy-MM-ddTHH:mm:ssZ` (e.g., `2026-02-16T14:30:00Z`)
- Always UTC for DateTime

**Money:**
```json
{
  "amount": 75000.00,
  "currency": {
    "code": "GBP",
    "display": "British Pound",
    "symbol": "£"
  }
}
```

**Address:**
```json
{
  "line1": "123 High Street",
  "line2": "Apartment 4B",
  "city": "London",
  "postcode": "SW1A 1AA",
  "county": {
    "code": "GB-LND",
    "name": "London"
  },
  "country": {
    "code": "GB",
    "name": "United Kingdom"
  }
}
```

**Country (ISO 3166-1 alpha-2):**
```json
{
  "code": "GB",
  "name": "United Kingdom"
}
```

**County (ISO 3166-2):**
```json
{
  "code": "GB-LND",
  "name": "London"
}
```

**Percentage:**
- Range: 0.00 to 100.00
- Decimal places: 2
- Example: `4.75`, `50.0`, `100.00`

### Appendix D: Common Enumerations

**Marital Status:**
- Single
- Married
- CivilPartnership
- Divorced
- Widowed
- Separated

**Gender:**
- Male
- Female
- Other
- PreferNotToSay

**Employment Status:**
- Employed
- SelfEmployed
- CompanyDirector
- ContractWorker
- SemiRetired
- MaternityLeave
- LongTermIllness
- Unemployed
- Retired
- Student
- Homemaker
- Other

**Client Type:**
- Person
- Corporate
- Trust

**Service Status:**
- Prospect
- Active
- Inactive
- Archived

**Risk Rating:**
- VeryCautious
- Cautious
- Balanced
- Adventurous
- VeryAdventurous

### Appendix E: Security Considerations

**Authentication:**
- OAuth 2.0 with JWT tokens required for all endpoints
- Token expiry: 1 hour (access), 30 days (refresh)
- Support for token refresh flow

**Authorization:**
- Granular scope-based permissions
- Resource-level access control
- Tenant isolation enforced at data layer

**Data Protection:**
- PII fields obfuscated by default
- Special scope required for sensitive data
- Audit logging for all PII access
- GDPR right to erasure support

**Transport Security:**
- TLS 1.2+ required
- Strong cipher suites only
- Certificate validation enforced

**API Security:**
- Rate limiting per user and tenant
- Input validation and sanitization
- Output encoding to prevent XSS
- SQL injection prevention (parameterized queries)
- CSRF protection for state-changing operations

---

## Document Metadata

**Status:** Design Specification
**Date:** 2026-02-19
**Author:** Principal API Designer
**Reviewers:** Architecture Team, Product Owners, Compliance Team

**Scope:**
- Complete coverage of 50+ entities
- 8 bounded contexts with RESTful API specifications
- Full request/response contracts with validation rules
- Industry-standard terminology and compliance alignment

**Related Documents:**
- Greenfield ERD Design - FactFind System (steering/Target-Model/Greenfield-ERD-FactFind.md)
- API Design Guidelines 2.0 (Company Standards)
- FCA Handbook (COBS, PROD, ICOBS)
- MiFID II Directive
- GDPR Compliance Guidelines

**File Path:** `C:\work\FactFind-Entities\steering\API-Docs\FactFind-API-Design.md`

---



### 14.31 Net Worth

**Purpose:** Calculate and track client net worth based on total assets and liabilities.

**Structure:**
```json
{
  "id": 9001,
  "href": "/api/v2/factfinds/456/networth/9001",

  "factfind": {
    "id": 456,
    "href": "/api/v2/factfinds/456"
  },

  "clients": [
    {
      "id": 456,
      "href": "/api/v2/factfinds/456/clients/456"
    }
  ],

  "calculatedOn": "2026-02-18T14:30:00Z",

  "assets": {
    "property": {
      "amount": 450000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "pensions": {
      "amount": 325000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "investments": {
      "amount": 185000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "cash": {
      "amount": 45000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "other": {
      "amount": 25000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalAssets": {
      "amount": 1030000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "liabilities": {
    "mortgages": {
      "amount": 240000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "loans": {
      "amount": 15000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "creditCards": {
      "amount": 8500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "other": {
      "amount": 5000.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    },
    "totalLiabilities": {
      "amount": 268500.00,
      "currency": {
        "code": "GBP",
        "display": "British Pound",
        "symbol": "£"
      }
    }
  },

  "netWorth": {
    "amount": 761500.00,
    "currency": {
      "code": "GBP",
      "display": "British Pound",
      "symbol": "£"
    }
  },

  "notes": "Net worth calculation as of property revaluation",

  "createdAt": "2026-02-18T14:30:00Z",
  "updatedAt": "2026-02-18T14:30:00Z"
}
```

**Field Definitions:**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| id | integer | Yes | Unique identifier |
| href | string | Yes | Resource URI |
| factfind | Reference | Yes | Parent factfind reference |
| clients | Array[Reference] | Yes | Client references |
| calculatedOn | datetime | Yes | Calculation date |
| assets | Object | Yes | Asset breakdown |
| assets.property | MoneyValue | Yes | Property assets total |
| assets.pensions | MoneyValue | Yes | Pension assets total |
| assets.investments | MoneyValue | Yes | Investment assets total |
| assets.cash | MoneyValue | Yes | Cash assets total |
| assets.other | MoneyValue | Yes | Other assets total |
| assets.totalAssets | MoneyValue | Yes | Total assets |
| liabilities | Object | Yes | Liability breakdown |
| liabilities.mortgages | MoneyValue | Yes | Mortgage liabilities total |
| liabilities.loans | MoneyValue | Yes | Loan liabilities total |
| liabilities.creditCards | MoneyValue | Yes | Credit card liabilities total |
| liabilities.other | MoneyValue | Yes | Other liabilities total |
| liabilities.totalLiabilities | MoneyValue | Yes | Total liabilities |
| netWorth | MoneyValue | Yes | Net worth (assets - liabilities) |
| notes | string | No | Additional notes |
| createdAt | datetime | Yes | Creation timestamp |
| updatedAt | datetime | Yes | Last update timestamp |

**Validation Rules:**
- All clients must be associated with the factfind
- Calculations must be mathematically correct:
  - totalAssets = sum of all asset categories
  - totalLiabilities = sum of all liability categories
  - netWorth = totalAssets - totalLiabilities
- All money values must have consistent currency
- calculatedOn cannot be in the future
- Net worth can be negative (more liabilities than assets)


**END OF SPECIFICATION**

This comprehensive API design provides production-ready specifications for implementing the complete FactFind system. All endpoints follow RESTful principles, industry standards, and regulatory requirements for wealth management platforms.



